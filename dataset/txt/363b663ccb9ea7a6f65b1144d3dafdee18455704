urces for the Applet;
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 12/150
                        eMRTD Configuration)

        o  Global Platform Card Manager, responsible for management of Applets
           on the card.
        o Mifare implementation can be enabled or disabled for this TOE.
        o Crypto Library.
    The Applet Layer is IDeal Pass v2.3-n JC with Privacy Protection
     (SAC/EAC/Polymorphic eMRTD Configuration) applet.




                                        Figure 1: TOE



1.4.2 TOE usage and security features for operational use
Depending on its configuration during pre-personalisation and personalisation,
the TOE can be used as:
    ICAO/EAC eMRTD,
    Polymorphic eMRTD and
    EU/ISO Driving Licence.

The ICAO/EAC eMRTD, Polymorphic eMRTD and Driver Licence are installed as a
separate application instances of the applet having their own dedicated
application identifiers and personalisation. The following TOE configurations are
covered within the scope of this Security Target:

    Configuration ICAO/EAC            Polymorphic        Driver licence
                  eMRTD               eMRTD
    1             present             -                  -
    2             present             present            -
    3             -                   -                  present
    4             -                   present            present
    5             -                   Present            -

The authentication protocols PACEv2, Chip authentication (CAv1), Active
Authentication and Terminal Authentication (TAv1) specified in [ICAO-9303] and
                         Security Target Lite
                                                                             Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                       2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                         Page: 13/150
           Document Basic Access Keys.

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6                Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.6.1              The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE during a BAC mechanism based communication after successful
                          authentication of the terminal with Basic Access Control Authentication
                          Mechanism.




 FIA_AFL.1                Authentication failure handling

 Hierarchical to:         No other components.

 Dependencies:            FIA_UAU.1 Timing of authentication

 FIA_AFL.1.1              The TSF shall detect when a configurable number (see application note below) of
                          unsuccessful authentication attempts occur related to authentication attempts
                          using the BAC password as shared password.

 FIA_AFL.1.2              When the defined number of unsuccessful authentication attempts has been met
                          the TSF shall increasingly slow down the performance up to a maximum not
                          higher than 7 seconds verifying the authentication token.

 [IFX specific]           The number of failed authentication attempts is configurable. This configurable
                          number can be in the range [1..7f].
 Application note




CC Document                                          35
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.3             Class FDP User Data Protection


 FDP_ACC.1                Subset access control – Basic Access control

 Hierarchical to:         No other components

 Dependencies:            FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1              The TSF shall enforce the Basic Access Control SFP on terminals gaining write,
                          read and modification access to data in the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of
                          the logical MRTD.




 FDP_ACF.1                Basic Security attribute based access control – Basic Access Control

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACC.1 Subset access control, FMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1              The TSF shall enforce the Basic Access Control SFP to objects based on the
                          following:
                          1. Subjects:
                                                     a) Personalisation Agent,
                                                     b) Basic Inspection System,
                                                     c) Terminal,
                          2. Objects
                                                     a) data EF.DG1 to EF.DG16 of the logical MRTD,
                                                     b) data in EF.COM,
                                                     c) data in EF.SOD,
                          3. Security attributes
                                                     a) authentication status of terminals

 FDP_ACF.1.2              The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed:
                          1. the successfully authenticated Personalisation Agent is allowed to write and to
                             read the data of the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of the logical MRTD,
                          2. the successfully authenticated Basic Inspection System is allowed to read the
                             data in EF.COM, EF.SOD, EF.DG1, EF.DG2 and EF.DG5 to EF.DG16 of the logical
                             MRTD.

 FDP_ACF.1.3              The TSF shall explicitly authorise access of subjects to objects based on the
                          following additional rules: none.


CC Document                                           36
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_ACF.1.4              The TSF shall explicitly deny access of subjects to objects based on the rule:
                          1. Any terminal is not allowed to modify any of the EF.DG1 to EF.DG16 of the
                             logical MRTD.
                          2. Any terminal is not allowed to read any of the EF.DG1 to EF.DG16 of the logical
                             MRTD.
                          The Basic Inspection System is not allowed to read the data in EF.DG3 and EF.DG4.

 Refinement:              This SFR was refined (deletion of 3. from the list of Objects) as the optional EF.DG3
                          and EF.DG4 are not created and therefore do not exist.




 FDP_UCT.1                Basic data exchange confidentiality - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]

 FDP_UCT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from unauthorized disclosure.




 FDP_UIT.1                Data exchange integrity - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                          [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]

 FDP_UIT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from modification, deletion, insertion and
                          replay errors.

 FDP_UIT.1.2              The TSF shall be able to determine on receipt of user data, whether modification,
                          deletion, insertion and replay has occurred.




CC Document                                           37
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.4             Class FAU Security Audit


 FAU_SAS.1/BAC            Audit storage

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FAU_SAS.1.1/BAC          The TSF shall provide the Manufacturer with the capability to store the IC
                          Identification Data in the audit records.




7.1.4.5             Class FMT Security Management


 FMT_SMF.1/BAC            Specification of Management Functions

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies

 FMT_SMF.1.1/BAC          The TSF shall be capable of performing the following management functions:
                          1. Initialization,
                          2. Pre-Personalisation,
                          3. Personalisation.



 FMT_SMR.1                Security roles

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE

 FMT_SMR.1.1              The TSF shall maintain the roles
                          1. Manufacturer,
                          2. Personalisation Agent,
                          3. Basic Inspection System


CC Document                                          38
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_SMR.1.2              The TSF shall be able to associate users with roles.




 FMT_LIM.1/BAC            Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability: fulfilled by FMT_LIM.2

 FMT_LIM.1.1 /BAC         The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with ‘Limited availability (FMT_LIM.2) the following policy is enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks




 FMT_LIM.2/BAC            Limited availability

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.1 Limited capabilities: fulfilled by FMT_LIM.

 FMT_LIM.2.1/BAC          The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with ‘Limited capabilities (FMT_LIM.1)’ the following policy is
                          enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks



 FMT_MTD.1/INI_DIS/BAC         Management of TSF data – Reading and Using Initialisation and Pre-
                               Personalisation Data

 Hierarchical to:              No other components.


CC Document                                           39
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:               FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                             FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/INI_DIS/BAC     The TSF shall restrict the ability to disable read access for users to the
                             Initialisation Data to the Personalisation Agent.




 FMT_MTD.1/KEY_WRITE        Management of TSF data – Key Write

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_WRITE      The TSF shall restrict the ability to write the Document Basic Access Keys to the
                            Personalisation Agent.




 FMT_MTD.1/KEY_READ/BAC         Management of TSF data – Key Read

 Hierarchical to:               No other components.

 Dependencies:                  FMT_SMF.1 Specification of management functions fulfilled by FMT_SMF.1
                                FMT_SMR.1 Security roles fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/KEY_READ/BAC       The TSF shall restrict the ability to read the Document Basic Access Keys and
                                Personalisation Agent Keys to none.




7.1.4.6             Class FPT Protection of the Security Functions


 FPT_EMSEC.1              TOE Emanation

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies.

CC Document                                           40
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMSEC.1.1            The TOE shall not emit electromagnetic and current emissions in excess of none
                          useful information enabling access to Personalisation Agent Key(s) and Document
                          Basic Access Keys

 FPT_EMSEC.1.2            The TSF shall ensure any unauthorized users are unable to use the following
                          interface smart card circuit contacts to gain access to Personalisation Agent Key(s)
                          and Document Basic Access Keys.




 FPT_FLS.1/BAC            Failure with preservation of secure state

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_FLS.1.1              The TSF shall preserve a secure state when the following types of failures occur:
                          1. Exposure to out-of-range operating conditions where therefore a malfunction
                             could occur,
                          2. Failure detected by TSF according to FPT_TST.1,




7.1.5               SFRs specifically from [PP_EAC]

7.1.5.1             Cryptographic support


 FCS_CKM.1/CA             Cryptographic key generation – Diffie-Hellman for Chip Authentication
                          session keys

 Hierarchical to:          No other components.

 Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                          operation]




CC Document                                          41
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_CKM.1.1/CA           The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm ECDH cryptographic key generation
                          algorithm and specified cryptographic key sizes:
                          id-CA-ECDH-3DES-CBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or FCS_CKM.1


CC Document                                          43
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                                        Cryptographic key generation]FCS_CKM.4 Cryptographic key
                                        destruction

 FCS_COP.1.1/CA_MAC                     The TSF shall perform secure messaging – message authentication
                                        code in accordance with a specified cryptographic algorithm AES CMAC
                                        and 3DES-CBC and cryptographic key sizes 128, 192, 256 bits for AES
                                        CMAC and 112 for 3DES-CBC that meet the following: compliant to
                                        [ICAO_SAC] .


                                        Personalisation of the TOE is done using the secure channel protocol
 [IFX specific]
                                        03 as specified in [GPv2_3_1] with AES 256 bits key length with CMAC
 Application note                       compliant with NIST 800-38A.




7.1.5.3             Class FIA Identification and Authentication


The following table provides an overview of the authentication mechanisms used.

 Name                                                               SFR for the TOE

 Authentication Mechanism for Personalisation Agents                FIA_UAU.4/PACE
 Chip authentication v.1                                            FIA_API.1,
                                                                    FIA_UAU.5/PACE,
                                                                    FIA_UAU.6/EAC

 Chip Active Authentication                                         FIA_API.1/AA
 Terminal Authentication Protocol v.1                               FIA_UAU.5/PACE
 PACE protocol (listed only for information purposes, so will not   FIA_UAU.1/PACE
 be described further in this section)                              FIA_UAU.5/PACE
                                                                    FIA_AFL.1/PACE

 Passive authentication                                             FIA_UAU.5/PACE




 FIA_API.1/AA              Authentication Proof of Identity (Active Authentication)

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.


CC Document                                            44
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          The TSF shall provide the Active Authentication Mechanisms according to
 FIA_API.1.1/AA
                          [ICAO_9303_1] to prove the identity of the TOE.


 [IFX specific]           The SFR FIA_API.1/AA has been included in this security target in addition to the
 Application Note:        SFRs defined by the Protection Profiles claimed in section 3.2. This extension does
                          not conflict with the strict conformance to the claimed Protection Profiles.




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110_1]
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-03110_1]
                          (see next item 6)
                           6. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is identified.


 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel


CC Document                                            45
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key
                          5. to carry out the Chip Authentication Protocol Version 1 according to [TR-
                          03110_1]
                          6. to carry out the Terminal Authentication Protocol Version a 1ccording to [TR-
                          03110_1] (see next item 7)
                           7. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is authenticated.



 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




                          Single-use authentication mechanisms - Single-use authentication of the
 FIA_UAU.4/PACE
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according [ICAO_SAC],
                          2. Authentication Mechanism based on Triple- DES or AES .
                          3. Terminal Authentication Protocol v.1 according to [TR-03110_1].




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide

CC Document                                            46
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. PACE Protocol according to [ICAO_SAC],
                          2. Passive Authentication according to [ICAO_9303_01],
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC],
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                              length
                          5. Terminal Authentication Protocol v.1 according to [TR-03110_1],
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                          commands with correct message authentication code sent by means of secure
                          messaging with the key agreed with the terminal by means of the PACE protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by secure
                          channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key length.
                          3. After run of the Chip Authentication Protocol Version 1 the TOE accepts only
                          received commands with correct message authentication code sent by means of
                          secure messaging with key agreed with the terminal by means of the Chip
                          Authentication Mechanism v1.
                          4. The TOE accepts the authentication attempt by means of the Terminal
                          Authentication Protocol v.1 only if the terminal uses the public key presented
                          during the Chip Authentication Protocol v.1 and the secure messaging established
                          by the Chip Authentication Mechanism v.1 19.
                          5. None

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6/EAC            Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.




CC Document                                          47
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE after successful run of the Chip Authentication Protocol Version 1 shall
                          be verified as being sent by the Inspection System.




 FIA_API.1                 Authentication Proof of Identity

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.

 FIA_API.1.1              The TSF shall provide a Chip Authentication Protocol Version 1 according to [TR-
                          03110_1] to prove the identity of the TOE.




7.1.5.4             Class User Data Protection


 FDP_ACC.1/TRM             Subset access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1/TRM          The TSF shall enforce the Access Control SFP on terminals gaining access to the
                          User Data and data stored in EF.SOD of the logical travel document



The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below
(Common Criteria Part 2).



 FDP_ACF.1/TRM             Security attribute based access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACC.1 Subset access controlFMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1/TRM           The TSF shall enforce the Access Control SFP to objects based on the following:

CC Document                                          48
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. Subjects:
                            a.Terminal,
                            b.BIS-PACE
                            c.Extended Inspection System
                          2. Objects:
                             a.data in EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                          logical travel document ,
                            b.data in EF.DG3 of the logical travel document ,
                            c.data in EF.DG4 of the logical travel document ,
                            d.all TOE intrinsic secret cryptographic keys stored in the travel document
                          3. Security attributes:
                            a.PACE Authentication
                            b.Terminal Authentication v.1
                            c.Authorisation of the Terminal.

 FDP_ACF.1.2/TRM          The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed: A BIS-PACE is allowed to
                          read data objects from FDP_ACF.1.1/TRM according to [4] after a successful PACE
                          authentication as required by FIA_UAU.1/PACE.

 FDP_ACF.1.3/TRM          The TSF shall explicitly authorize access of subjects to objects based on the
                          following additional rules: none.

 FDP_ACF.1.4/TRM          The TSF shall explicitly deny access of subjects to objects based on the following
                          additional rules:
                          1.Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                          allowed to read, to write, to modify, to use any User Data stored on the travel
                          document.
                          2.Terminals not using secure messaging are not allowed to read, to write, to
                          modify, to use any data stored on the travel document.
                          3.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 3 (Fingerprint) granted by the relative
                          certificate holder authorization encoding is not allowed to read the data objects
                          2b) of FDP_ACF.1.1/TRM.
                          4.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 4 (Iris) granted by the relative certificate holder
                          authorization encoding is not allowed to read the data objects 2c) of
                          FDP_ACF.1.1/TRM.
                          5.Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.

CC Document                                           49
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          6.Terminals authenticated as CVCA or as DV are not allowed to read data in the
                          EF.DG3 and EF.DG4 .




7.1.5.5             Class FMT Security Management


 FMT_SMR.1/PACE            Security roles

 Hierarchical to:          No other components.

 Dependencies:             FIA_UID.1 Timing of identification.

 FMT_SMR.1.1/PACE          The TSF shall maintain the roles
                           1.Manufacturer ,
                           2.Personalisation Agent,
                           3.Terminal,
                           4.PACE authenticated BIS-PACE,
                           5.Country Verifying Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability.

 FMT_LIM.1.1              The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                          enforced: Deploying Test Features after TOE Delivery does not allow,
                          1.User Data to be manipulated and disclosed,


CC Document                                           50
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2.TSF data to be disclosed or manipulated,
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.




 FMT_LIM.2                Limited availability

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_LIM.1 Limited capabilities.

 FMT_LIM.2.1              The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is
                          enforced:
                          Deploying Test Features after TOE Delivery does not allow:
                          1.User Data to be manipulated and disclosed,
                          2.TSF data to be disclosed or manipulated
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed .




 FMT_MTD.1/CVCA_INI        Management of TSF data – Initialization of CVCA Certificate and Current Date

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions
                           FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_INI      The TSF shall restrict the ability to write the

CC Document                                            51
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                           1.initial Country Verifying Certification Authority Public Key,
                           2.initial Country Verifying Certification Authority Certificate,
                           3.initial Current Date,
                           4. none
                           to Personalisation agent.




 FMT_MTD.1/CVCA_UPD         Management of TSF data – Country Verifying Certification Authority

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_UPD       The TSF shall restrict the ability to update the
                            1.Country Verifying Certification Authority Public Key,
                            2.Country Verifying Certification Authority Certificate
                            to Country Verifying Certification Authority.




 FMT_MTD.1/DATE             Management of TSF data – Current date

 Hierarchical to:
                            No other components.


 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/DATE           The TSF shall restrict the ability to modify the Current date to
                            1.Country Verifying Certification Authority,
                            2.Document Verifier,
                            3.Domestic Extended Inspection System.




CC Document                                            52
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_MTD.1/CAPK            Management of TSF data – Chip Authentication Private Key

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions, FMT_SMR.1 Security roles

 FMT_MTD.1.1/CAPK         The TSF shall restrict the ability to load the Chip Authentication Private Key to
                          Personalisation agent.




 FMT_MTD.1/KEY_READ         Management of TSF data – Key Read

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_READ       The TSF shall restrict the ability to read the
                            1.PACE passwords ,
                            2.Chip Authentication Private Key,
                            3.Personalisation Agent Keys
                            to none.




 FMT_MTD.3                Secure TSF data

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_MTD.1 Management of TSF data

 FMT_MTD.3.1              The TSF shall ensure that only secure values of the certificate chain are accepted
                          for TSF data of the Terminal Authentication Protocol v.1 and the Access Control.

 Refinement:              The certificate chain is valid if and only if
                          1. the digital signature of the Inspection System Certificate can be verified as
                          correct with the public key of the Document Verifier Certificate and the expiration
                          date of the Inspection System Certificate is not before the Current Date of the TOE,


CC Document                                             53
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. the digital signature of the Document Verifier Certificate can be verified as
                          correct with the public key in the Certifi Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability.

 FMT_LIM.1.1              The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                          enforced: Deploying Test Features after TOE Delivery does not allow,
                          1.User Data to be manipulated and disclosed,


CC Document                                           50
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2.TSF data to be disclosed or manipulated,
                          3.software to be reconstructed,
                          4.subst                         FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
 Dependencies:
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
                          The TSF shall restrict the ability to create and load the Active Authentication
 FMT_MTD.1.1/AA
                          Private Key to the Manufacturer and the Personalisation Agent.

 [IFX specific]           This SFR has been included in this security target in addition to the SFRs defined
                          by the Protection Profiles claimed in section 3.2 to address the import of private
 Application Note:
                          key used for AA. This extension does not conflict with the strict conformance to the
                          claimed Protection Profiles




7.1.5.6             Class FPT Protection of the Security Functions


 FPT_EMS.1                  TOE Emanation

 Hierarchical to:           No other components.

 Dependencies:              No Dependencies.



CC Document                                           54
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMS.1.1                The TOE shall not emit variations in power consumption or timing during com-
                            mand execution in excess of non-useful information enabling access to
                            1.Chip Authentication Session Keys
                            2.PACE session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s),
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.

 FPT_EMS.1.2                The TSF shall ensure any users are unable to use the following interface smart card
                            circuit contacts to gain access to
                            1.Chip Authentication Session Keys
                            2.PACE Session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s) and
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.




 7.2           Security Assurance Requirements
For the BAC feature, the TOE claims EAL 4 augmented with ALC_DVS.2, therefore [PP_BAC] section 6.2 “Security
Assurance Requirements for the TOE” applies.
For PACE and PACE-EAC features, the current document claims EAL5 augmented with ALC_DVS.2 and
AVA_VAN.5 therefore it claims a higher assurance level compared to [PP_SAC] and [PP_EAC], section 6.2
respectively.




CC Document                                           55
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 7.3          Security Requirements Rationale

7.3.1             Security Functional Requirements Rationale
Respective sections 6.3.1 “Security Functional Requirements Rationale” of [PP_SAC], [PP_BAC] and [PP_EAC]
are applicable for this chapter.
For the additionally defined SFRs in this ST, FIA_API.1/AA, FMT_MTD.1/AA and FCS_COP.1/SIG_GEN formalizing
the Active Authentication feature they meet the security objective OT.Active_Auth.




7.3.2             Rationale for SFR’s Dependencies
[PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.2 “Rationale for SFR’s Dependencies” are also applicable for this
chapter.


7.3.3             Security Assurance Requirements Rationale
[PP_BAC] section 6.3.3 “Security Assurance Requirements Rationale “ is applicable for this chapter.
[PP_EAC] and [PP_SAC] and their respective sections 6.3.3 “Security Assurance Requirements Rationale“ are
also applicable for this chapter with one additional rationale justifying the security assurance dependencies.
With the exception of ALC_DVS.2 and AVA_VAN.5, all assurance components are part of the EAL5 package,
which by package design does not have any dependency conflicts and is hierarchical to EAL4. The assurance
components ALC_DVS.2 and AVA_VAN.5 are also part of the assurance requirements from [PP_SAC], where
assurance dependencies are met as is shown in section 6.3.3 from [PP_SAC].
EAL5+ augmented with ALC_DVS.2 and AVA_VAN.5 is appropriate for this TOE, because this assurance level is
requested by several states. The assurance expectations for this kind of application are high due to the
sensitivity of data stored by the TOE. Therefore several governmental organizations request for an increased
assurance level.


7.3.4              Security Requirements – Internal Consistency
The rationale for the internal consistency of the SFRs from [PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.4
“Security Requirements – Internal Consistency” are also applicable to this chapter.
The assurance package EAL5 and EAL4 are pre-defined sets of internally consistent assurance requirements.
The dependency analysis for the sensitive assurance components in [PP_SAC], [PP_EAC] and [PP_BAC] section
7.3.3 “Security Assurance Requirements Rationale” together with the additional rational from section 7.3.3
show that the assurance requirements are internally consistent as all (additional) dependencies are satisfied
and no inconsistency appears.
The rationale for internal consistency between functional and assurance requirements from [PP_SAC] ,
[PP_EAC] and and [PP_BAC] section 6.3.4 “Security Requirements – Internal Consistency” are also applicable to
this chapter.




CC Document                                            56
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




    8             TOE Summary Specification
This TOE summary specification described in this section relies on the security services provided by the
platform product. For a description of these services please refer to [ST_JC_ID_S_Platform].
In the following each SFR is mentioned together with an indication for the PP from which these are originating
        -   (BAC) stands for SFRs originating from [PP_BAC].
        -   (SAC) stands for SFRs originating from [PP_SAC].
        -   (EAC) stands for SFRs originating from [PP_EAC]. Note that we include here also in this group the SFRs
            related to Active Authentication.
The composite TOE provides the security functions as follows:
       SF_EAC_PACE_BAC
The TOE implements the EAC, PACE and BAC protocol (PICC side). It encompasses:
        -   ECDH key generation, FCS_CKM.1/DH_PACE (SAC) and FCS_CKM.1/CA (EAC): The TOE uses the
            platform service “Elliptic Curves EC” for EC key generation. Further for session key generation the
            application uses the hybrid physical random number generator of the platform complying to PTG.3 as
            per [AIS31]. For the key generation the TOE supports “Generic Mapping” provided by the platform.
        -   Generation of Document Basic Access Keys, FCS_CKM.1 (BAC), FCS_COP.1/SHA (BAC): The TOE uses
            the cryptographic APIs provided by the underlying Secora ID S OS.
        -   Key destruction, FCS_CKM.4: The TOE uses the platform API ‘clearKey’ service to destroy session keys.
            The platform API ‘clearKey’ uses random numbers compliant to PTG.3 as per [AIS31] to overwrite the
            session keys.
        -   Provision of random numbers, as per FCS_RND.1. Authentication failure handling, FIA_AFL.1/PACE
            (SAC), FIA_AFL.1 (BAC): The TOE implements this check in such a way, that it withstands tearing events.
            A counter for unsuccessful authentication attempts is incremented before authentication is performed
            and reset in case of successful authentication.
        -   Prevention of replay attacks, FIA_UAU.4/PACE (EAC), FIA_UAU.4/PACE (SAC), FIA_UAU.4 (BAC):
            Replay attacks are prevented by the cryptographic protocol, which relies on good quality random
            numbers as required by FCS_RND.1 of this ST and supported by the underlying RNG of the platform and
            claimed in the ST of the platform with SFR FCS_RNG.1.
        -   Multiple authentication, FIA_UAU.5/PACE (EAC), FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE
            follows the protocol as described in [ICAO_SAC].
 SF_AA
  - Signature generation for the Active Authentication mechanism covered by FIA_API.1/AA,
     FCS_COP.1/SIG_GEN
  - Injecting private cryptographic keys used for the signatures as per FMT_MTD.1/AA
 SF_AuthPersoAgent
  - FIA_UAU.5/PACE (EAC) , FIA_UAU.5/PACE (SAC), FCS_COP.1/AUTH (BAC): The TOE uses the protocol
     scp v0.3 as per [GPv2_3_1] based on AES [FIPS_197] for authenticating the personalization agent.




CC Document                                                57
                                                                                                           1.2
                                                                                                           2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



   SF_SecureMessaging
    - Secure messaging, encryption/decryption, FCS_COP.1/PACE_ENC (SAC), FCS_COP.1/ENC (BAC): The
       TOE uses the proprietary PACE API from Secora ID S OS.
    - Secure messaging integrity protection, FCS_COP.1/PACE_MAC (SAC), FCS_COP.1/MAC (BAC): The TOE
       uses the underlying platform PACE dedicated API to calculate CMAC or Retail-MAC.
    - FCS_COP.1/CA_ENC (EAC), FCS_COP.1/CA_MAC (EAC) and FCS_COP.1/SIG_VER (EAC) are satisfied by
       using the standard Java Card API supported by the platform.
    - FCS_COP.1/CA_MAC (EAC) also covers to the GP scp03 used for secure card content management
       during personalization. This aspect of secure messaging by the TOE relies on the specially tailored API
       to GP SCP from the underlying platform and described in the SFR FCS_COP.1/SCP.
    - Multiple authentication, FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE performs a MAC check for
       every received message before instruction is executed, if the MAC check fails secure messaging is
       aborted; every response during secure messaging is MAC’ed by the TOE.
    - Re-authentication of terminal, FIA_UAU.6/EAC (EAC), FIA_UAU.6/PACE (SAC), FIA_UAU.6 (BAC): The
       TOE checks for every incoming message, whether the message is genuine (MAC check).
    - Trusted channel, FTP_ITC.1/PACE (SAC): The TOE follows the standardized implementation of the
       trusted channel according to [ICAO_SAC].

   SF_AccessControl
    - Allow specific access before user identification, FIA_UID.1/PACE (EAC), FIA_UID.1/PACE (SAC),
       FIA_UID.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess (see
       [ICAO_9303_11]) and EF.ATR/INFO (see [ISO7816-4]) before PACE or BAC authentication is performed.
       The TOE allows to read a specific subset of initialization data.
    - Allow specific access before user authentication, FIA_UAU.1/PACE (EAC), FIA_UAU.1/PACE (SAC),
       FIA_UAU.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess and
       EF.ATR/INFO before PACE or BAC authentication was performed. The TOE allows to read a specific
       subset of initialization data.
    - Subset and security attribute based access control, FDP_ACC.1/TRM (EAC), FDP_ACC.1/TRM (SAC),
       FDP_ACC.1 (BAC), FDP_ACF.1/TRM (EAC), FDP_ACF.1/TRM (SAC), FDP_ACF.1 (BAC), the TOE blocks
       access to EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM, EF.DG3 and EF.DG4 in case BAC
       or PACE protocol is not successfully performed.
    - Residual information protection, FDP_RIP.1: as soon secure messaging is stopped, the whole secure
       messaging context including session keys is wiped with random numbers.
    - Data exchange confidentiality, FDP_UCT.1/TRM (SAC), FDP_UCT.1 (BAC): during secure messaging,
       responses by the ICC are always wrapped (encrypted and MAC’ed) before being sent.
    - Data exchange integrity, FDP_UIT.1/TRM (SAC), FDP_UIT.1 (BAC) : during secure messaging, responses
       by the ICC aCBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of usProtection (SAC/EAC/Polymorphic
                                                                  Page: 26/150
                        eMRTD Configuration)

The additional functionality of Password Authenticated Connection Establishment
with Chip Authentication Mapping (PACE-CAM) has been added to the TOE. It
possesses the same security requirements as the PACE functionality, which
means that the same security problem definition is applicable for PACE-CAM.


The following additional SFRs have been defined for PACE-CAM:
              FIA_UID.1/PACE_CAM
                FIA_UAU.1/PACE_CAM
                FIA_UAU.4/PACE_CAM
                FIA_UAU.5/PACE_CAM
                FIA_UAU.6/PACE_CAM
                FMT_MTD.1/PACE_CAM_KEY_READ
                FMT_MTD.1/PACE_CAM_KEY_WRITE




The additional functionality of the Polymorphic eMRTD extensions has been
added to the TOE with: (i) additional security problem definition; (ii) additional
security objectives; (iii) additional SFRs. Notice that many SFRs are included
from the [EACv2-PP].
                        Security Target Lite
                           eneral support for cryptographic operations needed.

OT.Data_Authenticity The security objective OT.Data_Authenticity aims
  ensuring authenticity of the User- and TSF data (after the PACE
  Authentication) by enabling its verification at the terminal-side and by an
  active verification by the TOE itself. This objective is mainly achieved by
  FTP_ITC.1/PACE using FCS_COP.1/PACE_MAC. A phe caller.
                                    Deviation of step c) and f):
                                         o The jumps to step a) were substituted by a return of the function with
                                              an error code, the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                     Chapter 6.4.3.7 is not supported
                                  Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                  Deviation of step (3) and (4):
                                       o The jumps to step 1 were substituted by a return of the function with
                                           an error code, the jumps are emulated by another call to our function
                             ECDSA Signature Verification:




CC Document                                                92                                                         1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                           1. According to section 7.4.1 in ANSI [23]

                                  Step b) and c) are not supported.
                                  The output of step c) has to be provided as input to our function by the caller.
                                  Deviation of step d):
                                       o Beside noted calculation, our algorithm adds a random multiple of
                                            BasepointerOrder n to the calculated values u1 and u2.
                           2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                Chapter 6.4.4.2 is not supported
                                Chapter 6.4.4.3 is not supported:
                                       o The hash-code H of the message has to be provided by the caller as
                                            input to our function
                           3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-1 and FCS_COP.1/ECDSA-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                              93                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.4    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-1         Cryptographic key generation
   or
   FCS_CKM.1/EC-2
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-1       The TSF shall generate cryptographic keys in accordance with a specified
   or                     cryptographic key generation algorithm implemented by following functions which
   FCS_CKM.1.1/EC-2       can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note for FCS_CKM.1/EC-1 and FCS_CKM.1/EC-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             94                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.5     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-1          Cryptographic operation
  or
  FCS_COP.1/ECDH-2
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-1        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
  or                        with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
  FCS_COP.1.1/ECDH-2        163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section 7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Notes for: FCS_COP.1/ECDH-1 and FCS_COP.1/ECDH-2:

1. The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163 and 192 bits are supported. Numerous other curve types, being also secure in terms of
side channel attacks on this TOE, exist, which the user optionally can add in the composition certification
process.
End of note

2. For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

3. The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not
provide the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security
functional requirements FCS_COP.1/ECDSA-1 or FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-1 or
FCS_COP.1/ECDH-2 and FCS_CKM.1/EC-1 or FCS_CKM.1/EC-2. In case of a blocked Crypto2304T, the RSA and
EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered cryptographic
RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

4. The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of notes.

CC Document                                             95                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




7.1.4.6       The Asymmetric Cryptographic Library v2.06.003
 7.1.4.6.1    Rivest-Shamir-Adleman (RSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

   FCS_COP.1/RSA-3      Cryptographic operation
   Hierarchical to:     No other components.
   Dependencies:        [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                        or FDP_ITC.2 Import of user data of the Composite TOE with security attributes]

                        FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/RSA-3    The TSF shall perform encryption, decryption, signature generation and signature
                        verification in accordance with a specified cryptographic algorithm Rivest-Shamir-
                        Adleman (RSA) and cryptographic key sizes from 512 bits up to 4096+128 bits in 1 Bit
                        stepping that meet the following:
                        Encryption:
                        1. According to section 5.1.1 RSAEP in PKCS [22]:
                               Supported for n < 24096 + 128
                              5.1.1(1) not supported
                        2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
                        Supported for n < 24096 + 128
                        Decryption (with or without CRT):
                        1. According to section 5.1.2 RSADP in PKCS [22]
                        for u = 2, i.e., without any (ri, di, ti), i > 2
                               5.1.2(1) not supported
                               5.1.2(2.a) supported for n < 22048 + 64
                               5.1.2(2.b) supported for p  q < 24096 + 128
                             5.1.2(2.b) (ii)&(v) not applicable due to u = 2
                        2. According to section 8.2.3 IEEE [29]:
                               8.2.1(I) supported for n < 22048 + 64
                               8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported




CC Document                                             96                                                  1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                          Signature Generation (with or without CRT):
                          1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e.,
                          without any (ri, di, ti), i >2

                                  5.2.1(1) not supported
                                  5.2.1(2.a) supported for n < 22048 + 64
                                  5.2.1(2b) supported for p  q < 24096 + 128
                               5.2.1(2b) (ii)&(v) not applicable due to u = 2
                          2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                                  8.2.1(I) supported for n < 22048 + 64
                                  8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported
                          Signature Verification:
                          1. According to section 5.2.2 RSAVP1 in PKCS [22]:
                          supported for n < 24096 +128
                               5.2.2(1) not supported
                          2. According to section 8.2.5 IEEE [29]:
                                  Supported for n < 24096 +128
                                  8.2.5(1) not supported


Please consider also the statement of chapter 7.1.4.1.




CC Document                                                97                                 1.8
                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.2     Rivest-Shamir-Adleman (RSA) key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

The RSA cryptographic library is offered in two parts: The 2k part of the RSA library can be used for key lengths
of up to 2048 + 64 bits and the 4k part of the RSA library can be used for key lengths of up to 4096 + 128 bits.

   FCS_CKM.1/RSA-3      Cryptographic key generation
       Hierarchical to: No other components.
       Dependencies: FCS_CKM.2 Cryptographic key distribution, or
                        FCS_COP.1 Cryptographic operation]
                        FCS_CKM.4 Cryptographic key destruction
                        FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/RSA-3 The TSF shall generate cryptographic keys in accordance with a specified
                        cryptographic key generation algorithm implemented by following functions:
                         CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_D plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_N plus CryptoGeneratePrimeMask
                        and specified cryptographic key sizes of 512 – 4096 bits that meet the following:
                        RSA key generation according to Infineon key generation methods. The generated
                        keys are in conformance with:
                        1. According to sections 3.1 and 3.2 in PKCS [22],
                        for u = 2, i.e. without any (ri, di, ti), i > 2:
                                 3.1 supported for n < 24096 + 128
                                 3.2.(1) supported for n < 22048 + 64
                                 3.2.(2) supported for p x q < 24096 + 128
                        2. According to section 8.1.3.1 in IEEE [29]:
                                 8.1.3.1(1) supported for n < 22048 + 64
                                 8.1.3.1(2) supported for p x q < 24096 + 128
                                 8.1.3.1(3) supported for p x q < 22048 + 64

Note 1 for FCS_CKM.1.1/RSA-3:
The minimum key length follows the national recommendations by the BSI which means that RSA key lengths
below 1976 bits are not included in the certificate. The key length requirements can differ between the countries.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

Note 2 for FCS_CKM.1.1/RSA-3:
The TOE can be delivered with or without the RSA library. In the case of coming without the RSA library the TOE
does not provide the Additional Specific Security Functionality Rivest-Shamir-Adleman Cryptography (RSA)
realized with the security functional requirements FCS_COP.1/RSA and FCS_CKM.1/RSA. In case of a blocked
Crypto2304T the optionally delivered cryptographic and the supporting Toolbox cannot be used in that TOE
product.
End of note.

 7.1.4.6.3     General Preface regarding Elliptic Curve Cryptography
The EC library is delivered as object code and in this way integrated in the user software. The security functional
requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,

CC Document                                              98                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
  All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
                                        with size n є [41-1; 521] are supported.

 7.1.4.6.4     Elliptic Curve DSA (ECDSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.
 FCS_COP.1/ECDSA-3           Cryptographic operation
 Hierarchical to:            No other components.
 Dependencies:               [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                             or
                             FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                             FCS_CKM.4 Cryptographic key destruction
 FCS_COP.1.1/ECDSA-3         The TSF shall perform signature generation and signature verification in accordance
                             with a specified cryptographic algorithm ECDSA and cryptographic key sizes 160,
                             163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                             ECDSA Signature Generation:
                             1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                   Deviation of step c) and f):
                             The jumps to step a) were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                  Chapter 6.4.3.7 is not supported
                             Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                   Deviation of step (3) and (4):
                             The jumps to step 1 were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function
                             ECDSA Signature Verification:
                             1. According to section 7.4.1 in ANSI [23]
                                     Step b) and c) are not supported.
                                     The output of step c) has to be provided as input to our function by the caller.
                                     Deviation of step d):
                                         o Beside noted calculation, our algorithm adds a random multiple of
                                              BasepointerOrder n to the calculated values u1 and u2.

CC Document                                                 99                                                         1.8
                                                                                                                2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                            2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                   Chapter 6.4.4.2 is not supported
                                   Chapter 6.4.4.3 is not supported:
                                        o The hash-code H of the message has to be provided by the caller as
                                             input to our function
                            3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             100                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.5    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-3         Cryptographic key generation
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-3       The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm implemented by following functions which
                      BSI-DSZ-CC-0879-V4-2020

                       for

   Infineon Security Controller M7893 B11 with
 optional RSA2048/4096 v2.03.008, EC v2.03.008,
SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox
v2.03.008 and with specific IC dedicated software
                    (firmware)

                      from

           Infineon Technologies AG
                     BSI - Bundesamt für Sicherheit in der Informationstechnik, Postfach 20 03 63, D-53133 Bonn
                      Phone +49 (0)228 99 9582-0, Fax +49 (0)228 9582-5477, Infoline +49 (0)228 99 9582-111




Certification Report V1.0                                                                                         CC-Zert-327 V5.25
      BSI-DSZ-CC-0879-V4-2020 (*)
      Infineon Security Controller M7893 B11 with optional RSA2048/4096
      v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
      Toolbox v2.03.008 and with specific IC dedicated software (firmware)

      from                       Infineon Technologies AG
      PP Conformance:            Security IC Platform Protection Profile, Version 1.0,                             SOGIS
                                 15 June 2007, BSI-CC-PP-0035-2007                                           Recognition Agreement

      Functionality:             PP conformant plus product specific extensions
                                 Common Criteria Part 2 extended
      Assurance:                 Common Criteria Part 3 conformant
                                 EAL 6 augmented by ALC_FLR.1



The IT Product identified in this certificate has been evaluated at an approved evaluation
facility using the Common Methodology for IT Security Evaluation (CEM), Version 3.1
extended by Scheme Interpretations, by advice of the Certification Body for components
beyond EAL5 and CC Supporting Documents as listed in the Certification Report for
conformance to the Common Criteria for IT Security Evaluation (CC), Version 3.1. CC and
CEM are also published as ISO/IEC 15408 and ISO/IEC 18045.
(*) This certificate applies only to the specific version and release of the product in its
evaluated configuration and in conjunction with the complete Certification Report and
Notification. For details on the validity see Certification Report part A chapter 5.
The evaluation has been conducted in accordance with the provisions of the certification
scheme of the German Federal Office for Information Security (BSI) and the conclusions
                                                                                                             Common Criteria
of the evaluation facility in the evaluation technical report are consistent with the                    Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                                                  4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................12
   3. Security Policy............................................................................................................15
   4. Assumptions and Clarification of Scope.....................................................................15
   5. Architectural Information.............................................................................................16
   6. Documentation...........................................................................................................16
   7. IT Product Testing.......................................................................................................16
   8. Evaluated Configuration.............................................................................................17
   9. Results of the Evaluation............................................................................................18
   10. Obligations and Notes for the Usage of the TOE.....................................................19
   11. Security Target..........................................................................................................20
   12. Regulation specific aspects (eIDAS, QES)..............................................................20
   13. Definitions.................................................................................................................20
   14. Bibliography..............................................................................................................23
C. Excerpts from the Criteria..............................................................................................26

D. Annexes.........................................................................................................................27




                                                                                                                                 5 / 33
Certification Report                                                               BSI-DSZ-CC-0879-V4-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carried out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BSI Schedule of Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]
●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.

1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     Schedule of Cost for Official Procedures of the Bundesamt für Sicherheit in der Informationstechnik
     (BSI-Kostenverordnung, BSI-KostV) of 3 March 2005, Bundesgesetzblatt I, p. 519



                                                                                                           6 / 33
BSI-DSZ-CC-0879-V4-2020                                                              Certification Report




●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
               can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note1 for FCS_CKM.1/EC-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             101                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.6     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-3          Cryptographic operation
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-3        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
                            with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
                            163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section “7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Note for FCS_COP.1/ECDH-3:
The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163, 192 bits are supported. Numerous other curve types, being also secure in terms of side
channel attacks on this TOE, exist, which the user optionally can add in the composition certification process.
End of note

Note 2 for FCS_COP.1/ECDH-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

Note 3 for FCS_COP.1/ECDH-3:
The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not provide
the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security functional
requirements FCS_COP.1/ECSA, FCS_COP.1/ECDH and FCS_CKM.1/EC. In case of a blocked Crypto2304T, the
RSA and EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered
cryptographic RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

Note 4 for FCS_COP.1/ECDH-3:
The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of note.



CC Document                                             102                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.5          Data Integrity FDP_SDI.2 and FDP_SDC.1
The TOE shall meet the requirement Stored data integrity monitoring and action (FDP_SDI.2) as specified below:

    FDP_SDI.2           Stored data integrity monitoring and action
    Hierarchical to:    FDP_SDI.1 stored data integrity monitoring
    Dependencies:       No dependencies
    FDP_SDI.2.1         The TSF shall monitor user data of the Composite TOE stored in containers controlled
                        by the TSF for data integrity and one- and/or more-bit-errors on all objects, based on
                        the following attributes: corresponding EDC value for RAM, ROM and SOLID FLASH™
                        NVM and error correction ECC for the SOLID FLASH™ NVM.
    FDP_SDI.2.2         Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                        FLASH™ NVM automatically and inform the user about more bit errors.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.

The TOE shall meet the requirement “Stored data confidentiality (FDP_SDC.1)” as specified below:
   FDP_SDC.1             Stored data confidentiality
     Hierarchical to:    No other components
     Dependencies:       No dependencies
   FDP_SDC.1.1           The TSF shall ensure the confidentiality of the information of the user data of the
                         Composite TOE while it is stored in the RAM, ROM, Cache and SOLID FLASH™ NVM.




CC Document                                              103                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.6          Application Note to FPT_FLS.1 Failure with preservation of secure state
The SFR FPT_FLS.1 is defined in the PP [9] but with application note 14 it is required to describe the secure state:
Where ever FPT_FLS.1 is claimed it depends on the source or affected piece of data the failure was detected.
Induced failures on other than memory contents could in the worse lead to exploitable situations if not
discovered and treated properly. This includes i.e. internal transported keys and other TSF data. For that reasons
the integrity of the transport ways and also the modules the TSF and critical data are used is protected against
failure.
Depending on the criticality where the failure occurred and in most cases a security reset is triggered. Only in
case of a peripheral bus error or an address translation mismatch, a user software action is required as described
in the user guidance.
In case of a security reset, the user cannot take any action. The chip immediately stops operation and reboots.


7.2            Support by the Flash Loader

The TOE provides the Flash Loader to download user data into the SOLID FLASH™ NVM, either during
production of the TOE or at customer site. The Flash Loader is dedicated for usage by authorized users only in
secured and insecure environment during the production up to Phase 6 Security IC Personalisation.
The Flash Loader has to be permanently deactivated before entering Phase 7 Security IC end-usage.
For this reason the TOE shall meet the requirements as defined and described in the PP [9] section 7.3 Packages
for Loader and 7.2 Package Authentication of the Security IC:
     Limited capabilities (FMT_LIM.1/Loader),
     Limited availability – Loader (FMT_LIM.2/Loader),
     Authentication Proof of Identity (FIA_API.1),
     Inter-TSF trusted channel (FTP_ITC.1),
     Basic data exchange confidentiality (FDP_UCT.1),
     Data exchange integrity (FDP_UIT.1),
     Subset access control – Loader (FDP_ACC.1/Loader) and
     Security attribute based access control – Loader (FDP_ACF.1/Loader)
as defined in the PP [9], section 7.2 and 7.3.

The Flash Loader supports the following security function policy (SFP):
    Loader SFP:
        provides the mutual authentication between the TOE and the administrator user or download operator
        user and the download of the user data into the memory of the TOE.

The Flash Loader supports the following two subjects:
    Administrator user:
        is enabled performing mutual authentication with the keys Kc and Kd, to manage (set, exchange, delete)
        the keys Kc, Kd and Kfdi and to process the download of the user data into the memory of the TOE.
    Download operator user:
        is enabled performing mutual authentication with Kd, to exchange the key Kd and to perform the
        download of the user data into the memory of the TOE. He can also delete Kfdi.




CC Document                                             104                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The Flash Loader supports the following object:
    User data:
        Data loaded into the memory of the TOE.

The TOE shall meet the requirement “Limited capabilities (FMT_LIM.1/Loader)” as specified below:

 FMT_LIM.1/Loader          Limited capabilities
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.2 Limited availability.
 FMT_LIM.1.1/Loader        The TSF shall be designed and implemented in a manner that limits its capabilities so
                           that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                           enforced:
                           Deploying Loader functionality after permanent deactivation does not allow stored user
                           data of the Composite TOE to be disclosed or manipulated by unauthorized user.

The TOE shall meet the requirement “Limited availability – Loader (FMT_LIM.2/Loader)” as specified below:
 FMT_LIM.2/Loader          Limited availability – Loader
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.1 Limited capabilities.
 FMT_LIM.2.1/Loader        The TSF shall be designed in a manner that limits its availability so that in
                           conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced:

                           The TSF prevents deploying the Loader functionality after permanent deactivation.

The TOE shall meet the requirement “Limited availability – Loader (FIA_API.1)” as specified below:
  FIA_API.1              Authentication Proof of Identity
      Hierarchical to:   No other components.
      Dependencies:      No dependencies.
  FIA_API.1.1            The TSF shall provide an authentication mechanism according to [34] ISO/IEC 9798-2
                         section 6.2.2 Mechanism 4: Three-path authentication based on the security attributes
                         (keys) Kc or Kd to prove the identity of the TOE to an external entity.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.




CC Document                                             105                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FTP_ITC.1)” as specified below:
  FTP_ITC.1              Inter-TSF trusted channel
     Hierarchical to:    No other components.
     Dependencies:       No dependencies.
  FTP_ITC.1.1            The TSF shall provide a communication channel between itself and the administrator
                         user and the Download Operator user as described in the Loader SFP that is logically
                         distinct from other communication channels and provides assured identification of its
                         end points and protection of the channel data from modification or disclosure.
  FTP_ITC.1.2            The TSF shall permit another trusted IT product to initiate communication via the
                         trusted channel.
  FTP_ITC.1.3            The TSF shall initiate communication via the trusted channel for deploying Loader for
                         downloading user data.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UCT.1)” as specified below:
  FDP_UCT.1               Basic data exchange confidentiality
      Hierarchical to:    No other components.
      Dependencies:       No dependencies.
  FDP_UCT.1.1             The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                          unauthorised disclosure.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UIT.1)” as specified below:
 FDP_UIT.1            Data exchange integrity
     Hierarchical to: No other components.
      Dependencies: [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                      [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control].
 FDP_UIT.1.1          The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                      modification, deletion or insertion errors.
 FPP_UIT.1.2          The TSF shall be able to determine on receipt of user data, whether modification,
                      deletion or insertion have occurred.

Note regarding the Flash Loader:
The algorithm strength of the Flash Loader has not been cryptographic-analytically evaluated by the BSI, as
Infineon has implemented a proprietary extension.
End of note.




CC Document                                            106                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FDP_ACC.1/Loader)” as specified below:
 FDP_ACC.1/Loader           Subset access control – Loader
       Hierarchical to:     No other components.
       Dependencies:        FDP_ACF.1 Security attribute based access control.
 FDP_ACC.1.1/Loader         The TSF shall enforce the Loader SFP on
                               (1) the subjects Administrator user and the Download operator user,
                               (2) the objects User data in the SOLID FLASH™ NVM memory of the TOE,
                               (3) the operation deployment of the Loader.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.

The TOE shall meet the requirement “Limited availability – Loader (FTP_ACF.1/Loader)” as specified below:
 FDP_ACF.1/Loader             Security attribute based access control – Loader
             Hierarchical to: No other components.
             Dependencies: FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        The TSF shall enforce the Loader SFP to objects based on the following:
                                 (1) the subjects Administrator user and the Download operator user with
                                     security attributes Kc, Kd and Kfdi
                                 (2) the objects user data in data loaded into the SOLID FLASH™ NVM
                                     memory of the TOE with security attributes Kfdi.

      FDP_ACF.1.2/Loader          The TSF shall enforce the following rules to determine if an operation among
                                  controlled subjects and controlled objects is allowed:
                                     (1) evaluate the corresponding access control information of the relevant
                                          subject, administrator user and download operator user, before the
                                          access, so that accesses to be denied cannot be utilized by the subject
                                          attempting to perform the operation. The subsequent download is then
                                          protected by the key Kfdi.

      FDP_ACF.1.3/Loader          The TSF shall explicitly authorise access of subjects to objects based on the
                                  following additional rules:
                                                                       None

      FDP_ACF.1.4/Loader          The TSF shall explicitly deny access of subjects to objects based on the
                                  following additional rules:
                                                                       None




CC Document                                            107                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


Note 15:
Regarding FDP_ACF.1.4/Loader it is added in the User Guidance that the Flash Loader has to be permanently
deactivated prior delivery to the end-user.
End of note.

Note 16:
The security functional requirements FMT_LIM.1/Loader, FMT_LIM.2/Loader, FIA_API.1, FTP_ITC.1, FDP_UCT.1,
FDP_UIT.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader apply only at TOE products coming with activated Flash
Loader enabled for user data download. In other cases the Flash Loader is not available anymore and the user
software or data download is completed. Depending on the capabilities of the user software these security
functional requirements may then reoccur as subject of the composite TOE.
The permanent locking of the Flash Loader after finalizing the download and prior delivery to the end-user is
added to package 2 with LIM1/Loader and FMT_LIM.2/Loader.
End of note.


7.3             TOE Security Assurance Requirements

The evaluation assurance level is EAL6 augmented with ALC_FLR.1.
In the following table, the security assurance requirements are given. The augmentation of the assurance
components compared to the Protection Profile [9] is expressed with bold letters.

                                     Table 13     Assurance Components
              Aspect               Acronym                        Description                    Refinement
 Development                    ADV_ARC.1          Security Architecture Description            In PP [9]
                                ADV_FSP.5          Complete semi-formal functional              in ST
                                                   specification with additional error
                                                   information
                                ADV_IMP.2          Complete mapping of the                      in ST
                                                   implementation representation of the
                                                   TSF
                                ADV_INT.3          Minimally complex internals
                                ADV_TDS.5          Complete semi-formal modular design
                                ADV_SPM.1          Formal TOE security policy model
 Guidance Documents             AGD_OPE.1          Operational user guidance                    in PP [9]
                                AGD_PRE.1          Preparative procedures                       in PP [9]
 Life-Cycle Support             ALC_CMC.5          Advanced support                             in ST
                                ALC_CMS.5          Development tools CM coverage                in ST
                                ALC_DEL.1          Delivery procedures                          in PP [9]
                                ALC_DVS.2          Sufficiency of security measures             in PP [9]
                                ALC_LCD.1          Developer defined life-cycle model
                                ALC_TAT.3          Compliance with implementation
                                                   standards – all parts
                                ALC_FLR.1          Basic Flaw Remediation
 Security Target Evaluation     ASE_CCL.1          Conformance claims
                                ASE_ECD.1          Extended components definition
                                ASE_INT.1          ST introduction
CC Document                                           108                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              Aspect                 Acronym                         Description                    Refinement
                                 ASE_OBJ.2           Security objectives
                                 ASE_REQ.2           Derived security requirements
                                 ASE_SPD.1           Security problem definition
                                 ASE_TSS.1           TOE summary specification
 Tests                           ATE_COV.3           Rigorous analysis of coverage                  In ST
                                 ATE_DPT.3           Testing: modular design
                                 ATE_FUN.2           Ordered functional testing
                                 ATE_IND.2           Independent testing – sample
 Vulnerability Assessment        AVA_VAN.5           Advanced methodical vulnerability testing      in PP [9]


7.3.1           Refinements
Some refinements are taken unchanged from the PP [9]. In some cases a clarification is necessary. In Table 17 an
overview is given where the refinement is done.
The refinements from the PP [9] have to be discussed here in the Security Target, as the assurance level is
increased. The refinements from the PP [9] are included in the chosen assurance level EAL 6 augmented with
ALC_FLR.1.
7.3.1.1         Development (ADV)
ADV_IMP Implementation Representation:
The refined assurance package ADV_IMP.1 implementation representation of the TSF requires the availability of
the entire implementation representation, a mapping of the design description to the implementation
representation with a level of detail that the TSF can be generated without further design decisions. In addition,
the correspondence of design description and implementation representation shall be demonstrated.
The covered higher assurance package ADV_IMP.2 requires a complete and not curtailed mapping of the
implementation representation of the TSF, and the mapping of the design description to the entire
implementation representation. In addition, the correspondence of design description and the implementation
representation shall be demonstrated. The ADV_IMP.1 aspect and refinement remains therefore valid. The
enhancement underlines the refinement in the PP [9] and by that the entirely complete design i.e. not curtailed
representation with according mapping was provided, demonstrated and reviewed.

ADV_FSP Functional Specification:
The ADV_FSP.4 package requires a functional description of the TSFIs and there assignment to SFR-enforcing,
SFR-supporting, SFR-non-interfering, including related error messages, the assurance package. The
enhancement of ADV_FSP.5 requires additionally a complete semi-formal functional specification with
additional error information. In addition the package includes a tracing from the functional specification to the
SFRs, as well as the TSFIs descriptions including error messages not resulting from an invocation of a TSFI.
These aspects from ADV_FSP.5 are independent from the ADV_FSP.4 refinements from the PP [9] but
constitute an enhancement of it. By that the aspects of ADV_FSP.4 and its refinement in the PP [9] apply also
here. The assurance and evidence was provided accordingly.

ADV_SPM Formal Security Policy Model
It is the objective of this family to provide additional assurance from the development of a formal security policy
model of the TSF, and establishing a correspondence between the functional specification and this security
policy model. Preserving internal consistency the security policy model is expected to formally establish the
security principles from its characteristics by means of a mathematical proof.



CC Document                                             109                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


   ADV_SPM.1          Formal TOE security policy model
   Hierarchical to:   No other components
   Dependencies:      ADV_FSP.4 Complete function description
   ADV_SPM.1.1D       The developer shall provide a formal security policy model for the
                      Memory Access Control Policy and the corresponding SFRs
                          FDP_ACC.1 Subset Access Control
                          FDP_ACF.1 Security attribute based access control
                          FMT_MSA.1 Management of Security Attributes
                          FMT_MSA.3 Static Attribute Initialization.
                      Moreover, the following SFRs shall be addressed by the formal security policy model:
                         FDP_SDI.2 Stored data integrity monitoring and action
                         FDP_SDC.1 Stored data confidentiality
                         FDP_ITT.1 Basic Internal Transfer Protection
                         FDP_IFC.1 Information Flow Control
                         FPT_ITT.1 Basic internal TSF data transfer protection
                         FPT_PHP.3 Resistance to physical attack
                         FPT_FLS.1 Failure with preservation of secure state
                         FRU_FLT.2 Limited fault tolerance
                         FMT_LIM.1 Limited capabilities
                         FMT_LIM.2 Limited availability
                         FAU_SAS.1 Audit storage
                         FMT_SMF.1 Specification of Management Functions
                       Moreover, the following SFRs of the package authentication of the IC PP [9] and the
                         loader packages PP [9] shall be addressed by the formal security policy model:
                         FIA_API.1
                         FMT_LIM.1/Loader
                         FMT_LIM.2/Loader
                         FTP_ITC.1
                         FDP_UCT.1
                         FDP_UIT.1
                         FDP_ACC.1/Loader
                         FDP_ACF.1/Loader
   ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify
                the relevant portions of the statement of SFRs that make up that policy.
   ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and
                any formal functional specification.
   ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model
                and the functional specification.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.


CC Document                                            110                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.3.1.2        Life-cycle Support (ALC)
ALC_CMS Configuration Management Scope:
The refinement of ALC_CMS.4 in the PP [9] defines with some conditions the possibility that the Security IC
embedded firmware can be part of the delivered TOE. This is the case as the Security IC embedded firmware –
regardless of the version in use - and the optional software are part of TOE and delivered together with the TOE
as the firmware and optional software are stored in the ROM and/or SOLID FLASH™ NVM. The presence of the
optional parts belongs to the user order. Both, the firmware and software delivered with the TOE are controlled
entirely by Infineon Technologies.
In addition, the TOE offers the possibility that the user can download his software at his own premises. These
parts of the software are user controlled only and are not part of this TOE. The download of this solely user
controlled software into the SOLID FLASH™ NVM is protected by strong authentication means. In addition, the
download itself could also be encrypted.
The requirements by ALC_CMS.4 are fulfilled including the refinements from the PP [9].
The ALC_CMS.5 implements the additional requirement to include development tools and related information
into the configuration list. This add on has no influence on the refinement of ALC_CMS.4 in the PP [9] as the
delivery of Security IC embedded firmware is independent from the TOE development tools and related
information. The package ALC_CMS.5 is therefore an enhancement to ACL_CMS.4 and the package with its
refinement in the PP [9] remains valid. The assurance and evidence was provided accordingly.

ALC_CMC Configuration Management Capabilities:
The PP refinement from the assurance package ALC_CMC.4 Production support, acceptance procedures and
automation points out that the configuration items comprise all items defined under ALC_CMS to be tracked
under configuration management. In addition a production control system is required guaranteeing the
traceability and completeness of different charges and lots. Also the number of wafers, dies and chips must be
tracked by this system as well as procedures applied for managing wafers, dies or complete chips being removed
from the production process in order to verify and to control predefined quality standards and production
parameters. It has to be controlled that these wafers, dies or assembled devices are returned to the same
production stage from which they are taken or they have to be securely stored or destroyed otherwise.
The additionally covered extended package of ALC_CMC.5 Advance Support requires advanced support
considering the automatisms configuration management systems, acceptance and documentation procedures
of changes, role separation with regard to functional roles of personnel, automatisms for tracking and version
controlling in those systems, and includes also production control systems. The additional aspects of
ADV_CMC.5 constitute an enhancement of ACL_CMC.4 and therefore the aspects and ACL_CMC.4 refinements
in the PP [9] remain valid. The assurance and evidence was provided.

ALC_DVS Development Security:
The requirement ALC_DVS.2 is refined in the PP [9] requiring the development security documentation
comprising all the physical, procedural, personnel, and other security measures that are necessary to protect the
confidentiality and integrity of the TOE design and implementation in its development environment.
The documentation and evidence was given, reviewed, audited and thus the assurance and evidence was
provided accordingly.

Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the:
      keys are generated with sufficient entropy
      the keys are stored within a HSM as integral part of the vendor environment
      the keys are stored in the non-volatile memory of the chip
All these requirements were subject of an audit; assurance and evidence was provided.



CC Document                                            111                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


ALC_DEL Delivery Procedure:
Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the delivery process of the Flash Loader keys - as referenced in the section 10 - is separated from the chip
delivery to the user.


7.3.1.3         Tests (ATE)
ATE_COV Test Coverage:
The PP refined assurance package ATE_COV.2 Analysis of coverage addresses the extent to which the TSF is
tested, and whether or not the testing is sufficiently extensive to demonstrate that the TSF operates as specified.
It includes the test documentation of the TSFIs in the functional specification. In particular the refinement
requires that The TOE must be tested under different operating conditions within the specified ranges. In
addition, the existence and effectiveness of mechanisms against physical attacks should be covered by evidence
that the TOE has the particular physical characteristics. This is furthermore detailed in the PP [9].
This assurance package ATE_COV.2 has been enhanced to ATE_COV.3 to cover the rigorous analysis of
coverage. This requires the presence of evidence that exhaustive testing on rigorous entirely all interfaces as
documented in the functional specification was conducted. By that ATE_COV.2 and refinements as given in the
PP [9] are enhanced by ATE_COV.3 and remain as well. The TSFIs were completely tested according to
ATE_COV.3 and the assurance and evidence was provided.


7.3.1.4         AVA_VAN Vulnerability Analysis
The assurance package AVA_VAN remains unchanged compared to the forerunner processes and requires
advanced methodical vulnerability analysis.




CC Document                                             112                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.4           Security Requirements Rationale

7.4.1         Rationale for the Security Functional Requirements
The objectives O.Authentication and OE.TOE_Auth are discussed in the PP [9] chapter 7.2.1.
The objectives O.Cap_Avail_Loader and OE.Lim_Block_Loader and the covering security functional
requirements FMT_LIM.1/Loader and FMT_LIM.2/Loader are discussed in the PP [9] chapter 7.3.1.
The policy P.Ctrl_Loader and the objectives O.Ctrl_Auth_Loader and OE.Loader_usage are discussed in the PP
[9] chapter 7.3.2.

Additionally, the objective O.Add-Function includes the objectives implemented by the CIPURSE™
Cryptographic Library versions: O.Ctrl_Auth_CCL, O.Prot_Integrity and O.Prot_Confidentiality.
These extended objectives are discussed in this ST in chapter 5.5 P.Add functions.

The additional objectives O.Prot_TSF_Confidentiality is defined in chapter 5.1 and 5.8 in this document.
PP [9] chapter 6.1 includes also the definition of FDP_SDI.2 „Stored data integrity monitoring and action“.
While the above mentioned security functional requirements rationale of the TOE are defined and described in
PP [9] section 6.3.1, the additional introduced SFRs are listed and discussed below:

                              Table 14     Rational for additional SFR in the ST
         Objective                                TOE Security Functional Requirements
                             FCS_COP.1/RSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDH-1 Cryptographic operation for ACL-1
                             FCS_CKM.1/RSA-1 Cryptographic key generation for ACL-1
                             FCS_CKM.1/EC-1 Cryptographic key generation for ACL-1
                             FCS_COP.1/RSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDH-2 Cryptographic operation for ACL-2
                             FCS_CKM.1/RSA-2 Cryptographic key generation for ACL-2
                             FCS_CKM.1/EC-2 Cryptographic key generation for ACL-2
O.Add-Functions
                             FCS_COP.1/RSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDH-3 Cryptographic operation for ACL-3
                             FCS_CKM.1/RSA-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/EC-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/CCL Cryptographic key generation for CCL
                             FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel for CCL
                             FCS_CKM.4/CCL Cryptographic key destruction for CCL
                             FCS_COP.1/CMAC-SCL-1 Cryptographic operation CMAC for SCL-1
                             FCS_CKM.4/CMAC-SCL-1 Cryptographic key destruction CMAC for SCL-1
O.Phys-Manipulation          FPT_TST.2 Subset TOE security testing
                             FDP_ACC.1 Subset access control
O.Mem-Access                 FDP_ACF.1 Security attribute based access control
                             FMT_MSA.3 Static attribute initialization

CC Document                                           113                                                   1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


         Objective                                TOE Security Functional Requirements
                             FMT_MSA.1 Management of security attributes
                             FMT_SMF.1 Specification of Management Functions
O.Malfunction                FDP_SDI.2 Stored data integrity monitoring and action
                             FCS_RNG.1/TRNG Generation of Random Numbers –TRNG
                             FCS_RNG.1/HPRG Generation of Random Numbers – HPRG
O.RND
                             FCS_RNG.1/DRNG Generation of Random Numbers –DRNG
                             FCS_RNG.1/KSG Generation of Random Numbers – KSG
                             FTP_ITC.1 Inter-TSF-trusted channel
O.Prot_TSF_
                             FDP_ACC.1/Loader Subset access control –Loader
Confidentiality
                             FDP_ACF.1/Loader Security attribute based access control – Loader
                             FCS_COP.1/TDES-SCL-1 Cryptographic operation – TDES by SCL-1
                             FCS_CKM.4/TDES-SCL-1 Cryptographic key destruction – TDES by SCL-1
                             FCS_COP.1/TDES-SCL-2 Cryptographic operation – TDES by SCL-2
O.TDES
                             FCS_CKM.4/TDES-SCL-2 Cryptographic key destruction – TDES by SCL-2
                             FCS_COP.1/TDES Cryptographic operation – TDES by SCP
                             FCS_CKM.4/TDES Cryptographic key destruction – TDES by SCP
                             FCS_COP.1/AES-SCL-1 Cryptographic operation – AES by SCL-1
                             FCS_CKM.4/AES-SCL-1 Cryptographic key destruction – AES by SCL-1
                             FCS_COP.1/AES-SCL-2 Cryptographic operation – AES by SCL-2
O.AES
                             FCS_CKM.4/AES-SCL-2 Cryptographic key destruction – AES by SCL-2
                             FCS_COP.1/AES Cryptographic operation – AES by SCP
                             FCS_CKM.4/AES Cryptographic key destruction – AES by SCP
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Ctrl_Auth_CCL              FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Integrity             FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Confidentiality       FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL

The table above gives an overview, how the security functional requirements are combined to meet the security
objectives.




CC Document                                          114                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


For clarity please find following assignment to versions:
     ACL-1 covers version v2.08.007
     ACL-2 covers version v2.07.003
     ACL-3 covers version v2.06.003
     SCL-1 covers version v2.04.002
     SCL-2 covers version v2.02.010
     CCL covers version v02.00.0004


 7.4.1.1       Cryptographic Aspects
The justification related to the security objective “Additional Specific Security Functionality (O.Add-Functions)”
is as follows:
The security functional requirement(s) “Cryptographic operation (FCS_COP.1)” exactly require(s) those functions
to be implemented which are demanded by O.Add-Functions:
      The ACL library – regardless of the version chosen – implements the SFRs FCS_CKM.1/RSA, supporting
          the generation of RSA keys, and the FCS_CKM.1/EC, supporting the generation of EC keys, needed for
          these cryptographic operations.
          To sum up, the ACL versions implement the SFRs as follows:
              o FCS_COP.1/RSA-1, FCS_COP.1/ECDSA-1, FCS_COP.1/ECDH-1, FCS_CKM.1/RSA-1, and
                  FCS_CKM/EC-1 respectively
              o FCS_COP.1/RSA-2, FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-2, FCS_CKM.1/RSA-2, and
                  FCS_CKM/EC-2 respectively
              o FCS_COP.1/RSA-3, FCS_COP.1/ECDSA-3, FCS_COP.1/ECDH-3, FCS_CKM.1/RSA-3, and
                  FCS_CKM/EC-3
      The SCL library of version v2.04.002 implements the function of cipher based message authentication
          code CMAC, supporting the authenticity and integrity of data blocks for example used for messages.
      The CIPURSE™ Cryptographic Library implements the SFRs FCS_COP.1/CCL Cryptographic Operation
          CCL Trusted Channel, establishing the trusted channel between two authenticated entities and
          FCS_CKM.1/CCL Cryptographic key generation, supporting the generation of the keys used for
          authentication and confidentiality. The CIPURSE™ CL operation requires the presence of the SCP.

The implementation covers the functional requirements and meets the objective O.Add-Functions.
The use of the supporting library Toolbox has no impact on any security functional requirement nor does the use
generate additional requirements. The Toolbox library is not part of the TOE Security Functionality (TSF).

All these requirements have to be fulfilled to support OE.Resp-Appl for the SFRs implemented by the:
      SCP:
             o FCS_COP.1/TDES
             o FCS_COP.1/AES
      SCL for version v2.04.002:
             o FCS_COP.1/TDES-SCL-1
             o FCS_COP.1/AES-SCL-1
             o FCS_COP.1/CMAC-SCL-1
      SCL for version v2.02.010:
             o FCS_COP.1/TDES-SCL-2
             o FCS_COP.1/AES-SCL-2
      CCL for version v02.00.0004:
CC Document                                             115                                                    1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              o   FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel,
              o   FCS_CKM.1/CCL Cryptographic key generation
              o   FCS_CKM.4/CCL Cryptographic key destruction

Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. These issues are addressed by the specific security functional requirements:
     [FDP_ITC.1 Import of user data of the Composite TOE without security attributes or
        FDP_ITC.2 Import of user data of the Composite TOE with security attributes or
        FCS_CKM.1 Cryptographic key generation],
     FCS_CKM.4 Cryptographic key destruction

The security functional requirements required to meet the security objectives O.Leak-Inherent, O.Phys-Probing,
    O.Malfunction, O.Phys-Manipulation and O.Leak-Forced define how to implement the specific security
functionality. However, key-dependent functions could be implemented in the Smartcard Embedded Software.

The usage of cryptographic algorithms requires the use of appropriate keys. Otherwise these cryptographic
functions do not provide security. The keys have to be unique with a very high probability, and must have a
certain cryptographic strength etc. In case of a key import into the TOE (which is usually after TOE delivery) it
has to be ensured that quality and confidentiality are maintained. Keys for DES and AES are provided by the
environment. Keys for RSA and EC algorithms can be provided either by the TOE or the environment.

The justification of the security objective and the additional requirements (both for the TOE and its environment)
show that they do not contradict to the rationale already given in the Protection Profile for the assumptions,
policy and threats defined there.




CC Document                                              116                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.4.1.2       Hardware related Aspects
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and functions
provided by the TOE can be tested after TOE Delivery. This security functional component is used instead of the
functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to know which
security functions or mechanisms can be tested. The functional component FPT_TST.1 does not mandate to
explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of the integrity
of TSF data and stored TSF executable code which might violate the security policy.
The tested security enforcing functions are SF_DPM Device Phase Management, SF_CS Cryptographic Support
and SF_PMA Protection against modifying attacks.

The justification related to the security objective “Protection against Physical Manipulation (O.Phys-
Manipulation)” is as follows:
The security functional requirement FPT_TST.2 will detect attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation. The physical manipulation
will be tried to overcome security enforcing functions.

The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1 and FMT_SMF.1 cover this security objective. The implementation of
these functional requirements is represented by the dedicated privilege level concept.

The justification of the security objective and the additional requirements show that they do not contradict to
the rationale already given in the Protection Profile for the assumptions, policy and threats defined there.
Moreover, these additional security functional requirements cover the requirements by the PP [9] user data of
the Composite TOE protection of chapter 1.2.5 claim 35 and 36 which are not refined by the PP [9].
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. The TOE only provides the tool to implement the policy defined in the
context of the application.

The justification related to the security objective Protection against Malfunction due to Environmental Stress
(O.Malfunction) is as follows:
The security functional requirement Stored data integrity monitoring and action (FDP_SDI.2) requires the
implementation of an integrity observation and correction which is implemented by the Error Detection (EDC)
and Error Correction (ECC) measures. The EDC is present throughout all memories of the TOE while the ECC is
realized in the SOLID FLASH™ NVM. These measures detect and inform about one and more bit errors. In case
of the SOLID FLASH™ NVM 1 bit errors of the data are corrected automatically. The ECC mechanism protects
the TOE from the use of corrupt data. Therefore FDP_SDI.2 is suitable to meet the security objective
O.Malfunction.

The presence of true random numbers is the security goal 4 (SG4) which is formalized in the objective O.RND
Random Numbers. This objective must be covered by fulfillment of the security functional requirement
FCS_RNG. This is defined in the PP [9] chapter 5.1. The requirement implements a quality metric which is defined
by national regulations. The implemented random number generation fulfils the definitions of AIS 31 [13] in the
quality classes as outlined in chapter 7.1.1.1. Therefore the SFR FCS_RNG and the objective O.RND are covered.




CC Document                                              117                                                       1.8
                                               the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.
This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 33
Certification Report                                                       BSI-DSZ-CC-0879-V4-2020




4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-0879-V3-2018. Specific
results from the evaluation process BSI-DSZ-CC-0879-V3-2018 were re-used.
The evaluation of the product Infineon Security Controller M7893 B11 with optional
RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
Toolbox v2.03.008 and with specific IC dedicated software (firmware), was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 11 February 2020.
TÜV Informationstechnik GmbH is an evaluation facility (ITSEF) 5 recognised by the
certification body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and in the Security Target.
For the meaning of the assurance components and assurance levels please refer to CC
itself. Detailed references are listed in part C of this report.
The Certificate issued confirms the assurance of the product claimed in the Security Target
at the date of certification. As attack methods evolve over time, the resistance of the
certified version of the product against new attack methods needs to be re-assessed.
Therefore, the sponsor should apply for the certified product being monitored within the
assurance continuity program of the BSI Certification Scheme (e.g. by a re-assessment or
re-certification). Specifically, if results of the certification are used in subsequent evaluation
and certification procedures, in a system integration process or if a user's risk
management needs regularly updated results, it is recommended to perform a re-
assessment on a regular e.g. annual basis.
In order to avoid an indefinite usage of the certificate when evolved attack methods would
require a re-assessment of the products resistance to state of the art attack methods, the
maximum validity of the certificate has been limited. The certificate issued on 12 February
2020 is valid until 11 February 2025. Validity can be re-newed by re-certification.
The owner of the certificate is obliged:

5
     Information Technology Security Evaluation Facility



                                                                                             8 / 33
BSI-DSZ-CC-0879-V4-2020                                                        Certification Report




     1. when advertising the certificate or the fact of the product's certification, to refer to
        the Certification Report as well as to provide the Certification Report, the Security
        Target and user guidance documentation mentioned herein to any customer of the
        product for the application and usage of the certified product,
     2. to inform the Certification Body at BSI immediately about vulnerabilities of the
        product that have been identified by the developer or any third party after issuance
        of the certificate,
     3. to inform the Certification Body at BSI immediately in the case that security relevant
        changes in the evaluated life cycle, e.g. related to development and production sites
        or processes, occur, or the confidentiality of documentation and information related
        to the Target of Evaluation (TOE) or resulting from the evaluation and certification
        procedure where the certification of the product has assumed this confidentiality
        being maintained, is not given any longer. In particular, prior to the dissemination of
        confidential documentation and information related to the TOE or resulting from the
        evaluation and certification procedure that do not belong to the                                                              2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.4.1.3       Flash Loader related Aspects
The justification related to the Flash Loader security objectives are as follows. Note that the following objectives
and related rationales apply only at TOE products coming with activated Flash Loader enabled for software or
data download by the user. In other cases the Flash Loader is not available anymore and the user data download
is completed. Depending on the capabilities of the user software these security functional requirements may
then reoccur as subject of the composite TOE.
The Flash Loader related objectives are:

The objective O.Authentication requires the presence of an authentication mechanism proving the identity of a
given security IC to an external entity. This objective is covered by the functional requirement FIA_API
Authentication Proof of Identity. The Flash Loader implements this functionality and outputs identification data
to external requesting entity. The user guidance describes in more detail how this authentication request is
applied and conducted by the external entity. As the functional requirements are met by the Flash Loader the
objective is covered.

The objective O.Cap_Avail_Loader requires limited capabilities of the Loader functionality and irreversible
termination of the Loader. First, this is covered by the functional requirement FMT_LIM.1/Loader which
implements protection against data manipulation and disclosure by unauthorized users after permanent
deactivation of the Flash Loader. Second, the functional requirement FMT_LIM.2/Loader limits the Flash Loader
availability after the download has been finished by the user. The Flash Loader provides a final locking command
which irreversibly terminates the Flash Loader availability. This command execution must be applied after user
has finalized his download. As the functional requirements are met by the Flash Loader the objective is covered.

The objectives O.Ctrl_Auth_Loader and O.Prot_TSF_Confidentiality require that a trusted communication
channel with an authorized user, a confidentiality protection during the download and authentication of the user
data and access control for the usage of the Loader functionality are provided by the Loader.
Without successfully passing the authentication functionality of the Flash Loader no usage of the Flash Loader is
possible. Passing the authentication successfully assigns also a user role to the current user.
The Flash Loader implements mutual authentication functionality and if successfully passing this mutual
authentication, the TOE and the external user are established as trusted entities. Furthermore, the Flash Loader
enforces the exchange of the download key by the user which provides clear separation from the hardware
vendor and preserves confidentiality of the user data download. In addition, the Flash Loader preserves the
integrity of the downloaded data against for example induced errors by hashing functionality.
As the functional requirements are met by the Flash Loader the objective is covered.

Note regarding the Flash Loader:
The algorithm strength of the Flash Loader has not been cryptographic-analytical                                    [IEEE1363], ch. 7.2.1
 ADD              EC point addition        C = A+B           160 – 521 Bits      n.a.

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

Note:         For the /SIG iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step d) is not supported

Note:         For the /VER iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step b) is not supported.
              Beside noted calculation, our algorithm adds a random multiple of order of the basepoint to the
              calculated values u1 and u2.

Note:         For the/ DH iteration, the implementation always returns the y-coordinate in addition to the x-
              coordinate.

Note:         For the /ADD iteration, the elliptic curve points A, B and C are considered as secrets.

Note:         Cofactor multiplication is not supported

FCS_CKM.1/ECC                 Cryptographic key generation
Hierarchical to               No other components.
Dependencies                  FCS_CKM.2 Cryptographic key distribution, or
                              FCS_COP.1 Cryptographic operation]

Security Target                                            35                                                    v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/ECC                 The TSF shall generate cryptographic keys in accordance with a specified
                                cryptographic key generation algorithm EC key generation1 and specified
                                cryptographic key sizes of 160-521 bits2 that meet the following: [ANSX9.62], ch.
                                A4.3 and [IEEE1363], ch. A.16.9.3

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

FCS_CKM.4/ECC                   Cryptographic key destruction
Hierarchical to:                No other components.
Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                FDP_ITC.2 Import of user data with security attributes, or
                                FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/ECC                 The TSF shall destroy cryptographic keys in accordance with a specified
                                cryptographic key destruction method destruction of RAM key during system or
                                power on reset4 that meets the following: None5


Note:         The TOE can be delivered with or without the optional ECC library. If the ECC library is not deliverd, the
              TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
              delivered cryptographic ECClibrary cannot be used and therefore this SFR is also not applicable. .




6.1.4                Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

FPT_TST.2                       Subset TOE testing
Hierarchical to:                No other components.
Dependencies:                   No dependencies
FPT_TST.2.1                     The TSF shall run a suite of self tests at the conditions request of the Security IC
                                Embedded Software1 to demonstrate the correct operation of the alarm lines
                                and/or the environmental sensor mechanisms:


1
  [assignment: list of cryptographic operations]
2
  [assignment: cryptographic key sizes
3
  [assignment: list of standards]
4
  [assignment: cryptographic key destruction method]
5
  [assignment: list of standards]

Security Target                                             36                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                       Please refer to the confidential Security Target2


6.1.5                  Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent
that one application can access code and/or data of another application. For this reason the TOE provides Area
based Memory Access Control. The underlying Memory Protection Unit (MPU) is documented in Appendix B3.5
of the ARMv7 M architecture reference manual [ARMv7M].
In particular, the MPU provides full support for:
 Protection regions.
 Overlapping protection regions, with ascending region priority:
  − Region 7 = highest priority.
  − Region 0 = lowest priority.
 Access permissions.
   MPU mismatches and permission violations invoke the programmable-priority MemManage fault handler.

The MPU can be used to:
   Enforce privilege rules, preventing user applications from corrupting operating system data.
   Separate processes, blocking the active task from accessing other tasks’ data.
   Enforce access rules, allowing memory regions to be defined as read-only or detecting unexpected memory
    accesses.

The SFRs are provided by the Memory Access Control Policy (FDP_ACC.1 and dependencies).


6.1.5.1                Subjects, objects and operations of the Memory Access Control Policy
Subjects:
 MPU

Objects:
 memory/code addresses

Operations:
 Read a/o write a/o execute access


6.1.5.2                Security attributes of the Memory Access Control Policy
Security Attribute which define the roles for Subject MPU:
 Npriv flag defining privilege/non-privilege mode


Security Attribute which control the behavior of the Subject MPU:



1
  [selection: during initial start-up, periodically during normal operation, at the request of the authorized user, and/or at the conditions
     [assignment: conditions under which self test should occur]]
2
  [assignment: functions and/or mechanisms]

Security Target                                                      37                                                                 v4.0
                                                                                                                                  2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 MPU enable/disable bit.
 8 regions with the following attributes
    − a unique priority
    − the enable bit
    − the xn (execute never) bit
    − the start address and size
    − an access matrix which defines if an Operation of the MPU (Subject) to a memory/code address (Object)
     lying in the region is allowed or denied
 A bit defining the acces behavior of the default region, i.e. memory/code addresses not covered by one of the
  8 MPU regions.


Security Attributes for objects:
There are no security attributes for objects.


6.1.5.3            Access control rules of the Memory Access Control Policy
The following generic rules shall apply in case the MPU is enabled. In case the MPU is disabled, a privileged and
unprivileged code has full read/write/execute rights to all addresses.
 If an address is contained in multiple enabled regions, then the region with the highest priority defines the
    access rights.
   If an address is contained in no region then the default region defines the access rights.
   The region defining the access rights checks if the Subject has access to the Object with respect to the desired
    Operation. In case the access is denied the MPU throws an access violation exception. The checks are done
    according to the access matrix inTable 21.
   overlapping regions, have access to other regions with ascending region priority:
    region 7 = highest priority, region 0 = lowest priority
   execution of code is bound to the read access of Table 21 and the xn bit. If the xn bit is cleared and read
    access is enabled then execution of code is defined by Table 21. If the xn bit is set then execution is never
    allowed.

Table 21      Access matrix for read(execute)/write access
 Privileged Mode Permissions            User Mode                             Description
                                        Permissions
 No access                              No access                             All accesses in user mode and
                                                                              privileged mode generate a
                                                                              permission fault
 Read/write                             No access                             Privilege mode has full access
                                                                              while any access from user mode
                                                                              leads to a permission fault.
 Read/write                             Read(execute) only                    Privileged mode has full access
                                                                              while the user mode has no write
                                                                              access rights. Execute access in
                                                                              User mode further depends on the
                                                                              xn bit.
 Read/write                             Read(execute)/write                   Privileged mode has read and
                                                                              execute access rights. Write

Security Target                                         38                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Privileged Mode Permissions                 User Mode                                      Description
                                                Permissions
                                                                                               accesses from privileged mode
                                                                                               lead to a permission fault.
                                                                                               Any access of the user mode leads
                                                                                               to a permission fault.
    Read only                                   No access                                      Privileged mode has read and
                                                                                               execute access rights. Write
                                                                                               accesses lead to a permission
                                                                                               fault.
                                                                                               The same holds for the user mode,
                                                                                               except execute access further
                                                                                               depends on the xn bit.
    Read only                                   Read(execute) only                             All accesses in user mode and
                                                                                               privileged mode generate a
                                                                                               permission fault


6.1.5.4                SFRs of the Memory Access Control Policy
FDP_ACC.1                    Subset access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy as1 defined in section 6.1.5.12.


FDP_ACF.1                    Security attribute based access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACC.1 Subset access control
                             FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1                  The TSF shall enforce the Memory Access Control Policy3 to objects based on the
                             following: Attributes as specified in section 6.1.5.24 .
FDP_ACF.1.2                  The TSF shall enforce the following rules to determine if an operation among
                             controlled subjects and controlled objects is allowed: As specified in the section
                             6.1.5.35.
FDP_ACF.1.3                  The TSF shall explicitly authorize access of subjects to objects based on the following
                             additional rules: none6.
FDP_ACF.1.4                  The TSF shall explicitly deny access of subjects to objects based on the following
                             additional rules: none1.


1
  editorially refined
2
  [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]
3
  [assignment: access control SFP]
4
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
5
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
6
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]

Security Target                                                      39                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)


FMT_MSA.3                    Static attribute initialization
Hierarchical to:             No other components.
Dependencies:                FMT_MSA.1 Management of security attributes
                             FMT_SMR.1 security roles
FMT_MSA.3.1                  The TSF shall enforce the Memory Access Control Policy2 to provide restrictive3 default
                             values for security attributes that are used to enforce the SFP.
FMT_MSA.3.2                  The TSF shall allow the privilege mode4 to specify alternative initial values to override
                             the default values when an object or information is created.


FMT_MSA.1                    Management of security attributes
Hierarchical to:             No other components.
Dependencies:                [FDP_ACC.1 Subset access control or FDP_IFC.1 Subset information flow control]
                             FMT_SMF.1 Specification of management functions
                             FMT_SMR.1 Security roles
FMT_MSA.1.1                  The TSF shall enforce the Memory Access Control Policy5 to restrict the ability to
                             modify6 the security attributes Security Attribute which control the behavior of the
                             Subject MPU7 to the privilege mode8.


FMT_SMF.1                    Specification of management functions
Hierarchical to:             No other components
Dependencies:                No dependencies
FMT_SMF.1.1                  The TSF shall be capable of performing the following security management functions:
                             modifying the security attributes9.


FMT_SMR.1                    Security roles
Hierarchical to:             No other components.
Dependencies:                FIA_UID.1 Timing of identification
FMT_SMR.1.1                  The TSF shall maintain the roles privilege mode and non-privilege mode10.
FMT_SMR.1.2                  The TSF shall be able to associate users with roles.

6.1.6                  Data Integrity
FDP_SDI.2                    Stored data integrity monitoring and action


1
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
2
  [assignment: access control SFP, information flow control SFP]
3
  [selection, choose one of: restrictive, permissive, [assignment: other property]]
4
  [assignment: the authorised identified roles]
5
  [assignment: access control SFP(s), information flow control SFP(s)]
6
  [selection: change_default, query, modify, delete, [assignment: other operations]]
7
  [assignment: list of security attributes]
8
  [assignment: the authorised identified roles]
9
  [assignment: list of management functions to be provided by the TSF]
10
   [assignment: the authorised identified roles]

Security Target                                                       40                                             v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Hierarchical to:             FDP_SDI.1 stored data integrity monitoring
Dependencies:                No dependencies
FDP_SDI.2.1                  The TSF shall monitor user data stored in containers controlled by the TSF for data
                             integrity and one- and/or more-bit-errors1 on all objects, based on the following
                             attributes: error correction ECC for the SOLID FLASHҹ NVM2.
FDP_SDI.2.2                  Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                             FLASHҹ NVM automatically and inform the user about other bit errors3.



FDP_SDC.1                    Stored data confidentiality
Hierarchical to:             No other components
Dependencies:                No dependencies
FDP_SDC.1.1                  The TSF shall ensure the confidentiality of the information of the user data while it is
                             stored in the RAM and SOLID FLASHҹ NVM4.




6.1.7                  Support of Flash Loader
The TOE provides a Flash Loader to download user data into the SOLID FLASHҹ NVM, either during production
of the TOE or at customer site. Depending on the configuration option EA the Flash Loader claims different sets
of SFRs. [PP0084] section 7.3.1 “Package 1: Loader dedicated for usage in secured environment only” is claimed
for both options. [PP0084] section 7.2 Package “Authentication of the Security IC” and [PP0084] section 7.3.2
“Package 2: Loader dedicated for usage by authorized users only” is only claimed in case TOE is ordered with
EA unavailable, however a subset of SFRs from loader package 2 is also claimed, if TOE is ordered with EA
available.




6.1.8                  Flash Loader Policy
The table as follows shows the Flash Loader SFR claims in dependency of the order option EA.

Table 22       Flash loader SFR claims
EA unavailable                                                  EA available
Limited capabilities (FMT_LIM.1/Loader)                         Limited capabilities (FMT_LIM.1/Loader)
Limited availability – Loader (FMT_LIM.2/Loader)                Limited availability – Loader (FMT_LIM.2/Loader)
Authentication Proof of Identity (FIA_API.1)                    -
Inter-TSF trusted channel (FTP_ITC.1)                           -
Basic data exchange confidentiality (FDP_UCT.1)                 Basic data exchange confidentiality (FDP_UCT.1)
Data exchange integrity (FDP_UIT.1)                             Data exchange integrity (FDP_UIT.1)

1
  [assignment: integrity errors]
2
  [assignment: user data attributes]
3
  [assignment: action to be taken]
4
  [assignment: memory area]

Security Target                                               41                                                      v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

EA unavailable                                                EA available
Subset access control – Loader (FDP_ACC.1/Loader)             Subset access control – Loader (FDP_ACC.1/Loader)
Security attribute based access control – Loader              Security attribute based access control – Loader
(FDP_ACF.1/Loader)                                            (FDP_ACF.1/Loader)
Management of TSF data – Loader                               Management of TSF data – Loader
(FMT_MTD.1/Loader)                                            (FMT_MTD.1/Loader)
Security Roles – Loader (FMT_SMR.1/Loader)                    Security Roles – Loader (FMT_SMR.1/Loader)
Specification of Management Functions – Loader                Specification of Management Functions – Loader
(FMT_SMF.1/Loader)                                            (FMT_SMF.1/Loader)
User Identification before any action – Loader                User Identification before any action – Loader
(FIA_UID.2/Loader)                                            (FIA_UID.2/Loader)



The TOE shall meet the loader SFRs as specified below:

FMT_LIM.1/Loader            Limited Capabilities
    Hierarchical to:         No other components.
    Dependencies:            No other components
    FMT_LIM.1.1/Loader       The TSF shall be designed and implemented in a manner that limits its capabilities so
                             that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                             enforced: Deploying Loader functionality after permanent deactivation does not
                             allow stored user data to be disclosed or manipulated by unauthorized user1.



FMT_LIM.2/Loader            Limited availability - Loader
    Hierarchical to:         No other components.
Dependencies:               FMT_LIM.1 Limited capabilities.
    FMT_LIM.2.1/Loader       The TSF shall be designed in a manner that limits its availability so that in conjunction
                             with “Limited capabilities (FMT_LIM.1)” the following policy is enforced: The TSF
                             prevents deploying the Loader functionality after permanent deactivation2.

Regarding FMT_LIM.1.1/Loader the User Guidance requires the Flash Loader to be permanently deactivated
prior delivery to the end user (Phase 7).
 FTP_ITC.1               Inter-TSF trusted channel
    Hierarchical to:         No other components.
    Dependencies:            No dependencies.
    FTP_ITC.1.1              The TSF shall provide a communication channel between itself and administrator
                             user, or Download operator user3, that is logically distinct from other communication
                             channels and provides assured identification of its end points and protection of the
                             channel data from modification or disclosure.




1
  [assignment: Limited capability policy]
2
  [assignment: Limited availability policy]
3
  [assignment: users authorized for using the Loader]

Security Target                                             42                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    FTP_ITC.1.2              The TSF shall permit another trusted IT product1 to initiate communication via the
                             trusted channel.
    FTP_ITC.1.3              The TSF shall initiate communication via the trusted channel for deploying Loader for
                             downloading user data2.

    FDP_UCT.1                Basic data exchange confidentiality
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP3 to receive4 user data in a manner protected
                             from unauthorised disclosure.

    FDP_UIT.1                Data exchange integrity
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP5 to receive6 user data in a manner protected
                             from modification, deletion, insertion7 errors.
FDP_UIT.1.2                 The TSF shall be able to determine on receipt of user data, whether modification,
                            deletion, insertion8 has occurred.



FDP_ACC.1/Loader            Subset access control - Loader
    Hierarchical to:         No other components.
    Dependencies:            FDP_ACF.1 Security attribute based access control.
    FDP_ACC.1.1/Loader       The TSF shall enforce the Loader SFP9 on
                              the subjects Administrator User, Download Operator User and Image Provider,
                              the objects user data in SOLID FLASHҹ NVM memory of the TOE,
                              the operation deployment of Loader10




    FDP_ACF.1/Loader         Security attribute based access control - Loader
    Hierarchical to:         No other components.


1
  [selection: the TSF, another trusted IT product]
2
  [assignment: list of functions for which a trusted channel is required][assignment: rules]
3
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
4
  [selection: transmit, receive]
5
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
6
  [selection: transmit, receive]
7
  [selection: modification, deletion, insertion, replay]
8
  [selection: modification, deletion, insertion, replay]
9
  [assignment: access control SFP]
10
   [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]

Security Target                                                    43                                            v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:             FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        FDP_ACF.1.1 The TSF shall enforce the Loader SFP1 to objects based on the following:
                              the subjects and objects of FDP_ACC.1.1/Loader without security attributes2
    FDP_ACF.1.2/Loader        FDP_ACF.1.2 The TSF shall enforce the following rules to determine if an operation
                              among controlled subjects and controlled objects is allowed:
                              The authenticated Administrator User or authenticated Download Operator User can
                              modify the user data by new user data when the new user data is authorized by the
                              Image Provider3
    FDP_ACF.1.3/Loader        FDP_ACF.1.3 The TSF shall explicitly authorise access of subjects to objects based on
                              the following additional rules: none4.
    FDP_ACF.1.4/Loader        The TSF shall explicitly deny access of subjects to objects based on the following
                              additional rules: none5.

Note:          The security functional requirements FIA_API.1, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1, FDP_ACC.1/Loader
               and FDP_ACF.1/Loader apply only to TOE products with activated Flash Loader. In other cases the
               Flash Loader is not available anymore and the user data download is completed.

The following SFRs have been added to the SFRs from Flash Loader package 2 of [PP0084] in order to describe
the management of the various Flash Loader authentication keys.



FMT_MTD.1/Loader               Management of TSF data
    Hierarchical to:           No other components.
    Dependencies:              FMT_SMR.1 Security roles
                               FMT_SMF.1 Specification of Management Functions
    FMT_MTD.1.1/Loader         The TSF shall restrict the ability to change_default, modify, delete6 the Authentication
                               keys for Administrator User, Download Operator User and Image Provider7 to
                               Administrator User, Download Operator User8.

Note:          The Administrator User can manage the keys for Administration User, Download Operator User and
               Image Provider. The Download Operator User can delete the key for Image Provider and Download
               Operator, otherwise manage the keys for the Download Operator User only. The image provider cannot
               modify any keys or perform authentication with the Flash Loader. It can simply built authentic
               loadable images.

FMT_SMR.1/Loader               Security roles
    Hierarchical to:           No other components.


1
  [assignment: access control SFP]
2
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
3
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
4
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]
5
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
6
  [selection: change_default, query, modify, delete, clear, [assignment: other operations]]
7
  [assignment: list of TSF data]
8
  [assignment: the authorised identified roles]

Security Target                                                      44                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMR.1.1/Loader       The TSF shall maintain the roles Administrator User, Download Operator User, Image
                             provider1.
    FMT_SMR.1.2/Loader       The TSF shall be able to associate users with roles.



FMT_SMF.1/Loader             Specification of Management Functions
    Hierarchical to:         No other components.
    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMF.1.1/Loader       The TSF shall be capable of performing the following management functions: Change
                             Key, Invalidate Key2.

Note:          “Change Key” of this SFR combines the “Change default” and “modify” operations from SFR
               FMT_MTD.1/Loader. “Invalidate Key” of this SFR is equivalent to the “delete” operation from SFR
               FMT_MTD.1/Loader.

    FIA_UID.2/Loader         User Identification before any action
    Hierarchical to:         FIA_UID.1
    Dependencies:            No dependencies.
    FIA_UID.2.1/Loader       The TSF shall require each user to be successfully identified before allowing any other
                             TSF-mediated actions on behalf of that user.


6.1.9                  Support of Authentication of the Security IC
The Flash Loader provides a security IC authentication service.



FIA_API.1                   Authentication Proof of Identity
Hierarchical to:            No other components.
Dependencies:               No dependencies.
FIA_API.1.1                 The TSF shall provide a authentication mechanism according to [ISO9798_2] section
                            6.2.2 Mechanism 4: Three-pass authentication3 to prove the identity of the TOE4 to an
                            external entity.

This security functional requirement applies only to TOE products with Flash Loader activated and TOE is
ordered with EA unavailable.

6.2                    TOE Security Assurance Requirements
The evaluation assurance level is EAL6 augmented with ALC_FLR.1. In the following table, the security
assurance requirements are given.


1
  [assignment: the authorised identified roles]
2
  [assignment: list of management functions to be provided by the TSF]
3
  [assignment: authentication mechanism]
4
  [selection: TOE, [assignment: object, authorized user or role]]

Security Target                                                   45                                              v4.0
                                                                                                            2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Table 23      Assurance components
 Aspect                    Acronym          Description                                Refinement
 Development               ADV_ARC.1        Security Architecture Description          [PP0084]
                           ADV_FSP.5        Complete semi-formal functional            [PP0084]
                                            specification with additional error
                                            information
                           ADV_IMP.2        Complete mapping of the                    [PP0084]
                                            implementation representation of the
                                            TSF
                           ADV_INT.3        Minimally complex internals
                           ADV_TDS.5        Complete semi-formal modular design
                           ADV_SPM.1        Formal TOE security policy model
 Guidance Documents        AGD_OPE.1        Operational user guidance                  [PP0084]
                           AGD_PRE.1        Preparative procedures                     [PP0084]
 Life-Cycle Support        ALC_CMC.5        Advanced support                           [PP0084]
                           ALC_CMS.5        Development tools CM coverage              [PP0084]
                           ALC_DEL.1        Delivery procedures                        [PP0084]
                           ALC_DVS.2        Sufficiency of security measures           [PP0084]
                           ALC_LCD.1        Developer defined life-cycle model
                           ALC_TAT.3        Compliance with implementation
                                            standards – all parts
 ST Evaluation             ASE_CCL.1        Conformance claims
                           ASE_ECD.1        Extended components definition
                           ASE_INT.1        ST introduction
                           ASE_OBJ.2        Security objectives
                           ASE_REQ.2        Derived security requirements
                           ASE_SPD.1        Security problem definition
                           ASE_TSS.1        TOE summary specification
 Tests                     ATE_COV.3        Rigorous analysis of coverage              [PP0084]
                           ATE_DPT.3        Testing: modular design
                           ATE_FUN.2        Ordered functional testing
                           ATE_IND.2        Independent testing - sample
 Vulnerability             AVA_VAN.5        Advanced methodical vulnerability          [PP0084]
 Assessment                                 analysis

6.2.1              Refinements
Some refinements are taken unchanged from [PP0084]. Table 23 provides an overview.
Some refinements from [PP0084] have to be discussed here in the ST, as the assurance level is increased.




Security Target                                       46                                                   v4.0
                                                                                                     2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.2.1.1              Implementation representation (ADV_IMP)
The refinement of [PP0084] requires the evaluator to check for completeness. In case of ADV_IMP.2 the entire
implementation representation has to be provided anyhow. A check for completeness is also applicable in case
the entire implementation representation is provided.

6.2.1.2              Life cycle support (ALC_CMS)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ALC_CMS.5.
The assurance package ALC_CMS.4 is extended to ALC_CMS.5 with aspects regarding the configuration control
system for the TOE. The refinement is still valid.

6.2.1.3              Configuration management capabilities (ALC_CMC)
The refinement from [PP0084] details, how configuration management has to be also applied to production.
This is also applicable for ALC_CMC.5. ALC_CMC.5 is not specifically focused on production.

6.2.1.4              Test Coverage (ATE_COV)
The refinement in [PP0084] clarifies, how to deal with testing of security mechanisms for physical protection. It
further requests the TOE to be tested under different operating conditions. These refinements are also
applicable for ATE_COV.3, which requires complete TSFI coverage.

6.2.1.5              Functional Specification (ADV_FSP)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ADV_FSP.5. The
assurance package ADV_FSP.4 is extended to ADV_FSP.5 with aspects regarding the level of description.
ADV_FSP.5 requires a semi-formal description in addition. The refinement is still valid.
For refinement details see [PP0084].

6.2.2                Security policy model details
EAL6 requires the development of a formal security policy model of the TSF, and establishing a correspondence
between the functional specification and this security policy model. Preserving internal consistency the
security policy model is expected to formally establish the security principles from its characteristics by means
of a mathematical proof.
ADV_SPM.1          Formal TOE security policy model
Hierarchical to:          No other components
Dependencies:             ADV_FSP.4 Complete function description
ADV_SPM.1.1D              The developer shall provide a formal security policy model for the
Memory Access Control Policy and the corresponding SFRs
              o    FDP_ACC.1 Subset Access Control
              o    FDP_ACF.1 Security attribute based access control
              o    FMT_MSA.1 Management of Security Attributes
              o    FMT_MSA.3 Static Attribute Initialization.
              o    FMT_SMF.1 Specification of management functions
              o    FMT_SMR.1 Security roles


Security Target                                          47                                                   v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Support of Flash Loader SFRs
            o FMT_LIM.1/Loader Limited Capabilities
            o FMT_LIM.2/Loader Limited availability – Loader
            o FTP_ITC.1 Inter-TSF trusted channel
            o FDP_UCT.1 Basic data exchange confidentiality
            o FDP_UIT.1 Data exchange integrity
            o FDP_ACC.1/Loader Subset access control – Loader
            o FDP_ACF.1/Loader Security attribute based access control – Loader
            o FMT_MTD.1/Loader Management of TSF data – Loader
            o FMT_SMR.1/Loader Security roles – Loader
            o FMT_SMF.1/Loader Specification of Management Functions – Loader
            o FIA_UID.2/Loader Use identification before any action – Loader
Support of Authentication of the Security IC SFR
            o FIA_API.1 Authentication Proof of Identity
Moreover, the following SFRs shall be addressed by the formal security policy model:
              o   FDP_SDI.2 Stored data integrity monitoring and action
              o   FDP_SDC.1 Stored data confidentiality
              o   FDP_ITT.1 Basic Internal Transfer Protection
              o   FDP_IFC.1 Information Flow Control
              o   FPT_ITT.1 Basic internal TSF data transfer protection
              o   FPT_PHP.3 Resistance to physical attack
              o   FPT_FLS.1 Failure with preservation of secure state
              o   FRU_FLT.2 Limited fault tolerance
              o   FMT_LIM.1 Limited capabilities
              o   FMT_LIM.2 Limited availability
              o   FAU_SAS.1 Audit storage
ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify the
          relevant portions of the statement of SFRs that make up that policy.
ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and any
          formal functional specification.
ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model and the
          functional specification.

6.3                 Security Requirements Rationale

6.3.1               Rationale for the Security Functional Requirements
While the security functional requirements rationale of the TOE are defined and described in [PP0084] section
6.3.1, 7.2.3, 7.3.1, 7.3.2, 7.4.1 and 7.4.2, the additional introduced SFRs are discussed below:

Table 24      Rational for additional SFR in the ST
 Objective                            TOE Security Functional Requirements
 O.Phys-Manipulation                  -       FPT_TST.2 „ Subset TOE security testing “
 O.Mem-Access                         -       FDP_ACC.1 “Subset access control”

Security Target                                        48                                                   v4.0
                                                                                                      2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Objective                            TOE Security Functional Requirements
                                      -     FDP_ACF.1 “Security attribute based access control”
                                      -     FMT_MSA.3 “Static attribute initialisation”
                                      -     FMT_MSA.1 “Management of security attributes”
                                      -     FMT_SMF.1 “Specification of Management Functions”
                                      -     FMT_SMR.1 “Security Roles”
 O.AES-TDES-MAC                       FCS_COP.1/SCL/TDES, FCS_COP.1/SCL/TDES-MAC, FCS_CKM.4/SCL,
                                      FCS_COP.1/SCL/AES, FCS_COP.1/SCL/AES-MAC,
 O.AES                                FCS_CKM.4/SCL, FCS_COP.1/SCL/AES
 O.TDES                               FCS_COP.1/SCL/TDES, FCS_CKM.4/SCL
 O.RSA                                FCS_COP.1/RSA/<iteration>, FCS_CKM.1/RSA/<iteration>,
                                      FCS_CKM.4/RSA
 O.ECC                                FCS_COP.1/ECC/<iteration>, FCS_CKM.1/ECC, FCS_CKM.4/ECC
 O.Prot_TSF_Confidentiality           -      FTP_ITC.1 Inter-trusted-TSF channel
                                      -      FDP_ACC.1/Loader Subset access control –Loader
                                      -      FDP_ACF.1/Loader Security attribute based access control –
                                      Loader
 O.Ctrl_Auth_Loader                   FMT_MTD.1/Loader, FMT_SMR.1/Loader, FMT_SMF.1/Loader,
                                      FIA_UID.2/Loader

The table above gives an overview how the security functional requirements are combined to meet the security
objectives. This table has to be read in addition to [PP0084] table 2 “Security Requirements versus Security
Objectives”. The detailed justification is given in the following:
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and
functions provided by the TOE can be tested after TOE Delivery. This security functional component is used
instead of the functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to
know which security functions or mechanisms can be tested. The functional component FPT_TST.1 does not
mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of
the integrity of TSF data and stored TSF executable code which might violate the security policy.
The security functional requirement FPT_TST.2 detects attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation.
The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1, FMT_SMF.1 and FMT_SMR.1 cover this security objective. The
implementation of these functional requirements is represented by the dedicated privilege level concept.
The additional SCL related SFRs support standard TDES and AES encryption and decryption. It also offers MAC
services based on these cryptographic primitives.
The additional cryptographic SFRs related to RSA and ECC are mapped to the respective RSA and ECC
objectives.
The additional loader SFRs describe the Flash Loader roles and the access rules. Therefore these additional
SFRs are mapped to O.Ctrl_Auth_Loader contributing to the aspect “access control for usage of the loader
functionality” as described in [PP0084]. In case EA is chosen, FTP_ITC.1 is not part of the TOE and therefore not


Security Target                                         49                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

mapped to O.Ctrl_Auth_Loader. However due to the confidentiality and integrity protection of downloaded
user data andone-way authentication from user towards Flash Loader, the loader can still be controlled in an
effective way and prevent misuse of unauthorized usage.
The loader SFR FTP_ITC.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader describe the requirement of a trusted
channel with role based access control in order to use the loader functionality. This prevents loading of
unauthorized software by unauthorized subjects and maps to O.Prot_TSF_Confidentiality. In case EA is chosen,
the Flash Loader requests a one-way authentication instead of a mutual authentication. FTP_ITC.1 is not part
of the TOE. However the objective is still met, because the one-way authentication and role based access
control together with the environmental objective OE.Prevent_Masquerade prevent unauthorized and
manipulative usage.
The justification of the security objective and the additional requirements show that they do not contradict the
rationale already given in [PP0084] for the assumptions, policy and threats defined there.
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions
are used as specified and that the User Data processed by these functions are protected as defined for the
application context. The TOE only provides the tool to implement the policy defined in the context of the
application.

6.3.1.1            Dependencies of Security Functional Requirements
The dependencies of security functional requirements are defined and described in [PP0084] section 6.3.2,
7.2.3, 7.3.1, 7.3.2, 7.4.1 and section 7.4.2 for the following security functional requirements: FDP_SDC.1,
FDP_SDI.2, FDP_ITT.1, FDP_IFC.1, FPT_ITT.1, FPT_PHP.3, FPT_FLS.1, FRU_FLT.2, FMT_LIM.1, FMT_LIM.2,
FCS_RNG.1. FAU_SAS.1, FIA_API.1, FMT_LIM.1/Loader, FMT_LIM.2/Loader, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1,
FDP_ACC.1/Loader, FDP_ACF.1/Loader.
The dependencies of the additional security functional requirements (the functional requirements in addition
to the ones defined in [PP0084]) are analysed in the following description.

Table 25      Dependency for cryptographic operation requirement
 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
 FPT_TST.2                           None                        n.a.
 FDP_ACC.1                           FDP_ACF.1                   Yes
                                     FDP_ACC.1                   Yes
 FDP_ACF.1
                                     FMT_MSA.3                   Yes
                                     FMT_MSA.1                   Yes
 FMT_MSA.3
                                     FMT_SMR.1                   Yes
                                     FDP_ACC.1 or FDP_IFC.1      Yes
 FMT_MSA.1                           FMT_SMR.1                   Yes
                                     FMT_SMF.1                   Yes
 FMT_SMF.1                           None                        n.a.
 FMT_SMR.1                           FIA_UID.1                   No, see comment 1
 FCS_COP.1                           FCS_CKM.4                   Yes
                                     [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]
 FCS_CKM.4                           [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]

Security Target                                        50                                                    v4.0
                                                                                                       2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
                                     [FCS_CKM.2,
 FCS_CKM.1                                                       Yes, FCS_CKM.4
                                     FCS_COP.1, FCS_CKM.4]
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UCT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UIT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
 FDP_ACF.1/Loader                    FMT_MSA.3                   No, see comment 3
 FMT_MTD.1/Loader                    FMT_SMR.1, FMT_SMF.1        Yes
 FMT_SMR.1/Loader                    FIA_UID.2                   Yes
 FMT_SMF.1/Loader                    FIA_UID.2                   Yes

Comment 1:
As the privileged mode and the non-privileged mode identified in FMT_SMR.1 are implicitly identified by the
MPU, the dependency to FIA_UID.1 is not applicable.
End of comment.
Comment 2:
The security functional requirement “Cryptographic operation (FCS_COP.1)” met by the TOE has the following
dependencies:
    [FDP_ITC.1 Import of user data without security attributes, or
    FDP_ITC.2 Import of user data with security attributes or
    FCS_CKM.1 Cryptographic key generation]
 encryption of the transmitted data and encrypting the nonce in the first step of PACE. The keys
are agreed between the TOE and the terminal as part of the PACE protocol according to FCS_CKM.1/DH_PACE.


FCS_COP.1/PACE_MAC             MAC Cryptographic operation – MAC
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_MAC      The TSFshall perform secure messaging – message authentication code in
                   accordance with a specified cryptographic algorithm CMAC and Retail-MAC and
                   cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant to
                   [ICAO_SAC] .
Application Note: In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used in Retail
mode for secure messaging.


6.3.2               Class FIA Identification and Authentication


FIA_AFL.1/PACE         Authentication failure handling – PACE authentication using non-blocking
authorisation data

CC Document                                           17                                                      3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchicalto:    No other components.
Dependencies:      FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE   The TSF shall detect when one unsuccessful authentication attempt occurs related to
                   authentication attempts using the PACE password as shared password
FIA_AFL.1.2/PACE   When the defined number of unsuccessful authentication attempts has been met, the
                   TSF shall increasingly slow down the performance up to a maximum not higher than 7
                   seconds verifying the authentication token.


FIA_UID.1/PACE     Timing of identification
Hierarchical to:   No other components.
Dependencies:      No dependencies.
FIA_UID.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carry out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS
                   4. none
                   on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE   The TSF shall require each user to be successfully identified before allowing any other
                   TSF-mediated actions on behalf of that user.


FIA_UAU.1/PACE     Timing of authentication
Hierarchical to:   No other components.
Dependencies:      FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE
FIA_UAU.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carrying out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS,
                   4. none
                   on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE           The TSF shall require each user to be successfully authenticated before allowing
                           any other TSF-mediated actions on behalf of that user.




FIA_UAU.4/PACE     Single-use authentication of the Terminals by the TOE


CC Document                                         18                                                    3.5
                                                                                                   2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchical to:      No other components.
Dependencies:         No dependencies.
FIA_UAU.4.1/PACE      The TSF shall prevent reuse of authentication data related to
                      1. PACE Protocol according to [ICAO_SAC]
                      2. Authentication Mechanism based on Triple-DES
                      3. none


FIA_UAU.5/PACE        Multiple authentication mechanisms
Hierarchi                                    type

                                                                                                  Hardware
                                                                                                                    SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
® TÜV, TUEV and TUV are registered trademarks  FMT_SMR.1 for BAC
FMT_MTD.1.1/INI_ENA The TSF shall restrict the ability to write the Initialisation Data and Pre-personalisation
                    Data to the Manufacturer.
Application Note: The application note 42 of [PP_BAC] applies. This application note provides a definition, what
is meant by “Pre-personalization Data”. This definition is also applicable to FMT_MTD.1/INI_ENA from
[PP_SAC]. Therefore FMT_MTD.1/INI_ENA from [PP_BAC] and [PP_SAC] can be combined.



CC Document                                            15                                                     3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

6.2.3              Class FPT Protection of the Security Functions
FPT_TST.1               TSF testing
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_TST.1.1             The TSF shall run a suite of self tests during initial start-up, to demonstrate the correct
                        operation of the TSF.
FPT_TST.1.2             The TSF shall provide authorised users with the capability to verify the integrity of the
                        TSF data.
FPT_TST.1.3             The TSF shall provide authorised users with the capability to verify the integrity of
                        stored TSF executable code.
Application Note: There is no contradiction between application note 46 of [PP_BAC] and application note 52 of
[PP_SAC]. In fact, although the wording is slightly different, the meaning of these application notes is identical.
Therefore either of these application notes applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be
combined.


FPT_PHP.3               Resistance to physical attack
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_PHP.3.1             The TSF shall resist physical manipulation and physical probing to the TSF by
                        responding automatically such that the SFRs are always enforced.
Application Note: Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application note 48 of
[PP_BAC] is only informative to the reader in the sense, that it provides a context to an older CC standard, but
not relevant for the interpretation of FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or
application note 53 of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.


6.3                SFRs specifically from [PP_SAC]

6.3.1              Class FCS: Cryptographic Support
FCS_CKM.1/DH_PACE Cryptographic key generation – Diffie-Hellman for PACE session keys
Hierarchical to:        No other components.
Dependencies:           [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic operation]
                        Justification: A Diffie-Hellman key agreement is used in order to have no key
                        distribution, therefore FCS_CKM.2 makes no sense in this case. FCS_CKM.4
                        Cryptographic key destruction: fulfilled by FCS_CKM.4
FCS_CKM.1.1/DH_PACE       The TSF shall generate cryptographic keys in accordance with a specified
                   cryptographic key generation algorithm Diffie-Hellman-Protocol compliant to
                   [PKCS#3], ECDH compliant to [TR_ECC] and specified cryptographic key size Table 6
                   column key size that meet the following: [ICAO_SAC].


CC Document                                              16                                                       3.5
                                                                                                           2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Table 6       FCS_CKM/DH_PACE Key Sizes
 algorithm                                                                Key size
 ECDH key agreement algorithm                                             192, 224, 256, 320, 384, 512, 521
 DH key agreement algorithm                                               1024, 1280, 1536, 2048
 AES session keys                                                         128, 192, 256
 TDES session keys                                                        112



FCS_COP.1/PACE_ENC Cryptographic operation – Encryption / Decryption AES / 3DES
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_ENC      The TSF shall perform secure messaging – encryption and decryption in
                   accordance with a specified cryptographic algorithm AES and 3DES in CBC mode and
                   cryptographic key sizes 112, 128, 192 and 256 bit that meet the following: compliant to
                   [ICAO_SAC]
Application Note: 3DES in CBC mode is used with key size of 112 bit. AES in CBC mode is used with key size of
128, 192 or 256 bit. The TOE implements the cryptographic primitives (i.e. Triple-DES and AES) for secure
messaging with encryption of the transmitted data and encrypting the nonce in the first step of PACE. The keys
are agreed between the TOE and the terminal as part of the PACE protocol according to FCS_CKM.1/DH_PACE.


FCS_COP.1/PACE_MAC             MAC Cryptographic operation – MAC
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_MAC      The TSFshall perform secure messaging – message authentication code in
                   accordance with a specified cryptographic algorithm CMAC and Retail-MAC and
                   cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant to
                   [ICAO_SAC] .
Application Note: In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used in Retail
mode for secure messaging.


6.3.2               Class FIA Identification and Authentication


FIA_AFL.1/PACE         Authentication failure handling – PACE authentication using non-blocking
authorisation data

CC Document                                           17                                                      3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchicalto:    No other components.
Dependencies:      FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE   The TSF shall detect when one unsuccessful authentication attempt occurs related to
                   authentication attempts using the PACE password as shared password
FIA_AFL.1.2/PACE   When the defined number of unsuccessful authentication attempts has been met, the
                   TSF shall increasingly slow down the performance up to a maximum not higher than 7
                   seconds verifying the authentication token.


FIA_UID.1/PACE     Timing of identification
Hierarchical to:   No other components.
Dependencies:      No dependencies.
FIA_UID.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carry out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS
                   4. none
                   on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE   The TSF shall require each user to be successfully identified before allowing any other
                   TSF-mediated actions on behalf of that user.


FIA_UAU.1/PACE     Timing of authentication
Hierarchical to:   No other components.
Dependencies:      FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE
FIA_UAU.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carrying out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS,
                   4. none
                   on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE           The TSF shall require each user to be successfully authenticated before allowing
                           any other TSF-mediated actions on behalf of that user.




FIA_UAU.4/PACE     Single-use authentication of the Terminals by the TOE


CC Document                                         18                                                    3.5
                                                                                                   2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchical to:      No other components.
Dependencies:         No dependencies.
FIA_UAU.4.1/PACE      The TSF shall prevent reuse of authentication data related to
                      1. PACE Protocol according to [ICAO_SAC]
                      2. Authentication Mechanism based on Triple-DES
                      3. none


FIA_UAU.5/PACE        Multiple authentication mechanisms
Hierarchi                                    type

                                                                                                  Hardware
                                                                                                                    SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                             Platform Build ID: 0261A7

                                                                                                                             eUICC plug-in                                        1.5.129

                                                                                                                    JCOP5.2                                 ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????                      R2.01.1

                                                                                                                             Platform ID: N5C2M0029E7D0600
                                                                                                  Software
                                                                                                  TOE
                                                                                                                             Platform Build ID: 029E7D

                                                                                                                             eUICC plug-in                                        1.5.146

                                                                                                                    JCOP5.2                                                       R2.02.1

                                                                                                                             Platform ID: N5C2M002A62D0600

                                                                                                                             Platform Build ID: 02A62D

                                                                                                                             eUICC plug-in                                        1.5.148


                                                                                                 To ensure secure usage a set of guidance documents is provided together with the NXP JCOP 5.2 on
                                                                                                 SN100.C58 Secure Element. Details can be found in section “Documentation” of this report.
                                                                                                 For a detailed and precise description of the TOE lifecycle refer to the [ST], chapter 1.3.3.
                                                                                                 Page: 7/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.2       Security Policy
                                                                                                 The TOE is a composite product on top of CC certified Hardware, Firmware and Crypto Library. The
                                                                                                 overall product consists of a Secure Micro-Controller and a software stack. The Micro-Controller
                                                                                                 provides an Integrated NFC controller and an embedded Secure Element core. The software stack
                                                                                                 creates 2 separate domains to provide a converged product consisting of a familiar Java Card Secure
                                                                                                 Element domain and an eUICC domain providing UICC functionality and external ISO-7816
                                                                                                 connectivity.
                                                                                                 The TOE has the following features:
                                                                                                           Cryptographic algorithms and functionality:
                                                                                                                o 3DES for en-/decryption (CBC and ECB) and MAC generation and verification (2-
                                                                                                                     key3DES, 3-key 3DES, Retail-MAC, CMAC and CBC-MAC).
                                                                                                                o AES (Advanced Encryption Standard) for en-/decryption (GCM, CBC and ECB) and
                                                                                                                     MAC generation and verification (CMAC, CBC-MAC).
                                                                                                                o RSA and RSA CRT for en-/decryption and signature generation and verification.
                                                                                                                o RSA and RSA CRT key generation.
                                                                                                                o SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                                                                                                                o Secure SHA-1, Secure SHA-224, Secure SHA-256, Secure SHA-384, Secure SHA-
                                                                       NXP Secure Sm                                                512 hash algorithm.
                                                                                                                o HMAC.
                                                                                                                o ECC over GF(p) for signature generation and verification (ECDSA).
                                                                                                                o ECC over GF(p) key generation for key agreement.
                                                                                                                o Random number generation according to class DRG.3 of AIS 20.
                                                                                                           Java Card 3.0.5 functionality.
                                                                                                           GlobalPlatform 2.3 functionality including Amendments A,B,C,D,E,F,H and I and is compliant
                                                                                                            with the Common Implementation Configuration.
                                                                                                           GSMA ’Remote SIM Provisioning Architecture for consumer Devices’.
                                                                                                           Cryptographic Service Provider (CSP) features.
                                                                                                           NXP Proprietary Functionality:
                                                                                                                o MiFare functionality accessible via Applets using the MiFare API – no security
                                                                                                                     functionality is claimed.
                                                                                                                o OSSCA (Chinese Crypto) functionality accessible via Applets using the OSSCA API –
                                                                                                                     No security functionality is claimed.
                                                                                                                o Felica functionality accessible via Applets using the Felica API - no security
                                                                                                                     functionality is claimed for this functionality.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                o Config Applet: JCOP5.2 OS includes a Config Applet that can be used for
                                                                                                                     configuration of the TOE.
                                                                                                                o OS Update Component: Proprietary functionality that can update JCOP5.2 OS or
                                                                                                                     UpdaterOS.
                                                                                                                o UAI update component: Proprietary functionality that is can update JCOP5.2 OS- no
                                                                                                                     security functionality is claimed.
                                                                                                                o Restricted Mode: In Restricted Mode only very limited functionality of the TOE is
                                                                                                                     available such as, e.g.: reading logging information or resetting the Attack Counter.
                                                                                                                o Error Detection Code (EDC) API.
                                                                                                           Functionality introduced in R2, for which there are no specific additional security claims:
                                                                                                                o CAT-TP, with limitations as described in the [AGD_UGM] Section 8.1.
                                                                                                                o 5G features as per SIM Alliance 2.3, as in [AGD_UGM] Section 2.4.4 and 8.1.
                                                                                                                o Extension to Global Platform Amendment H, as in [AGD_UGM] Section 3.5.7.
                                                                                                                o CPLC data made available through SystemInfo, as in [AGD_UGM] Section 2.1.3.22.

                                                                                                 2.3       Assumptions and Clarification of Scope

                                                                                                 2.3.1      Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in section 5.2 of the
                                                                                                 [ST].
                                                                                                 Page: 8/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.
                                                                                                 Note that proprietary applications have been included in the TOE, but as there are no security claims
                                                                                                 on these functionalities, these application functionality has not been assessed, only the self-protection
                                                                                                 of the TSF.

                                                                                                 2.4     Architectural Information
                                                                                                 The TOE consists of a certified Hardware IC, with Micro Controller Firmware (Boot OS, Factory OS
                                                         art Card
  Controller P6022y VB
  Security Targe                                        and Flash driver software) and certified security software library consisting of a crypto library and
                                                                                                 services software. All these parts are depicted in the figure below with the shaded box marked
                                                                                                 SE100_SE. Since, this TOE is a composite on top of this certified platform, this block is not depicted
                                                                                                 in more detail.
                                                                                                 The Software stack consists of the JCOP Core parts marked with salmon coloured blocks
                                                                                                 implementing the Native OS, Global platform functionality and the Java Card 3.05 functionality. The
                                                                                                 TOE also implements a Cryptographic Service Provider marked with an orange coloured block. It
                                                                                                 implements a number of NXP proprietary features like the JCOP extension APIs for MiFare, Felica,
                                                                                                 Updater O/S and Config applet (note there are no security claims relating to MiFare and Felica).
                                                                                                 Furthermore the TOE implements GSMA ‘Remote SIM Provisioning Architecture for consumer
                                                                                                 Devices’, referred to as eUICC. The JCOP O/S supports the eUICC APIs and uses the Broker API to
                                                                                                 forward to the eSIM/SIM/UICC/ISIM commands to the eUICC Plugin Library.
                                                                                                 The TOE supports two domains, the eSE for the Java Card Secure Element domain and an eUICC
                                                                                                 domain providing UICC functionality in accordance with the GSMA Specification.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 9/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.5     Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                  JCOP Version       Identifier                                                        Version
                                                                                                  JCOP 5.2 R1        [AGD_UGM52R1] JCOP 5.2 R1.01.1 User Guidance Manual               1.8, 2019-10-30
                                                                                                                     [AGD_UGMSEMS52R1] JCOP 5.2 R1.01.1 User Guidance
                                                                                                                                                                                       1.1, 2019-10-17
                                                                                                                     Manual Addendum for SEMS API
                                                                                                                     [AGD_CSP52R1] JCOP 5.2 R1.01.1 User Guidance Manual
                                                                                                                                                                                       1.6, 2019-10-15
                                                                                                                     Addendum for CSPAPI
                                                                                                  JCOP 5.2 R2        [AGD_UGM52R2] JCOP 5.2 R2, User Guidance Manual,
                                                                                                                                                                                       1.3, 2020-06-08
                                                                                                                     doc. no. 608813
                                                                                                                     [AGD_UGMSEMS52R2] JCOP 5.2 R2, User Guidance
                                                                                                                                        t Lite
  Rev. 2.1 — 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document inf                                               1.2, 2020-06-08
                                                                              ormation
Informat            Assets .......................................10
3.2       Threats .............................................................10
3.3       Organizational Security Policies ...................... 10
3.4       Assumptions .................................................... 10
4       Security Objectives ...........................................11
4.1       Security Objectives for the TOE ...................... 11
4.2       Security Objectives for the IC Embedded
          Software ...........................................................12
4.3       Security Objectives for the Operational
          Environment .....................................................12
4.4       Security Objectives Rationale ..........................12
5       Extended Components Definition ....................13
6       Security Requirements ..................................... 14
6.1       Security Functional Requirements ................... 14
6.1.1     SFRs from the Protection Profile and the
          Security Target of the platform ........................ 14
6.1.2     Security Functional Requirements added in
          this Security Target ......................................... 14
6.2       Security Assurance Requirements ...................20
6.2.1     Refinements of the Security Assurance
          Requirements for EAL6+ ................................. 21
6.3       Security Requirements Rationale .................... 21
6.3.1     Rationale for the Security Functional
          Requirements ...................................................21
6.3.2     Extended requirements ....................................23
6.3.3     Dependencies of security requirements ...........23
6.3.4     Rationale for the Assurance Requirements ..... 23
7       TOE Summary Specification ............................ 24
7.1       IT Security Functionality .................................. 24
7.1.1     Security Services of the TOE .......................... 24
7.1.1.1   SS.RSA ............................................................24
7.1.1.2   SS.RSA_Pad ................................................... 24




                                                            ty,    (www.infineon.com).
Published by                                condition or quality of the product. Before
Infineon Technologies AG                    implementation of the product, the recipient of this
                                            application note must verify any function and other    WARNINGS
81726 Munich, Germany                       technical information given herein in the real         Due to technical requirements products may
                                            application.    Infineon    Technologies    hereby     contain dangerous substances. For information on
                                            disclaims any and all warranties and liabilities of    the types in question please contact your nearest
© 2020 Infineon Technologies AG.            any kind (including without limitation warranties of   Infineon Technologies office.
                                            non-infringement of intellectual property rights of
All Rights Reserved.                        any third party) with respect to any and all
                                            information given in this Security Target.             Except as otherwise explicitly approved by Infineon
                                                                                                   Technologies in a written document signed by
Do you have a question about this                                                               © NXP B.V. 2019.                                                                            All rights reserved.
                                                               authorized      representatives     of     Infineon
document?                                   The data contained in this document is exclusively     Technologies, Infineon Technologies’ products may
                                            intended for technically trained staff. It is the      not be used in any applications where a failure of
Email: erratum@infineon.com                 responsibility of customer’s technical departments     the product or any consequences of the use thereof
                                            to evaluate the s                 uitability of the product for the     can reasonably be expected to result in personal
<DOC_Number>                                intended application and the completeness of the       injury.
Document reference                          product information given in this document with
                                                For more information, please visit: http://www.nxp.com
                                                                                     For sales office addresses, please send an email to: salesaddresses@nxp.com
                  res                                            pect to such applicati                                                               on.
                    Date of release: 5 June 2019
rity functional requirements of the TOE an additional family (FCS_RNG) of the Class FCS
(cryptographic support) is defined in the PP [9]. This family describes the functional requirements for random
number generation used for cryptographic purposes.

Please note that the national regulation are outlined in PP [9] chapter 7.5.1 and in AIS31 [13]. These regulations
apply for this TOE.

Note 12:
The functional requirements FCS_RNG.1/TRNG, FCS_RNG.1/HPRG, FCS_RNG.1/DRNG, FCS_RNG.1/KSG, are
iterations of the FCS_RNG.1 defined in the PP [9] according to “Anwendungshinweise und Interpretationen zum
Schema (AIS)” respectively “A proposal for: Functionality classes for random number generators” [13].
End of note.

Note 13:
The Physical True Random Number Generator PTRNG implements total failure test of the random source and a
continuous RNG test according to:
National Institute of Standards and Technology, Security Requirements for Cryptographic Modules, Federal
Information Processing Standards Publication (FIPS) 140-2, 2002-03-12, chapter 4.9.2.
End of note.

Together with the guidelines in [6] the hybrid PTRNG of this TOE provides random numbers conformant to
several quality metrics as defined in [13]. Depending on the user configuration the TOE provide the according
random number quality. For each addressed quality metric of [13] the definitions are made in the following
chapters.




CC Document                                              65                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.1.1     True Random Number Generation, meeting AIS31 PTG.2


      FCS_RNG.1/TRNG         Random Number Generation
          Hierarchical to:   No other components
           Dependencies:     No dependencies
      FCS_RNG.1/TRNG         Random numbers generation Class PTG.2 according to [13]
      FCS_RNG.1.1/TRNG       The TSF shall provide a physical random number generator that
                             implements:
                  PTG.2.1    A total failure test detects a total failure of entropy source immediately when
                             the RNG has started. When a total failure is detected, no random numbers
                             will be output.
                  PTG.2.2    If a total failure of the entropy source occurs while the RNG is being operated,
                             the RNG prevents the output of any internal random number that depends on
                             some raw random numbers that have been generated after the total failure of
                             the entropy source.
                  PTG.2.3    The online test shall detect non-tolerable statistical defects of the raw
                             random number sequence (i) immediately when the RNG has started, and (ii)
                             while the RNG is being operated. The TSF must not output any random
                             numbers before the power-up online test has finished successfully or when a
                             defect has been detected.
                  PTG.2.4    The online test procedure shall be effective to detect non-tolerable
                             weaknesses of the random numbers soon.
                  PTG.2.5    The online test procedure checks the quality of the raw random number
                             sequence. It is triggered continuously. The online test is suitable for detecting
                             non-tolerable statistical defects of the statistical properties of the raw random
                             numbers within an acceptable period of time.
      FCS_RNG.1.2/TRNG       The TSF shall provide numbers in the format 8- or 16-bit that meet
                PTG.2.6      Test procedure A, as defined in [13] does not distinguish the internal random
                             numbers from output sequences of an ideal RNG.
                  PTG.2.7    The average Shannon entropy per internal random bit exceeds 0.997.




CC Document                                        66                                                         1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                          Hybrid Random Number Generation, meeting AIS31 PTG.3



  FCS_RNG.1/HPRG         Random Number Generation
      Hierarchical to:   No other components
       Dependencies:     No dependencies
  FCS_RNG.1/HPRG         Random numbers generation Class PTG.3 according to [13]
  FCS_RNG.1.1/HPRG       The TSF shall provide a hybrid physical random number generator that implements:
             PTG.3.1     A total failure test detects a total failure of entropy source immediately when the RNG
                         has started. When a total failure has been detected no random numbers will be
                         output.
              PTG.3.2    If a total failure of the entropy source+ occurs while the RNG is being operated, the
                         RNG prevents the output of any internal random number that depends on some raw
                         random numbers that have been generated after the total failure of the entropy
                         source.
              PTG.3.3    The online test shall detect non-tolerable statistical defects of the raw random
                         number sequence (i) immediately when the RNG has started, and (ii) while the RNG is
                         being operated. The TSF must not output any random numbers before the power-up
                         online test and the seeding of the DRG.3 post-processing algorithm have been finished
                         successfully or when a defect has been detected.
              PTG.3.4    The online test procedure shall be effective to detect non-tolerable weaknesses of the
                         random numbers soon.
              PTG.3.5    The online test procedure checks the raw random number sequence. It is triggered
                         continuously. The online test is suitable for detecting non-tolerable statistical defects
                         of the statistical properties of the raw random numbers within an acceptable period of
                         time.
                         Note:
                         Continuously means that the raw random bits are scanned continuously.
                         The algorithmic post-processing belongs to Class DRG.3 with cryptographic state
                         transition function and cryptographic output function. The output data rate of the
                         post-processing algorithm shall not exceed its input data rate.
                         End of note.
              PTG.3.6    The algorithmic post-processing algorithm belongs to Class DRG.3 with cryptographic
                         state transition function and cryptographic output function, and the output data rate
                         of the post-processing algorithm shall not exceed its input data rate.
  FCS_RNG.1.2/HPRG       The TSF shall provide numbers in the format 8- or 16-bit that meet
            PTG.3.7      Statistical test suites cannot practically distinguish the internal random numbers from
                         output sequences of an ideal RNG. The internal random numbers must pass test
                         procedure A.




CC Document                                             67                                                        1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




Deterministic Random Number Generation (DRNG) AIS31 DRG.3

  FCS_RNG.1/DRNG          Random Number Generation
       Hierarchical to:   No other components
       Dependencies:      No dependencies
  FCS_RNG.1/DRNG          Random numbers generation Class DRG.3 according to [13]
  FCS_RNG.1.1/DRNG        The TSF shall provide a deterministic random number generator that implements:
              DRG.3.1     If initialized with a random seed using a PTRNG of class PTG.2 as random source the
                          internal state of the RNG shall have at least 100 bit of entropy.
                          Note:
                          Furthermore, the length of the internal state shall have at least 200 bit. (For the
                          DRG.3 under consideration, the internal state has 351 bit.). The seed is provided by a
                          certified PTG.2 physical TRNG with guaranteed 7,976 bit of entropy per byte.
                          End of note.
            DRG.3.2       The RNG provides forward secrecy.
            DRG.3.3       The RNG provides backward secrecy even if the current internal state is known.
  FCS_RNG.1.2/DRNG        The TSF shall provide numbers in the format 8- or 16-bit that meet
            DRG.3.4       The RNG, initialized with a random seed, where the seed has at least 100 bit of
                          entropy and is derived by a PTG.2 certified PTRNG. The RNG generates output for
                          which any consecutive 234 strings of bit length 128 are mutually different with a
                          probability that is greater than 1 – 2(-16).
              DRG.3.5     Statistical test suites cannot practically distinguish the random numbers from the
                          output sequences of an ideal RNG. The random numbers must pass test procedure A
                          and the U.S. National Institute of Standards and Technology (NIST) test suite for
                          RNGs used for cryptographic purposes [41] containing following 16 tests:
                          Frequency (Monobit) Test, Frequency Test within a Block, Runs Tests, Test for the
                          Longest-Run-of-Ones in a Block, Binary Matrix Rank Test, Discrete Fourier Transform
                          (Spectral) Test, Non-overlapping (Aperiodic) Template Matching Test, Overlapping
                          (Periodic) Template Matching Test, Maurer´s “Universal Statistical” Test, Liner
                          Complexity Test, Serial Test, Approximate Entropy Test, Cumulative Sums (Cusums)
                          Test, Random Excursions Test and Random Excursions Variant Test.




CC Document                                             68                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.1.2      Deterministic Random Number Generation (DRNG) AIS31 DRG.2

This additional operation mode is named Key Stream Generation (KSG), which is a stream cipher generation. It is
conformant to DRG.2 and implements therefore forward and additional backward secrecy.


  FCS_RNG.1/KSG         Random Number Generation
     Hierarchical to:   No other components
     Dependencies:      No dependencies
  FCS_RNG.1/KSG         Random numbers generation Class DRG.2 according to [13]
  FCS_RNG.1.1/KSG       The TSF shall provide a deterministic random number generator that implements:
            DRG.2.1     If initialized with a random seed using a PTRNG of class PTG.2 as random source, the
                        applied seed shall have at least 100 bits of entropy, the internal state of the RNG shall
                        have at least the size of 200 bit – in this case the size of the internal state amounts to
                        351 bit, has the work factor for breaking the algorithm of 2127 due to the restriction on
                        the maximum amount of keystream computed from a given seed, required guess work
                        amounts to 2127 as well.
          DRG.2.2       The RNG provides forward secrecy.
          DRG.2.3       The RNG provides backward secrecy.
  FCS_RNG.1.2/KSG       The TSF shall provide numbers in the format 8- or 16-bit that meet
          DRG.2.4       The RNG, initialized with a random seed of length at least 100 bit delivered by an
                        PTRNG of the class PTG.2, generates output for which any consecutive 234 strings of the
                        length 128 bits are mutually different with probability greater than 1-2(-16).
              DRG.2.5   Statistical test suites cannot practically distinguish the random numbers from the
                        output sequences of an ideal RNG. The random numbers must pass test procedure A.
                        Note:
                        The random numbers have been shown to fulfill all statistical tests of the AIS 20/31
                        statistical tests of procedure A. The random numbers are in the format 8- or 16 Bit.
                        End of Note.




CC Document                                             69                                                        1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.2        FAU_SAS
During testing at the end of Phase 3 before TOE Delivery, the TOE shall be able to store some data (for instance
about the production history or identification data of the individual die or other data to be used after delivery).
Therefore, the security functional component Audit storage (FAU_SAS.1) has been added and is described in the
PP [9].
The TOE shall meet the requirement “Audit storage (FAU_SAS.1)” as specified below, PP [9]:

 FAU_SAS.1                Audit Storage
      Hierarchical to:    No dependencies
      Dependencies:       No dependencies.
 FAU_SAS.1.1              The TSF shall provide the test process before TOE Delivery with the capability to store
                          the Initialization Data (GCIM) and/or Pre-personalization Data and/or supplements of
                          the Security IC Embedded Software in the not changeable configuration page area and
                          non-volatile memory.



7.1.2          Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests
can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

 FPT_TST.2             Subset TOE testing
    Hierarchical to:   No other components.
    Dependencies:      No dependencies.
 FPT_TST.2.1           The TSF shall run a suite of self-tests at the request of the authorized user to demonstrate
                       the correct operation of the alarm lines and/or following environmental sensor
                       mechanisms:
                                     More information is given in the confidential security target [8].




CC Document                                             70                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.3          Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent that
one application can access code and/or data of another application. For this reason the TOE provides Area based
Memory Access Control. The underlying memory management unit (MMU) is documented in section 4 in the
hardware reference manual HRM [1].
The security service being provided is described in the Security Function Policy (SFP) Memory Access Control
Policy. The security functional requirement “Subset access control (FDP_ACC.1)” requires that this policy is in
place and defines the scope were it applies. The security functional requirement “Security attribute based
access control (FDP_ACF.1)” defines security attribute usage and characteristics of policies. It describes the
rules for the function that implements the Security Function Policy (SFP) as identified in FDP_ACC.1. The
decision whether an access is permitted or not is taken based upon attributes allocated to the software. The
Smartcard Embedded Software defines the attributes and memory areas. The corresponding permission control
information is evaluated “on-the-fly” by the hardware so that access is granted/effective or denied/inoperable.
The security functional requirement “Static attribute initialization (FMT_MSA.3)” ensures that the default
values of security attributes are appropriately either permissive or restrictive in nature. Alternative values can be
specified by any subject provided that the Memory Access Control Policy allows that. This is described by the
security functional requirement “Management of security attributes (FMT_MSA.1)”. The attributes are
determined during TOE manufacturing (FMT_MSA.3) or set at run-time (FMT_MSA.1).
From TOE’s point of view the different roles in the Smartcard Embedded Software can be distinguished
according to the memory based access control. However the definition of the roles belongs to the user software.
The following Security Function Policy (SFP) Memory Access Control Policy is defined for the requirement
“Security attribute based access control (FDP_ACF.1)”:

Memory Access Control Policy
The TOE shall control read, write, delete and execute accesses of software running at the privilege levels as defined
below. Any access is controlled, regardless whether the access is on code or data or a jump on any other privilege
level outside the current one.

The memory model provides distinct, independent privilege levels separated from each other in the virtual
address space. The access rights are controlled by the MMU and related to the privilege level. More information
is given in the confidential Security Target [8].

The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below.

 FDP_ACC.1               Subset access control
 Hierarchical to:        No other components.
 Dependencies:           FDP_ACF.1 Security attribute based access control
 FDP_ACC.1.1             The TSF shall enforce the Memory Access Control Policy on all subjects (software
                         running at the defined and assigned privilege levels), all objects (data including code
                         stored in memories) and all the operations defined in the Memory Access Control Policy,
                         i.e. privilege levels.




CC Document                                               71                                                        1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below.
   FDP_ACF.1          Security attribute based access control
   Hierarchical to:   No other components.
   Dependencies:      FDP_ACC.1 Subset access control
                      FMT_MSA.3 Static attribute initialization
   FDP_ACF.1.1        The TSF shall enforce the Memory Access Control Policy to objects based on the
                      following:
                      Subject:
                      - software running at the IFX, OS1 and OS2 privilege levels required to securely operate
                      the chip. This includes also privilege levels running interrupt routines.
                      - software running at the privilege levels containing the application software
                      Object:
                      - data including code stored in memories
                      Attributes:
                      - the memory area where the access is performed to and/or
                      - the operation to be performed.
   FDP_ACF.1.2        The TSF shall enforce the following rules to determine if an operation among
                      controlled subjects and controlled objects is allowed:
                      evaluate the corresponding permission control information of the relevant memory range
                      before and during the access so that accesses to be denied cannot be utilized by the
                      subject attempting to perform the operation.
   FDP_ACF.1.3        The TSF shall explicitly authorize access of subjects to objects based on the following
                      additional rules:
                      none.
   FDP_ACF.1.4        The TSF shall explicitly deny access of subjects to objects based on the following
                      additional rules: none.




CC Document                                            72                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Static attribute initialisation (FMT_MSA.3)” as specified below.
   FMT_MSA.3               Static attribute initialisation
   Hierarchical to:        No other components.
   Dependencies:           FMT_MSA.1 Management of security attributes
                           FMT_SMR.1 Security roles
   FMT_MSA.3.1             The TSF shall enforce the Memory Access Control Policy to provide well defined1 default
                           values for security attributes that are used to enforce the SFP.
   FMT_MSA.3.2             The TSF shall allow any subject, provided that the Memory Access Control Policy is
                           enforced and the necessary access is therefore allowed2, to specify alternative initial
                           values to override the default values when an object or information is created.

The TOE shall meet the requirement “Management of security attributes (FMT_MSA.1)” as specified below:
   FMT_MSA.1               Management of security attributes
   Hierarchical to:        No other components.
   Dependencies:           [FDP_ACC.1 Subset access control or
                           FDP_IFC.1 Subset information flow control]
                           FMT_SMF.1 Specification of management functions
                           FMT_SMR.1 Security roles
   FMT_MSA.1.1             The TSF shall enforce the Memory Access Control Policy to restrict the ability to change
                           default, modify or delete the security attributes permission control information to the
                           software running on the privilege levels.

The TOE shall meet the requirement “Specification of management functions (FMT_SMF.1)” as specified below:
   FMT_SMF.1               Specification of management functions
   Hierarchical to:        No other components
   Dependencies:           No dependencies
   FMT_SMF.1.1             The TSF shall be capable of performing the following security management functions:
                           access the configuration registers of the MMU.




          1
              The static definition of the access rules is documented in the hardware reference manual as listed in chapter 1.1
                         2
                           The Smartcard Embedded Software is intended to set the memory access control policy


CC Document                                                         73                                                                   1.8
                                                                                                                                  2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4               Support of Cipher Schemes
The following additional specific security functionality is implemented in the TOE:
FCS_COP.1 Cryptographic operation requires a cryptographic operation to be performed in accordance with a
specified algorithm and with a cryptographic key of specified sizes. The specified algorithm and cryptographic
key sizes can be based on an assigned standard; dependencies are discussed in chapter 0.

The following additional specific security functionality is implemented in the TOE:
    Rivest-Shamir-Adleman (RSA)1
    Elliptic Curve Cryptography (EC)1
    Advanced Encryption Standard (AES)
    Triple Data Encryption Standard (TDES)
    Cipher based Message Authentication Code (CMAC)
    CIPURSE™ Cryptographic Library (CCL)

The RSA cryptographic library, regardless of the version chosen, is offered in two parts: The 2k part of the RSA
library can be used for key lengths of up to 2048 bits and the 4k part of the RSA library can be used for key
lengths of up to 4096 bits.

Note 14:
This TOE can come with both crypto co-processors accessible, or with a blocked SCP or with a blocked
Crypto2304T, or with both crypto co-processors blocked. The blocking depends on the customer demands prior
to the production of the hardware. In case the SCP is blocked, no AES and DES respectively CMAC computation,
as well as CCL operation supported by hardware is possible. In case the Crypto2304T is blocked, no RSA and EC
computation supported by hardware is possible. No accessibility of the deselected cryptographic co-processors is
without impact on any other security policy of the TOE; it is exactly equivalent to the situation where the user
decides just not to use the cryptographic co-processors.
End of note.




1
    For the case the TOE comes without RSA and/or EC library, the TOE provides basic HW-related routines for RSA and/or EC calculations.
      For a secure library implementation the user has to implement additional countermeasures himself.


CC Document                                                          74                                                              1.8
                                                                                                                              2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.1        Preface regarding Security Level related to Cryptography
Implemented cryptography, regardless whether proprietary or following public standards is subject of ageing
due to the evolution and progress of technology, mathematics and analysis methods. For that reason,
guarantees for the absence of exploitable properties cannot be given - by anybody. But, the risk for the absence
of such properties is severely reduced if the implementation is based on a long time published and publicly
discussed standard algorithm.
If the vendor implements a proprietary algorithm, then the BSI analyses this algorithm in the course and time
frame of the certification process. It is obvious that this local, one party and short timed analysis cannot replace a
long time publicly discussed standard algorithm. Possible risk mitigation, if not an industrial secret, is the
publication of the proprietary standard and starting the public discussion. This transparency could provide on
one hand some mitigation of risk; on the other hand, the algorithm is then directly a valuable analyst target. In
that case, also no one can say, when such publication is sufficiently discussed; and again guarantees for the life
time being in the field can no one give.
As of today, using public standards is often not possible due to compromises with regard to acceptable
computing time and available energy. For that reason it is up to the user to decide. The SFR claims assign
whether an algorithm or proprietary or following a standard or implementing a standard with deviations.

The BSI states that the strength of the cryptographic algorithms is not rated in the course of the product
certification (see [25] Section 9, Para.4, Clause 2). But cryptographic functionalities with a security level of lower
than 100 bits can no longer be regarded as secure without considering the application context. Therefore, for
these functions it shall be checked whether the related cryptographic operations are appropriate for the
intended system. The assignment to the 100 Bit level by BSI can be read in the certification report issued by BSI.
Some further hints and guidelines can be derived from the Technische Richtlinie BSI TR-02102,
www.bsi.bund.de.




CC Document                                               75                                                        1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.2       Cryptography by the Symmetric Cryptographic Coprocessor SCP
 7.1.4.2.1    Triple-DES Operation
The DES Operation of the SCP of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)”
and “Cryptographic key destruction” (FCS_CKM.4) as specified below:

  FCS_COP.1/TDES       Cryptographic operation
      Hierarchical to: No other components.
      Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security attributes, or
                       FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                       FCS_CKM.1 Cryptographic key management]
                       FCS_CKM.4 Cryptographic key destruction.
  FCS_COP.1.1/TDES The TSF shall perform encryption and decryption in accordance with a specified
                       cryptographic algorithm TDES in
                            the Electronic Codebook Mode (ECB)
                            the Cipher Block Chaining Mode (CBC)
                            the Cipher Block Chaining Message Authentication Code (CBC-MAC)
                            the Cipher Block Chaining Message Authentication Code Encrypt Last Block
                              (CBC-MAC-ELB)
                            the Blinding Mode (BLD)
                            the Recrypt Mode
                       and cryptographic key sizes of 112 and 168 bit that meet the following standards:
                            ECB, CBC:
                              o National Institute of Standards and Technology (NIST) 800-67 [20],
                                 standard allows encryption with 168 bit keys only
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                            CBC_MAC
                              o National Institute of Standards and Technology (NIST) 800-67 [20]
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                              o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                            CBC-MAC-ELB:
                              o National Institute of Standards and Technology (NIST) 800-67 [20]
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                              o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                            BLD, Recrypt Mode
                              Proprietary, description given in the hardware reference manual HRM [1]




CC Document                                         76                                                   1.8
                                                                                                  2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)



Notes for FCS_COP.1/TDES:

   1.   The proprietary BLD and Recrypt operation modes are described in the hardware reference manual HRM [1] while
        the implementations of the other modes follow the referenced standards. Also the BLD is compliant to the
        referenced standards but is operated in a masked way. The proprietary modes offer increased protection against
        failure and side channel analysis.
   2.   Using the TDES algorithm with three keys of which two keys equal is a so called two key triple DES operation. This
        operation can be configured and managed by the user but does not meet the national requirements issued by BSI
        and achieves therefore not the 100 Bits security level.
        End of note.


    FCS_CKM.4/TDES                 Cryptographic key destruction – TDES
    Hierarchical to:               No other components.
    Dependencies:                  [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
    FCS_CKM.4.1/TDES               The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method overwriting or zeroing that meets the
                                   following:
                                   None

Note for FCS_CKM.4/TDES:
The key destruction can be done by overwriting the key register interfaces or by software reset of the SCP which
provides immediate zeroing of all SCP key registers.
End of note.




CC Document                                                   77                                                      1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.2.2    AES Operation
The AES Operation the TOE shall meet the requirement Cryptographic operation (FCS_COP.1) and
Cryptographic key destruction (FCS_CKM.4) as specified below:

     FCS_COP.1/AES       Cryptographic operation
        Hierarchical to: No other components.
        Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security
                         attributes, or
                         FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                         FCS_CKM.1 Cryptographic key generation]
                         FCS_CKM.4 Cryptographic key destruction
     FCS_COP.1.1/AES The TSF shall perform decryption and encryption in accordance with a specified
                         cryptographic algorithm AES in
                              the Electronic Codebook Mode (ECB)
                              the Cipher Block Chaining Mode (CBC)
                              the Cipher Block Chaining Message Authentication Code (CBC-MAC)
                              the Cipher Block Chaining Message Authentication Code Encrypt Last
                                 Block
                                 (CBC-MAC-ELB)
                              the Blinding Mode (BLD)
                              the Recrypt Mode
                         and cryptographic key sizes of 128 bit or 192 bit or 256 bit that meet the following
                         standards:
                              ECB, CBC:
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                              CBC_MAC
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                                 o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                              CBC-MAC-ELB:
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                                 o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                              BLD, Recrypt Mode
                                 Proprietary, description given in the hardware reference manual HRM [1]

Note for FCS_COP.1/AES:
The proprietary BLD and Recrypt operation modes are proprietary and described in the hardware reference
manual HRM [1] while the implementations of the other modes follow the referenced standards. Also the BLD is
compliant to the referenced standards but is operated in a masked way. The proprietary modes offer increased
protection against failure and side channel analysis.
End of note.

CC Document                                             78                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)



      FCS_CKM.4/AES        Cryptographic key destruction – AES
      Hierarchical to:     No other components.
      Dependencies:        [FDP_ITC.1 Import of user data without security attributes, or
                           FDP_ITC.2 Import of user data with security attributes, or
                           FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/AES       The TSF shall destroy cryptographic keys in accordance with a specified
                           cryptographic key destruction method overwriting or zeroing that meets the
                           following:
                           None

Note for FCS_CKM.4/AES:
The key destruction can be done by overwriting the key register interfaces or by software reset of the SCP which
provides immediate zeroing of all SCP key registers.
End of Note.




CC Document                                            79                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.3      Cryptography by the Symmetric Cryptographic Library SCL
                             The following holds true for both alternative versions.

 7.1.4.3.1    Triple-DES Operation for both SCL versions
The DES Operation of the SCL of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)”
and “Cryptographic key destruction” (FCS_CKM.4) as specified below:

      FCS_COP.1/TDES-SCL-1        Cryptographic operation – TDES
      or
      FCS_COP.1/TDES-SCL-2
                 Hierarchical to: No other components.
                 Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without
                                  security attributes, or
                                  FDP_ITC.2 Import of user data of the Composite TOE with security
                                  attributes, or
                                  FCS_CKM.1 Cryptographic key management]
                                  FCS_CKM.4 Cryptographic key destruction.
      FCS_COP.1.1/TDES-SCL-1      The TSF shall perform encryption and decryption in accordance with a
      or                          specified cryptographic algorithm TDES in
      FCS_COP.1.1/TDES-SCL-2            the Electronic Codebook Mode (ECB)
                                        the Cipher Block Chaining Mode (CBC)
                                        the Counter Mode (CTR)
                                        the Cipher Feedback Mode (CFB)
                                        the Propagating Cipher Block Chaining (PCBC)
                                  and cryptographic key sizes of 112 and 168 bit that meet the
                                  following standards:
                                        National Institute of Standards and Technology (NIST)
                                          SP 800-67 [20], standard allows encryption with 168 bit keys
                                          only
                                        The ECB, CBC, CTR and CFB modes refer to:
                                          National Institute of Standards and Technology (NIST)
                                          SP 800-38A [21]
                                        The PCBC mode refers to:
                                          Bruce Schneier, Applied Cryptography, Second Edition, John
                                          Wiley & Sons, 1996 section 9.10 [36]. This standard should be
                                          implemented considering the Security Guidelines only.




CC Document                                           80                                                   1.8
                                                                                                    2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


     FCS_CKM.4/TDES-SCL-1            Cryptographic key destruction – TDES
     or
     FCS_CKM.4/TDES-SCL-2
     Hierarchical to:                No other components.
     Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or
                                     FCS_CKM.1 Cryptographic key generation]
     FCS_CKM.4.1/TDES-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
     or                              specified cryptographic key destruction method overwriting or zeroing
     FCS_CKM.4.1/TDES-SCL-2          that meets the following:
                                     None

Note for FCS_CKM.4/TDES-SCL-1 and FCS_CKM.4/TDES-SCL-2:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             81                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




 7.1.4.3.2    AES Operation for both SCL versions
The AES Operation the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and
“Cryptographic key destruction” (FCS_CKM.4) as specified below:

     FCS_COP.1/AES-SCL-1        Cryptographic operation – AES
     or
     FCS_COP.1/AES-SCL-2
               Hierarchical to: No other components.
               Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security
                                attributes, or
                                FDP_ITC.2 Import of user data of the Composite TOE with security
                                attributes, or
                                FCS_CKM.1 Cryptographic key generation]
                                FCS_CKM.4 Cryptographic key destruction
     FCS_COP.1.1/AES-SCL-1      The TSF shall perform decryption and encryption in accordance with a
     or                         specified cryptographic algorithm AES in
     FCS_COP.1.1/AES-SCL-2            the Electronic Codebook Mode (ECB)
                                      the Cipher Block Chaining Mode (CBC)
                                      the Counter Mode (CTR)
                                      the Cipher Feedback Mode (CFB)
                                      the Propagating Cipher Block Chaining (PCBC)
                                and cryptographic key sizes of 128 bit or 192 bit or 256 bit that meet the
                                following standards:
                                      The AES advanced encryption standard refers to:
                                        National Institute of Standards and Technology (NIST)
                                        FIPS PUB 197 [31]
                                      The ECB, CBC, CTR and CFB modes refer to:
                                        National Institute of Standards and Technology (NIST)
                                        SP 800-38A [21]
                                      The PCBC mode refers to:
                                        Bruce Schneier, Applied Cryptography, Second Edition, John
                                        Wiley & Sons, 1996, section 9.10[36]. This standard should be
                                        implemented considering the Security Guidelines only.




CC Document                                            82                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


      FCS_CKM.4/AES-SCL-1           Cryptographic key destruction – AES
      or
      FCS_CKM.4/AES-SCL-2
      Hierarchical to:              No other components.
      Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                                    FDP_ITC.2 Import of user data with security attributes, or
                                    FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/AES-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
      or                            specified cryptographic key destruction method overwriting or zeroing
      FCS_CKM4.1/AES-SCL-2          that meets the following:
                                    None

Note for FCS_CKM.4/AES-SCL-1 or FCS_CKM.4/AES-SCL-2:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             83                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.3.3    CMAC Operation on for the SCL version v2.04.002
The CMAC operation of this SCL version of the TOE shall meet the requirement Cryptographic operation
(FCS_COP.1) and Cryptographic key destruction (FCS_CKM.4) as specified below:

      FCS_COP.1/CMAC-SCL-1         Cryptographic operation – CMAC
                  Hierarchical to: No other components.
                   Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without
                                   security attributes, or
                                   FDP_ITC.2 Import of user data of the Composite TOE with security
                                   attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
                                   FCS_CKM.4 Cryptographic key destruction
      FCS_COP.1.1/CMAC-SCL-1       The TSF shall perform computation of a cipher based message
                                   authentication code in accordance with a specified cryptographic
                                   algorithm CMAC using
                                        AES or
                                        TDES
                                   and cryptographic key sizes of 128 bit or 192 bit or 256 bit for AES
                                   and 168 bit for TDES that meet the following standards:
                                        CMAC: National Institute of Standards and Technology
                                           (NIST) SP 800-38B [37]
                                        AES
                                          o Federal Information Standards Publication 197 [31]
                                        TDES
                                          o National Institute of Standards and Technology
                                             SP 800-67 [20]




CC Document                                           84                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


      FCS_CKM.4/CMAC-SCL-1           Cryptographic key destruction – CMAC
      Hierarchical to:               No other components.
      Dependencies:                  [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or
                                     FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/CMAC-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
                                     specified cryptographic key destruction method overwriting or
                                     zeroing that meets the following:
                                     None

Note for FCS_CKM.4/CMAC-SCL-1:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             85                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.4      Cryptography by CIPURSE™ Cryptographic Library
The CIPURSE™ CL is a delivery option. If the CCL is on board the belonging security functional requirements are
fulfilled else the functionality is not on board and the security functional requirements are not covered.

 7.1.4.4.1    CIPURSE™ CL Cryptographic Functions
The CCL shall meet the security functional requirement FCS_COP.1/CCL as specified below.

   FCS_COP.1/CCL       Cryptographic Operation CCL Trusted Channel
      Hierarchical to: No other components.
      Dependencies: [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/CCL The TSF shall perform
                            an authentication and cryptographic protected protocol
                       in accordance with a specified cryptographic algorithm
                            CIPURSE™ V2 Cryptographic Protocol
                       and cryptographic key sizes of 128 Bit that meet the following:
                            Federal Information Processing Standards Publication 197 [31]
                            NIST Special Publication SP 800-38A, chapter 6.1 AES in ECB mode [21]
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 5.2 Session key Derivation
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.2 Key Derivation for the
                               first frame
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.3 Integrity Protection
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.4 Confidential
                               Communication
                            CIPURSE™ V2 Cryptographic Protocol Errata and Precision list
                               [35-2] chapters P.2




CC Document                                            86                                                    1.8
                                                                                                      2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The CCL shall meet the security functional requirement FCS_CKM.1/CCL as specified below.

 FCS_CKM.1/CCL         Cryptographic key generation
      Hierarchical to: No other components.
      Dependencies: [FCS_CKM.2 Cryptographic key distribution, or
                       FCS_COP.1 Cryptographic operation]
                       FCS_CKM.4 Cryptographic key destruction
                       FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/CCL The TSF shall generate cryptographic keys in accordance with a specified
                       cryptographic key generation algorithm:
                            In the mode confidential communication:
                              session key derivation and key derivation for the exchange protocol
                            In the mode integrity protection:
                              session key derivation
                       and specified cryptographic key sizes of 128 bits that meet the following:
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapters 5.2 and 6.2

The CCL shall meet the security functional requirement FCS_CKM.1/CCL as specified below.

 FCS_CKM.4/CCL            Cryptographic key destruction
 Hierarchical to:         No other components.
 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or
                          FDP_ITC.2 Import of user data with security attributes, or
                          FCS_CKM.1 Cryptographic key generation]
 FCS_CKM4.1/CCL           The TSF shall destroy cryptographic keys in accordance with a specified
                          cryptographic key destruction method overwriting with random value that meets the
                          following
                          None

Note for FCS_CKM.4/CCL:
The key destruction is triggered by the SCP at every entry and exit. The key storage in the SCP is wiped with
random values.
End of note.




CC Document                                             87                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.5       The Asymmetric Cryptographic Library v2.08.007 and v2.07.003
 7.1.4.5.1    Rivest-Shamir-Adleman (RSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

   FCS_COP.1/RSA-1      Cryptographic operation
   or
   FCS_COP.1/RSA-2
   Hierarchical to:     No other components.
   Dependencies:        [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                        or FDP_ITC.2 Import of user data of the Composite TOE with security attributes]

                        FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/RSA-1    The TSF shall perform encryption, decryption, signature generation and signature
   or                   verification in accordance with in accordance with a specified cryptographic
   FCS_COP.1.1/RSA-2    algorithm Rivest-Shamir-Adleman (RSA) and cryptographic key sizes from 512 bits
                        up to 4096+128 bits in 1 Bit stepping that meet the following:
                        Encryption:
                        1. According to section 5.1.1 RSAEP in PKCS [22]:
                               Supported for n < 24096 + 128
                             5.1.1(1) not supported
                        2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
                        Supported for n < 24096 + 128
                        Decryption (with or without CRT):
                        1. According to section 5.1.2 RSADP in PKCS [22] for u = 2, i.e.,
                        without any (ri, di, ti), i > 2
                               5.1.2(1) not supported
                               5.1.2(2.a) supported for n < 22048 + 64
                               5.1.2(2.b) supported for p  q < 24096 + 128
                             5.1.2(2.b) (ii)&(v) not applicable due to u = 2
                        2. According to section 8.2.3 IEEE [29]:
                               8.2.1(I) supported for n < 22048 + 64
                               8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported




CC Document                                             88                                                1.8
                                                                                                   2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                      Signature Generation (with or without CRT):
                      1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e.,
                      without any (ri, di, ti), i >2
                             5.2.1(1) not supported
                             5.2.1(2.a) supported for n < 22048 + 64
                             5.2.1(2b) supported for p  q < 24096 + 128
                           5.2.1(2b) (ii)&(v) not applicable due to u = 2
                      2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                             8.2.1(I) supported for n < 22048 + 64
                             8.2.1(II) supported for p  q < 24096 + 128
                           8.2.1(III) not supported
                      Signature Verification:
                      1. According to section 5.2.2 RSAVP1 in PKCS [22]:
                      supported for n < 24096 +128
                           5.2.2(1) not supported
                      2. According to section 8.2.5 IEEE [29]:
                             Supported for n < 24096 +128
                             8.2.5(1) not supported


                          Please consider also the statement of chapter 7.1.4.1.




CC Document                                           89                                          1.8
                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.2     Rivest-Shamir-Adleman (RSA) key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

The RSA cryptographic library is offered in two parts: The 2k part of the RSA library can be used for key lengths
of up to 2048 bits and the 4k part of the RSA library can be used for key lengths of up to 4096 bits.

   FCS_CKM.1/RSA-1       Cryptographic key generation
   or
   FCS_CKM.1/RSA-.2
        Hierarchical to: No other components.
         Dependencies: FCS_CKM.2 Cryptographic key distribution, or
                         FCS_COP.1 Cryptographic operation]
                         FCS_CKM.4 Cryptographic key destruction
                         FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/RSA-1     The TSF shall generate cryptographic keys in accordance with a specified
   or                    cryptographic key generation algorithm implemented by following functions:
   FCS_CKM.1.1/RSA-2      CryptoRSAKeyGen
                             CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrime or
                              CryptoGeneratePrimeMask
                             CryptoRSAKeyGenMask_D plus CryptoGeneratePrime or
                              CryptoGeneratePrimeMask
                              CryptoRSAKeyGenMask_N plus CryptoGeneratePrime or
                                 CryptoGeneratePrimeMask
                            and specified cryptographic key sizes of 512 up to 4096+128 bits that meet the
                            following:
                            RSA key generation according to Infineon key generation methods. The generated
                            keys are in conformance with:
                            1. According to sections 3.1 and 3.2 in PKCS [22], for u = 2,
                            i.e. without any (ri, di, ti), i > 2:
                                     3.1 supported for n < 24096 + 128
                                     3.2.(1) supported for n < 22048 + 64
                                     3.2.(2) supported for p x q < 24096 + 128
                            2. According to section 8.1.3.1 in IEEE [29]:
                                     8.1.3.1(1) supported for n < 22048 + 64
                                     8.1.3.1(2) supported for p x q < 24096 + 128
                                     8.1.3.1(3) supported for p x q < 22048 + 64

Notes for FCS_CKM.1.1/RSA-1 or FCS_CKM.1.1/RSA-2:
1. The function CryptoGeneratePrime has been assigned to the appropriate security level by BSI. The proprietary
CryptoGeneratePrimeMask function has not been cryptographic-analytically evaluated and certified by BSI.
End of note.

2. The minimum key length follows the national recommendations by the BSI which means that RSA key lengths
below 1976 bits are not included in the certificate. The key length requirements can differ between the countries.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

CC Document                                             90                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


3. For easy integration of RSA functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
Please consider also the statement of chapter 7.1.4.1.
End of note.

4. The TOE can be delivered with or without one of the RSA libraries. In the case of coming without the RSA
library – regardless of the version – the TOE does not provide the Additional Specific Security Functionality
Rivest-Shamir-Adleman Cryptography (RSA) realized with the security functional requirements FCS_COP.1/RSA-
1 respectively FCS_COP.1/RSA-2 and FCS_CKM.1/RSA-1 and FCS_CKM.1/RSA-2. In case of a blocked
Crypto2304T the optionally delivered cryptographic and the supporting Toolbox cannot be used in that TOE
product.
End of notes.




CC Document                                             91                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.3     General Preface regarding Elliptic Curve Cryptography
The EC library is delivered as object code and in this way integrated in the user software. The security functional
requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,
224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
with size n є [41-1; 521] are supported.

Elliptic Curve DSA (ECDSA) operation

  FCS_COP.1/ECDSA-1          Cryptographic operation
  or
  FCS_COP.1/ECDSA-2
  Hierarchical to:    No other components.
  Dependencies:       [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                      or
                      FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                      FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDSA-1 The TSF shall perform signature generation and signature verification in
  or                  accordance with a specified cryptographic algorithm ECDSA and cryptographic key
  FCS_COP.1.1/ECDSA- sizes 160, 163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the
  2                   following:
                      ECDSA Signature Generation:
                       1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                    Deviation of step c) and f):
                                         o The jumps to step a) were substituted by a return of the function with
                                              an error code, the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                     Chapter 6.4.3.7 is not supported
                                  Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                  Deviation of step (3) and (4):
                                       o The jumps to step 1 were substituted by a return of the function with
                                           an error code, the jumps are emulated by another call to our function
                             ECDSA Signature Verification:




CC Document                                                92                                                         1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                           1. According to section 7.4.1 in ANSI [23]

                                  Step b) and c) are not supported.
                                  The output of step c) has to be provided as input to our function by the caller.
                                  Deviation of step d):
                                       o Beside noted calculation, our algorithm adds a random multiple of
                                            BasepointerOrder n to the calculated values u1 and u2.
                           2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                Chapter 6.4.4.2 is not supported
                                Chapter 6.4.4.3 is not supported:
                                       o The hash-code H of the message has to be provided by the caller as
                                            input to our function
                           3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-1 and FCS_COP.1/ECDSA-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                              93                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.4    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-1         Cryptographic key generation
   or
   FCS_CKM.1/EC-2
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-1       The TSF shall generate cryptographic keys in accordance with a specified
   or                     cryptographic key generation algorithm implemented by following functions which
   FCS_CKM.1.1/EC-2       can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note for FCS_CKM.1/EC-1 and FCS_CKM.1/EC-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             94                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.5     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-1          Cryptographic operation
  or
  FCS_COP.1/ECDH-2
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-1        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
  or                        with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
  FCS_COP.1.1/ECDH-2        163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section 7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Notes for: FCS_COP.1/ECDH-1 and FCS_COP.1/ECDH-2:

1. The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163 and 192 bits are supported. Numerous other curve types, being also secure in terms of
side channel attacks on this TOE, exist, which the user optionally can add in the composition certification
process.
End of note

2. For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

3. The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not
provide the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security
functional requirements FCS_COP.1/ECDSA-1 or FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-1 or
FCS_COP.1/ECDH-2 and FCS_CKM.1/EC-1 or FCS_CKM.1/EC-2. In case of a blocked Crypto2304T, the RSA and
EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered cryptographic
RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

4. The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of notes.

CC Document                                             95                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




7.1.4.6       The Asymmetric Cryptographic Library v2.06.003
 7.1.4.6.1    Rivest-Shamir-Adleman (RSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

   FCS_COP.1/RSA-3      Cryptographic operation
   Hierarchical to:     No other components.
   Dependencies:        [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                        or FDP_ITC.2 Import of user data of the Composite TOE with security attributes]

                        FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/RSA-3    The TSF shall perform encryption, decryption, signature generation and signature
                        verification in accordance with a specified cryptographic algorithm Rivest-Shamir-
                        Adleman (RSA) and cryptographic key sizes from 512 bits up to 4096+128 bits in 1 Bit
                        stepping that meet the following:
                        Encryption:
                        1. According to section 5.1.1 RSAEP in PKCS [22]:
                               Supported for n < 24096 + 128
                              5.1.1(1) not supported
                        2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
                        Supported for n < 24096 + 128
                        Decryption (with or without CRT):
                        1. According to section 5.1.2 RSADP in PKCS [22]
                        for u = 2, i.e., without any (ri, di, ti), i > 2
                               5.1.2(1) not supported
                               5.1.2(2.a) supported for n < 22048 + 64
                               5.1.2(2.b) supported for p  q < 24096 + 128
                             5.1.2(2.b) (ii)&(v) not applicable due to u = 2
                        2. According to section 8.2.3 IEEE [29]:
                               8.2.1(I) supported for n < 22048 + 64
                               8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported




CC Document                                             96                                                  1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                          Signature Generation (with or without CRT):
                          1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e.,
                          without any (ri, di, ti), i >2

                                  5.2.1(1) not supported
                                  5.2.1(2.a) supported for n < 22048 + 64
                                  5.2.1(2b) supported for p  q < 24096 + 128
                               5.2.1(2b) (ii)&(v) not applicable due to u = 2
                          2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                                  8.2.1(I) supported for n < 22048 + 64
                                  8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported
                          Signature Verification:
                          1. According to section 5.2.2 RSAVP1 in PKCS [22]:
                          supported for n < 24096 +128
                               5.2.2(1) not supported
                          2. According to section 8.2.5 IEEE [29]:
                                  Supported for n < 24096 +128
                                  8.2.5(1) not supported


Please consider also the statement of chapter 7.1.4.1.




CC Document                                                97                                 1.8
                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.2     Rivest-Shamir-Adleman (RSA) key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

The RSA cryptographic library is offered in two parts: The 2k part of the RSA library can be used for key lengths
of up to 2048 + 64 bits and the 4k part of the RSA library can be used for key lengths of up to 4096 + 128 bits.

   FCS_CKM.1/RSA-3      Cryptographic key generation
       Hierarchical to: No other components.
       Dependencies: FCS_CKM.2 Cryptographic key distribution, or
                        FCS_COP.1 Cryptographic operation]
                        FCS_CKM.4 Cryptographic key destruction
                        FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/RSA-3 The TSF shall generate cryptographic keys in accordance with a specified
                        cryptographic key generation algorithm implemented by following functions:
                         CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_D plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_N plus CryptoGeneratePrimeMask
                        and specified cryptographic key sizes of 512 – 4096 bits that meet the following:
                        RSA key generation according to Infineon key generation methods. The generated
                        keys are in conformance with:
                        1. According to sections 3.1 and 3.2 in PKCS [22],
                        for u = 2, i.e. without any (ri, di, ti), i > 2:
                                 3.1 supported for n < 24096 + 128
                                 3.2.(1) supported for n < 22048 + 64
                                 3.2.(2) supported for p x q < 24096 + 128
                        2. According to section 8.1.3.1 in IEEE [29]:
                                 8.1.3.1(1) supported for n < 22048 + 64
                                 8.1.3.1(2) supported for p x q < 24096 + 128
                                 8.1.3.1(3) supported for p x q < 22048 + 64

Note 1 for FCS_CKM.1.1/RSA-3:
The minimum key length follows the national recommendations by the BSI which means that RSA key lengths
below 1976 bits are not included in the certificate. The key length requirements can differ between the countries.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

Note 2 for FCS_CKM.1.1/RSA-3:
The TOE can be delivered with or without the RSA library. In the case of coming without the RSA library the TOE
does not provide the Additional Specific Security Functionality Rivest-Shamir-Adleman Cryptography (RSA)
realized with the security functional requirements FCS_COP.1/RSA and FCS_CKM.1/RSA. In case of a blocked
Crypto2304T the optionally delivered cryptographic and the supporting Toolbox cannot be used in that TOE
product.
End of note.

 7.1.4.6.3     General Preface regarding Elliptic Curve Cryptography
The EC library is delivered as object code and in this way integrated in the user software. The security functional
requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,

CC Document                                              98                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
  All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
                                        with size n є [41-1; 521] are supported.

 7.1.4.6.4     Elliptic Curve DSA (ECDSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.
 FCS_COP.1/ECDSA-3           Cryptographic operation
 Hierarchical to:            No other components.
 Dependencies:               [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                             or
                             FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                             FCS_CKM.4 Cryptographic key destruction
 FCS_COP.1.1/ECDSA-3         The TSF shall perform signature generation and signature verification in accordance
                             with a specified cryptographic algorithm ECDSA and cryptographic key sizes 160,
                             163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                             ECDSA Signature Generation:
                             1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                   Deviation of step c) and f):
                             The jumps to step a) were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                  Chapter 6.4.3.7 is not supported
                             Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                   Deviation of step (3) and (4):
                             The jumps to step 1 were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function
                             ECDSA Signature Verification:
                             1. According to section 7.4.1 in ANSI [23]
                                     Step b) and c) are not supported.
                                     The output of step c) has to be provided as input to our function by the caller.
                                     Deviation of step d):
                                         o Beside noted calculation, our algorithm adds a random multiple of
                                              BasepointerOrder n to the calculated values u1 and u2.

CC Document                                                 99                                                         1.8
                                                                                                                2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                            2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                   Chapter 6.4.4.2 is not supported
                                   Chapter 6.4.4.3 is not supported:
                                        o The hash-code H of the message has to be provided by the caller as
                                             input to our function
                            3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             100                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.5    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-3         Cryptographic key generation
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-3       The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm implemented by following functions which
                      BSI-DSZ-CC-0879-V4-2020

                       for

   Infineon Security Controller M7893 B11 with
 optional RSA2048/4096 v2.03.008, EC v2.03.008,
SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox
v2.03.008 and with specific IC dedicated software
                    (firmware)

                      from

           Infineon Technologies AG
                     BSI - Bundesamt für Sicherheit in der Informationstechnik, Postfach 20 03 63, D-53133 Bonn
                      Phone +49 (0)228 99 9582-0, Fax +49 (0)228 9582-5477, Infoline +49 (0)228 99 9582-111




Certification Report V1.0                                                                                         CC-Zert-327 V5.25
      BSI-DSZ-CC-0879-V4-2020 (*)
      Infineon Security Controller M7893 B11 with optional RSA2048/4096
      v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
      Toolbox v2.03.008 and with specific IC dedicated software (firmware)

      from                       Infineon Technologies AG
      PP Conformance:            Security IC Platform Protection Profile, Version 1.0,                             SOGIS
                                 15 June 2007, BSI-CC-PP-0035-2007                                           Recognition Agreement

      Functionality:             PP conformant plus product specific extensions
                                 Common Criteria Part 2 extended
      Assurance:                 Common Criteria Part 3 conformant
                                 EAL 6 augmented by ALC_FLR.1



The IT Product identified in this certificate has been evaluated at an approved evaluation
facility using the Common Methodology for IT Security Evaluation (CEM), Version 3.1
extended by Scheme Interpretations, by advice of the Certification Body for components
beyond EAL5 and CC Supporting Documents as listed in the Certification Report for
conformance to the Common Criteria for IT Security Evaluation (CC), Version 3.1. CC and
CEM are also published as ISO/IEC 15408 and ISO/IEC 18045.
(*) This certificate applies only to the specific version and release of the product in its
evaluated configuration and in conjunction with the complete Certification Report and
Notification. For details on the validity see Certification Report part A chapter 5.
The evaluation has been conducted in accordance with the provisions of the certification
scheme of the German Federal Office for Information Security (BSI) and the conclusions
                                                                                                             Common Criteria
of the evaluation facility in the evaluation technical report are consistent with the                    Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                                                  4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................12
   3. Security Policy............................................................................................................15
   4. Assumptions and Clarification of Scope.....................................................................15
   5. Architectural Information.............................................................................................16
   6. Documentation...........................................................................................................16
   7. IT Product Testing.......................................................................................................16
   8. Evaluated Configuration.............................................................................................17
   9. Results of the Evaluation............................................................................................18
   10. Obligations and Notes for the Usage of the TOE.....................................................19
   11. Security Target..........................................................................................................20
   12. Regulation specific aspects (eIDAS, QES)..............................................................20
   13. Definitions.................................................................................................................20
   14. Bibliography..............................................................................................................23
C. Excerpts from the Criteria..............................................................................................26

D. Annexes.........................................................................................................................27




                                                                                                                                 5 / 33
Certification Report                                                               BSI-DSZ-CC-0879-V4-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carried out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BSI Schedule of Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]
●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.

1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     Schedule of Cost for Official Procedures of the Bundesamt für Sicherheit in der Informationstechnik
     (BSI-Kostenverordnung, BSI-KostV) of 3 March 2005, Bundesgesetzblatt I, p. 519



                                                                                                           6 / 33
BSI-DSZ-CC-0879-V4-2020                                                              Certification Report




●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
               can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note1 for FCS_CKM.1/EC-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             101                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.6     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-3          Cryptographic operation
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-3        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
                            with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
                            163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section “7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Note for FCS_COP.1/ECDH-3:
The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163, 192 bits are supported. Numerous other curve types, being also secure in terms of side
channel attacks on this TOE, exist, which the user optionally can add in the composition certification process.
End of note

Note 2 for FCS_COP.1/ECDH-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

Note 3 for FCS_COP.1/ECDH-3:
The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not provide
the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security functional
requirements FCS_COP.1/ECSA, FCS_COP.1/ECDH and FCS_CKM.1/EC. In case of a blocked Crypto2304T, the
RSA and EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered
cryptographic RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

Note 4 for FCS_COP.1/ECDH-3:
The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of note.



CC Document                                             102                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.5          Data Integrity FDP_SDI.2 and FDP_SDC.1
The TOE shall meet the requirement Stored data integrity monitoring and action (FDP_SDI.2) as specified below:

    FDP_SDI.2           Stored data integrity monitoring and action
    Hierarchical to:    FDP_SDI.1 stored data integrity monitoring
    Dependencies:       No dependencies
    FDP_SDI.2.1         The TSF shall monitor user data of the Composite TOE stored in containers controlled
                        by the TSF for data integrity and one- and/or more-bit-errors on all objects, based on
                        the following attributes: corresponding EDC value for RAM, ROM and SOLID FLASH™
                        NVM and error correction ECC for the SOLID FLASH™ NVM.
    FDP_SDI.2.2         Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                        FLASH™ NVM automatically and inform the user about more bit errors.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.

The TOE shall meet the requirement “Stored data confidentiality (FDP_SDC.1)” as specified below:
   FDP_SDC.1             Stored data confidentiality
     Hierarchical to:    No other components
     Dependencies:       No dependencies
   FDP_SDC.1.1           The TSF shall ensure the confidentiality of the information of the user data of the
                         Composite TOE while it is stored in the RAM, ROM, Cache and SOLID FLASH™ NVM.




CC Document                                              103                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.6          Application Note to FPT_FLS.1 Failure with preservation of secure state
The SFR FPT_FLS.1 is defined in the PP [9] but with application note 14 it is required to describe the secure state:
Where ever FPT_FLS.1 is claimed it depends on the source or affected piece of data the failure was detected.
Induced failures on other than memory contents could in the worse lead to exploitable situations if not
discovered and treated properly. This includes i.e. internal transported keys and other TSF data. For that reasons
the integrity of the transport ways and also the modules the TSF and critical data are used is protected against
failure.
Depending on the criticality where the failure occurred and in most cases a security reset is triggered. Only in
case of a peripheral bus error or an address translation mismatch, a user software action is required as described
in the user guidance.
In case of a security reset, the user cannot take any action. The chip immediately stops operation and reboots.


7.2            Support by the Flash Loader

The TOE provides the Flash Loader to download user data into the SOLID FLASH™ NVM, either during
production of the TOE or at customer site. The Flash Loader is dedicated for usage by authorized users only in
secured and insecure environment during the production up to Phase 6 Security IC Personalisation.
The Flash Loader has to be permanently deactivated before entering Phase 7 Security IC end-usage.
For this reason the TOE shall meet the requirements as defined and described in the PP [9] section 7.3 Packages
for Loader and 7.2 Package Authentication of the Security IC:
     Limited capabilities (FMT_LIM.1/Loader),
     Limited availability – Loader (FMT_LIM.2/Loader),
     Authentication Proof of Identity (FIA_API.1),
     Inter-TSF trusted channel (FTP_ITC.1),
     Basic data exchange confidentiality (FDP_UCT.1),
     Data exchange integrity (FDP_UIT.1),
     Subset access control – Loader (FDP_ACC.1/Loader) and
     Security attribute based access control – Loader (FDP_ACF.1/Loader)
as defined in the PP [9], section 7.2 and 7.3.

The Flash Loader supports the following security function policy (SFP):
    Loader SFP:
        provides the mutual authentication between the TOE and the administrator user or download operator
        user and the download of the user data into the memory of the TOE.

The Flash Loader supports the following two subjects:
    Administrator user:
        is enabled performing mutual authentication with the keys Kc and Kd, to manage (set, exchange, delete)
        the keys Kc, Kd and Kfdi and to process the download of the user data into the memory of the TOE.
    Download operator user:
        is enabled performing mutual authentication with Kd, to exchange the key Kd and to perform the
        download of the user data into the memory of the TOE. He can also delete Kfdi.




CC Document                                             104                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The Flash Loader supports the following object:
    User data:
        Data loaded into the memory of the TOE.

The TOE shall meet the requirement “Limited capabilities (FMT_LIM.1/Loader)” as specified below:

 FMT_LIM.1/Loader          Limited capabilities
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.2 Limited availability.
 FMT_LIM.1.1/Loader        The TSF shall be designed and implemented in a manner that limits its capabilities so
                           that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                           enforced:
                           Deploying Loader functionality after permanent deactivation does not allow stored user
                           data of the Composite TOE to be disclosed or manipulated by unauthorized user.

The TOE shall meet the requirement “Limited availability – Loader (FMT_LIM.2/Loader)” as specified below:
 FMT_LIM.2/Loader          Limited availability – Loader
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.1 Limited capabilities.
 FMT_LIM.2.1/Loader        The TSF shall be designed in a manner that limits its availability so that in
                           conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced:

                           The TSF prevents deploying the Loader functionality after permanent deactivation.

The TOE shall meet the requirement “Limited availability – Loader (FIA_API.1)” as specified below:
  FIA_API.1              Authentication Proof of Identity
      Hierarchical to:   No other components.
      Dependencies:      No dependencies.
  FIA_API.1.1            The TSF shall provide an authentication mechanism according to [34] ISO/IEC 9798-2
                         section 6.2.2 Mechanism 4: Three-path authentication based on the security attributes
                         (keys) Kc or Kd to prove the identity of the TOE to an external entity.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.




CC Document                                             105                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FTP_ITC.1)” as specified below:
  FTP_ITC.1              Inter-TSF trusted channel
     Hierarchical to:    No other components.
     Dependencies:       No dependencies.
  FTP_ITC.1.1            The TSF shall provide a communication channel between itself and the administrator
                         user and the Download Operator user as described in the Loader SFP that is logically
                         distinct from other communication channels and provides assured identification of its
                         end points and protection of the channel data from modification or disclosure.
  FTP_ITC.1.2            The TSF shall permit another trusted IT product to initiate communication via the
                         trusted channel.
  FTP_ITC.1.3            The TSF shall initiate communication via the trusted channel for deploying Loader for
                         downloading user data.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UCT.1)” as specified below:
  FDP_UCT.1               Basic data exchange confidentiality
      Hierarchical to:    No other components.
      Dependencies:       No dependencies.
  FDP_UCT.1.1             The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                          unauthorised disclosure.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UIT.1)” as specified below:
 FDP_UIT.1            Data exchange integrity
     Hierarchical to: No other components.
      Dependencies: [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                      [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control].
 FDP_UIT.1.1          The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                      modification, deletion or insertion errors.
 FPP_UIT.1.2          The TSF shall be able to determine on receipt of user data, whether modification,
                      deletion or insertion have occurred.

Note regarding the Flash Loader:
The algorithm strength of the Flash Loader has not been cryptographic-analytically evaluated by the BSI, as
Infineon has implemented a proprietary extension.
End of note.




CC Document                                            106                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FDP_ACC.1/Loader)” as specified below:
 FDP_ACC.1/Loader           Subset access control – Loader
       Hierarchical to:     No other components.
       Dependencies:        FDP_ACF.1 Security attribute based access control.
 FDP_ACC.1.1/Loader         The TSF shall enforce the Loader SFP on
                               (1) the subjects Administrator user and the Download operator user,
                               (2) the objects User data in the SOLID FLASH™ NVM memory of the TOE,
                               (3) the operation deployment of the Loader.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.

The TOE shall meet the requirement “Limited availability – Loader (FTP_ACF.1/Loader)” as specified below:
 FDP_ACF.1/Loader             Security attribute based access control – Loader
             Hierarchical to: No other components.
             Dependencies: FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        The TSF shall enforce the Loader SFP to objects based on the following:
                                 (1) the subjects Administrator user and the Download operator user with
                                     security attributes Kc, Kd and Kfdi
                                 (2) the objects user data in data loaded into the SOLID FLASH™ NVM
                                     memory of the TOE with security attributes Kfdi.

      FDP_ACF.1.2/Loader          The TSF shall enforce the following rules to determine if an operation among
                                  controlled subjects and controlled objects is allowed:
                                     (1) evaluate the corresponding access control information of the relevant
                                          subject, administrator user and download operator user, before the
                                          access, so that accesses to be denied cannot be utilized by the subject
                                          attempting to perform the operation. The subsequent download is then
                                          protected by the key Kfdi.

      FDP_ACF.1.3/Loader          The TSF shall explicitly authorise access of subjects to objects based on the
                                  following additional rules:
                                                                       None

      FDP_ACF.1.4/Loader          The TSF shall explicitly deny access of subjects to objects based on the
                                  following additional rules:
                                                                       None




CC Document                                            107                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


Note 15:
Regarding FDP_ACF.1.4/Loader it is added in the User Guidance that the Flash Loader has to be permanently
deactivated prior delivery to the end-user.
End of note.

Note 16:
The security functional requirements FMT_LIM.1/Loader, FMT_LIM.2/Loader, FIA_API.1, FTP_ITC.1, FDP_UCT.1,
FDP_UIT.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader apply only at TOE products coming with activated Flash
Loader enabled for user data download. In other cases the Flash Loader is not available anymore and the user
software or data download is completed. Depending on the capabilities of the user software these security
functional requirements may then reoccur as subject of the composite TOE.
The permanent locking of the Flash Loader after finalizing the download and prior delivery to the end-user is
added to package 2 with LIM1/Loader and FMT_LIM.2/Loader.
End of note.


7.3             TOE Security Assurance Requirements

The evaluation assurance level is EAL6 augmented with ALC_FLR.1.
In the following table, the security assurance requirements are given. The augmentation of the assurance
components compared to the Protection Profile [9] is expressed with bold letters.

                                     Table 13     Assurance Components
              Aspect               Acronym                        Description                    Refinement
 Development                    ADV_ARC.1          Security Architecture Description            In PP [9]
                                ADV_FSP.5          Complete semi-formal functional              in ST
                                                   specification with additional error
                                                   information
                                ADV_IMP.2          Complete mapping of the                      in ST
                                                   implementation representation of the
                                                   TSF
                                ADV_INT.3          Minimally complex internals
                                ADV_TDS.5          Complete semi-formal modular design
                                ADV_SPM.1          Formal TOE security policy model
 Guidance Documents             AGD_OPE.1          Operational user guidance                    in PP [9]
                                AGD_PRE.1          Preparative procedures                       in PP [9]
 Life-Cycle Support             ALC_CMC.5          Advanced support                             in ST
                                ALC_CMS.5          Development tools CM coverage                in ST
                                ALC_DEL.1          Delivery procedures                          in PP [9]
                                ALC_DVS.2          Sufficiency of security measures             in PP [9]
                                ALC_LCD.1          Developer defined life-cycle model
                                ALC_TAT.3          Compliance with implementation
                                                   standards – all parts
                                ALC_FLR.1          Basic Flaw Remediation
 Security Target Evaluation     ASE_CCL.1          Conformance claims
                                ASE_ECD.1          Extended components definition
                                ASE_INT.1          ST introduction
CC Document                                           108                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              Aspect                 Acronym                         Description                    Refinement
                                 ASE_OBJ.2           Security objectives
                                 ASE_REQ.2           Derived security requirements
                                 ASE_SPD.1           Security problem definition
                                 ASE_TSS.1           TOE summary specification
 Tests                           ATE_COV.3           Rigorous analysis of coverage                  In ST
                                 ATE_DPT.3           Testing: modular design
                                 ATE_FUN.2           Ordered functional testing
                                 ATE_IND.2           Independent testing – sample
 Vulnerability Assessment        AVA_VAN.5           Advanced methodical vulnerability testing      in PP [9]


7.3.1           Refinements
Some refinements are taken unchanged from the PP [9]. In some cases a clarification is necessary. In Table 17 an
overview is given where the refinement is done.
The refinements from the PP [9] have to be discussed here in the Security Target, as the assurance level is
increased. The refinements from the PP [9] are included in the chosen assurance level EAL 6 augmented with
ALC_FLR.1.
7.3.1.1         Development (ADV)
ADV_IMP Implementation Representation:
The refined assurance package ADV_IMP.1 implementation representation of the TSF requires the availability of
the entire implementation representation, a mapping of the design description to the implementation
representation with a level of detail that the TSF can be generated without further design decisions. In addition,
the correspondence of design description and implementation representation shall be demonstrated.
The covered higher assurance package ADV_IMP.2 requires a complete and not curtailed mapping of the
implementation representation of the TSF, and the mapping of the design description to the entire
implementation representation. In addition, the correspondence of design description and the implementation
representation shall be demonstrated. The ADV_IMP.1 aspect and refinement remains therefore valid. The
enhancement underlines the refinement in the PP [9] and by that the entirely complete design i.e. not curtailed
representation with according mapping was provided, demonstrated and reviewed.

ADV_FSP Functional Specification:
The ADV_FSP.4 package requires a functional description of the TSFIs and there assignment to SFR-enforcing,
SFR-supporting, SFR-non-interfering, including related error messages, the assurance package. The
enhancement of ADV_FSP.5 requires additionally a complete semi-formal functional specification with
additional error information. In addition the package includes a tracing from the functional specification to the
SFRs, as well as the TSFIs descriptions including error messages not resulting from an invocation of a TSFI.
These aspects from ADV_FSP.5 are independent from the ADV_FSP.4 refinements from the PP [9] but
constitute an enhancement of it. By that the aspects of ADV_FSP.4 and its refinement in the PP [9] apply also
here. The assurance and evidence was provided accordingly.

ADV_SPM Formal Security Policy Model
It is the objective of this family to provide additional assurance from the development of a formal security policy
model of the TSF, and establishing a correspondence between the functional specification and this security
policy model. Preserving internal consistency the security policy model is expected to formally establish the
security principles from its characteristics by means of a mathematical proof.



CC Document                                             109                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


   ADV_SPM.1          Formal TOE security policy model
   Hierarchical to:   No other components
   Dependencies:      ADV_FSP.4 Complete function description
   ADV_SPM.1.1D       The developer shall provide a formal security policy model for the
                      Memory Access Control Policy and the corresponding SFRs
                          FDP_ACC.1 Subset Access Control
                          FDP_ACF.1 Security attribute based access control
                          FMT_MSA.1 Management of Security Attributes
                          FMT_MSA.3 Static Attribute Initialization.
                      Moreover, the following SFRs shall be addressed by the formal security policy model:
                         FDP_SDI.2 Stored data integrity monitoring and action
                         FDP_SDC.1 Stored data confidentiality
                         FDP_ITT.1 Basic Internal Transfer Protection
                         FDP_IFC.1 Information Flow Control
                         FPT_ITT.1 Basic internal TSF data transfer protection
                         FPT_PHP.3 Resistance to physical attack
                         FPT_FLS.1 Failure with preservation of secure state
                         FRU_FLT.2 Limited fault tolerance
                         FMT_LIM.1 Limited capabilities
                         FMT_LIM.2 Limited availability
                         FAU_SAS.1 Audit storage
                         FMT_SMF.1 Specification of Management Functions
                       Moreover, the following SFRs of the package authentication of the IC PP [9] and the
                         loader packages PP [9] shall be addressed by the formal security policy model:
                         FIA_API.1
                         FMT_LIM.1/Loader
                         FMT_LIM.2/Loader
                         FTP_ITC.1
                         FDP_UCT.1
                         FDP_UIT.1
                         FDP_ACC.1/Loader
                         FDP_ACF.1/Loader
   ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify
                the relevant portions of the statement of SFRs that make up that policy.
   ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and
                any formal functional specification.
   ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model
                and the functional specification.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.


CC Document                                            110                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.3.1.2        Life-cycle Support (ALC)
ALC_CMS Configuration Management Scope:
The refinement of ALC_CMS.4 in the PP [9] defines with some conditions the possibility that the Security IC
embedded firmware can be part of the delivered TOE. This is the case as the Security IC embedded firmware –
regardless of the version in use - and the optional software are part of TOE and delivered together with the TOE
as the firmware and optional software are stored in the ROM and/or SOLID FLASH™ NVM. The presence of the
optional parts belongs to the user order. Both, the firmware and software delivered with the TOE are controlled
entirely by Infineon Technologies.
In addition, the TOE offers the possibility that the user can download his software at his own premises. These
parts of the software are user controlled only and are not part of this TOE. The download of this solely user
controlled software into the SOLID FLASH™ NVM is protected by strong authentication means. In addition, the
download itself could also be encrypted.
The requirements by ALC_CMS.4 are fulfilled including the refinements from the PP [9].
The ALC_CMS.5 implements the additional requirement to include development tools and related information
into the configuration list. This add on has no influence on the refinement of ALC_CMS.4 in the PP [9] as the
delivery of Security IC embedded firmware is independent from the TOE development tools and related
information. The package ALC_CMS.5 is therefore an enhancement to ACL_CMS.4 and the package with its
refinement in the PP [9] remains valid. The assurance and evidence was provided accordingly.

ALC_CMC Configuration Management Capabilities:
The PP refinement from the assurance package ALC_CMC.4 Production support, acceptance procedures and
automation points out that the configuration items comprise all items defined under ALC_CMS to be tracked
under configuration management. In addition a production control system is required guaranteeing the
traceability and completeness of different charges and lots. Also the number of wafers, dies and chips must be
tracked by this system as well as procedures applied for managing wafers, dies or complete chips being removed
from the production process in order to verify and to control predefined quality standards and production
parameters. It has to be controlled that these wafers, dies or assembled devices are returned to the same
production stage from which they are taken or they have to be securely stored or destroyed otherwise.
The additionally covered extended package of ALC_CMC.5 Advance Support requires advanced support
considering the automatisms configuration management systems, acceptance and documentation procedures
of changes, role separation with regard to functional roles of personnel, automatisms for tracking and version
controlling in those systems, and includes also production control systems. The additional aspects of
ADV_CMC.5 constitute an enhancement of ACL_CMC.4 and therefore the aspects and ACL_CMC.4 refinements
in the PP [9] remain valid. The assurance and evidence was provided.

ALC_DVS Development Security:
The requirement ALC_DVS.2 is refined in the PP [9] requiring the development security documentation
comprising all the physical, procedural, personnel, and other security measures that are necessary to protect the
confidentiality and integrity of the TOE design and implementation in its development environment.
The documentation and evidence was given, reviewed, audited and thus the assurance and evidence was
provided accordingly.

Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the:
      keys are generated with sufficient entropy
      the keys are stored within a HSM as integral part of the vendor environment
      the keys are stored in the non-volatile memory of the chip
All these requirements were subject of an audit; assurance and evidence was provided.



CC Document                                            111                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


ALC_DEL Delivery Procedure:
Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the delivery process of the Flash Loader keys - as referenced in the section 10 - is separated from the chip
delivery to the user.


7.3.1.3         Tests (ATE)
ATE_COV Test Coverage:
The PP refined assurance package ATE_COV.2 Analysis of coverage addresses the extent to which the TSF is
tested, and whether or not the testing is sufficiently extensive to demonstrate that the TSF operates as specified.
It includes the test documentation of the TSFIs in the functional specification. In particular the refinement
requires that The TOE must be tested under different operating conditions within the specified ranges. In
addition, the existence and effectiveness of mechanisms against physical attacks should be covered by evidence
that the TOE has the particular physical characteristics. This is furthermore detailed in the PP [9].
This assurance package ATE_COV.2 has been enhanced to ATE_COV.3 to cover the rigorous analysis of
coverage. This requires the presence of evidence that exhaustive testing on rigorous entirely all interfaces as
documented in the functional specification was conducted. By that ATE_COV.2 and refinements as given in the
PP [9] are enhanced by ATE_COV.3 and remain as well. The TSFIs were completely tested according to
ATE_COV.3 and the assurance and evidence was provided.


7.3.1.4         AVA_VAN Vulnerability Analysis
The assurance package AVA_VAN remains unchanged compared to the forerunner processes and requires
advanced methodical vulnerability analysis.




CC Document                                             112                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.4           Security Requirements Rationale

7.4.1         Rationale for the Security Functional Requirements
The objectives O.Authentication and OE.TOE_Auth are discussed in the PP [9] chapter 7.2.1.
The objectives O.Cap_Avail_Loader and OE.Lim_Block_Loader and the covering security functional
requirements FMT_LIM.1/Loader and FMT_LIM.2/Loader are discussed in the PP [9] chapter 7.3.1.
The policy P.Ctrl_Loader and the objectives O.Ctrl_Auth_Loader and OE.Loader_usage are discussed in the PP
[9] chapter 7.3.2.

Additionally, the objective O.Add-Function includes the objectives implemented by the CIPURSE™
Cryptographic Library versions: O.Ctrl_Auth_CCL, O.Prot_Integrity and O.Prot_Confidentiality.
These extended objectives are discussed in this ST in chapter 5.5 P.Add functions.

The additional objectives O.Prot_TSF_Confidentiality is defined in chapter 5.1 and 5.8 in this document.
PP [9] chapter 6.1 includes also the definition of FDP_SDI.2 „Stored data integrity monitoring and action“.
While the above mentioned security functional requirements rationale of the TOE are defined and described in
PP [9] section 6.3.1, the additional introduced SFRs are listed and discussed below:

                              Table 14     Rational for additional SFR in the ST
         Objective                                TOE Security Functional Requirements
                             FCS_COP.1/RSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDH-1 Cryptographic operation for ACL-1
                             FCS_CKM.1/RSA-1 Cryptographic key generation for ACL-1
                             FCS_CKM.1/EC-1 Cryptographic key generation for ACL-1
                             FCS_COP.1/RSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDH-2 Cryptographic operation for ACL-2
                             FCS_CKM.1/RSA-2 Cryptographic key generation for ACL-2
                             FCS_CKM.1/EC-2 Cryptographic key generation for ACL-2
O.Add-Functions
                             FCS_COP.1/RSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDH-3 Cryptographic operation for ACL-3
                             FCS_CKM.1/RSA-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/EC-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/CCL Cryptographic key generation for CCL
                             FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel for CCL
                             FCS_CKM.4/CCL Cryptographic key destruction for CCL
                             FCS_COP.1/CMAC-SCL-1 Cryptographic operation CMAC for SCL-1
                             FCS_CKM.4/CMAC-SCL-1 Cryptographic key destruction CMAC for SCL-1
O.Phys-Manipulation          FPT_TST.2 Subset TOE security testing
                             FDP_ACC.1 Subset access control
O.Mem-Access                 FDP_ACF.1 Security attribute based access control
                             FMT_MSA.3 Static attribute initialization

CC Document                                           113                                                   1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


         Objective                                TOE Security Functional Requirements
                             FMT_MSA.1 Management of security attributes
                             FMT_SMF.1 Specification of Management Functions
O.Malfunction                FDP_SDI.2 Stored data integrity monitoring and action
                             FCS_RNG.1/TRNG Generation of Random Numbers –TRNG
                             FCS_RNG.1/HPRG Generation of Random Numbers – HPRG
O.RND
                             FCS_RNG.1/DRNG Generation of Random Numbers –DRNG
                             FCS_RNG.1/KSG Generation of Random Numbers – KSG
                             FTP_ITC.1 Inter-TSF-trusted channel
O.Prot_TSF_
                             FDP_ACC.1/Loader Subset access control –Loader
Confidentiality
                             FDP_ACF.1/Loader Security attribute based access control – Loader
                             FCS_COP.1/TDES-SCL-1 Cryptographic operation – TDES by SCL-1
                             FCS_CKM.4/TDES-SCL-1 Cryptographic key destruction – TDES by SCL-1
                             FCS_COP.1/TDES-SCL-2 Cryptographic operation – TDES by SCL-2
O.TDES
                             FCS_CKM.4/TDES-SCL-2 Cryptographic key destruction – TDES by SCL-2
                             FCS_COP.1/TDES Cryptographic operation – TDES by SCP
                             FCS_CKM.4/TDES Cryptographic key destruction – TDES by SCP
                             FCS_COP.1/AES-SCL-1 Cryptographic operation – AES by SCL-1
                             FCS_CKM.4/AES-SCL-1 Cryptographic key destruction – AES by SCL-1
                             FCS_COP.1/AES-SCL-2 Cryptographic operation – AES by SCL-2
O.AES
                             FCS_CKM.4/AES-SCL-2 Cryptographic key destruction – AES by SCL-2
                             FCS_COP.1/AES Cryptographic operation – AES by SCP
                             FCS_CKM.4/AES Cryptographic key destruction – AES by SCP
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Ctrl_Auth_CCL              FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Integrity             FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Confidentiality       FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL

The table above gives an overview, how the security functional requirements are combined to meet the security
objectives.




CC Document                                          114                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


For clarity please find following assignment to versions:
     ACL-1 covers version v2.08.007
     ACL-2 covers version v2.07.003
     ACL-3 covers version v2.06.003
     SCL-1 covers version v2.04.002
     SCL-2 covers version v2.02.010
     CCL covers version v02.00.0004


 7.4.1.1       Cryptographic Aspects
The justification related to the security objective “Additional Specific Security Functionality (O.Add-Functions)”
is as follows:
The security functional requirement(s) “Cryptographic operation (FCS_COP.1)” exactly require(s) those functions
to be implemented which are demanded by O.Add-Functions:
      The ACL library – regardless of the version chosen – implements the SFRs FCS_CKM.1/RSA, supporting
          the generation of RSA keys, and the FCS_CKM.1/EC, supporting the generation of EC keys, needed for
          these cryptographic operations.
          To sum up, the ACL versions implement the SFRs as follows:
              o FCS_COP.1/RSA-1, FCS_COP.1/ECDSA-1, FCS_COP.1/ECDH-1, FCS_CKM.1/RSA-1, and
                  FCS_CKM/EC-1 respectively
              o FCS_COP.1/RSA-2, FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-2, FCS_CKM.1/RSA-2, and
                  FCS_CKM/EC-2 respectively
              o FCS_COP.1/RSA-3, FCS_COP.1/ECDSA-3, FCS_COP.1/ECDH-3, FCS_CKM.1/RSA-3, and
                  FCS_CKM/EC-3
      The SCL library of version v2.04.002 implements the function of cipher based message authentication
          code CMAC, supporting the authenticity and integrity of data blocks for example used for messages.
      The CIPURSE™ Cryptographic Library implements the SFRs FCS_COP.1/CCL Cryptographic Operation
          CCL Trusted Channel, establishing the trusted channel between two authenticated entities and
          FCS_CKM.1/CCL Cryptographic key generation, supporting the generation of the keys used for
          authentication and confidentiality. The CIPURSE™ CL operation requires the presence of the SCP.

The implementation covers the functional requirements and meets the objective O.Add-Functions.
The use of the supporting library Toolbox has no impact on any security functional requirement nor does the use
generate additional requirements. The Toolbox library is not part of the TOE Security Functionality (TSF).

All these requirements have to be fulfilled to support OE.Resp-Appl for the SFRs implemented by the:
      SCP:
             o FCS_COP.1/TDES
             o FCS_COP.1/AES
      SCL for version v2.04.002:
             o FCS_COP.1/TDES-SCL-1
             o FCS_COP.1/AES-SCL-1
             o FCS_COP.1/CMAC-SCL-1
      SCL for version v2.02.010:
             o FCS_COP.1/TDES-SCL-2
             o FCS_COP.1/AES-SCL-2
      CCL for version v02.00.0004:
CC Document                                             115                                                    1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              o   FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel,
              o   FCS_CKM.1/CCL Cryptographic key generation
              o   FCS_CKM.4/CCL Cryptographic key destruction

Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. These issues are addressed by the specific security functional requirements:
     [FDP_ITC.1 Import of user data of the Composite TOE without security attributes or
        FDP_ITC.2 Import of user data of the Composite TOE with security attributes or
        FCS_CKM.1 Cryptographic key generation],
     FCS_CKM.4 Cryptographic key destruction

The security functional requirements required to meet the security objectives O.Leak-Inherent, O.Phys-Probing,
    O.Malfunction, O.Phys-Manipulation and O.Leak-Forced define how to implement the specific security
functionality. However, key-dependent functions could be implemented in the Smartcard Embedded Software.

The usage of cryptographic algorithms requires the use of appropriate keys. Otherwise these cryptographic
functions do not provide security. The keys have to be unique with a very high probability, and must have a
certain cryptographic strength etc. In case of a key import into the TOE (which is usually after TOE delivery) it
has to be ensured that quality and confidentiality are maintained. Keys for DES and AES are provided by the
environment. Keys for RSA and EC algorithms can be provided either by the TOE or the environment.

The justification of the security objective and the additional requirements (both for the TOE and its environment)
show that they do not contradict to the rationale already given in the Protection Profile for the assumptions,
policy and threats defined there.




CC Document                                              116                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.4.1.2       Hardware related Aspects
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and functions
provided by the TOE can be tested after TOE Delivery. This security functional component is used instead of the
functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to know which
security functions or mechanisms can be tested. The functional component FPT_TST.1 does not mandate to
explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of the integrity
of TSF data and stored TSF executable code which might violate the security policy.
The tested security enforcing functions are SF_DPM Device Phase Management, SF_CS Cryptographic Support
and SF_PMA Protection against modifying attacks.

The justification related to the security objective “Protection against Physical Manipulation (O.Phys-
Manipulation)” is as follows:
The security functional requirement FPT_TST.2 will detect attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation. The physical manipulation
will be tried to overcome security enforcing functions.

The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1 and FMT_SMF.1 cover this security objective. The implementation of
these functional requirements is represented by the dedicated privilege level concept.

The justification of the security objective and the additional requirements show that they do not contradict to
the rationale already given in the Protection Profile for the assumptions, policy and threats defined there.
Moreover, these additional security functional requirements cover the requirements by the PP [9] user data of
the Composite TOE protection of chapter 1.2.5 claim 35 and 36 which are not refined by the PP [9].
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. The TOE only provides the tool to implement the policy defined in the
context of the application.

The justification related to the security objective Protection against Malfunction due to Environmental Stress
(O.Malfunction) is as follows:
The security functional requirement Stored data integrity monitoring and action (FDP_SDI.2) requires the
implementation of an integrity observation and correction which is implemented by the Error Detection (EDC)
and Error Correction (ECC) measures. The EDC is present throughout all memories of the TOE while the ECC is
realized in the SOLID FLASH™ NVM. These measures detect and inform about one and more bit errors. In case
of the SOLID FLASH™ NVM 1 bit errors of the data are corrected automatically. The ECC mechanism protects
the TOE from the use of corrupt data. Therefore FDP_SDI.2 is suitable to meet the security objective
O.Malfunction.

The presence of true random numbers is the security goal 4 (SG4) which is formalized in the objective O.RND
Random Numbers. This objective must be covered by fulfillment of the security functional requirement
FCS_RNG. This is defined in the PP [9] chapter 5.1. The requirement implements a quality metric which is defined
by national regulations. The implemented random number generation fulfils the definitions of AIS 31 [13] in the
quality classes as outlined in chapter 7.1.1.1. Therefore the SFR FCS_RNG and the objective O.RND are covered.




CC Document                                              117                                                       1.8
                                               the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.
This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 33
Certification Report                                                       BSI-DSZ-CC-0879-V4-2020




4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-0879-V3-2018. Specific
results from the evaluation process BSI-DSZ-CC-0879-V3-2018 were re-used.
The evaluation of the product Infineon Security Controller M7893 B11 with optional
RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
Toolbox v2.03.008 and with specific IC dedicated software (firmware), was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 11 February 2020.
TÜV Informationstechnik GmbH is an evaluation facility (ITSEF) 5 recognised by the
certification body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and in the Security Target.
For the meaning of the assurance components and assurance levels please refer to CC
itself. Detailed references are listed in part C of this report.
The Certificate issued confirms the assurance of the product claimed in the Security Target
at the date of certification. As attack methods evolve over time, the resistance of the
certified version of the product against new attack methods needs to be re-assessed.
Therefore, the sponsor should apply for the certified product being monitored within the
assurance continuity program of the BSI Certification Scheme (e.g. by a re-assessment or
re-certification). Specifically, if results of the certification are used in subsequent evaluation
and certification procedures, in a system integration process or if a user's risk
management needs regularly updated results, it is recommended to perform a re-
assessment on a regular e.g. annual basis.
In order to avoid an indefinite usage of the certificate when evolved attack methods would
require a re-assessment of the products resistance to state of the art attack methods, the
maximum validity of the certificate has been limited. The certificate issued on 12 February
2020 is valid until 11 February 2025. Validity can be re-newed by re-certification.
The owner of the certificate is obliged:

5
     Information Technology Security Evaluation Facility



                                                                                             8 / 33
BSI-DSZ-CC-0879-V4-2020                                                        Certification Report




     1. when advertising the certificate or the fact of the product's certification, to refer to
        the Certification Report as well as to provide the Certification Report, the Security
        Target and user guidance documentation mentioned herein to any customer of the
        product for the application and usage of the certified product,
     2. to inform the Certification Body at BSI immediately about vulnerabilities of the
        product that have been identified by the developer or any third party after issuance
        of the certificate,
     3. to inform the Certification Body at BSI immediately in the case that security relevant
        changes in the evaluated life cycle, e.g. related to development and production sites
        or processes, occur, or the confidentiality of do fulfilled by FMT_SMF.1 for
                          PACE; fulfilled by FMT_SMF.1/BAC for BAC
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE for PACE; fulfilled by
                          FMT_SMR.1 for BAC

 FMT_MTD.1.1/INI_ENA      The TSF shall restrict the ability to write the Initialisation Data and Pre-
                          personalisation Data to the Manufacturer.

 [IFX specific]           The application note 42 of [PP_BAC] applies. This application note provides a
 Application Note:        definition, what is meant by “Pre-Personalisation Data”. This definition is also
                          applicable to FMT_MTD.1/INI_ENA from [PP_SAC]. Therefore FMT_MTD.1/INI_ENA
                          from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            18
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.2.3             Class FPT Protection of the Security Functions


 FPT_TST.1                TSF testing

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_TST.1.1              The TSF shall run a suite of self tests during initial start-up, to demonstrate the
                          correct operation of the TSF.

 FPT_TST.1.2              The TSF shall provide authorised users with the capability to verify the integrity of
                          the TSF data.

 FPT_TST.1.3              The TSF shall provide authorised users with the capability to verify the integrity of
                          stored TSF executable code.



 [IFX specific]           There is no contradiction between application note 46 of [PP_BAC] and application
                          note 52 of [PP_SAC]. In fact, although the wording is slightly different, the meaning
 Application Note:
                          of these application notes is identical. Therefore either of these application notes
                          applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be combined.




 FPT_PHP.3                Resistance to physical attack

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_PHP.3.1              The TSF shall resist physical manipulation and physical probing to the TSF by
                          responding automatically such that the SFRs are always enforced.

 [IFX specific]           Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application
                          note 48 of [PP_BAC] is only informative to the reader in the sense, that it provides a
 Application Note:
                          context to an older CC standard, but not relevant for the interpretation of
                          FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or application note 53
                          of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            19
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.3                SFRs specifically from [PP_SAC]

7.1.3.1              Class FCS: Cryptographic Support


  FCS_CKM.1/DH_PACE        Cryptographic key generation – Diffie-Hellman for PACE session keys

  Hierarchical to:         No other components.

  Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                           operation]: fulfilled by FCS_CKM.4
                           Justihe CXRAM parity watchdog.
                           watchdog error               off)
                           configuration              • enabled after
                                                        watchdog
                                                        initialization
                                                        done
                                                      • enabled (always
                                                        on)
                           FXRAM parity               • disabled (always Configuration of the FXRAM parity watchdog.
                           watchdog error               off)
                           configuration              • enabled after
                                                        watchdog




                                             All information provided in this document is subject to legal disclaimers.           © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                 Rev. 4.4 — 29 October 2018                                                                      12 of 87
PUBLIC
NXP Semiconductors                                                  P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                 Security Target Lite



                           Name                    Value                                      Description
                                                            initialization
                                                            done
                                                      • enabled (always
                                                        on)
                           Selection of reset         • ISO13239/                             Selection of CRC algorithm for ISO7816 enhanced
                           value for UART               HDLC                                  protocol support.
                           CRC algorithm              • de facto PC/SC
                           Start-Up with Low          • YES                                   Start-Up with low CPU clock to enable specific low
                           CPU clock                  • NO                                    power applications. If this option is enabled the ISO
                           enabled                                                            start-up timing is not met.
                           RunMode                    • YES                                   Special start-up behavior in order to support a start-up
                           enabled                    • NO                                    with
                                                                                              • RST_N pad forced to LOW or not connected
                                                                                              and
                                                                                              • CLK pad forced HIGH or not connected.
                           Allow                      • YES                                   Disables the Low Frequency Sensor to allow parallel
                           simultaneous               • NO                                    operation via contact and contactless interfaces. The
                           operation of                                                       Low Frequency Sensor is disabled only when the CPU
                           ISO7816                                                            is free-running or runs at an internal clock.
                           and ISO14443
                           applications
                           Chip Health mode           • YES                                   Activation of read-out of IC identification items and
                           enabled                    • NO                                    start of built-in self test and ident routines is enabled or
                                                                                              not.
                           L_A / L_B input                                Additional capacitance (2x26 pF) between L_A/L_B
                                                      • 17 pF for class 1
                           capacitance                                    required meeting resonance frequency at ID1/2
                           configuration                (ID1) antennas    operation.
                                                        (default)
                                                      • 69 pF for class 2
                                                        (“half ID1”)
                                                        antennas
                           UID options                • Single FNUID,                         Defines size of the contactless communication protocol
                                                        four bytes                            unique identifier (set by Contactless Communication
                                                      • Double UID,                           Parameter ATQ0)
                                                        seven bytes

                          See Section 31.1 of the Data Sheet [9] for details on all minor configuration options listed in
                          Table 8. The availability of minor configuration options partly depends on the selected major
                          configuration option. However, in general the minor configuration options can be chosen
                          independently.
                1.4.2.3     Post Delivery Configuration
                          Post Delivery Configuration (PDC) can be applied by the customer himself after the TOE
                          has been delivered to that customer. These options can be used to tailor the TOE to the
                          specific customer requirements. The Post Delivery Configuration can be changed multiple
                          times but must be set permanently by the customer before the TOE is delivered to phase 7
                          of the life cycle.
                          The Post Delivery Configuration for the P60D024/016/012yVB(Y/Z/A)/yVF is listed in Table
                          9.




                                             All information provided in this document is subject to legal disclaimers.            © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                 Rev. 4.4 — 29 October 2018                                                                       13 of 87
PUBLIC
NXP Semiconductors                                                P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                        Security Target Lite


                          Table 9.     Post Delivery Configuration for P60D024/016/012yVB(Y/Z/A)/yVF
                           Name                Values            Description
                           EEPROM Size           Steps of 2KB                         This value determines the maximum size of the EEPROM
                                                                                      in steps of 2KB. Default EEPROM size is given by the
                                                                                      major configuration.
                           CXRAM Size            Steps of 128 Byte This value determines the maximum size of the CXRAM
                                                                   in steps of 128 Bytes. Default CXRAM size is given by the
                                                                   major configuration.
                           Fame2                 Enabled or                           This value determines whether the Fame2 coprocessor is
                           coprocessor           Disabled                             enabled or disabled. Default value is enabled.
                           AES                   Enabled or                           This value determines whether the AES coprocessor is
                                                 Disabled                             enabled or disabled. Default value is enabled.
                           Contactless           Enabled or                           This value determines whether the Contactless interface
                           Interface             Disabled                             is enabled or not. Default value is enabled.

                          By applying Post Delivery Configuration the Security Rows content is updated for the
                          changed configuration options and can therefore be used for identification of the TOE after
                          applying any Post Delivery Configuration. Further details regarding Security Rows content
                          and identification of the TOE after applying Post Delivery Configuration refer to [9].
                          The Post Delivery Configuration can be accessed using chip health mode functionality in
                          combination with the ISO/IEC 7816 contact interface.
                1.4.2.4         Evaluated package types
                          A number of package types are supported for each major configuration of the TOE. The
                          commercial types are named according to the following format.
                            • P60D024ypp(p)/9Brrff(o) for major configuration P60D024PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D016ypp(p)/9Brrff(o) for major configuration P60D016PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D012ypp(p)/9Brrff(o) for major configuration P60D012PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D024ypp(p)/9Frrff(o) for major configuration P60D024yVF
                            • P60D016ypp(p)/9Frrff(o) for major configuration P60D016yVF
                            • P60D012ypp(p)/9Frrff(o) for major configuration P60D012yVF
                          The commercial type name of each major configuration varies with the package type as
                          indicated by the variable pp and with the Security IC Embedded Software as indicated by
                          the variables rr and ff. Variable y identifies the activation of the firmware emulations.
                          Variable o identifies the EEPROM size of MIFARE Software. The number 9 is used as Fab
                          identifier and B/F references to the silicon version also available at major configuration
                          naming as VB/VF. The variables are replaced according to the rules in Table 10.

                          Table 10. Variable definitions for commercial type names
                           Variable         Definition
                           y                     Emulation Option Configuration for Dual Interface Types (alpha numeric), e.g.
                                                 ‘M’ for MIFARE Plus.
                           pp(p)                 Package delivery type (alpha numeric, last character optional), e.g. “A4” for
                                                 MOB4 module.
                           rr                    ROM code number, which identifies the ROM mask.




                                           All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                               Rev. 4.4 — 29 October 2018                                                                14 of 87
PUBLIC
NXP Semiconductors                                                           P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                          Security Target Lite



                           Variable                               Definition
                           ff                                     FabKey number, which identifies the EEPROM content at TOE delivery.
                           (o)                                    Size of EEPROM area for firmware emulation, e.g. ‘2’ 2kByte MIFARE Plus
                                                                  Emulation. In case no firmware emulation is activated for a commercial type
                                                                  this character is left blank.

                       Table 11 depicts the package types, which are supported in this Security Target, and
                       assigns these to the major configurations. The two characters in each entry of the table
                       stand for the variable pp, and identify the package type. An empty cell means that the
                       Security Target does not support the respective package type for the corresponding major
                       configuration.

                       Table 11.               Supported Package Types
                                P60D024y


                                           P60D016y


                                                       P60D012y




                                                                                                                            Description



                                Ux         Ux         Ux            Wafer not thinner than 50 µm
                                                                    (The letter “x” in “Ux” stands for a capital letter or a number, which
                                                                    identifies the wafer type)
                                Xn         Xn         Xn            Module
                                                                    (The letter “n” in” Xn” stands for a capital letter or a number, which
                                                                    identifies the module type)
                                A4         A4                       MOB4 module
                                A6         A6                       MOB6 module
                                Ai         Ai                       Inlay
                                                                    (The letter ‘i” in “Ai” stands for a capital letter, which identifies both, the inlay
                                                                    type and the package type inside the inlay.)


                       For example, commercial type name P60D024PX0/9Brrff denotes major configuration
                       P60D024yVB(Y/Z/A)/yVF in PDM1.1 dual interface smart card module. The characters ‘rr’
                       and ‘ff’ are individual for each customer product.
                       The package types do not influence the security functionality of the TOE. They only define
                       which pads are connected in the package and for what purpose and in which environment
                       the chip can be used. Note that the security of the TOE is not dependent on which pad is
                       connected or not - the connections just define how the product can be used. If the TOE is
                       delivered as wafer the customer can choose the connections on his own.
                       Security during development and production is ensured for all package types listed above,
                       for details refer to section 1.4.4.
                       The commercial type name identifies major configuration and package type of the TOE as
                       well as the Security IC Embedded Software. However, the commercial type name does not
                       itemize the minor configuration options of the TOE, which are introduced in section 1.4.2.2.
                       Instead, minor configuration options are identified in the Order Entry Form, which is
                       assigned to the ROM code number and the FabKey number of the commercial type name.




                                                      All information provided in this document is subject to legal disclaimers.            © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                             Rev. 4.4 — 29 October 2018                                                                    15 of 87
PUBLIC
NXP Semiconductors                                               P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                     Security Target Lite



                          Minor configuration options as well as configuration options changed by means of Post
                          Delivery Configuration are coded in the Security Rows and can be read out for identification
                          of the TOE. Further details regarding Security Rows content and identification of the TOE
                          after applying Post Delivery Configuration refer to [9].


                  1.4.3 Logical Scope of TOE
                1.4.3.1     Hardware Description
                          The CPU of the P60D024/016/012yVB(Y/Z/A)/yVF supports a 32-/24-/16-/8-bit instruction
                          set and distinguishes five CPU modes, which are summarized in Table 12.

                          Table 12.    CPU modes of the TOE
                                            Super System Mode
                           Boot Mode            Test Mode                            Firmware Mode                     System Mode        User Mode

                          Boot Mode, Test Mode and Firmware Mode are sub-modes of the so-called Super System
                          Mode. These three modes are not available to the Security IC Embedded Software; they
                          are reserved for the Security IC Dedicated Software. The Security IC Dedicated Software is
                          composed of Security IC Dedicated Test Software and Security IC Dedicated Support
                          Software, (Boot-ROM Software and Firmware Operating System) as introduced in section
                          1.4.1. The three software components are mapped one-to-one to the three CPU modes: In
                          Boot Mode the TOE executes the Boot-ROM Software, in Test Mode the TOE executes the
                          IC Dedicated Test Software and in Firmware Mode the TOE executes the Firmware
                          Operating System. Please note that the Super System Mode is not a mode on its own:
                          When the TOE is in Super System Mode, it is always either in Boot Mode, Test Mode or
                          Firmware Mode.
                          The P60D024/016/012yVB(Y/Z/A)/yVF is able to control two different logical phases. After
                          production of the Security IC every start-up or reset completes with Test Mode and
                          execution of the IC Dedicated Test Software. The Test Mode is disabled at the end of the
                          production test. Afterwards, every start-up or reset ends up in System Mode and execution
                          of the Security IC Embedded Software.
                          In case the minor configuration option ‘Post Delivery Configuration’ is enabled and not finally
                          locked by the customer, the resource configuration functionality allows the customer to
                          enable or disable specific functionality of the hardware platform, refer to Table 9.
                          In case the minor configuration option ‘Chip Health/Ident Mode’ is enabled, during the boot
                          process routines either starting built-in self tests checking the functional integrity of the TOE
                          or sending back identification items of the TOE can be activated by the user.
                          System Mode and User Mode are available to the developer of the Security IC Embedded
                          Software. System Mode has unlimited access to the hardware components available to the
                          Security IC Embedded Software. User Mode has restricted access to the CPU, specific
                          Special Function Registers and the memories depending on the access rights granted by
                          software running in System Mode. The hardware components are controlled by the Security
                          IC Embedded Software via Special Function Registers. Special Function Registers are
                          interrelated to the activities of the CPU, the Memory Management Unit, interrupt control, I/O
                          configuration, EEPROM, timers, UART, the contactless interface and the coprocessors.




                                          All information provided in this document is subject to legal disclaimers.                   © NXP B.V. 2018. All rights reserved.

Evaluation documentation                              Rev. 4.4 — 29 October 2018                                                                              16 of 87
PUBLIC
NXP Semiconductors                                            P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                    Security Target Lite



                       The P60D024/016/012yVB(Y/Z/A)/yVF provides two types of interrupts: (i) exception
                       interrupts, called “exception” in the following and (ii) event interrupts, called “interrupts” in
                       the following. Exceptions and interrupts each force a jump to a specific fixed vector address
                       in the ROM. Any exception and interrupt can therefore be controlled and guided by a specific
                       part     of     the    Security     IC     Embedded       Software.      In     addition,    the
                       P60D024/016/012yVB(Y/Z/A)/yVF provides eight firmware vectors (FVEC) and 32 system
                       call vectors (SVEC). These vectors have to be explicitly called by the Security IC Embedded
                       Software. A jump to a firmware vector forces Firmware Mode and starts execution of the
                       Firmware Operating System, a jump to a system call vector forces System Mode.
                       The Watchdog timer is intended to abort irregular program executions by a time-out
                       mechanism and is enabled and configured by the Security IC Embedded Software.
                       The P60D024yVB(Y/Z/A)/yVF incorporates 352 kBytes of ROM, 8.125 kBytes of RAM and
                       24 kBytes of EEPROM. Access control to all three memory types is enforced by a Memory
                       Management Unit. The Memory Management Unit partitions each memory into two                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                       d control
and against download of malicious software before, during and after the user downloads his software. This is
formalized with the objectives O.Cap_Avail_Loader, O.Authentication and O.Ctrl_Auth_Loader requiring
authentication of the TOE to external entities and a trusted communication channel. The O.Authentication
implements a mutual authentication and involves the environment therefore.
And the policies cover also the environmental objective OE.Process-Sec-IC at user premises, as it must be
regardless in which environment the Flash Loader is operated.
The implemented mutual authentication requires first to authenticate the TOE to the external user. This requires
also knowledge by the user about the sequence of the protocol, interpretation of the transferred data and how to
start the authentication of the TOE. This authentication mean counters the threat T.Masquerade_TOE as only
the genuine TOE is able to identify itself correctly to the enabled user, which covers O.Authentication.
The second step of the mutual authentications mean implements the authentication of the user to the TOE. Only
the user enabled to present the correct authentication data and knowing about the sequence, data
interpretation and signaling of the authentication to the TOE is able to proceed further on.
This enforces OE.TOE_Auth, requiring the support of the verification mechanism and known authentication
reference data by the operational environment.

It is normal business that products enabled for software download by the user are either on their way to the user
or are already stored at user premises. At both situations it cannot be excluded that an attacker could manage to
steal such products enabled for software downloads. The ability to download software on a chip without
operating system and/or application is defined as open sample.
This situation generates the threat T.Open_Samples_Diffusion which is defined as follows:
The download of analysis software could enable an attacker to characterize the product and to construct an
attack path out of the gained information.
This threat is countered by the Flash Loader by following rational:
As long as the Flash Loader is active, controlled usage to the Flash Loader functionality (P.Ctrl_Loader) is
enforced which protects the TOE from achieving the status of being an open sample. And more, even the
attacker could observe, meaning in the sense of measurements during, or induce faults during an authorized
download, the Flash Loader protects the user data of the download by confidentiality and integrity protection
means. The Flash Loader functionalities of mutual authentication, establishing a dedicated trusted
communication channel, the encryption and integrity protection means cover the objectives
O.Prot_TSF_Confidentiality, O.Leak-Inherent and O.Leak-Forced.
The policy P.Ctrl_Loader covers also the environmental objective OE.Process-Sec-IC at user                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].            • functionality to calculate the Advanced Encryption Standard (AES) with different key
                        lengths,
                      • support for large integer arithmetic operations like multiplication, addition and logical
                        operations, which are suitable for public key cryptography (e.g. RSA or ECC),
                      • a True Random Number Generator,
                      • memory management control,
                      • cyclic redundancy check (CRC) calculation,
                      • ISO/IEC 7816 contact interface with UART, and
                      • ISO/IEC 14443 A contactless interface supporting.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           