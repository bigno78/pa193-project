  NXP Secure Smart Card
  Controller P6022y VB
  Security Target Lite
  Rev. 2.1 — 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document information
Information     Content
Keywords        CC Security Evaluation, Security Target Lite, Functional Requirements,
                Security Functionality, Assurance Level 6+, P6022y VB, P6022P VB, P6022X
                VB, P6022M VB, P6022D VB, P6022J VB
Abstract        Security Target Lite of the NXP Secure Smart Card Controller P6022y VB,
                which is developed and provided by NXP Semiconductors according to the
                Common Criteria for Information Technology Security Evaluation Version 3.1
                at Evaluation Assurance Level 6 augmented for P6022P VB / P6022X VB /
                P6022M VB / P6022D VB / P6022J VB.
NXP Semiconductors
                                                                                                                P6022y VB
                                                                                                                Security Target Lite


Revision history
Revision     Date         Description
number
2.1          06.04.2018   Derived from P6022y VB Security Target v2.1




P6022y VB                          All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      2 / 101
NXP Semiconductors
                                                                                                                      P6022y VB
                                                                                                                          Security Target Lite


1       ST Introduction
                       This chapter is divided into the following sections: "ST Reference", "TOE Reference",
                       "TOE Overview" and "TOE Description".


                 1.1 ST Reference
                       “NXP Secure Smart Card Controller P6022y VB, Security Target Lite, NXP
                       Semiconductors, Rev. 2.1, 6 April 2018”.


                 1.2 TOE Reference
                                                                                                                      *
                       The TOE is named "NXP Secure Smart Card Controller P6022y VB including IC
                       Dedicated Software". In this document the TOE is abbreviated to NXP Secure Smart
                       Card Controller P6022y VB.


                 1.3 TOE Overview


               1.3.1 Configuration of the TOE
                       The TOE is configurable to P6022P VB which includes IC Dedicated Software,
                       configurable to P6022X VB which includes IC Dedicated Software with extended
                       memory, configurable to P6022M VB which includes IC Dedicated Software with MIFARE
                       Plus MF1PLUSx0, configurable to P6022D VB which includes IC Dedicated Software
                       with MIFARE DESFire EV1, or configurable to P6022J VB which includes IC Dedicated
                       Software with both MIFARE Plus MF1PLUSx0 and MIFARE DESFire EV1.
                       MIFARE functionality does not implement any Security Functional Requirement and its
                       functionality is therefore not in the scope of the evaluation and does not interfere with the
                       security functionality provided by the IC hardware platform.


               1.3.2   Usage and major security functionality of the P6022P VB/P6022X VB
                       The P6022P VB/P6022X VB is composed of the IC hardware platform of NXP Secure
                       Smart Card Controller P6022P VB/P6022X VB, the IC Dedicated Software, and the
                       documentation describing the Instruction Set and the usage. The P6022P VB/P6022X VB
                       is delivered with a customer specific Security IC Embedded Software.
                       The IC hardware platform of NXP Secure Smart Card Controller P6022P VB/P6022X VB
                       is a microcontroller incorporating a central processing unit, memories accessible via a
                       Memory Management Unt,c iryptographic coprocessors, other security components and
                       two communication interfaces. The central processing unit supports a 32-/24-/16-/8-bit
                       instruction set optimized for smart card applications, which is a super set of the 80C51
                       family instruction set. The first and in some cases the second byte of an instruction are
                       used for operation encoding. On-chip memories are ROM, RAM and EEPROM. The non-
                       volatile EEPROM can be used as data or program memory. It consists of high reliable
                       memory cells, which guarantee data integrity. The EEPROM is optimized for applications


                          * MIFARE emulations are not part of the TSF and do not implement any Security Functional Requirement.
                            The evaluation scope of the MIFARE emulations are limited to not interfere with the functionality provided
                            by the IC hardware platform.
P6022y VB                                All information provided in this document is subject to legal disclaimers.         © NXP B.V. 2018. All rights reserved.

Evaluation document                                      Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                                3 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      requiring reliable non-volatile data storage for data and program code. Dedicated security
                      functionality protects the contents of all memories.
                      The IC Dedicated Software for NXP Secure Smart Card Controller P6022P VB/P6022X
                      VB comprises IC Dedicated Test Software for test purposes and IC Dedicated Support
                      Software. The IC Dedicated Support Software consists of Boot-ROM Software which
                      controls the boot process of the hardware platform and Plain Firmware Operating System
                      (FOS-Plain) which can be called by the Security IC Embedded Software. The FOS-
                      Plain provides an interface for programming of the internal EEPROM memory, which
                      is mandatory for use by the Security IC Embedded Software when programming the
                      EEPROM memory. Also, the FOS-Plain provides an interface for the Post Delivery
                      Configuration functionality.
                      The documentation includes a Product Data Sheet, an Instruction Set, a Guidance
                      and Operation Manual, two Wafer and delivery specifications (according to Fab) and
                      a Firmware Interface Specification Product data sheet addendum. This documentation
                      comprises a description of the architecture, the secure configuration and usage of the
                      IC hardware platform and the IC Dedicated Software by the Security IC Embedded
                      Software.
                      The security functionality of the P6022P VB/P6022X VB is designed to act as an integral
                      part of a complete security system in order to strengthen the design as a whole. Several
                      security mechanisms are completely implemented in and controlled by the P6022P VB/
                      P6022X VB. Other security mechanisms allow for configuration or even require handling
                      of exceptions by the Security IC Embedded Software. The different CPU modes and the
                      Memory Management Unit support the implementation of multi-application projects using
                      the P6022P VB/P6022X VB.
                      A Security IC must provide high security in particular when being used in the banking
                      and finance market, in electronic commerce or in governmental applications because
                      the P6022P VB/P6022X VB is intended to be used in a potential insecure environment.
                      Hence the P6022P VB/P6022X VB shall maintain
                      • the integrity and the confidentiality of code and data stored in its memories,
                      • the different CPU modes with the related capabilities for configuration and memory
                        access and
                      • the integrity, the correct operation and the confidentiality of security functionality
                        provided by the P6022P VB/P6022X VB.
                      This is ensured by the construction of the P6022P VB/P6022X VB and its security
                      functionality.
                      NXP Secure Smart Card Controller P6022P VB/P6022X VB basically provides a
                      hardware platform for an implementation of a smart card application with
                      • functionality to calculate the Data Encryption Standard (Triple-DES) with up to three
                        keys,
            JCOP 4.7 SE051
  Security Target Lite
  Rev. 1.3 — 30 June 2020                                         Evaluation document
  NSCIB-CC-0095534                                                             PUBLIC




Document information
Information     Content
Keywords        ASE, JCOP, Common Criteria, EAL6 augmented
Abstract        This document contains information to fulfill the requirements of the Common
                Criteria component ASE (Security Target) for the Evaluation of the JCOP
                4.7 SE051 developed and provided by NXP Semiconductors, Business Unit
                Security & Connectivity, according to the Common Criteria for Information
                Technology Security Evaluation Version 3.1 at EAL6 augmented
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


Revision history
Rev          Date           Description
1.3          30 June 2020   Initial version.




JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                              2 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


1       ST Introduction (ASE_INT)

                 1.1 ST Reference and TOE Reference
                      Table 1. ST Reference and TOE reference
                      Title          JCOP 4.7 SE051 Security Target Lite
                      Version        Revision 1.3
                      Date           30 June 2020
                      Product Type   Java Card
                      TOE name       JCOP 4.7 SE051
                      Certification ID NSCIB-CC-0095534
                      CC version     Common Criteria for Information Technology Security Evaluation Version 3.1,
                                     Revision 5, April 2017 (Part 1 [1], Part 2 [2] and Part 3 [3])


                 1.2 TOE Overview
                      The TOE consists of the Micro Controller and a software stack which is stored on the
                      Micro Controller and which can be executed by the Micro Controller. The software stack
                      can be further split into the following components:
                      • Firmware for booting and low level functionality of the Micro Controller (MC FW)
                        like writing to flash memory. This includes software for implementing cryptographic
                        operations, called Crypto Library.
                      • Software for implementing a Java Card Virtual Machine [15], a Java Card Runtime
                        Environment [16] and a Java Card Application Programming Interface [14], called
                        JCVM, JCRE and JCAPI.
                      • Software for implementing content management according to GlobalPlatform [17],
                        called GlobalPlatform (GP) Framework.
                      • Software for executing native libraries, called Secure Box.
                      The TOE is referred to as JCOP 4.7 SE051. The JCOP 4 Operating System (JCOP 4
                      OS) consists of the software stack without the Crypto Library (Crypto Lib) and without
                      the Micro Controller Firmware (MC FW). The TOE uses one or more communication
                      interfaces to communicate with its environment.
                      The complete TOE is depicted in Figure 1. The elements are described in more detail in
                      Section 1.3 "TOE Description".




JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                             3 / 120
NXP Semiconductors
                                                                                                                               JCOP 4.7 SE051
                                                                                                                                           Security Target Lite




                                                                                Communication Interface(s)
                                                                                    to Environment



         Java Card Applets                                                                                      Secure
                                                                                                                 Secure
                                                                                                                 Box
                                                                                                                  Box
                  User
                    User
                 Applet
                                            GP Framework                                                        Native
                                                                                                                 Native
                   Applet
                                                                                                                  Lib
                                                                                                                   Lib

                                                                                                                                              Optional
                                                                                                                                            Functionality

                            JCVM, JCRE and JCAPI

                                                                                                                               SecureBox
                                                      MC FW and
                                                     Crypto Library


                                                                       Micro Controller



                                  TOE Border                                                                    Optional interaction
                                                                                                                 CC Certified Hardware,
                                  JCOP 4 OS                                                                      Firmware and Crypto Lib
                                  Not certified


 Figure 1. Components of the TOE

                               Figure 1 shows the components of the TOE. The TOE is a composite product on top
                               of CC certified Hardware, Firmware and Crypto Library. Part of the TOE are the JCVM,
                               JCRE, JCAPI and the GP Framework. Also included is optional functionality and the
                               Secure Box mechanism. The Secure Box Native Librarys provide native functions for
                               untrusted third parties and are not part of the TOE.
                               The figure shows Java Card applets which are small programs in Java language that can
                               be executed by the TOE, but are not part of the TOE.

                     1.2.1 Usage and Major Security Features of the TOE
                               The usage of the TOE is focused on security critical applications in small form factors.
                               One main usage scenario is the use of so called smart cards. Examples of such cards
                               are banking cards or electronic drivers’ licenses. The TOE can also be used in an
                               electronic passport. Another usage scenario is device authentication, where the TOE can
                               be used to prove the authenticity or originality of a device like an accessory for a gaming
                               console.
                               The TOE provides a variety of security features. The hardware of the Micro Controller
                               already protects against logical and physical attacks by applying various sensors to
                               detect manipulations and by processing data in ways which protect against leakage
                               of data by side channel analysis. With the software stack the TOE provides many

JCOP 4.7 SE051                                    All information provided in this document is subject to legal disclaimers.                 © NXP B.V. 2020. All rights reserved.

Evaluation document                                              Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                                 4 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                      cryptographic primitives for encryption and decryption of data but also for signing and
                      signature verification. Also the software stack contains security features to protect
                      against attacks.
                      The following list contains the features of this TOE:
                      • Supported communication protocols:
                        1. ISO 7816 T=1.
                        2. ISO 7816 T=0.
                        3. ISO 14443 T=CL.
                        4. I2C Slave.
                      • Cryptographic algorithms and functionality:
                        1. Data Encryption Standard with 3 keys (3DES) for en-/decryption (CBC and ECB)
                           and MAC generation and verification (Retail-MAC, CMAC and CBC-MAC).
                        2. Advanced Encryption Standard (AES) for en-/decryption (CBC, ECB and counter
                           mode) and MAC generation and verification (CMAC, CBC-MAC).
                        3. Rivest Shamir Adleman asymmetric algorithm (RSA) and RSA CRT for en-/
                           decryption and signature generation and verification.
                                                                                              1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].            • functionality to calculate the Advanced Encryption Standard (AES) with different key
                        lengths,
                      • support for large integer arithmetic operations like multiplication, addition and logical
                        operations, which are suitable for public key cryptography (e.g. RSA or ECC),
                      • a True Random Number Generator,
                      • memory management control,
                      • cyclic redundancy check (CRC) calculation,
                      • ISO/IEC 7816 contact interface with UART, and
                      • ISO/IEC 14443 A contactless interface supporting.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                         4 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      In addition, several security mechanisms are implemented to ensure proper operation
                      as well as integrity and confidentiality of stored data. For example, this includes security
                      mechanisms for memory protection and security exceptions as well as sensors, which
                      allow operation under specified conditions only. Memory encryption is used for memory
                      protection and chip shielding is added to the chip.

                      Note: Large integer arithmetic operations are intended to be used for calculation of
                      asymmetric cryptographic algorithms. Any asymmetric cryptographic algorithm utilizing
                      the support for large integer arithmetic operations has to be implemented in the Security
                      IC Embedded Software. Thus, the support for large integer arithmetic operations itself
                      does not provide security functionality like cryptographic support. The Security IC
                      Embedded Software implementing an asymmetric cryptographic algorithm is not included
                      in this evaluation. Nevertheless the support for large integer arithmetic operations is
                      part of the Security IC and therefore a security relevant component of the P6022P VB/
                      P6022X VB, that must resist to the attacks mentioned in this Security Target and that
                      must operate correctly as specified in the data sheet. The same scope of evaluation is
                      applied to the CRC calculation.


               1.3.3 Usage and major security functionality of the P6022M VB/P6022D VB/
                     P6022J VB
                      The P6022M VB/P6022D VB/P6022J VB variants provide the all security functionality as
                      the afore mentioned P6022P VB/P6022X VB variants.
                      In addition to P6022P VB/P6022X VB, NXP Secure Smart Card Controller P6022M
                      VB/P6022D VB/P6022J VB includes Emulation MIFARE Plus MF1PLUSx0 or MIFARE
                      DESFire EV1 or both MIFARE Plus MF1PLUSx0 and MIFARE DESFire EV1 in the
                      FOS-Emu and is, therefore, part of the TOE. Note that MIFARE Plus MF1PLUSx0 and
                      MIFARE DESFire EV1 are represented by the term MIFARE Software in this document.
                      The MIFARE Software provides a set of functions used to manage the data stored in the
                      non-volatile EEPROM memory owned by MIFARE Software respectively.
                      Note that the Firmware Operating System (FOS) for the hardware platform is called the
                      Plain Firmware Operating System (FOS-Plain) and the Firmware Operating System for
                      the MIFARE Software Emulation is called the Emulation Firmware Operating System
                      (FOS-Emu).
                      The documentation includes a Product Data Sheet, an Instruction Set, a Guidance
                      and Operation Manual, two Wafer and delivery specification (according to Fab) and
                      a Firmware Interface Specification Product data sheet addendum. For the TOE
                      with MIFARE Software, the documentation additionally includes a Functionality of
                      implementation of MIFARE Software and a Guidance, Delivery and Operation Manual
                      of MIFARE Software. This documentation comprises a description of the architecture,
                      the secure configuration and usage of the IC hardware platform and the IC Dedicated
                      Software by the Security IC Embedded Software.
                      MIFARE functionality does not implement any Security Functional Requirement and its
                      functionality is therefore not in the scope of the evaluation and does not interfere with the
                      security functionality provided by the IC hardware platform.


               1.3.4 TOE Type
                      The TOE NXP Secure Smart Card Controller P6022y VB is provided as IC hardware
                      platform for various operating systems and applications with high security requirements.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2
                                                                                   1
                        8. Diffie-Hellman with ECDH and modular exponentiation .
                        9. SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                        10.Following cryptographic algorithms are part of the TOE but without claims for
                           security functional requirements:
                                                                                 1
                           a. AES in Counter with CBC-MAC mode (AES CCM) .
                                                                                    1
                           b. Keyed-Hash Message Authentication Code (HMAC) .
                                                                                  1
                           c. HMAC based Key Derivation Function (HKDF) [28] .
                                                                                        1
                           d. Elliptic Curve Direct Anonymous Attestation (ECDAA) [30] .
                                                                                                     1
                           e. Elliptic curve cryptography based on Edwards and Montgomery curves .
                      • Java Card functionality:
                        1. Executing the Java byte codes which are generated from the Java compiler when
                           Java source code is compiled.
                        2. Managing memory allocation of code and data of applets.
                        3. Enforcing access rules between applets and the JCRE.
                        4. Mapping of Java method calls to native implementations of e.g. cryptographic
                           operation.
                        5. Support for Extended Length APDUs.
                        6. Garbage Collection with memory reclamation and compaction.
                        7. Persistent Memory Management and Transaction Mechanism.
                      • GlobalPlatform functionality:
                        1. Loading of Java packages.
                        2. Instantiating applet instances.
                        3. Removing of Java packages.
                        4. Removing of applet instances.
                        5. Issuer Security Domain (ISD), Supplementary Security Domain (SSD).

                         1 Optional functionality
JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                5 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                        6. Creating SSDs.
                        7. Associating applets to Security Domains.
                        8. Installation of keys.
                        9. Verification of signatures of signed applets.
                        10.Verification of signatures for commands.
                        11.CVM Management (Global PIN).
                        12.Secure Channel Protocol (SCP01, SCP02 and SCP03).
                        13.Delegated Management, Data Authentication Pattern (DAP).
                        14.Post-issuance installation and deletion of applets and packages.
                        15.Compliance to several GP configurations.
                        16.Executable Load File Upgrade.
                        17.Secure Element Management Service.
                      • NXP Proprietary Functionality
                                        2
                        1. Secure Box .
                        2. Java Card APIs for:
                           – Data encryption via PUF [12].
                           – Data integrity protection with an EDC.
                           – Asserting results of sensitive functions.
                                                                         2
                        3. Time representation and counter functionality .

                 1.2.2 TOE Type
                      The TOE is a Java Card with a GP Framework. It can be used to load and execute off-
                      card verified Java Card applets.

                 1.2.3 Required non-TOE Hardware/Software/Firmware
                      Three groups of users shall be distinguished here.
                      The first group is the end-users group, which uses the TOE with one or more loaded
                      applets in the final form factor like a banking card or an electronic passport. These users
                      only require a communication device to be able to communicate with the TOE. The
                      communication protocol of the TOE is standardized in either ISO7816 [31] (T=1, T=0),
                      ISO14443 [32] (T=CL), or UM10204 [33] (I2C Slave).
                      The second group of users are administrators of cards. They want to configure the
                      card by using the Configuration Module, to install additional applets and to configure and
                      personalise these applets. These users require the same equipment as end-users.
                      The third group of users wants to develop Java Card applets and execute them on
                      the TOE. These applet developers need in addition to the communication device a
                      set of tools for the development of applets. This set of tools can be obtained from the
                      TOE vendor and comprises elements such as PC development environment, byte code
                      verifier, compiler, linker and debugger.




                         2 Optional functionality
JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                6 / 120
NXP Semiconductors
                                                                                                                              JCOP 4.7 SE051
                                                                                                                                   Security Target Lite


                     1.3 TOE Description

                    1.3.1 TOE Components and Composite Certification
                           The certification of this TOE is a composite certification. The following sections provide
                           a more detailed description of the components of Figure 1. It is also made clear whether
                           a component is covered by a previous certification or whether it is covered in the
                           certification of this TOE.

                  1.3.1.1 Micro Controller

                           The Micro Controller is a secure smart card controller from NXP’s SmartMX3 family.
                           The Micro Controller contains a co-processor for symmetric cryptographic operations,
                           supporting DES and AES, as well as an accelerator for asymmetric cryptographic
                           algorithms. The Micro Controller further contains a physical random number generator.
                           The supported memory technologies are volatile (Random Access Memory (RAM)) and
                           non-volatile (Read Only Memory (ROM) and FLASH) memory.
                           Access to all memory types is controlled by a Memory Management Unit (MMU) which
                           allows to separate and restrict access to parts of the memory.
                           The Micro Controller has been certified in a previous certification and the results are re-
                           used for this certification. The exact reference to the previous certification is given in the
                           following Table 2 "Reference to Certified Micro Controller":

                           Table 2. Reference to Certified Micro Controller
                           Name                            NXP Secure Smart Card Controller N7121 with IC Dedicated Software and
                                                                          [1]
                                                           Crypto Library
                           Certification ID                BSI-DSZ-CC-1040
                           Reference                       [10]

                           [1]   The SE051 hardware is an instantiation of the N7121 hard macro with I2C side-car.


                  1.3.1.2 Security IC Dedicated Software

                 1.3.1.2.1 MC FW (Micro Controller Firmware)

                           The Micro Controller Firmware is used for testing of the Micro Controller at production,
                           for booting of the Micro Controller after power-up or after reset, for configuration of
                           communication devices and for writing data to volatile and non-volatile memory.
                           The MC FW has been certified together with the Micro Controller and the same reference
                           [10] as given for the Micro Controller also apply for the MC FW.

                 1.3.1.2.2 Crypto Library

                           The Crypto Library provides implementations for symmetric and asymmetric
                           cryptographic operations, hashing, the generation of hybrid deterministic and hybrid
                           physical random numbers and further functions like secure copy and compare.
                           Some of the cryptographic algorithms offered by the Crypto Lib are not certified, see
                           Section 1.3.1.4 "Excluded functionality".
                           The symmetric cryptographic operations comprise the algorithms 3DES and AES. These
                           algorithms use the symmetric co-processor of the Micro Controller.



JCOP 4.7 SE051                                   All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                             Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                         7 / 120
NXP Semiconductors
                                                                                                                      JCOP 4.7 SE051
                                                                                                                           Security Target Lite


                          The supported asymmetric cryptographic operations are ECC and RSA. These
                          algorithms use the Public Key Crypto Coprocessor (PKCC) of the Micro Controller for the
                          cryptographic operations.
                          The Crypto Library has been certified together with the Micro Controller and the same
                          reference [10] as given for the Micro Controller also applies.

                  1.3.1.3 Security IC Embedded Software

                 1.3.1.3.1 JCOP 4.7 SE051

                          The OS of the TOE consists of JCVM, JCRE, JCAPI and GP framework. It is
                          implemented according to the Java Card Specification and GlobalPlatform. Additionally it
                          consists of a proprietary API, which is described in the UGM [9].
                          The TOE can be identified by using the IDENTIFY APDU command (see UGM [9]). This
                          command returns the card identification data, which includes a Platform ID, a Patch ID
                          and other information that allows to identify the content in ROM, FLASH and loaded
                          patches (if any).
                          The TOE also includes a Configuration Module (see Section 1.3.2 "Optional TOE
                          Functionality") which is used for personalisation and configuration of the TOE. It must be
                          deleted after the personalisation is finished (end of Phase 6 ”Personalisation”) by using
                          the DELETE APDU command. Once the Configuration Module is deleted, it is no longer
                          possible to configure the TOE.
                    018
PUBLIC                                                                                                                                         5 / 101
NXP Semiconductors
                                                                                                                    P6022y VB
                                                                                                                    Security Target Lite



               1.3.5 Required non-TOE hardware/software/firmware
                        None


                 1.4 TOE Description

               1.4.1 Physical Scope of TOE


              1.4.1.1   NXP Secure Smart Card Controller P6022P VB/P6022X VB
                        NXP Secure Smart Card Controller P6022P VB/P6022X VB is manufactured in an
                        advanced 90nm CMOS technology. The block diagram of the IC hardware platform of
                        P6022y VB is depicted in Fig. 1.




 Figure 1. Block Diagram of NXP Secure Smart Card Controller P6022y VB

                        The P6022P VB/P6022X VB contains the IC hardware platform and the IC Dedicated
                        Software which is composed of IC Dedicated Test Software and IC Dedicated Support
                        Software. All other software is called Security IC Embedded Software. The Security IC
                        Embedded Software is not part of the P6022P VB/P6022X VB.
                        This Security Target claims conformance to the assurance package EAL6 augmented for
                        the P6022P VB/P6022X VB. Please refer Section 2.2 for details.




P6022y VB                              All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                    Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                          6 / 101
NXP Semiconductors
                                                                                                                                P6022y VB
                                                                                                                                  Security Target Lite



              1.4.1.2 NXP Secure Smart Card Controller P6022M VB/P6022D VB/P6022J VB
                         NXP Secure Smart Card Controller P6022M VB/P6022D VB/P6022J VB is manufactured
                         in an advanced 90nm CMOS technology. The block diagram of the IC hardware platform
                         of P6022M VB/P6022D VB/P6022J VB is depicted in Fig. 1.
                         The P6022M VB/P6022D VB/P6022J VB contains the IC hardware platform (see Fig. 1)
                         and the IC Dedicated Software which is composed of IC Dedicated Test Software and
                         IC Dedicated Support Software including MIFARE Software. All other software is called
                         Security IC Embedded Software. The Security IC Embedded Software is not part of the
                         P6022M VB/P6022D VB/P6022J VB.
                         This Security Target claims conformance to the assurance package EAL6 augmented for
                         the P6022M VB/P6022D VB/P6022J VB. Please refer Section 2.2 for details.
                         MIFARE functionality does not implement any Security Functional Requirement and its
                         functionality is therefore not in the scope of the evaluation and does not interfere with the
                         security functionality provided by the IC hardware platform.


              1.4.1.3 TOE Components
                         The TOE components of NXP Secure Smart Card Controller P6022y VB are
                         composed of the IC hardware platform (see Fig. 1), the IC Dedicated Software, and the
                         documentation.
                         The IC Dedicated Software consists of a IC Dedicated Test Software and IC Dedicated
                         Support Software. The IC Dedicated Test Software contains the Test-ROM Software, and
                         the IC Dedicated Support Software contains the Boot-ROM Software and the Firmware
                         Operating System. Please note that for the ATMC samples the romcode contents and
                         options are a 1:1 copy of the romcode LR009 on device 9072B.
                         The version of the Firmware Operating System as part of the IC Dedicated Support
                         Software can be read-out by Security IC Embedded Software using FVEC interface as
                         specified in [17], Section 2.1.9 Emulation Control Interface (FVEC0).

            1.4.1.3.1     NXP Secure Smart Card Controller P6022P VB
                         The TOE components of NXP Secure Smart Card Controller P6022P VB are listed in
                         Table 1.

Table 1. TOE Components for P6022P VB
Type                  Name                                     Release                  Date                           Form of delivery
IC Hardware           NXP Secure Smart Card                    VB                       18 January 2016                wafer, module, inlay, package
                      Controller P6022P VB                                                                             (dice have nameplate 9072B or
                                                                                                                       F072A)
Security IC           Test-ROM Software                        10.1D                    25 April 2015                  Test-ROM on the chip acc. to
Dedicated Test                                                                                                         9072A_LK097_TESTROM_v1
Software                                                                                                               _btos_10v1D_fos_Cv21rc5.hex
                                                                                                                       (0C.22) / 9072B_LR009_
                                                                                                                       TESTROM_v1_btos_10v1D_fos_
                                                                                                                       Cv6.hex (0C.60) / F072A_ZK015_
                                                                                                                       TESTROM_v1_btos_10v1D_fos_
                                                                                                                       Cv6.hex (0C.60)




P6022y VB                                 All information provided in this document is subject to legal disclaimers.                 © NXP B.V. 2018. All rights reserved.

Evaluation document                                       Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                                         7 / 101
NXP Semiconductors
                                                                                                                                P6022y VB
                                                                                                                                  Security Target Lite


Type                  Name                                     Release                  Date                           Form of delivery
Security IC           Boot-ROM Software                        10.1D                    25 April 2015                  Boot-ROM on the chip acc. to
      The TOE contains further functionality for integrity protection of user data via an
                          EDC, encryption of user data via PUF [12] and optional functionality as described in
                          Section 1.3.2 "Optional TOE Functionality".

                  1.3.1.4 Excluded functionality

                          All Secure Box Native Libraries are not part of the TOE. No security functional
                          requirements are claimed on AES CCM, HMAC, HKDF, ECDAA, elliptic curve
                          cryptography based on Edwards and Montgomery curves and FIPS self-tests, they are
                          TSF non-interfering.

                   1.3.2 Optional TOE Functionality
                          Some dedicated functionality of the TOE as listed below can be removed:
                          • RSA key generation,
                          • Elliptic curve cryptographic functionalityDedicated                                           ,
                              