urces for the Applet;
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 12/150
                        eMRTD Configuration)

        o  Global Platform Card Manager, responsible for management of Applets
           on the card.
        o Mifare implementation can be enabled or disabled for this TOE.
        o Crypto Library.
    The Applet Layer is IDeal Pass v2.3-n JC with Privacy Protection
     (SAC/EAC/Polymorphic eMRTD Configuration) applet.




                                        Figure 1: TOE



1.4.2 TOE usage and security features for operational use
Depending on its configuration during pre-personalisation and personalisation,
the TOE can be used as:
    ICAO/EAC eMRTD,
    Polymorphic eMRTD and
    EU/ISO Driving Licence.

The ICAO/EAC eMRTD, Polymorphic eMRTD and Driver Licence are installed as a
separate application instances of the applet having their own dedicated
application identifiers and personalisation. The following TOE configurations are
covered within the scope of this Security Target:

    Configuration ICAO/EAC            Polymorphic        Driver licence
                  eMRTD               eMRTD
    1             present             -                  -
    2             present             present            -
    3             -                   -                  present
    4             -                   present            present
    5             -                   Present            -

The authentication protocols PACEv2, Chip authentication (CAv1), Active
Authentication and Terminal Authentication (TAv1) specified in [ICAO-9303] and
                         Security Target Lite
                                                                             Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                       2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                         Page: 13/150
           Document Basic Access Keys.

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6                Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.6.1              The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE during a BAC mechanism based communication after successful
                          authentication of the terminal with Basic Access Control Authentication
                          Mechanism.




 FIA_AFL.1                Authentication failure handling

 Hierarchical to:         No other components.

 Dependencies:            FIA_UAU.1 Timing of authentication

 FIA_AFL.1.1              The TSF shall detect when a configurable number (see application note below) of
                          unsuccessful authentication attempts occur related to authentication attempts
                          using the BAC password as shared password.

 FIA_AFL.1.2              When the defined number of unsuccessful authentication attempts has been met
                          the TSF shall increasingly slow down the performance up to a maximum not
                          higher than 7 seconds verifying the authentication token.

 [IFX specific]           The number of failed authentication attempts is configurable. This configurable
                          number can be in the range [1..7f].
 Application note




CC Document                                          35
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.3             Class FDP User Data Protection


 FDP_ACC.1                Subset access control – Basic Access control

 Hierarchical to:         No other components

 Dependencies:            FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1              The TSF shall enforce the Basic Access Control SFP on terminals gaining write,
                          read and modification access to data in the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of
                          the logical MRTD.




 FDP_ACF.1                Basic Security attribute based access control – Basic Access Control

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACC.1 Subset access control, FMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1              The TSF shall enforce the Basic Access Control SFP to objects based on the
                          following:
                          1. Subjects:
                                                     a) Personalisation Agent,
                                                     b) Basic Inspection System,
                                                     c) Terminal,
                          2. Objects
                                                     a) data EF.DG1 to EF.DG16 of the logical MRTD,
                                                     b) data in EF.COM,
                                                     c) data in EF.SOD,
                          3. Security attributes
                                                     a) authentication status of terminals

 FDP_ACF.1.2              The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed:
                          1. the successfully authenticated Personalisation Agent is allowed to write and to
                             read the data of the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of the logical MRTD,
                          2. the successfully authenticated Basic Inspection System is allowed to read the
                             data in EF.COM, EF.SOD, EF.DG1, EF.DG2 and EF.DG5 to EF.DG16 of the logical
                             MRTD.

 FDP_ACF.1.3              The TSF shall explicitly authorise access of subjects to objects based on the
                          following additional rules: none.


CC Document                                           36
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_ACF.1.4              The TSF shall explicitly deny access of subjects to objects based on the rule:
                          1. Any terminal is not allowed to modify any of the EF.DG1 to EF.DG16 of the
                             logical MRTD.
                          2. Any terminal is not allowed to read any of the EF.DG1 to EF.DG16 of the logical
                             MRTD.
                          The Basic Inspection System is not allowed to read the data in EF.DG3 and EF.DG4.

 Refinement:              This SFR was refined (deletion of 3. from the list of Objects) as the optional EF.DG3
                          and EF.DG4 are not created and therefore do not exist.




 FDP_UCT.1                Basic data exchange confidentiality - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]

 FDP_UCT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from unauthorized disclosure.




 FDP_UIT.1                Data exchange integrity - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                          [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]

 FDP_UIT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from modification, deletion, insertion and
                          replay errors.

 FDP_UIT.1.2              The TSF shall be able to determine on receipt of user data, whether modification,
                          deletion, insertion and replay has occurred.




CC Document                                           37
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.4             Class FAU Security Audit


 FAU_SAS.1/BAC            Audit storage

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FAU_SAS.1.1/BAC          The TSF shall provide the Manufacturer with the capability to store the IC
                          Identification Data in the audit records.




7.1.4.5             Class FMT Security Management


 FMT_SMF.1/BAC            Specification of Management Functions

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies

 FMT_SMF.1.1/BAC          The TSF shall be capable of performing the following management functions:
                          1. Initialization,
                          2. Pre-Personalisation,
                          3. Personalisation.



 FMT_SMR.1                Security roles

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE

 FMT_SMR.1.1              The TSF shall maintain the roles
                          1. Manufacturer,
                          2. Personalisation Agent,
                          3. Basic Inspection System


CC Document                                          38
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_SMR.1.2              The TSF shall be able to associate users with roles.




 FMT_LIM.1/BAC            Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability: fulfilled by FMT_LIM.2

 FMT_LIM.1.1 /BAC         The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with ‘Limited availability (FMT_LIM.2) the following policy is enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks




 FMT_LIM.2/BAC            Limited availability

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.1 Limited capabilities: fulfilled by FMT_LIM.

 FMT_LIM.2.1/BAC          The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with ‘Limited capabilities (FMT_LIM.1)’ the following policy is
                          enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks



 FMT_MTD.1/INI_DIS/BAC         Management of TSF data – Reading and Using Initialisation and Pre-
                               Personalisation Data

 Hierarchical to:              No other components.


CC Document                                           39
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:               FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                             FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/INI_DIS/BAC     The TSF shall restrict the ability to disable read access for users to the
                             Initialisation Data to the Personalisation Agent.




 FMT_MTD.1/KEY_WRITE        Management of TSF data – Key Write

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_WRITE      The TSF shall restrict the ability to write the Document Basic Access Keys to the
                            Personalisation Agent.




 FMT_MTD.1/KEY_READ/BAC         Management of TSF data – Key Read

 Hierarchical to:               No other components.

 Dependencies:                  FMT_SMF.1 Specification of management functions fulfilled by FMT_SMF.1
                                FMT_SMR.1 Security roles fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/KEY_READ/BAC       The TSF shall restrict the ability to read the Document Basic Access Keys and
                                Personalisation Agent Keys to none.




7.1.4.6             Class FPT Protection of the Security Functions


 FPT_EMSEC.1              TOE Emanation

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies.

CC Document                                           40
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMSEC.1.1            The TOE shall not emit electromagnetic and current emissions in excess of none
                          useful information enabling access to Personalisation Agent Key(s) and Document
                          Basic Access Keys

 FPT_EMSEC.1.2            The TSF shall ensure any unauthorized users are unable to use the following
                          interface smart card circuit contacts to gain access to Personalisation Agent Key(s)
                          and Document Basic Access Keys.




 FPT_FLS.1/BAC            Failure with preservation of secure state

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_FLS.1.1              The TSF shall preserve a secure state when the following types of failures occur:
                          1. Exposure to out-of-range operating conditions where therefore a malfunction
                             could occur,
                          2. Failure detected by TSF according to FPT_TST.1,




7.1.5               SFRs specifically from [PP_EAC]

7.1.5.1             Cryptographic support


 FCS_CKM.1/CA             Cryptographic key generation – Diffie-Hellman for Chip Authentication
                          session keys

 Hierarchical to:          No other components.

 Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                          operation]




CC Document                                          41
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_CKM.1.1/CA           The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm ECDH cryptographic key generation
                          algorithm and specified cryptographic key sizes:
                          id-CA-ECDH-3DES-CBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or FCS_CKM.1


CC Document                                          43
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                                        Cryptographic key generation]FCS_CKM.4 Cryptographic key
                                        destruction

 FCS_COP.1.1/CA_MAC                     The TSF shall perform secure messaging – message authentication
                                        code in accordance with a specified cryptographic algorithm AES CMAC
                                        and 3DES-CBC and cryptographic key sizes 128, 192, 256 bits for AES
                                        CMAC and 112 for 3DES-CBC that meet the following: compliant to
                                        [ICAO_SAC] .


                                        Personalisation of the TOE is done using the secure channel protocol
 [IFX specific]
                                        03 as specified in [GPv2_3_1] with AES 256 bits key length with CMAC
 Application note                       compliant with NIST 800-38A.




7.1.5.3             Class FIA Identification and Authentication


The following table provides an overview of the authentication mechanisms used.

 Name                                                               SFR for the TOE

 Authentication Mechanism for Personalisation Agents                FIA_UAU.4/PACE
 Chip authentication v.1                                            FIA_API.1,
                                                                    FIA_UAU.5/PACE,
                                                                    FIA_UAU.6/EAC

 Chip Active Authentication                                         FIA_API.1/AA
 Terminal Authentication Protocol v.1                               FIA_UAU.5/PACE
 PACE protocol (listed only for information purposes, so will not   FIA_UAU.1/PACE
 be described further in this section)                              FIA_UAU.5/PACE
                                                                    FIA_AFL.1/PACE

 Passive authentication                                             FIA_UAU.5/PACE




 FIA_API.1/AA              Authentication Proof of Identity (Active Authentication)

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.


CC Document                                            44
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          The TSF shall provide the Active Authentication Mechanisms according to
 FIA_API.1.1/AA
                          [ICAO_9303_1] to prove the identity of the TOE.


 [IFX specific]           The SFR FIA_API.1/AA has been included in this security target in addition to the
 Application Note:        SFRs defined by the Protection Profiles claimed in section 3.2. This extension does
                          not conflict with the strict conformance to the claimed Protection Profiles.




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110_1]
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-03110_1]
                          (see next item 6)
                           6. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is identified.


 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel


CC Document                                            45
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key
                          5. to carry out the Chip Authentication Protocol Version 1 according to [TR-
                          03110_1]
                          6. to carry out the Terminal Authentication Protocol Version a 1ccording to [TR-
                          03110_1] (see next item 7)
                           7. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is authenticated.



 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




                          Single-use authentication mechanisms - Single-use authentication of the
 FIA_UAU.4/PACE
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according [ICAO_SAC],
                          2. Authentication Mechanism based on Triple- DES or AES .
                          3. Terminal Authentication Protocol v.1 according to [TR-03110_1].




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide

CC Document                                            46
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. PACE Protocol according to [ICAO_SAC],
                          2. Passive Authentication according to [ICAO_9303_01],
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC],
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                              length
                          5. Terminal Authentication Protocol v.1 according to [TR-03110_1],
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                          commands with correct message authentication code sent by means of secure
                          messaging with the key agreed with the terminal by means of the PACE protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by secure
                          channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key length.
                          3. After run of the Chip Authentication Protocol Version 1 the TOE accepts only
                          received commands with correct message authentication code sent by means of
                          secure messaging with key agreed with the terminal by means of the Chip
                          Authentication Mechanism v1.
                          4. The TOE accepts the authentication attempt by means of the Terminal
                          Authentication Protocol v.1 only if the terminal uses the public key presented
                          during the Chip Authentication Protocol v.1 and the secure messaging established
                          by the Chip Authentication Mechanism v.1 19.
                          5. None

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6/EAC            Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.




CC Document                                          47
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE after successful run of the Chip Authentication Protocol Version 1 shall
                          be verified as being sent by the Inspection System.




 FIA_API.1                 Authentication Proof of Identity

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.

 FIA_API.1.1              The TSF shall provide a Chip Authentication Protocol Version 1 according to [TR-
                          03110_1] to prove the identity of the TOE.




7.1.5.4             Class User Data Protection


 FDP_ACC.1/TRM             Subset access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1/TRM          The TSF shall enforce the Access Control SFP on terminals gaining access to the
                          User Data and data stored in EF.SOD of the logical travel document



The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below
(Common Criteria Part 2).



 FDP_ACF.1/TRM             Security attribute based access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACC.1 Subset access controlFMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1/TRM           The TSF shall enforce the Access Control SFP to objects based on the following:

CC Document                                          48
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. Subjects:
                            a.Terminal,
                            b.BIS-PACE
                            c.Extended Inspection System
                          2. Objects:
                             a.data in EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                          logical travel document ,
                            b.data in EF.DG3 of the logical travel document ,
                            c.data in EF.DG4 of the logical travel document ,
                            d.all TOE intrinsic secret cryptographic keys stored in the travel document
                          3. Security attributes:
                            a.PACE Authentication
                            b.Terminal Authentication v.1
                            c.Authorisation of the Terminal.

 FDP_ACF.1.2/TRM          The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed: A BIS-PACE is allowed to
                          read data objects from FDP_ACF.1.1/TRM according to [4] after a successful PACE
                          authentication as required by FIA_UAU.1/PACE.

 FDP_ACF.1.3/TRM          The TSF shall explicitly authorize access of subjects to objects based on the
                          following additional rules: none.

 FDP_ACF.1.4/TRM          The TSF shall explicitly deny access of subjects to objects based on the following
                          additional rules:
                          1.Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                          allowed to read, to write, to modify, to use any User Data stored on the travel
                          document.
                          2.Terminals not using secure messaging are not allowed to read, to write, to
                          modify, to use any data stored on the travel document.
                          3.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 3 (Fingerprint) granted by the relative
                          certificate holder authorization encoding is not allowed to read the data objects
                          2b) of FDP_ACF.1.1/TRM.
                          4.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 4 (Iris) granted by the relative certificate holder
                          authorization encoding is not allowed to read the data objects 2c) of
                          FDP_ACF.1.1/TRM.
                          5.Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.

CC Document                                           49
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          6.Terminals authenticated as CVCA or as DV are not allowed to read data in the
                          EF.DG3 and EF.DG4 .




7.1.5.5             Class FMT Security Management


 FMT_SMR.1/PACE            Security roles

 Hierarchical to:          No other components.

 Dependencies:             FIA_UID.1 Timing of identification.

 FMT_SMR.1.1/PACE          The TSF shall maintain the roles
                           1.Manufacturer ,
                           2.Personalisation Agent,
                           3.Terminal,
                           4.PACE authenticated BIS-PACE,
                           5.Country Verifying Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability.

 FMT_LIM.1.1              The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                          enforced: Deploying Test Features after TOE Delivery does not allow,
                          1.User Data to be manipulated and disclosed,


CC Document                                           50
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2.TSF data to be disclosed or manipulated,
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.




 FMT_LIM.2                Limited availability

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_LIM.1 Limited capabilities.

 FMT_LIM.2.1              The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is
                          enforced:
                          Deploying Test Features after TOE Delivery does not allow:
                          1.User Data to be manipulated and disclosed,
                          2.TSF data to be disclosed or manipulated
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed .




 FMT_MTD.1/CVCA_INI        Management of TSF data – Initialization of CVCA Certificate and Current Date

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions
                           FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_INI      The TSF shall restrict the ability to write the

CC Document                                            51
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                           1.initial Country Verifying Certification Authority Public Key,
                           2.initial Country Verifying Certification Authority Certificate,
                           3.initial Current Date,
                           4. none
                           to Personalisation agent.




 FMT_MTD.1/CVCA_UPD         Management of TSF data – Country Verifying Certification Authority

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_UPD       The TSF shall restrict the ability to update the
                            1.Country Verifying Certification Authority Public Key,
                            2.Country Verifying Certification Authority Certificate
                            to Country Verifying Certification Authority.




 FMT_MTD.1/DATE             Management of TSF data – Current date

 Hierarchical to:
                            No other components.


 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/DATE           The TSF shall restrict the ability to modify the Current date to
                            1.Country Verifying Certification Authority,
                            2.Document Verifier,
                            3.Domestic Extended Inspection System.




CC Document                                            52
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_MTD.1/CAPK            Management of TSF data – Chip Authentication Private Key

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions, FMT_SMR.1 Security roles

 FMT_MTD.1.1/CAPK         The TSF shall restrict the ability to load the Chip Authentication Private Key to
                          Personalisation agent.




 FMT_MTD.1/KEY_READ         Management of TSF data – Key Read

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_READ       The TSF shall restrict the ability to read the
                            1.PACE passwords ,
                            2.Chip Authentication Private Key,
                            3.Personalisation Agent Keys
                            to none.




 FMT_MTD.3                Secure TSF data

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_MTD.1 Management of TSF data

 FMT_MTD.3.1              The TSF shall ensure that only secure values of the certificate chain are accepted
                          for TSF data of the Terminal Authentication Protocol v.1 and the Access Control.

 Refinement:              The certificate chain is valid if and only if
                          1. the digital signature of the Inspection System Certificate can be verified as
                          correct with the public key of the Document Verifier Certificate and the expiration
                          date of the Inspection System Certificate is not before the Current Date of the TOE,


CC Document                                             53
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. the digital signature of the Document Verifier Certificate can be verified as
                          correct with the public key in the Certifi Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability.

 FMT_LIM.1.1              The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                          enforced: Deploying Test Features after TOE Delivery does not allow,
                          1.User Data to be manipulated and disclosed,


CC Document                                           50
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2.TSF data to be disclosed or manipulated,
                          3.software to be reconstructed,
                          4.subst                         FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
 Dependencies:
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
                          The TSF shall restrict the ability to create and load the Active Authentication
 FMT_MTD.1.1/AA
                          Private Key to the Manufacturer and the Personalisation Agent.

 [IFX specific]           This SFR has been included in this security target in addition to the SFRs defined
                          by the Protection Profiles claimed in section 3.2 to address the import of private
 Application Note:
                          key used for AA. This extension does not conflict with the strict conformance to the
                          claimed Protection Profiles




7.1.5.6             Class FPT Protection of the Security Functions


 FPT_EMS.1                  TOE Emanation

 Hierarchical to:           No other components.

 Dependencies:              No Dependencies.



CC Document                                           54
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMS.1.1                The TOE shall not emit variations in power consumption or timing during com-
                            mand execution in excess of non-useful information enabling access to
                            1.Chip Authentication Session Keys
                            2.PACE session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s),
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.

 FPT_EMS.1.2                The TSF shall ensure any users are unable to use the following interface smart card
                            circuit contacts to gain access to
                            1.Chip Authentication Session Keys
                            2.PACE Session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s) and
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.




 7.2           Security Assurance Requirements
For the BAC feature, the TOE claims EAL 4 augmented with ALC_DVS.2, therefore [PP_BAC] section 6.2 “Security
Assurance Requirements for the TOE” applies.
For PACE and PACE-EAC features, the current document claims EAL5 augmented with ALC_DVS.2 and
AVA_VAN.5 therefore it claims a higher assurance level compared to [PP_SAC] and [PP_EAC], section 6.2
respectively.




CC Document                                           55
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 7.3          Security Requirements Rationale

7.3.1             Security Functional Requirements Rationale
Respective sections 6.3.1 “Security Functional Requirements Rationale” of [PP_SAC], [PP_BAC] and [PP_EAC]
are applicable for this chapter.
For the additionally defined SFRs in this ST, FIA_API.1/AA, FMT_MTD.1/AA and FCS_COP.1/SIG_GEN formalizing
the Active Authentication feature they meet the security objective OT.Active_Auth.




7.3.2             Rationale for SFR’s Dependencies
[PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.2 “Rationale for SFR’s Dependencies” are also applicable for this
chapter.


7.3.3             Security Assurance Requirements Rationale
[PP_BAC] section 6.3.3 “Security Assurance Requirements Rationale “ is applicable for this chapter.
[PP_EAC] and [PP_SAC] and their respective sections 6.3.3 “Security Assurance Requirements Rationale“ are
also applicable for this chapter with one additional rationale justifying the security assurance dependencies.
With the exception of ALC_DVS.2 and AVA_VAN.5, all assurance components are part of the EAL5 package,
which by package design does not have any dependency conflicts and is hierarchical to EAL4. The assurance
components ALC_DVS.2 and AVA_VAN.5 are also part of the assurance requirements from [PP_SAC], where
assurance dependencies are met as is shown in section 6.3.3 from [PP_SAC].
EAL5+ augmented with ALC_DVS.2 and AVA_VAN.5 is appropriate for this TOE, because this assurance level is
requested by several states. The assurance expectations for this kind of application are high due to the
sensitivity of data stored by the TOE. Therefore several governmental organizations request for an increased
assurance level.


7.3.4              Security Requirements – Internal Consistency
The rationale for the internal consistency of the SFRs from [PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.4
“Security Requirements – Internal Consistency” are also applicable to this chapter.
The assurance package EAL5 and EAL4 are pre-defined sets of internally consistent assurance requirements.
The dependency analysis for the sensitive assurance components in [PP_SAC], [PP_EAC] and [PP_BAC] section
7.3.3 “Security Assurance Requirements Rationale” together with the additional rational from section 7.3.3
show that the assurance requirements are internally consistent as all (additional) dependencies are satisfied
and no inconsistency appears.
The rationale for internal consistency between functional and assurance requirements from [PP_SAC] ,
[PP_EAC] and and [PP_BAC] section 6.3.4 “Security Requirements – Internal Consistency” are also applicable to
this chapter.




CC Document                                            56
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




    8             TOE Summary Specification
This TOE summary specification described in this section relies on the security services provided by the
platform product. For a description of these services please refer to [ST_JC_ID_S_Platform].
In the following each SFR is mentioned together with an indication for the PP from which these are originating
        -   (BAC) stands for SFRs originating from [PP_BAC].
        -   (SAC) stands for SFRs originating from [PP_SAC].
        -   (EAC) stands for SFRs originating from [PP_EAC]. Note that we include here also in this group the SFRs
            related to Active Authentication.
The composite TOE provides the security functions as follows:
       SF_EAC_PACE_BAC
The TOE implements the EAC, PACE and BAC protocol (PICC side). It encompasses:
        -   ECDH key generation, FCS_CKM.1/DH_PACE (SAC) and FCS_CKM.1/CA (EAC): The TOE uses the
            platform service “Elliptic Curves EC” for EC key generation. Further for session key generation the
            application uses the hybrid physical random number generator of the platform complying to PTG.3 as
            per [AIS31]. For the key generation the TOE supports “Generic Mapping” provided by the platform.
        -   Generation of Document Basic Access Keys, FCS_CKM.1 (BAC), FCS_COP.1/SHA (BAC): The TOE uses
            the cryptographic APIs provided by the underlying Secora ID S OS.
        -   Key destruction, FCS_CKM.4: The TOE uses the platform API ‘clearKey’ service to destroy session keys.
            The platform API ‘clearKey’ uses random numbers compliant to PTG.3 as per [AIS31] to overwrite the
            session keys.
        -   Provision of random numbers, as per FCS_RND.1. Authentication failure handling, FIA_AFL.1/PACE
            (SAC), FIA_AFL.1 (BAC): The TOE implements this check in such a way, that it withstands tearing events.
            A counter for unsuccessful authentication attempts is incremented before authentication is performed
            and reset in case of successful authentication.
        -   Prevention of replay attacks, FIA_UAU.4/PACE (EAC), FIA_UAU.4/PACE (SAC), FIA_UAU.4 (BAC):
            Replay attacks are prevented by the cryptographic protocol, which relies on good quality random
            numbers as required by FCS_RND.1 of this ST and supported by the underlying RNG of the platform and
            claimed in the ST of the platform with SFR FCS_RNG.1.
        -   Multiple authentication, FIA_UAU.5/PACE (EAC), FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE
            follows the protocol as described in [ICAO_SAC].
 SF_AA
  - Signature generation for the Active Authentication mechanism covered by FIA_API.1/AA,
     FCS_COP.1/SIG_GEN
  - Injecting private cryptographic keys used for the signatures as per FMT_MTD.1/AA
 SF_AuthPersoAgent
  - FIA_UAU.5/PACE (EAC) , FIA_UAU.5/PACE (SAC), FCS_COP.1/AUTH (BAC): The TOE uses the protocol
     scp v0.3 as per [GPv2_3_1] based on AES [FIPS_197] for authenticating the personalization agent.




CC Document                                                57
                                                                                                           1.2
                                                                                                           2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



   SF_SecureMessaging
    - Secure messaging, encryption/decryption, FCS_COP.1/PACE_ENC (SAC), FCS_COP.1/ENC (BAC): The
       TOE uses the proprietary PACE API from Secora ID S OS.
    - Secure messaging integrity protection, FCS_COP.1/PACE_MAC (SAC), FCS_COP.1/MAC (BAC): The TOE
       uses the underlying platform PACE dedicated API to calculate CMAC or Retail-MAC.
    - FCS_COP.1/CA_ENC (EAC), FCS_COP.1/CA_MAC (EAC) and FCS_COP.1/SIG_VER (EAC) are satisfied by
       using the standard Java Card API supported by the platform.
    - FCS_COP.1/CA_MAC (EAC) also covers to the GP scp03 used for secure card content management
       during personalization. This aspect of secure messaging by the TOE relies on the specially tailored API
       to GP SCP from the underlying platform and described in the SFR FCS_COP.1/SCP.
    - Multiple authentication, FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE performs a MAC check for
       every received message before instruction is executed, if the MAC check fails secure messaging is
       aborted; every response during secure messaging is MAC’ed by the TOE.
    - Re-authentication of terminal, FIA_UAU.6/EAC (EAC), FIA_UAU.6/PACE (SAC), FIA_UAU.6 (BAC): The
       TOE checks for every incoming message, whether the message is genuine (MAC check).
    - Trusted channel, FTP_ITC.1/PACE (SAC): The TOE follows the standardized implementation of the
       trusted channel according to [ICAO_SAC].

   SF_AccessControl
    - Allow specific access before user identification, FIA_UID.1/PACE (EAC), FIA_UID.1/PACE (SAC),
       FIA_UID.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess (see
       [ICAO_9303_11]) and EF.ATR/INFO (see [ISO7816-4]) before PACE or BAC authentication is performed.
       The TOE allows to read a specific subset of initialization data.
    - Allow specific access before user authentication, FIA_UAU.1/PACE (EAC), FIA_UAU.1/PACE (SAC),
       FIA_UAU.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess and
       EF.ATR/INFO before PACE or BAC authentication was performed. The TOE allows to read a specific
       subset of initialization data.
    - Subset and security attribute based access control, FDP_ACC.1/TRM (EAC), FDP_ACC.1/TRM (SAC),
       FDP_ACC.1 (BAC), FDP_ACF.1/TRM (EAC), FDP_ACF.1/TRM (SAC), FDP_ACF.1 (BAC), the TOE blocks
       access to EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM, EF.DG3 and EF.DG4 in case BAC
       or PACE protocol is not successfully performed.
    - Residual information protection, FDP_RIP.1: as soon secure messaging is stopped, the whole secure
       messaging context including session keys is wiped with random numbers.
    - Data exchange confidentiality, FDP_UCT.1/TRM (SAC), FDP_UCT.1 (BAC): during secure messaging,
       responses by the ICC are always wrapped (encrypted and MAC’ed) before being sent.
    - Data exchange integrity, FDP_UIT.1/TRM (SAC), FDP_UIT.1 (BAC) : during secure messaging, responses
       by the ICC aCBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of usProtection (SAC/EAC/Polymorphic
                                                                  Page: 26/150
                        eMRTD Configuration)

The additional functionality of Password Authenticated Connection Establishment
with Chip Authentication Mapping (PACE-CAM) has been added to the TOE. It
possesses the same security requirements as the PACE functionality, which
means that the same security problem definition is applicable for PACE-CAM.


The following additional SFRs have been defined for PACE-CAM:
              FIA_UID.1/PACE_CAM
                FIA_UAU.1/PACE_CAM
                FIA_UAU.4/PACE_CAM
                FIA_UAU.5/PACE_CAM
                FIA_UAU.6/PACE_CAM
                FMT_MTD.1/PACE_CAM_KEY_READ
                FMT_MTD.1/PACE_CAM_KEY_WRITE




The additional functionality of the Polymorphic eMRTD extensions has been
added to the TOE with: (i) additional security problem definition; (ii) additional
security objectives; (iii) additional SFRs. Notice that many SFRs are included
from the [EACv2-PP].
                        Security Target Lite
                           eneral support for cryptographic operations needed.

OT.Data_Authenticity The security objective OT.Data_Authenticity aims
  ensuring authenticity of the User- and TSF data (after the PACE
  Authentication) by enabling its verification at the terminal-side and by an
  active verification by the TOE itself. This objective is mainly achieved by
  FTP_ITC.1/PACE using FCS_COP.1/PACE_MAC. A prerequisite for establishing
  this trusted channel is a successful PACE or Chip and Terminal Authentication
  v.1       FIA_UID.1/PACE,       FIA_UAU.1/PACE        (FIA_UID.1/PACE_CAM,
  FIA_UAU.1/PACE_CAM for PACE CAM) using FCS_CKM.1/DH_PACE resp.
  FCS_CKM.1/CA and possessing the special properties FIA_UAU.5/PACE,
  FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM, FIA_UAU.6/PACE_CAM for PACE
  CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1 requires erasing the values of session
  keys (here: for KMAC). FIA_UAU.4/PACE, FIA_UAU.5/PACE and FCS_CKM.4
  (FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM and FCS_CKM.4 for PACE
  CAM) represent some required specific properties of the protocols used. The
  SFR FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the
  Chip Authentication Private Key and the Active Authentication Private Key. The
  SFR FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE
  passwords and the modular invert of the CA key. FMT_MTD.1/PA requires that
  SOD containing signature over the User Data stored on the TOE and used for
  the Passive Authentication is allowed to be written by the Personalisation
  Agent only and, hence, is to be considered as trustworthy. The SFR
  FCS_RND.1 represents a general support for cryptographic operations needed.
  The SFRs FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles
  related.

OT.Data_Confidentiality The security objective OT.Data_Confidentiality aims
  that the TOE always ensures confidentiality of the User- and TSF-data stored
  and, after the PACE Authentication resp. Chip Authentication, of these data
  exchanged. This objective for the data stored is mainly achieved by
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 112/150
                       eMRTD Configuration)

  (FDP_ACC.1/TRM, FDP_ACF.1/TRM). FIA_UAU.4/PACE, FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM,        FIA_UAU.5/PACE_CAM      for   PACE    CAM)    and
  FCS_CKM.4 represent some required specific properties of the protocols used.
  This objective for the data exchanged is mainly achieved by FDP_UCT.1/TRM,
  FDP_UIT.1/TRM and FTP_ITC.1/PACE using FCS_COP.1/PACE_ENC resp.
  FCS_COP.1/CA_ENC. A prerequisite for establishing this trusted channel is a
  successful PACE or Chip and Terminal Authentication v.1 FIA_UID.1/PACE,
  FIA_UAU.1/PACE (FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM for PACE
  CAM) using FCS_CKM.1/DH_PACE resp. FCS_CKM.1/CA and possessing the
  special properties FIA_UAU.5/PACE, FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM,
  FIA_UAU.6/PACE_CAM for PACE CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1
  requires erasing the values of session keys (here: for Kenc). The SFR
  FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the Chip
  Authentication Private Key and the Active Authentication Private Key. The SFR
  FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE passwords
  and the modular invert of the CA key. FMT_MTD.1/PA requires that SOD
  containing signature over the User Data stored on the TOE and used for the
  Passive Authentication is allowed to be written by the Personalisation Agent
  only and, hence, is to be considered trustworthy. The SFR FCS_RND.1
  represents the general support for cryptographic operations needed. The SFRs
  FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles related.

OT.Tracing The security objective OT.Tracing aims that the TOE prevents
  gathering TOE tracing data by means of unambiguous identifying the travel
  document remotely through establishing or listening to a communication via
  the contactless/contact-based interface of the TOE without a priori knowledge
  of the correct values of shared passwords (CAN, MRZ, PIN, PUK). This
  objective is achieved as follows:
            1. While establishing PACE communication with CAN, MRZ or PUK
                (non-blocking      authentication /   authorization  data)   by
                FIA_AFL.1/PACE,
            2. while establishing PACE communication using the PIN (blocking
                authentication data) by FIA_AFL.1/Block_PIN,
            3. for listening to PACE communication and for establishing CAv1
                communication by FTP_ITC.1/PACE,
            4. and      for     listening     to  CAv1     communication     by
                FTP_ITC.1/Polymorphic. The trusted channel shall be established
                by performing the PACE, CAv1 and TAv1 protocols according to
                [TR03110TR-03110] and the Polymorphic Authentication protocol
                (PMA).

OT.Prot_Abuse-Func The security objective OT.Prot_Abuse-Func “Protection
  against Abuse of Functionality” is ensured by the SFRs FMT_LIM.1, FMT_LIM.2,
  FMT_LIM.1/POLY and FMT_LIM.2/POLY which prevent misuse of test
  functionality of the TOE or other features which may not be used after TOE
  Delivery.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 113/150
                        eMRTD Configuration)

OT.Prot_Inf_Leak The security objective OT.Prot_Inf_Leak “Protection against
  Information Leakage” requires the TOE to protect confidential TSF data stored
  and/or processed in the travel document’s chip against disclosure
      by measurement and analysis of the shape and amplitude of signals or the
        time between events found by measuring signals on the electromagnetic
        field, power consumption, clock, or I/O lines which is addressed by the
        SFR FPT_EMS.1,
      by forcing a malfunction of the TOE which is addressed by the SFR
        FPT_FLS.1 and FPT_TST.1, and/or
      by a physical manipulation of the TOE which is addressed by the SFR
        FPT_PHP.3.

OT.Prot_Phys-Tamper The security objective OT.Prot_Phys-Tamper “Protection
  against Physical Tampering” is covered by the SFR FPT_PHP.3.

OT.Prot_Malfunction The security objective OT.Prot_Malfunction “Protection
  against Malfunctions” is covered by (i) the SFR FPT_TST.1 which requires self-
  tests to demonstrate the correct operation and tests of authorized users to
  verify the integrity of TSF data and TSF code, and (ii) the SFRFPT_FLS.1 which
  requires a secure state in case of detected failure or operating conditions
  possibly causing a malfunction.

OT.Identification The security objective OT.Identification “Identification of the
  TOE” addresses the storage of Initialisation and Pre-Personalisation Data in its
  non-volatile memory, whereby they also include the IC Identification Data
  uniquely identifying the TOE’s chip. This will be ensured by TSF according to
  SFR FAU_SAS.1. The SFR FMT_MTD.1/INI_ENA allows only the Manufacturer
  to write Initialisation and Pre-personalisation Data (including the
  Personalisation Agent key set). The SFR FMT_MTD.1/INI_DIS requires the
  Personalisation Agent to disable access to Initialisation and Pre-personalisation
  Data in the life cycle phase ‘operational use’. The SFRs FMT_SMF.1 and
  FMT_SMR.1/PACE support the functions and roles related.

OT.AC_Pers The       security   objective  OT.AC_Pers      “Access   Control   for
  Personalisation of logical travel document” addresses the access control of the
  writing the logical travel document. The justification for the SFRs FAU_SAS.1,
  FMT_MTD.1/INI_ENA and FMT_MTD.1/INI_DIS arises from the justification for
  OT.Identification above with respect to the Pre-personalisation Data. The write
  access to the logical travel document data are defined by the SFR
  FIA_UID.1/PACE (FIA_UID.1/PACE_CAM for PACE CAM), FIA_UAU.1/PACE
  (FIA_UAU.1/PACE_CAM for PACE CAM), FDP_ACC.1/TRM and FDP_ACF.1/TRM
  in the same way: only the successfully authenticated Personalisation Agent is
  allowed to write the data of the groups EF.DG1 to EF.DG16 of the logical travel
  document only once. FMT_MTD.1/PA covers the related property of
  OT.AC_Pers (writing SOD and, in generally, personalization data). The SFR
  FMT_SMR.1/PACE lists the roles (including Personalisation Agent) and the SFR
  FMT_SMF.1 lists the TSF management functions (including Personalisation).
                        Security Target Lite
                                                                     Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 114/150
                       eMRTD Configuration)

  The SFRs FMT_MTD.1/KEY_READ (FMT_MTD.1/PACE_CAM_KEY_READ for
  PACE CAM protocol) and FPT_EMS.1 restrict the access to the Personalisation
  Agent Keys, the Chip Authentication Private Key and the Active Authentication
  Private key. The authentication of the terminal as Personalisation Agent shall
  be performed by TSF according to SFRs FIA_UAU.4/PACE and FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM and FIA_UAU.5/PACE_CAM for PACE CAM). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Terminal Authentication Protocol v.1 (after Chip Authentication v.1) with
  the Personalisation Agent Keys, the TOE will use TSF according to the
  FCS_RND.1 (for the generation of the challenge), FCS_CKM.1/CA (for the
  derivation of the new session keys after Chip Authentication v.1), and
  FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the ENC_MAC_Mode secure
  messaging), FCS_COP.1/SIG_VER (as part of the Terminal Authentication
  Protocol v.1) and FIA_UAU.6/EAC (for the re-authentication). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Authentication Mechanism with the Personalisation Agent Key, the TOE will
  use TSF according to the FCS_RND.1 (for the generation of the challenge) and
  FCS_COP.1/CA_ENC (to verify the authentication attempt). The session keys
  are destroyed according to FCS_CKM.4 after use.

OT.Sens_Data_Conf The            security     objective      OT.Sense_Data_Conf“
  Confidentiality of sensitive biometric reference data” is enforced by the Access
  Control SFP defined in FDP_ACC.1/TRM and FDP_ACF.1/TRM allowing the data
  of EF.DG3 and EF.DG4 only to be read by successfully authenticated Extended
  Inspection System being authorized by a valid certificate according
  FCS_COP.1/SIG_VER. The SFRs FIA_UID.1/PACE and FIA_UAU.1/PACE
  (FIA_UID.1/PACE_CAM and FIA_UAU.1/PACE_CAM for PACE CAM) require the
  identification and authentication of the inspection systems. The SFR
  FIA_UAU.5/PACE requires the successful Chip Authentication (CA) v.1 before
  any     authentication    attempt   as    Extended     Inspection  System    (or
  FIA_UAU.5/PACE_CAM for PACE CAM). During the protected communication
  following the CA v.1 the reuse of authentication data is prevented by
  FIA_UAU.4/PACE (FIA_UAU.4/PACE_CAM for PACE CAM). The SFR
  FIA_UAU.6/EAC and FDP_UCT.1/TRM requires the confidentiality protection of
  the transmitted data after Chip Authentication v.1 by means of secure
  messaging implemented by the cryptographic functions according to
  FCS_RND.1 (for the generation of the terminal authentication challenge),
  FCS_CKM.1/CA (for the generation of shared secret and for the derivation of
  the new session keys), and FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC for
  the ENC_MAC_Mode secure messaging. The session keys are destroyed
  according to FCS_CKM.4 after use. The SFR FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ requires that the Chip Authentication Key cannot be
  written unauthorized or read afterwards. The SFR FMT_MTD.1/AAPK and
  FMT_MTD.1/KEY_READ requires that the Active Authentication Key cannot be
  written       unauthorized       or      read      afterwards.      The     SFR
  FMT_MTD.1/PACE_CAM_KEY_WRITE and FMT_MTD.1/PACE_CAM_KEY_READ
  requires that the modular invert of the CA key cannot be written unauthorized
  or read afterwards. To allow a verification of the certificate chain as in
  FMT_MTD.3 the CVCA’s public key and certificate as well as the current date
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 115/150
                       eMRTD Configuration)

  are  written or   update  by   authorized identified role  as                 of
  FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD and FMT_MTD.1/DATE.

OT.Chip_Auth_Proof The security objective OT.Chip_Auth_Proof “Proof of
  travel document’s chip authenticity” is ensured by the Chip Authentication
  Protocolv.1 provided by FIA_API.1/CA and by Active Authentication provided
  by FIA_API.1/AA proving the identity of the TOE. The Chip Authentication
  Protocolv.1 defined by FCS_CKM.1/CA is performed using a TOE internally
  stored confidential private key as required by FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ. The Chip Authentication Protocolv.1 [TR-03110-1]
  requires additional TSF according to FCS_CKM.1/CA (for the derivation of the
  session keys), FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the
  ENC_MAC_Mode        secure    messaging).    The   SFRs     FMT_SMF.1     and
  FMT_SMR.1/PACE support the functions and roles related. The Active
  Authentication defined by FCS_COP.1/SIG_GEN for the generation of the RSA
  Signature is performed using a TOE internally stored confidential private key
  as required by FMT_MTD.1/AAPK and FMT_MTD.1/KEY_READ. According to
  FDP_ACF.1, only the successfully authenticated Inspection Systems are
  allowed to request active authentication (FDP_ACF.1.2, rule 2).

OT.Polymorphic_Data_Confidentiality: SFRs that contribute to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Integrity: SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.Polymorphic_Data_Authenticity:        SFRs   that contribute   to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Privacy:        SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.AC_Pers_Polymorphic:       SFRs that contribute to meet this objective are
  mentioned in table 7.

OT.DoS: SFRs that contribute to meet this objective are mentioned in table 7.

6.3.2 Rationale tables of Security Objectives and SFRs
                                 Security Target Lite
                                                                             Ref.:
                          IDeal Pass v2.3-n JC with Privacy
                                                                      2018_2000036361
                          Protection (SAC/EAC/Polymorphic
                                                                        Page: 116/150
                                eMRTD Configuration)

Security Objectives                Security Functional Requirements                 Rationale
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FPT_PHP.3, FCS_CKM.1/CA,
                                   FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Integrity                  FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FMT_MTD.1/AAPK,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_WRITE,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FTP_ITC.1/PACE,
                                   FMT_SMF.1, FMT_MTD.1/PA, FCS_CKM.1/CA,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Authenticity               FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                    6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FMT_SMR.1/PACE,
                                   FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_ENC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FCS_CKM.1/CA, FCS_COP.1/CA_ENC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,                  Section
OT.Data_Confidentiality
                                   FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_AFL.1/PACE, FTP_ITC.1/PACE,                  Section
OT.Tracing
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Block_PUK         6.3.1
                                   FMT_LIM.1, FMT_LIM.2, FMT_LIM.1/POLY,            Section
OT.Prot_Abuse-Func
                                   FMT_LIM.2/POLY                                   6.3.1
                                                                                    Section
OT.Prot_Inf_Leak                   FPT_FLS.1, FPT_TST.1, FPT_PHP.3, FPT_EMS.1
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Phys-Tamper                FPT_PHP.3
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Malfunction                FPT_FLS.1, FPT_TST.1
                                                                                    6.3.1
                                   FMT_SMF.1, FMT_MTD.1/INI_ENA, FAU_SAS.1,         Section
OT.Identification
                                   FMT_SMR.1/PACE, FMT_MTD.1/INI_DIS                6.3.1
                              Security Target Lite
                                                                               Ref.:
                       IDeal Pass v2.3-n JC with Privacy
                                                                        2018_2000036361
                       Protection (SAC/EAC/Polymorphic
                                                                          Page: 117/150
                             eMRTD Configuration)

                                      FMT_SMF.1, FMT_MTD.1/INI_ENA, FMT_MTD.1/PA,
                                      FAU_SAS.1, FCS_CKM.1/CA, FCS_CKM.4,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_COP.1/SIG_VER, FCS_RND.1, FIA_UID.1/PACE,
                                      FIA_UAU.1/PACE, FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                        Section
OT.AC_Pers                            FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                        6.3.1
                                      FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                      FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                      FPT_EMS.1, FMT_MTD.1/INI_DIS,
                                      FMT_MTD.1/PACE_CAM_KEY_READ
                                      FCS_CKM.1/CA, FCS_CKM.4, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_COP.1/SIG_VER,
                                      FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                      FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                      FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                      FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                      FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                                                                        Section
OT.Sens_Data_Conf                     FDP_UCT.1/TRM, FMT_MTD.1/CVCA_INI,
                                      FMT_MTD.1/CVCA_UPD, FMT_MTD.1/DATE,               6.3.1
                                      FMT_MTD.1/CAPK, FMT_MTD.1/KEY_READ,
                                      FMT_MTD.1/PACE_CAM_KEY_READ,
                                      FMT_MTD.1/PACE_CAM_KEY_WRITE FMT_MTD.3,
                                      FMT_MTD.1/AAPK,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                      FCS_CKM.1/CA, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FMT_SMF.1, FMT_SMR.1/PACE,
                                                                                        Section
OT.Chip_Auth_Proof                    FMT_MTD.1/CAPK, FMT_MTD.1/KEY_READ,
                                                                                        6.3.1
                                      FIA_API.1/CA, FMT_MTD.1/AAPK, FIA_API.1/AA,
                                      FCS_COP.1/SIG_GEN
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/SIG_VER,
                                      FCS_COP.1/PACE_ENC, FCS_COP.1/PACE_MAC,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                      FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                      FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                      FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                      FDP_RIP.1/POLY, FDP_RIP.1, FDP_ACC.1/POLY,
                                      FDP_ACF.1/POLY, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FDP_UCT.1/TRM, FDP_UIT.1/TRM, FTP_ITC.1/PACE,     Section
OT.Polymorphic_Data_Confidentiality
                                      FMT_SMF.1, FMT_SMR.1/POLY,                        6.3.1
                                      FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD,
                                      FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                      FMT_MTD.1/KEY_READ, FMT_MTD.1/PI_PP_CPI_Read,
                                      FMT_MTD.1/PI_PP_CPI_Load,
                                      FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                      FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                      FCS_CKM.1/CA, FIA_UAU.6/POLY, FMT_MTD.3,
                                      FCS_CKM.4, FIA_UAU.5/POLY, FCS_CKM.1/POLY,
                                      FCS_COP.1/POLY
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_RND.1,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,       Section
OT.Polymorphic_Data_Integrity
                                      FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,   6.3.1
                                      FIA_UAU.6/EAC, FDP_RIP.1/POLY, FDP_RIP.1,
                                      FDP_ACC.1/POLY, FDP_ACF.1/POLY, FDP_ACC.1/TRM,
                                      FDP_ACF.1/TRM, FDP_UCT.1/TRM, FDP_UIT.1/TRM,
                             Security Target Lite
                                                                            Ref.:
                      IDeal Pass v2.3-n JC with Privacy
                                                                     2018_2000036361
                      Protection (SAC/EAC/Polymorphic
                                                                       Page: 118/150
                            eMRTD Configuration)

                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,
                                   FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FPT_PHP.3,
                                   FMT_MTD.1/PI_PP_CPI_Read,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/PACE_MAC,
                                   FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                   FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                   FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                   FIA_AFL.1/PACE, FDP_RIP.1/POLY, FDP_RIP.1,        Section
OT.Polymorphic_Data_Authenticity
                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,        6.3.1
                                   FMT_MTD.1/PA, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/POLY,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                                                                     Section
OT.Polymorphic_Data_Privacy        FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                                                                     6.3.1
                                   FMT_MTD.1/PI_PP_CPI_Read, FPR_ANO.1,
                                   FPR_UNL.1, FCS_CKM.4, FCS_CKM.1/POLY
                                   FCS_COP.1/SIG_VER, FCS_COP.1/CA_ENC,
                                   FCS_COP.1/CA_MAC, FCS_RND.1,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,
                                   FIA_UAU.6/EAC, FDP_ACC.1/POLY, FDP_ACF.1/POLY,
                                   FDP_ACC.1/TRM, FDP_ACF.1/TRM, FAU_SAS.1,          Section
OT.AC_Pers_Polymorphic             FMT_SMF.1, FMT_SMR.1/POLY, FMT_MTD.1/PA,          6.3.1
                                   FMT_MTD.1/KEY_READ, FPT_EMS.1,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FMT_MTD.1/INI_DIS,
                                   FMT_MTD.1/INI_ENA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY
                                   FIA_AFL.1/Suspend_PIN,                            Section
OT.DoS
                                   FIA_AFL.1/Suspend_PUK                             6.3.1

                    Table 7 Security Objectives and SFRs - Coverage
                        Security Target Lite
                                                                       Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                  Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACE_CAM             No Dependencies
FIA_UID.1/POLY                 No Dependencies
FIA_UAU.1/POLY                 (FIA_UID.1)                FIA_UID.1/POLY
FIA_UAU.4/POLY                 No Dependencies
FIA_UAU.5/POLY                 No Dependencies
FIA_UAU.6/POLY                 No Dependencies
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_READ
                               (FMT_SMR.1)                FMT_SMR.1/PACE
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_WRITE
                               (FMT_SMR.1)                FMT_SMR.1/PACE
FIA_API.1/CA                   No Dependencies
FIA_API.1/AA                   No Dependencies
FDP_ACC.1/TRM                  (FDP_ACF.1)                FDP_ACF.1/TRM
                               (FDP_ACC.1) and
FDP_ACF.1/TRM                                             FDP_ACC.1/TRM
                               (FMT_MSA.3)
FDP_RIP.1                      No Dependencies
FDP_ACC.1/POLY                 (FDP_ACF.1)                FDP_ACF.1/POLY
                               (FDP_ACC.1) and
FDP_ACF.1/POLY                                            FDP_ACC.1/POLY
                               (FMT_MSA.3)
FDP_RIP.1/POLY                 No Dependencies
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UCT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UIT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
FTP_ITC.1/PACE                 No Dependencies
FAU_SAS.1                      No Dependencies
FMT_SMF.1                      No Dependencies
                                                          FIA_UID.1/PACE,
FMT_SMR.1/PACE                 (FIA_UID.1)
                                                          FIA_UID.1/PACE_CAM
                          Security Target Lite
                                                                    Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                               Page: 120/150
                         eMRTD Configuration)

FMT_LIM.1                     (FMT_LIM.2)               FMT_LIM.2
FMT_LIM.2                     (FMT_LIM.1)               FMT_LIM.1
FMT_SMR.1/POLY                (FIA_UID.1)               FIA_UID.1/POLY
FMT_LIM.1/POLY                (FMT_LIM.2)               FMT_LIM.2/POLY
FMT_LIM.2/POLY                (FMT_LIM.1)               FMT_LIM.1/POLY
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_ENA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_DIS
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/PA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_INI
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_UPD
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/DATE
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/AAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
F                          MT_MTD.1/KEY_READ
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                                                        FMT_MTD.1/CVCA_INI,
FMT_MTD.3                     (FMT_MTD.1)
                                                        FMT_MTD.1/CVCA_UPD
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/Initialize_PIN
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Change_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Unblock_PIN         (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Resume_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Load      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Read      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FPT_EMS.1                     No Dependencies
FPT_FLS.1                     No Dependencies
FPT_TST.1                     No Dependencies
FPT_PHP.3                     No Dependencies
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/DH_PACE             FCS_COP.1) and            FCS_COP.1/PACE_ENC,
                              (FCS_CKM.4)               FCS_COP.1/PACE_MAC
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/CA                  FCS_COP.1) and            FCS_COP.1/CA_ENC,
                              (FCS_CKM.4)               FCS_COP.1/CA_MAC
                              (FCS_CKM.2 or
                                                        FCS_CKM.4,
FCS_CKM.1/POLY                FCS_COP.1) and
                              (FCS_CKM.4)               FCS_COP.1/POLY
                              (FCS_CKM.1 or FDP_ITC.1
FCS_CKM.4                                               FCS_CKM.1/DH_PACE
                              or FDP_ITC.2)
FCS_COP.1/PACE_ENC            (FCS_CKM.1 or FDP_ITC.1   FCS_CKM.1/DH_PACE,
                          Security Target Lite
                                                                      Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                 Page: 121/150
                         eMRTD Configuration)

                                or FDP_ITC.2) and         FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/DH_PACE,
FCS_COP.1/PACE_MAC              or FDP_ITC.2) and
                                                          FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_ENC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_VER               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_GEN               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_MAC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
FCS_COP.1/POLY                  (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/POLY,
                                or FDP_ITC.2) and
                                (FCS_CKM.4)               FCS_CKM.4
FCS_RND.1                       No Dependencies
FPR_ANO.1                       No Dependencies
FPR_UNL.1                       No Dependencies

                          Table 8 SFRs Dependencies


6.3.3.1.1 Rationale for the exclusion of Dependencies


The dependency FMT_MSA.3 of FDP_ACF.1/TRM is discarded. The access
  control TSF according to FDP_ACF.1/TRM uses security attributes which are
  defined during the personalisation and are fixed over the whole life time of the
  TOE. No management of these security attribute (i.e. SFR FMT_MSA.1 and
  FMT_MSA.3) is necessary here.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 122/150
                        eMRTD Configuration)

6.3.3.2 SARs Dependencies
Requirements     CC Dependencies                          Satisfied Dependencies
ADV_ARC.1       (ADV_FSP.1) and (ADV_TDS.1)               ADV_FSP.5, ADV_TDS.4
ADV_FSP.5       (ADV_IMP.1) and (ADV_TDS.1)               ADV_IMP.1, ADV_TDS.4
ADV_IMP.1       (ADV_TDS.3) and (ALC_TAT.1)               ADV_TDS.4, ALC_TAT.2
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
ADV_INT.2
                (ALC_TAT.1)                               ALC_TAT.2
ADV_TDS.4       (ADV_FSP.5)                               ADV_FSP.5
AGD_OPE.1       (ADV_FSP.1)                               ADV_FSP.5
AGD_PRE.1       No Dependencies
                (ALC_CMS.1) and (ALC_DVS.1) and           ALC_CMS.5, ALC_DVS.2,
ALC_CMC.4
                (ALC_LCD.1)                               ALC_LCD.1
ALC_CMS.5       No Dependencies
ALC_DEL.1       No Dependencies
ALC_DVS.2       No Dependencies
ALC_LCD.1       No Dependencies
ALC_TAT.2       (ADV_IMP.1)                               ADV_IMP.1
                (ASE_ECD.1) and (ASE_INT.1) and           ASE_ECD.1, ASE_INT.1,
ASE_CCL.1
                (ASE_REQ.1)                               ASE_REQ.2
ASE_ECD.1       No Dependencies
ASE_INT.1       No Dependencies
ASE_OBJ.2       (ASE_SPD.1)                               ASE_SPD.1
ASE_REQ.2       (ASE_ECD.1) and (ASE_OBJ.2)               ASE_ECD.1, ASE_OBJ.2
ASE_SPD.1       No Dependencies
                (ADV_FSP.1) and (ASE_INT.1) and           ADV_FSP.5, ASE_INT.1,
ASE_TSS.1
                (ASE_REQ.1)                               ASE_REQ.2
ATE_COV.2       (ADV_FSP.2) and (ATE_FUN.1)               ADV_FSP.5, ATE_FUN.1
                (ADV_ARC.1) and (ADV_TDS.4) and           ADV_ARC.1, ADV_TDS.4,
ATE_DPT.3
                (ATE_FUN.1)                               ATE_FUN.1
ATE_FUN.1       (ATE_COV.1)                               ATE_COV.2
                (ADV_FSP.2) and (AGD_OPE.1) and           ADV_FSP.5, AGD_OPE.1,
ATE_IND.2       (AGD_PRE.1) and (ATE_COV.1) and           AGD_PRE.1, ATE_COV.2,
                (ATE_FUN.1)                               ATE_FUN.1
                (ADV_ARC.1) and (ADV_FSP.4) and           ADV_ARC.1, ADV_FSP.5,
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
AVA_VAN.5
                (AGD_OPE.1) and (AGD_PRE.1) and           AGD_OPE.1, AGD_PRE.1,
                (ATE_DPT.1)                               ATE_DPT.3

                           Table 9 SARs Dependencies


6.3.4 Rationale for the Security Assurance Requirements
The EAL5 was chosen to permits a developer to gain maximum assurance from
positive security engineering based upon rigorous commercial development
practices supported by moderate application of specialist security engineering
techniques. Such a TOE will probably be designed and developed with the intent
of achieving EAL5 assurance. It is likely that the additional costs attributable to
the EAL5 requirements, relative to rigorous development without the application
of specialised techniques, will not be large.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 123/150
                       eMRTD Configuration)

6.3.5 AVA_VAN.5 Advanced methodical vulnerability analysis
The selection of the component AVA_VAN.5 provides the assurance that the TOE
is shown to be highly resistant to penetration attacks to meet the security
objectives OT.Prot_Inf_Leak, OT.Prot_Phys-Tamper and OT.Prot_Malfunction.

6.3.6 ALC_DVS.2 Sufficiency of security measures
The selection of the component ALC_DVS.2 provides a higher assurance of the
secu-rity of the MRTD's development and manufacturing especially for the secure
handling of the MRTD's material.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 124/150
                       eMRTD Configuration)


7 TOE Summary Specification

7.1 TOE Summary Specification
This section provides a description of the security functions and assurance
measures of the TOE that meet the TOE security requirements.

The TOE provides security features (SF) which can be associated to following
groups:
  Identification and Authentication mechanisms
  Cryptographic functions support
  Access control /Storage and protection of logical travel document data
  Secure messaging
  Security and Life-cycle management
Moreover, the TOE will protect itself against interference, logical tampering and
bypass. The security functionality of the TOE respectively the IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration) applet
will be externally available to the user by APDU commands according to the
access conditions specified by the according policies considering the life cycle
state, user role and security state.

7.1.1 SF.IA Identification and Authentication
The different authentication mechanisms are supported by APDU commands and
parameters using the cryptographic functions provided by the platform. The
authentication mechanisms are enforced by protocols and APDU methods as
specified in the functional specification.

Note that Symmetric Basic Access Control (BAC) Authentication Mechanism is
supported by the TOE but not covered by this Security Target.

The TOE supports the following authentication mechanisms:
        SF.IA.1: Password Authenticated Connection Establishment (PACE)
        SF.IA.2: EAC Chip Authentication v. 1
        SF.IA.3: EAC Terminal Authentication Protocol v.1
        SF.IA.4: Authentication of the Personalization Agent with a
         personalisation key set based on a symmetric authentication
         mechanism
        SF.IA.5: ICAO Active Authentication
        SF.IA.6: Optionally PACE with additional Chip Authentication Mapping
         (PACE CAM)
        SF.IA.7: Polymorphic Authentication (PMA)
        SF.IA.8: Polymorphic eMRTD Document Holder Verification
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 125/150
                       eMRTD Configuration)

7.1.2 SF.CF Cryptographic functions support
Cryptographic function support          ent
OE.Polymorphic_Auth


OE.Polymorphic_Auth
     o All authentication infrastructure keys used by the central Key
        Management       Authority    for   the    polymorphic   authentication
        infrastructure (generation and transformation of PP, PI and CPI) are
        generated, handled and stored securely.
     o The Issuer has to ensure that Polymorphic PP/PI/CPI user data is
        generated securely by the central Key Management Authority of the
        polymorphic authentication infrastructure and stored securely in the
        electronic document during the eMRTD personalization phase.
     o The TOE communicates only with a Trustworthy Authentication
        Service/Terminal during the Polymorphic eMRTD authentication process
        steps (i.e. during sequence of PACE with PIN, PA, CAv1, TAv1 and
        PMA).
     o The authorized Polymorphic Authentication Service/Terminal has to
        ensure that the randomised PP, PI and optional CPI are securely
        received and transformed by the central Key Management Authority.
        This comprises:
         eMRTD       document      authentication   by   performing   Passive
            Authentication (SOD and DG14) signature verification and Chip
            Authentication (CAv1), being part of the Polymorphic Authentication
            process steps (i.e. sequence of PACE with PIN, PA, CAv1, TAv1 and
            PMA).
         eMRTD document status validation by encryption of the randomized
            PP received from the TOE using the public key of the eMRTD
            document Status Service and sending this with the the
            coresponding meta-data obtained from the TOE to the eMRTD
            document Status Service.
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 61/150
                        eMRTD Configuration)

            Transformation (re-keying): encryption of the randomized PP, PIP or
             CPI received from the TOE using the public key of the destination
             Service Provider.
           Transmiting the transformed (encrypted) PP, PIP or CPI to the
             destination Service provider.
  Application Note:
  This OE has been added to this ST for the polymorphic authentication
  infrastructure. This addition does not conflict with the strict conformance to
  PACE PP [PACE-PP] and EACv1 PP [EAC-PP-V2].

OE.Authoriz_Polymorphic_Data
  Authorization for Use of Polymorphic eMRTD User Data
     o The issuing States or Organisations have to establish a dedicated
       (separated) CVCA, DVCA and IS PKI in the polymorphic eMRTD
       infrastructure.
     o The Country Verifying Certification Authorities, the Document Verifier
       and Inspection Systems have to hold authentication key pairs and
       certificates for their public keys encoding the access control rights. The
       Country Verifying Certification Authorities of the issuing States or
       Organisations have to sign the certificates of the Document Verifier and
       the Document Verifiers have to sign the certificates of the Inspection
       Systems. The issuing States or Organisations have to distribute the
       public keys of their Country Verifying Certification Authority to their
       Polymorphic eMRTD document's chip.
     o The issuing State or Organisation have to establish the necessary public
       key infrastructure in order to limit the access to Polymorphic data of
       Polymorphic eMRTD document holders to authorized Organisations. The
       Country Verifying Certification Authority of the issuing State or
       Organisation has to generate card verifiable Document Verifier
       Certificates for the authorized Document Verifier only.
     o The issuing State or Organisation has to establish the necessary public
       key infrastructure in order to (i) generate the Polymorphic eMRTD
       document's Chip Authentication Key Pair, (ii) sign and store the Chip
       Authentication Public Key in the Chip Authentication Public Key data
       and (iii) support inspection systems to verify the authenticity of the
       Polymorphic eMRTD document's chip according to [TR-03110] and
       [ICAO-9303] used for genuine Polymorphic eMRTD document by
       certification of the Chip Authentication Public Key by means of the
       Document Security Object (SOD).
     o The Polymorphic eMRTD document issuer shall establish a public key
       infrastructure for the card verifiable certificates used for Terminal
       Authentication. For this aim, the Polymorphic eMRTD document issuer
       shall run a Country Verifying Certification Authority. The PKI shall fulfill
       the requirements and rules of the corresponding certificate policy. The
       Polymorphic eMRTD document issuer shall make the CVCA certificate
       available to the personalization agent or the manufacturer.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                           Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        19 / 35
NXP Semiconductors                                                                                               Crypto Library Cobalt on N7021 VA
                                                                                                                                   Security Target Lite



                              6.2 Security Assurance Requirements
                                    Table 4 below lists all security assurance components that are valid for Crypto Library
                                    Cobalt on N7021 VA. These security assurance components are required by EAL6 or by
                                    the Protection Profile [5]. Augmentations by the Security Target are marked with ST.

Table 4. Security Assurance Requirements EAL6+ and PP augmentations for Crypto Library Cobalt on N7021 VA
SAR                                 Title                                                                                          Required by
ADV_ARC.1                           Security architecture description                                                              PP / EAL6
ADV_FSP.5                           Complete semi-formal functional specification with additional error                            EAL6
                                    information
ADV_IMP.2                           Complete mapping of implementation representation of the TSF                                   EAL6
ADV_INT.3                           Minimally complex internals                                                                    EAL6
ADV_TDS.5                           Complete Semiformal modular design                                                             EAL6
ADV_SPM.1                           Security Policy Modelling                                                                      EAL6
AGD_OPE.1                           Operational user guidance                                                                      PP / EAL6
AGD_PRE.1                           Preparative procedures                                                                         PP / EAL6
ALC_CMC.5                           Advanced support                                                                               PP / EAL6
ALC_CMS.5                           Development tools CM coverage                                                                  EAL6
ALC_DEL.1                           Delivery procedures                                                                            PP / EAL6
ALC_DVS.2                           Sufficiency of security measures                                                               PP / EAL6
ALC_FLR.1                           Flaw remediation                                                                               ST
ALC_LCD.1                           Developer defined life-cycle model                                                             PP / EAL6
ALC_TAT.3                           Compliance with implementation standards – all parts                                           EAL6
ASE_CCL.1                           Conformance claims                                                                             PP / EAL6
ASE_ECD.1                           Extended components definition                                                                 PP / EAL6
ASE_INT.1                           ST introduction                                                                                PP / EAL6
ASE_OBJ.2                           Security objectives                                                                            PP / EAL6
ASE_REQ.2                           Derived security requirements                                                                  PP / EAL6
ASE_SPD.1                           Security problem definition                                                                    PP / EAL6
ASE_TSS.2                           TOE summary specification                                                                      ST
ATE_COV.3                           Rigorous analysis of coverage                                                                  EAL6
ATE_DPT.3                           Testing: modular design                                                                        EAL6
ATE_FUN.2                           Ordered functional testing                                                                     EAL6
ATE_IND.2                           Independent testing - sample                                                                   PP / EAL6
AVA_VAN.5                           Advanced methodical vulnerability analysis                                                     PP / EAL6

                                    Security Assurance Requirement ADV_SPM.1 requires the developer to provide a
                                    Security Policy Model for the Crypto Library. However, the N7021 hardware already
                                    provides a Security Policy Model (see [13] for details), which also applies unchanged
                                    to the composite product. As the SFRs introduced in this ST do not add a new Security
                                    Policy or change the rules of existing Security Policies of the hardware, there is no need
                                    for an additional Security Policy Model for the Crypto Library.
Crypto Library Cobalt on N7021 VA                     All information provided in this document is subject to legal disclaimers.        © NXP B.V. 2019. All rights reserved.

Product evaluation document                                           Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                            20 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                           6.2.1 Refinements of the Security Assurance Requirements for EAL6+
                                    The Security Target claims strict conformance to the Protection Profile [5], and therefore
                                    it has to be conform to the refinements of the TOE security assurance requirements (see
                                    Application Note 23 of the PP [5]).
                                    The Hardware Security Target [13] for N7021 has chosen the evaluation assurance
                                    level EAL6+. The Security Target of the hardware platform with IC Dedicated Software
                                    including cryptographic library is based on the Protection Profile [5], which requires
                                    the lower level EAL4+. This implies that the refinements made in the Protection Profile
                                    [5], section 6.2.1 Refinements of the TOE Assurance Requirements, for EAL4+ had to
                                    be refined again in order to ensure EAL6+ in the Hardware Security Target (this was
                                    necessary for ALC_CMS.5, ALC_CMC.5, ADV_IMP.2, ATE_COV.3, and ADV_FSP.5).
                                    Since these refinements explain and interpret the CC for hardware, these refinements do
                                    not affect the additional software in this composite TOE. Therefore all refinements made
                                    in the PP [5] are valid without change for the composite TOE.

                              6.3 Security Requirements Rationale


                           6.3.1    Rationale for the Security Functional Requirements
                                    Section 6.3.1 of the PP [5] and Section 6.3.1 of the Hardware Security Target [13]
                                    provide the mapping between security functional requirements and security objectives of
                                    the TOE. This mapping entirely apply to this Security Target.
                                    This ST lists a number of security objectives and SFRs for Crypto Library, which are
                                    additional to both the PP and the Hardware ST. These are listed in the following table.

Table 5. Mapping of SFRs to Security Objectives for Crypto Library in this ST
Objective                                TOE Security Functional Requirements
O.RSA                                    FCS_COP.1/RSA
                                         FCS_COP.1/RSA_Pad
                                         FDP_IFC.1
                                         FDP_ITT.1[HW]
                                         FPT_ITT.1[HW]
                                         FPT_FLS.1
                                         FRU_FLT.2
                                         FDP_RIP.1[SW]
                                         FCS_CKM.4
O.RSA_PubExp                             FCS_COP.1/RSA_PubExp
                                         FDP_IFC.1
                                         FDP_ITT.1[HW]
                                         FPT_ITT.1[HW]
                                         FPT_FLS.1
                                         FRU_FLT.2
                                         FDP_RIP.1[SW]




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      21 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



Objective                                 TOE Security Functional Requirements
O.RSA_KeyGen                              FCS_CKM.1/RSA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.ECDSA                                   FCS_COP.1/ECDSA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
                                          FCS_CKM.4
O.ECC_DHKE                                FCS_COP.1/ECC_DHKE
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.ECC_KeyGen                              FCS_CKM.1/ECC
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.SHA                                     FCS_COP.1/SHA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]

                                    The justification of the security objectives O.RSA, O.RSA_PubExp, O.RSA_KeyGen,
                                    O.ECDSA, O.ECC_DHKE, O.ECC_KeyGen and O.SHA are all as follows:
                                    • Each objective is directly implemented by a single SFR specifying the (cryptographic)
                                      service that the objective wishes to achieve (see the above table for the mapping).
                                    • The requirements and architectural measures that originally were taken from the
                                      Protection Profile [5] and thus were also part of the Security Target of the hardware
                                      (chip) evaluation support the security objectives:
                                      – FRU_FLT.2 and FPT_FLS.1 supports the objective by ensuring that the TOE works
                                        correctly (i.e., all of the TOE’s capabilities are ensured) within the specified operating
                                        conditions and maintains a secure state when the TOE is outside the specified

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       22 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                       operating conditions. A secure state is also entered when perturbation or DFA attacks
                                       are detected.
                                     – FDP_ITT.1[HW] (for User Data) and FPT_ITT.1[HW] (for TSF Data) ensure that no
                                       User Data (plain text data, keys) or TSF Data is disclosed when they are transmitted
                                       between different functional units of the TOE (i.e., the different memories, the CPU,
                                       cryptographic co-processors), thereby supporting the objective in keeping confidential
                                       data secret.
                                     – FDP_IFC.1 also supports the aspects of confidentiality by ensuring that User
                                       Data and TSF Data are not accessible from the TOE except when the Security IC
                                       Embedded Software decides to communicate them via an external interface.
                                     – FDP_RIP.1[SW] and FCS_CKM.4 ensures that the TOE provides procedural
                                       measures to prevent disclosure of memory contents that was used by the TOE. The
                                       Crypto Library supports FDP_RIP.1[SW] and FCS_CKM.4 by making all memory
                                       contents used by the library no longer available. Note that the requirement for
                                       residual information protection applies to all functionality of the Crypto Library.

                           6.3.2 Extended requirements
                                    This Security Target does not define extended requirements.

                           6.3.3 Dependencies of security requirements
                                    SFRs [FDP_ITC.1, or FDP_ITC.2 or FCS_CKM.1] are not included in this Security Target
                                    for FCS_COP.1/SHA since the TOE only provides a pure engine for these algorithms
                                    without additional features like the handling of keys or importing data from outside the
                                    TOE. Therefore the Security IC Embedded Software must fulfil these requirements
                                    related to the needs of the realized application.

                           6.3.4 Rationale for the Assurance Requirements
                                    The selection of assurance components and augmentations of Crypto Library on N7021
                                    is generally based on EAL6, the underlying Protection Profile [5], and the Security Target
                                    of the hardware [13] of the N7021.
                                    EAL6 was chosen to provide an even stronger baseline of assurance than the EAL4 in
                                    the Protection Profile. The augmentations ALC_FLR.1 and ASE_TSS.2 were chosen to
                                    extend the level of assurance even further.




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      23 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



7         TOE Summary Specification
                                    This chapter describes the “IT Security Functionality”.

                              7.1 IT Security Functionality
                                    The evaluation of this cryptographic library is performed as a composite evaluation,
                                    where the TOE comprises both the underlying hardware and the embedded software
                                    (Crypto Library). The TOE of this composite evaluation therefore extends the security
                                    functionality already available in the chip platform (see section 7.1 “Portions of the TOE
                                    Security Functionality” of the Hardware Security [13]).
                                    The security functionality of N7021
                                    The security functionality of the hardware platform for the N7021 is described in the
                                    Hardware Security Target [13]. They entirely apply to this Security Target.
                                    Note 8. The security functionality SF.LOG is extended by the Crypto Library as described
                                    in Security Features of the TOE.


                                    The additional security functionality provided by the TOE is described in the following
                                    sub-sections.
                                    The IT security functionalities directly correspond to the TOE security functional
                                    requirements defined in Section 6.1. The definitions of the IT security functionalities refer
                                    to the corresponding security functional requirements.

                           7.1.1 Security Services of the TOE

                         7.1.1.1    SS.RSA

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for data encryption, decryption, signature and verification. All algorithms are
                                    defined in PKCS #1, v2.2 (RSAEP, RSADP, RSAP1, RSAVP1)
                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    The TOE contains modular exponentiation functions, which, together with other functions
                                    in the TOE, perform the operations required for RSA encryption or decryption. Two
                                    different RSA algorithms are supported by the TOE, namely the "Simple Straight Forward
                                    Method" (called RSA "straight forward", the key consists of the pair n and d) and RSA
                                    using the "Chinese Remainder Theorem" (RSA CRT, the key consists of the quintuple p,
                                    q, dp, dq, qInv).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA

                         7.1.1.2    SS.RSA_Pad

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for message and signature encoding. This IT security functionality supports the
                                    EME-OAEP and EMSA-PSS signature scheme. All algorithms are defined in PKCS #1,
                                    v2.2 (EME-OAEP, EMSA-PSS)

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       24 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PAD

                         7.1.1.3    SS.RSA_PublicExp

                                    The TOE provides functions that implement computation of an RSA public key from a
                                    private CRT key. All algorithms are defined in PKCS #1, v2.2.
                                    This routine supports various key lengths from 512 bits to 4096 bits (CRT).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PubExp

                         7.1.1.4 SS.ECDSA

                                    The TOE provides functions to perform ECDSA Signature Generation and Signature
                                    Verification according to ISO/IEC 14888-3:2015 [18], ANSI X9.62 [21], FIPS PUB 186-4
                                    [17] and IEEE Std 1363™-2000 [20]
                                    Note that hashing of the message must be done beforehand and is not provided by this
                                    security functionality, but could be provided by SS.SHA.
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECDSA supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/ECDSA
                                    The TOE further provides functions to perform a full ECC point addition as well as a basic
                                    curve parameter check for EC domain parameter. These functionalities are additionally
                                    assessed by the ITSEF performing the evaluation.

                         7.1.1.5 SS.ECC_DHKE

                                    The TOE provides functions to perform Diffie-Hellman Key Exchange according to ISO/
                                    IEC 11770-3:2015 [15], ANSI X9.63 [22] and IEEE Std 1363™-2000 [20]
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECC_DHKE supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,


Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       25 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/ECC_DHKE

                         7.1.1.6 SS.RSA_KeyGen

                                    The TOE provides functions to generate RSA key pairs as described in PKCS #1, v2.2,
                                    and FIPS 186-4 [17].
                                    It supports various key lengths from 512 bits to 4096 bits.
                                    Two different output formats for the key parameters are supported by the TOE, namely
                                    the "Simple Straight Forward Method" (RSA "straight forward") and RSA using the
                                    "Chinese Remainder Theorem" (RSA CRT).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_CKM.1/RSA

                         7.1.1.7 SS.ECC_KeyGen

                                    The TOE provides functions to perform ECC over GF(p) Key Generation according to
                                    ISO/IEC 14888-3:2015 [18], ANSI X9.62 [21] and FIPS PUB 186-4 [17].
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECC_KeyGen supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_CKM.1/ECC

                         7.1.1.8 SS.SHA

                                    The TOE implements functions to compute the Secure Hash Algorithms SHA-1,
                                    SHA-224, SHA-256, SHA-384 and SHA-512 according to the standard FIPS 180-4 [16]
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/SHA




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       26 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



8         Annexes

                              8.1 Further Information contained in the PP
                                    The Annex of the Protection Profile ([5], chapter 7) provides further information. Section
                                    7.1 of the PP describes the development and production process of smartcards,
                                    containing a detailed life-cycle description and a description of the assets of the
                                    Integrated Circuits Designer/Manufacturer. Section 7.6 of the PP gives examples of
                                    Attack Scenarios.

                              8.2 Glossary and Vocabulary
                                    Note: To ease understanding of the used terms the glossary of the Protection Profile [5]
                                    is included here.
                                    Application Data                                 All data managed by the Security IC Embedded
                                                                                     Software in the application context. Application data
                                                                                     comprise all data in the final Security IC.
                                    Authentication reference                         Data used to verify the claimed identity in an
                                    data                                             authentication procedure.
                                    Authentication verification                      Data used to prove the claimed identity in an
                                    data                                             authentication procedure.
                                    Composite Product                                Role installing or finalizing the IC Security IC Embedded
                                    Integrator                                       Software and the applications on platform transforming
                                                                                     the TOE into the unpersonalized Composite Product
                                                                                     after TOE delivery. The TOE Manufacturer may
                                                                                     implement IC Security IC Embedded Software delivered
                                                                                     by the Security IC Embedded Software Developer
                                                                                     before TOE delivery (e.g. if the IC Security IC Embedded
                                                                                     Software is implemented in ROM or is stored in the
                                                                                     non-volatile memory as service provided by the IC
                                                                                     Manufacturer or IC Packaging Manufacturer).
                                    Composite Product                                The Composite Product Manufacturer has the following
                                    Manufacturer                                     roles (i) the Security IC Embedded Software Developer
                                                                                     (Phase 1), (ii) the Composite Product Integrator (Phase
                                                                                     5) and (iii) the Personalizer (Phase 6). If the TOE is
                                                                                     delivered after Phase 3 in form of wafers or sawn
                                                                                     wafers (dice) he has the role of the IC Packaging
                                                                                     Manufacturer (Phase 4) in addition. The customer of the
                                                                                     TOE Manufacturer who receives the TOE during TOE
                                                                                     Delivery. The Composite Product Manufacturer includes
                                                                                     the Security IC Embedded Software developer and all
                                                                                     roles after TOE Delivery up to Phase 6 (refer to Figure 2
                                                                                     on page 10 and Section 7.1.1).
                                    End-consumer                                     User of the Composite Product in Phase 7.
                                    IC Dedicated Software                            IC proprietary software embedded in a Security IC
                                                                                     (also known as IC firmware) and developed by the IC
                                                                                     Developer. Such software is required for testing purpose
                                                                                     (IC Dedicated Test Software) but may provide additional
Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       27 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                                                                    services to facilitate usage of the hardware and/or
                                                                                    to provide additional services (IC Dedicated Support
                                                                                    Software).
                                    IC Dedicated Test Software That part of the IC Dedicated Software (refer to above)
                                                               which is used to test the TOE before TOE Delivery but
                                                               which does not provide any functionality thereafter.
                                    IC Dedicated Support                            That part of the IC Dedicated Software (refer to above)
                                    Software                                        which provides functions after TOE Delivery. The usage
                                                                                    of parts of the IC Dedicated Software might be restricted
                                                                                    to certain phases.
                                    Initialization Data                             Initialization Data defined by the TOE Manufacturer to
                                                                                    identify the TOE and to keep track of the Security IC’s
                                                                                    production and further life-cycle phases are considered
                                                                                    as belonging to the TSF data. These data are for
                                                                                    instance used for traceability and for TOE identification
                                                                                    (identification data).
                                    Integrated Circuit (IC)                                                 3.2 (2)
                                                                                            [IEEE1363], ch. 8.1.3.1(2)
n_d               IFX RSA key generation (i.e. without       512 - 2112 Bits                [RSA-PKCSB] , ch. 3.1 and
                  CRT) and return of (n, d)                                                 3.2 (1)
                                                                                            [IEEE1363] , ch. 8.1.3.1(1)
p_q_d             IFX RSA key generation (i.e. without       512 – 2112 Bits                [IEEE1363] , ch. 8.1.3.1(3)
                  CRT) and return of (p , q, d)

Note:            RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.4/RSA                      Cryptographic key destruction
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/RSA                    The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method destruction of RAM key during system or
                                   power on reset1 that meets the following: None2

Note:            The TOE can be delivered with or without the optional RSA library. If the RSA library is not deliverd, the
                 TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
                 delivered cryptographic RSA library cannot be used and therefore the SFRs of this chapter are also not
                 applicable.

6.1.3.4                 Elliptic Curve Cryptography (ECC)
For cryptographic ECC functionality, the TOE shall meet the requirement cryptographic operation (FCS_COP.1)
and cryptographic key construction (FCS_CKM .1) as specified below:

FCS_COP.1/ECC/<iteration>                 Cryptographic operation
Hierarchical to:                          No other components.
Dependencies:                             [FDP_ITC.1 Import of user data of the Composite TOE without security
                                          attributes, or

1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               34                                                       v4.0
                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                     FDP_ITC.2 Import of user data of the Composite TOE with security
                                     attributes, or
                                     FCS_CKM.1 Cryptographic key management]
                                     FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/ECC/<iteration>          The TSF shall perform [assignment: list of cryptographic operations] in
                                     accordance with a specified cryptographic algorithm [assignment:
                                     cryptographic algorithm]
                                     and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                     meet the following standards: [assignment: list of standards]

Table 20      Cryptographic table for FCS_COP.1/ECC
 <iteration>      [assignment: list of     [assignment: [assignment:             [assignment: list of standards]
                  cryptographic            cryptographic cryptographic
                  operations]              algorithm]    key sizes]

 SIG              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.3
                  generation               ECSP-DSA                              [IEEE1363], ch. 7.2.7
 VER              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.4.1
                  verification             ECVP-DSA                              [IEEE1363], ch. 7.2.8
 DH               ECDH key agreement ECDH                    160 – 521 Bits      [ANSX9.63], ch. 5.4.1
                                     ECSVHDP-DH                                  [ISO11770_3], appendix D.6
                                                                                 [IEEE1363], ch. 7.2.1
 ADD              EC point addition        C = A+B           160 – 521 Bits      n.a.

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

Note:         For the /SIG iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step d) is not supported

Note:         For the /VER iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step b) is not supported.
              Beside noted calculation, our algorithm adds a random multiple of order of the basepoint to the
              calculated values u1 and u2.

Note:         For the/ DH iteration, the implementation always returns the y-coordinate in addition to the x-
              coordinate.

Note:         For the /ADD iteration, the elliptic curve points A, B and C are considered as secrets.

Note:         Cofactor multiplication is not supported

FCS_CKM.1/ECC                 Cryptographic key generation
Hierarchical to               No other components.
Dependencies                  FCS_CKM.2 Cryptographic key distribution, or
                              FCS_COP.1 Cryptographic operation]

Security Target                                            35                                                    v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/ECC                 The TSF shall generate cryptographic keys in accordance with a specified
                                cryptographic key generation algorithm EC key generation1 and specified
                                cryptographic key sizes of 160-521 bits2 that meet the following: [ANSX9.62], ch.
                                A4.3 and [IEEE1363], ch. A.16.9.3

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

FCS_CKM.4/ECC                   Cryptographic key destruction
Hierarchical to:                No other components.
Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                FDP_ITC.2 Import of user data with security attributes, or
                                FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/ECC                 The TSF shall destroy cryptographic keys in accordance with a specified
                                cryptographic key destruction method destruction of RAM key during system or
                                power on reset4 that meets the following: None5


Note:         The TOE can be delivered with or without the optional ECC library. If the ECC library is not deliverd, the
              TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
              delivered cryptographic ECClibrary cannot be used and therefore this SFR is also not applicable. .




6.1.4                Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

FPT_TST.2                       Subset TOE testing
Hierarchical to:                No other components.
Dependencies:                   No dependencies
FPT_TST.2.1                     The TSF shall run a suite of self tests at the conditions request of the Security IC
                                Embedded Software1 to demonstrate the correct operation of the alarm lines
                                and/or the environmental sensor mechanisms:


1
  [assignment: list of cryptographic operations]
2
  [assignment: cryptographic key sizes
3
  [assignment: list of standards]
4
  [assignment: cryptographic key destruction method]
5
  [assignment: list of standards]

Security Target                                             36                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                       Please refer to the confidential Security Target2


6.1.5                  Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent
that one application can access code and/or data of another application. For this reason the TOE provides Area
based Memory Access Control. The underlying Memory Protection Unit (MPU) is documented in Appendix B3.5
of the ARMv7 M architecture reference manual [ARMv7M].
In particular, the MPU provides full support for:
 Protection regions.
 Overlapping protection regions, with ascending region priority:
  − Region 7 = highest priority.
  − Region 0 = lowest priority.
 Access permissions.
   MPU mismatches and permission violations invoke the programmable-priority MemManage fault handler.

The MPU can be used to:
   Enforce privilege rules, preventing user applications from corrupting operating system data.
   Separate processes, blocking the active task from accessing other tasks’ data.
   Enforce access rules, allowing memory regions to be defined as read-only or detecting unexpected memory
    accesses.

The SFRs are provided by the Memory Access Control Policy (FDP_ACC.1 and dependencies).


6.1.5.1                Subjects, objects and operations of the Memory Access Control Policy
Subjects:
 MPU

Objects:
 memory/code addresses

Operations:
 Read a/o write a/o execute access


6.1.5.2                Security attributes of the Memory Access Control Policy
Security Attribute which define the roles for Subject MPU:
 Npriv flag defining privilege/non-privilege mode


Security Attribute which control the behavior of the Subject MPU:



1
  [selection: during initial start-up, periodically during normal operation, at the request of the authorized user, and/or at the conditions
     [assignment: conditions under which self test should occur]]
2
  [assignment: functions and/or mechanisms]

Security Target                                                      37                                                                 v4.0
                                                                                                                                  2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 MPU enable/disable bit.
 8 regions with the following attributes
    − a unique priority
    − the enable bit
    − the xn (execute never) bit
    − the start address and size
    − an access matrix which defines if an Operation of the MPU (Subject) to a memory/code address (Object)
     lying in the region is allowed or denied
 A bit defining the acces behavior of the default region, i.e. memory/code addresses not covered by one of the
  8 MPU regions.


Security Attributes for objects:
There are no security attributes for objects.


6.1.5.3            Access control rules of the Memory Access Control Policy
The following generic rules shall apply in case the MPU is enabled. In case the MPU is disabled, a privileged and
unprivileged code has full read/write/execute rights to all addresses.
 If an address is contained in multiple enabled regions, then the region with the highest priority defines the
    access rights.
   If an address is contained in no region then the default region defines the access rights.
   The region defining the access rights checks if the Subject has access to the Object with respect to the desired
    Operation. In case the access is denied the MPU throws an access violation exception. The checks are done
    according to the access matrix inTable 21.
   overlapping regions, have access to other regions with ascending region priority:
    region 7 = highest priority, region 0 = lowest priority
   execution of code is bound to the read access of Table 21 and the xn bit. If the xn bit is cleared and read
    access is enabled then execution of code is defined by Table 21. If the xn bit is set then execution is never
    allowed.

Table 21      Access matrix for read(execute)/write access
 Privileged Mode Permissions            User Mode                             Description
                                        Permissions
 No access                              No access                             All accesses in user mode and
                                                                              privileged mode generate a
                                                                              permission fault
 Read/write                             No access                             Privilege mode has full access
                                                                              while any access from user mode
                                                                              leads to a permission fault.
 Read/write                             Read(execute) only                    Privileged mode has full access
                                                                              while the user mode has no write
                                                                              access rights. Execute access in
                                                                              User mode further depends on the
                                                                              xn bit.
 Read/write                             Read(execute)/write                   Privileged mode has read and
                                                                              execute access rights. Write

Security Target                                         38                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Privileged Mode Permissions                 User Mode                                      Description
                                                Permissions
                                                                                               accesses from privileged mode
                                                                                               lead to a permission fault.
                                                                                               Any access of the user mode leads
                                                                                               to a permission fault.
    Read only                                   No access                                      Privileged mode has read and
                                                                                               execute access rights. Write
                                                                                               accesses lead to a permission
                                                                                               fault.
                                                                                               The same holds for the user mode,
                                                                                               except execute access further
                                                                                               depends on the xn bit.
    Read only                                   Read(execute) only                             All accesses in user mode and
                                                                                               privileged mode generate a
                                                                                               permission fault


6.1.5.4                SFRs of the Memory Access Control Policy
FDP_ACC.1                    Subset access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy as1 defined in section 6.1.5.12.


FDP_ACF.1                    Security attribute based access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACC.1 Subset access control
                             FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1                  The TSF shall enforce the Memory Access Control Policy3 to objects based on the
                             following: Attributes as specified in section 6.1.5.24 .
FDP_ACF.1.2                  The TSF shall enforce the following rules to determine if an operation among
                             controlled subjects and controlled objects is allowed: As specified in the section
                             6.1.5.35.
FDP_ACF.1.3                  The TSF shall explicitly authorize access of subjects to objects based on the following
                             additional rules: none6.
FDP_ACF.1.4                  The TSF shall explicitly deny access of subjects to objects based on the following
                             additional rules: none1.


1
  editorially refined
2
  [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]
3
  [assignment: access control SFP]
4
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
5
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
6
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]

Security Target                                                      39                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)


FMT_MSA.3                    Static attribute initialization
Hierarchical to:             No other components.
Dependencies:                FMT_MSA.1 Management of security attributes
                             FMT_SMR.1 security roles
FMT_MSA.3.1                  The TSF shall enforce the Memory Access Control Policy2 to provide restrictive3 default
                             values for security attributes that are used to enforce the SFP.
FMT_MSA.3.2                  The TSF shall allow the privilege mode4 to specify alternative initial values to override
                             the default values when an object or information is created.


FMT_MSA.1                    Management of security attributes
Hierarchical to:             No other components.
Dependencies:                [FDP_ACC.1 Subset access control or FDP_IFC.1 Subset information flow control]
                             FMT_SMF.1 Specification of management functions
                             FMT_SMR.1 Security roles
FMT_MSA.1.1                  The TSF shall enforce the Memory Access Control Policy5 to restrict the ability to
                             modify6 the security attributes Security Attribute which control the behavior of the
                             Subject MPU7 to the privilege mode8.


FMT_SMF.1                    Specification of management functions
Hierarchical to:             No other components
Dependencies:                No dependencies
FMT_SMF.1.1                  The TSF shall be capable of performing the following security management functions:
                             modifying the security attributes9.


FMT_SMR.1                    Security roles
Hierarchical to:             No other components.
Dependencies:                FIA_UID.1 Timing of identification
FMT_SMR.1.1                  The TSF shall maintain the roles privilege mode and non-privilege mode10.
FMT_SMR.1.2                  The TSF shall be able to associate users with roles.

6.1.6                  Data Integrity
FDP_SDI.2                    Stored data integrity monitoring and action


1
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
2
  [assignment: access control SFP, information flow control SFP]
3
  [selection, choose one of: restrictive, permissive, [assignment: other property]]
4
  [assignment: the authorised identified roles]
5
  [assignment: access control SFP(s), information flow control SFP(s)]
6
  [selection: change_default, query, modify, delete, [assignment: other operations]]
7
  [assignment: list of security attributes]
8
  [assignment: the authorised identified roles]
9
  [assignment: list of management functions to be provided by the TSF]
10
   [assignment: the authorised identified roles]

Security Target                                                       40                                             v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Hierarchical to:             FDP_SDI.1 stored data integrity monitoring
Dependencies:                No dependencies
FDP_SDI.2.1                  The TSF shall monitor user data stored in containers controlled by the TSF for data
                             integrity and one- and/or more-bit-errors1 on all objects, based on the following
                             attributes: error correction ECC for the SOLID FLASHҹ NVM2.
FDP_SDI.2.2                  Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                             FLASHҹ NVM automatically and inform the user about other bit errors3.



FDP_SDC.1                    Stored data confidentiality
Hierarchical to:             No other components
Dependencies:                No dependencies
FDP_SDC.1.1                  The TSF shall ensure the confidentiality of the information of the user data while it is
                             stored in the RAM and SOLID FLASHҹ NVM4.




6.1.7                  Support of Flash Loader
The TOE provides a Flash Loader to download user data into the SOLID FLASHҹ NVM, either during production
of the TOE or at customer site. Depending on the configuration option EA the Flash Loader claims different sets
of SFRs. [PP0084] section 7.3.1 “Package 1: Loader dedicated for usage in secured environment only” is claimed
for both options. [PP0084] section 7.2 Package “Authentication of the Security IC” and [PP0084] section 7.3.2
“Package 2: Loader dedicated for usage by authorized users only” is only claimed in case TOE is ordered with
EA unavailable, however a subset of SFRs from loader package 2 is also claimed, if TOE is ordered with EA
available.




6.1.8                  Flash Loader Policy
The table as follows shows the Flash Loader SFR claims in dependency of the order option EA.

Table 22       Flash loader SFR claims
EA unavailable                                                  EA available
Limited capabilities (FMT_LIM.1/Loader)                         Limited capabilities (FMT_LIM.1/Loader)
Limited availability – Loader (FMT_LIM.2/Loader)                Limited availability – Loader (FMT_LIM.2/Loader)
Authentication Proof of Identity (FIA_API.1)                    -
Inter-TSF trusted channel (FTP_ITC.1)                           -
Basic data exchange confidentiality (FDP_UCT.1)                 Basic data exchange confidentiality (FDP_UCT.1)
Data exchange integrity (FDP_UIT.1)                             Data exchange integrity (FDP_UIT.1)

1
  [assignment: integrity errors]
2
  [assignment: user data attributes]
3
  [assignment: action to be taken]
4
  [assignment: memory area]

Security Target                                               41                                                      v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

EA unavailable                                                EA available
Subset access control – Loader (FDP_ACC.1/Loader)             Subset access control – Loader (FDP_ACC.1/Loader)
Security attribute based access control – Loader              Security attribute based access control – Loader
(FDP_ACF.1/Loader)                                            (FDP_ACF.1/Loader)
Management of TSF data – Loader                               Management of TSF data – Loader
(FMT_MTD.1/Loader)                                            (FMT_MTD.1/Loader)
Security Roles – Loader (FMT_SMR.1/Loader)                    Security Roles – Loader (FMT_SMR.1/Loader)
Specification of Management Functions – Loader                Specification of Management Functions – Loader
(FMT_SMF.1/Loader)                                            (FMT_SMF.1/Loader)
User Identification before any action – Loader                User Identification before any action – Loader
(FIA_UID.2/Loader)                                            (FIA_UID.2/Loader)



The TOE shall meet the loader SFRs as specified below:

FMT_LIM.1/Loader            Limited Capabilities
    Hierarchical to:         No other components.
    Dependencies:            No other components
    FMT_LIM.1.1/Loader       The TSF shall be designed and implemented in a manner that limits its capabilities so
                             that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                             enforced: Deploying Loader functionality after permanent deactivation does not
                             allow stored user data to be disclosed or manipulated by unauthorized user1.



FMT_LIM.2/Loader            Limited availability - Loader
    Hierarchical to:         No other components.
Dependencies:               FMT_LIM.1 Limited capabilities.
    FMT_LIM.2.1/Loader       The TSF shall be designed in a manner that limits its availability so that in conjunction
                             with “Limited capabilities (FMT_LIM.1)” the following policy is enforced: The TSF
                             prevents deploying the Loader functionality after permanent deactivation2.

Regarding FMT_LIM.1.1/Loader the User Guidance requires the Flash Loader to be permanently deactivated
prior delivery to the end user (Phase 7).
 FTP_ITC.1               Inter-TSF trusted channel
    Hierarchical to:         No other components.
    Dependencies:            No dependencies.
    FTP_ITC.1.1              The TSF shall provide a communication channel between itself and administrator
                             user, or Download operator user3, that is logically distinct from other communication
                             channels and provides assured identification of its end points and protection of the
                             channel data from modification or disclosure.




1
  [assignment: Limited capability policy]
2
  [assignment: Limited availability policy]
3
  [assignment: users authorized for using the Loader]

Security Target                                             42                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    FTP_ITC.1.2              The TSF shall permit another trusted IT product1 to initiate communication via the
                             trusted channel.
    FTP_ITC.1.3              The TSF shall initiate communication via the trusted channel for deploying Loader for
                             downloading user data2.

    FDP_UCT.1                Basic data exchange confidentiality
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP3 to receive4 user data in a manner protected
                             from unauthorised disclosure.

    FDP_UIT.1                Data exchange integrity
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP5 to receive6 user data in a manner protected
                             from modification, deletion, insertion7 errors.
FDP_UIT.1.2                 The TSF shall be able to determine on receipt of user data, whether modification,
                            deletion, insertion8 has occurred.



FDP_ACC.1/Loader            Subset access control - Loader
    Hierarchical to:         No other components.
    Dependencies:            FDP_ACF.1 Security attribute based access control.
    FDP_ACC.1.1/Loader       The TSF shall enforce the Loader SFP9 on
                              the subjects Administrator User, Download Operator User and Image Provider,
                              the objects user data in SOLID FLASHҹ NVM memory of the TOE,
                              the operation deployment of Loader10




    FDP_ACF.1/Loader         Security attribute based access control - Loader
    Hierarchical to:         No other components.


1
  [selection: the TSF, another trusted IT product]
2
  [assignment: list of functions for which a trusted channel is required][assignment: rules]
3
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
4
  [selection: transmit, receive]
5
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
6
  [selection: transmit, receive]
7
  [selection: modification, deletion, insertion, replay]
8
  [selection: modification, deletion, insertion, replay]
9
  [assignment: access control SFP]
10
   [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]

Security Target                                                    43                                            v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:             FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        FDP_ACF.1.1 The TSF shall enforce the Loader SFP1 to objects based on the following:
                              the subjects and objects of FDP_ACC.1.1/Loader without security attributes2
    FDP_ACF.1.2/Loader        FDP_ACF.1.2 The TSF shall enforce the following rules to determine if an operation
                              among controlled subjects and controlled objects is allowed:
                              The authenticated Administrator User or authenticated Download Operator User can
                              modify the user data by new user data when the new user data is authorized by the
                              Image Provider3
    FDP_ACF.1.3/Loader        FDP_ACF.1.3 The TSF shall explicitly authorise access of subjects to objects based on
                              the following additional rules: none4.
    FDP_ACF.1.4/Loader        The TSF shall explicitly deny access of subjects to objects based on the following
                              additional rules: none5.

Note:          The security functional requirements FIA_API.1, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1, FDP_ACC.1/Loader
               and FDP_ACF.1/Loader apply only to TOE products with activated Flash Loader. In other cases the
               Flash Loader is not available anymore and the user data download is completed.

The following SFRs have been added to the SFRs from Flash Loader package 2 of [PP0084] in order to describe
the management of the various Flash Loader authentication keys.



FMT_MTD.1/Loader               Management of TSF data
    Hierarchical to:           No other components.
    Dependencies:              FMT_SMR.1 Security roles
                               FMT_SMF.1 Specification of Management Functions
    FMT_MTD.1.1/Loader         The TSF shall restrict the ability to change_default, modify, delete6 the Authentication
                               keys for Administrator User, Download Operator User and Image Provider7 to
                               Administrator User, Download Operator User8.

Note:          The Administrator User can manage the keys for Administration User, Download Operator User and
               Image Provider. The Download Operator User can delete the key for Image Provider and Download
               Operator, otherwise manage the keys for the Download Operator User only. The image provider cannot
               modify any keys or perform authentication with the Flash Loader. It can simply built authentic
               loadable images.

FMT_SMR.1/Loader               Security roles
    Hierarchical to:           No other components.


1
  [assignment: access control SFP]
2
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
3
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
4
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]
5
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
6
  [selection: change_default, query, modify, delete, clear, [assignment: other operations]]
7
  [assignment: list of TSF data]
8
  [assignment: the authorised identified roles]

Security Target                                                      44                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMR.1.1/Loader       The TSF shall maintain the roles Administrator User, Download Operator User, Image
                             provider1.
    FMT_SMR.1.2/Loader       The TSF shall be able to associate users with roles.



FMT_SMF.1/Loader             Specification of Management Functions
    Hierarchical to:         No other components.
    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMF.1.1/Loader       The TSF shall be capable of performing the following management functions: Change
                             Key, Invalidate Key2.

Note:          “Change Key” of this SFR combines the “Change default” and “modify” operations from SFR
               FMT_MTD.1/Loader. “Invalidate Key” of this SFR is equivalent to the “delete” operation from SFR
               FMT_MTD.1/Loader.

    FIA_UID.2/Loader         User Identification before any action
    Hierarchical to:         FIA_UID.1
    Dependencies:            No dependencies.
    FIA_UID.2.1/Loader       The TSF shall require each user to be successfully identified before allowing any other
                             TSF-mediated actions on behalf of that user.


6.1.9                  Support of Authentication of the Security IC
The Flash Loader provides a security IC authentication service.



FIA_API.1                   Authentication Proof of Identity
Hierarchical to:            No other components.
Dependencies:               No dependencies.
FIA_API.1.1                 The TSF shall provide a authentication mechanism according to [ISO9798_2] section
                            6.2.2 Mechanism 4: Three-pass authentication3 to prove the identity of the TOE4 to an
                            external entity.

This security functional requirement applies only to TOE products with Flash Loader activated and TOE is
ordered with EA unavailable.

6.2                    TOE Security Assurance Requirements
The evaluation assurance level is EAL6 augmented with ALC_FLR.1. In the following table, the security
assurance requirements are given.


1
  [assignment: the authorised identified roles]
2
  [assignment: list of management functions to be provided by the TSF]
3
  [assignment: authentication mechanism]
4
  [selection: TOE, [assignment: object, authorized user or role]]

Security Target                                                   45                                              v4.0
                                                                                                            2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Table 23      Assurance components
 Aspect                    Acronym          Description                                Refinement
 Development               ADV_ARC.1        Security Architecture Description          [PP0084]
                           ADV_FSP.5        Complete semi-formal functional            [PP0084]
                                            specification with additional error
                                            information
                           ADV_IMP.2        Complete mapping of the                    [PP0084]
                                            implementation representation of the
                                            TSF
                           ADV_INT.3        Minimally complex internals
                           ADV_TDS.5        Complete semi-formal modular design
                           ADV_SPM.1        Formal TOE security policy model
 Guidance Documents        AGD_OPE.1        Operational user guidance                  [PP0084]
                           AGD_PRE.1        Preparative procedures                     [PP0084]
 Life-Cycle Support        ALC_CMC.5        Advanced support                           [PP0084]
                           ALC_CMS.5        Development tools CM coverage              [PP0084]
                           ALC_DEL.1        Delivery procedures                        [PP0084]
                           ALC_DVS.2        Sufficiency of security measures           [PP0084]
                           ALC_LCD.1        Developer defined life-cycle model
                           ALC_TAT.3        Compliance with implementation
                                            standards – all parts
 ST Evaluation             ASE_CCL.1        Conformance claims
                           ASE_ECD.1        Extended components definition
                           ASE_INT.1        ST introduction
                           ASE_OBJ.2        Security objectives
                           ASE_REQ.2        Derived security requirements
                           ASE_SPD.1        Security problem definition
                           ASE_TSS.1        TOE summary specification
 Tests                     ATE_COV.3        Rigorous analysis of coverage              [PP0084]
                           ATE_DPT.3        Testing: modular design
                           ATE_FUN.2        Ordered functional testing
                           ATE_IND.2        Independent testing - sample
 Vulnerability             AVA_VAN.5        Advanced methodical vulnerability          [PP0084]
 Assessment                                 analysis

6.2.1              Refinements
Some refinements are taken unchanged from [PP0084]. Table 23 provides an overview.
Some refinements from [PP0084] have to be discussed here in the ST, as the assurance level is increased.




Security Target                                       46                                                   v4.0
                                                                                                     2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.2.1.1              Implementation representation (ADV_IMP)
The refinement of [PP0084] requires the evaluator to check for completeness. In case of ADV_IMP.2 the entire
implementation representation has to be provided anyhow. A check for completeness is also applicable in case
the entire implementation representation is provided.

6.2.1.2              Life cycle support (ALC_CMS)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ALC_CMS.5.
The assurance package ALC_CMS.4 is extended to ALC_CMS.5 with aspects regarding the configuration control
system for the TOE. The refinement is still valid.

6.2.1.3              Configuration management capabilities (ALC_CMC)
The refinement from [PP0084] details, how configuration management has to be also applied to production.
This is also applicable for ALC_CMC.5. ALC_CMC.5 is not specifically focused on production.

6.2.1.4              Test Coverage (ATE_COV)
The refinement in [PP0084] clarifies, how to deal with testing of security mechanisms for physical protection. It
further requests the TOE to be tested under different operating conditions. These refinements are also
applicable for ATE_COV.3, which requires complete TSFI coverage.

6.2.1.5              Functional Specification (ADV_FSP)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ADV_FSP.5. The
assurance package ADV_FSP.4 is extended to ADV_FSP.5 with aspects regarding the level of description.
ADV_FSP.5 requires a semi-formal description in addition. The refinement is still valid.
For refinement details see [PP0084].

6.2.2                Security policy model details
EAL6 requires the development of a formal security policy model of the TSF, and establishing a correspondence
between the functional specification and this security policy model. Preserving internal consistency the
security policy model is expected to formally establish the security principles from its characteristics by means
of a mathematical proof.
ADV_SPM.1          Formal TOE security policy model
Hierarchical to:          No other components
Dependencies:             ADV_FSP.4 Complete function description
ADV_SPM.1.1D              The developer shall provide a formal security policy model for the
Memory Access Control Policy and the corresponding SFRs
              o    FDP_ACC.1 Subset Access Control
              o    FDP_ACF.1 Security attribute based access control
              o    FMT_MSA.1 Management of Security Attributes
              o    FMT_MSA.3 Static Attribute Initialization.
              o    FMT_SMF.1 Specification of management functions
              o    FMT_SMR.1 Security roles


Security Target                                          47                                                   v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Support of Flash Loader SFRs
            o FMT_LIM.1/Loader Limited Capabilities
            o FMT_LIM.2/Loader Limited availability – Loader
            o FTP_ITC.1 Inter-TSF trusted channel
            o FDP_UCT.1 Basic data exchange confidentiality
            o FDP_UIT.1 Data exchange integrity
            o FDP_ACC.1/Loader Subset access control – Loader
            o FDP_ACF.1/Loader Security attribute based access control – Loader
            o FMT_MTD.1/Loader Management of TSF data – Loader
            o FMT_SMR.1/Loader Security roles – Loader
            o FMT_SMF.1/Loader Specification of Management Functions – Loader
            o FIA_UID.2/Loader Use identification before any action – Loader
Support of Authentication of the Security IC SFR
            o FIA_API.1 Authentication Proof of Identity
Moreover, the following SFRs shall be addressed by the formal security policy model:
              o   FDP_SDI.2 Stored data integrity monitoring and action
              o   FDP_SDC.1 Stored data confidentiality
              o   FDP_ITT.1 Basic Internal Transfer Protection
              o   FDP_IFC.1 Information Flow Control
              o   FPT_ITT.1 Basic internal TSF data transfer protection
              o   FPT_PHP.3 Resistance to physical attack
              o   FPT_FLS.1 Failure with preservation of secure state
              o   FRU_FLT.2 Limited fault tolerance
              o   FMT_LIM.1 Limited capabilities
              o   FMT_LIM.2 Limited availability
              o   FAU_SAS.1 Audit storage
ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify the
          relevant portions of the statement of SFRs that make up that policy.
ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and any
          formal functional specification.
ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model and the
          functional specification.

6.3                 Security Requirements Rationale

6.3.1               Rationale for the Security Functional Requirements
While the security functional requirements rationale of the TOE are defined and described in [PP0084] section
6.3.1, 7.2.3, 7.3.1, 7.3.2, 7.4.1 and 7.4.2, the additional introduced SFRs are discussed below:

Table 24      Rational for additional SFR in the ST
 Objective                            TOE Security Functional Requirements
 O.Phys-Manipulation                  -       FPT_TST.2 „ Subset TOE security testing “
 O.Mem-Access                         -       FDP_ACC.1 “Subset access control”

Security Target                                        48                                                   v4.0
                                                                                                      2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Objective                            TOE Security Functional Requirements
                                      -     FDP_ACF.1 “Security attribute based access control”
                                      -     FMT_MSA.3 “Static attribute initialisation”
                                      -     FMT_MSA.1 “Management of security attributes”
                                      -     FMT_SMF.1 “Specification of Management Functions”
                                      -     FMT_SMR.1 “Security Roles”
 O.AES-TDES-MAC                       FCS_COP.1/SCL/TDES, FCS_COP.1/SCL/TDES-MAC, FCS_CKM.4/SCL,
                                      FCS_COP.1/SCL/AES, FCS_COP.1/SCL/AES-MAC,
 O.AES                                FCS_CKM.4/SCL, FCS_COP.1/SCL/AES
 O.TDES                               FCS_COP.1/SCL/TDES, FCS_CKM.4/SCL
 O.RSA                                FCS_COP.1/RSA/<iteration>, FCS_CKM.1/RSA/<iteration>,
                                      FCS_CKM.4/RSA
 O.ECC                                FCS_COP.1/ECC/<iteration>, FCS_CKM.1/ECC, FCS_CKM.4/ECC
 O.Prot_TSF_Confidentiality           -      FTP_ITC.1 Inter-trusted-TSF channel
                                      -      FDP_ACC.1/Loader Subset access control –Loader
                                      -      FDP_ACF.1/Loader Security attribute based access control –
                                      Loader
 O.Ctrl_Auth_Loader                   FMT_MTD.1/Loader, FMT_SMR.1/Loader, FMT_SMF.1/Loader,
                                      FIA_UID.2/Loader

The table above gives an overview how the security functional requirements are combined to meet the security
objectives. This table has to be read in addition to [PP0084] table 2 “Security Requirements versus Security
Objectives”. The detailed justification is given in the following:
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and
functions provided by the TOE can be tested after TOE Delivery. This security functional component is used
instead of the functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to
know which security functions or mechanisms can be tested. The functional component FPT_TST.1 does not
mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of
the integrity of TSF data and stored TSF executable code which might violate the security policy.
The security functional requirement FPT_TST.2 detects attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation.
The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1, FMT_SMF.1 and FMT_SMR.1 cover this security objective. The
implementation of these functional requirements is represented by the dedicated privilege level concept.
The additional SCL related SFRs support standard TDES and AES encryption and decryption. It also offers MAC
services based on these cryptographic primitives.
The additional cryptographic SFRs related to RSA and ECC are mapped to the respective RSA and ECC
objectives.
The additional loader SFRs describe the Flash Loader roles and the access rules. Therefore these additional
SFRs are mapped to O.Ctrl_Auth_Loader contributing to the aspect “access control for usage of the loader
functionality” as described in [PP0084]. In case EA is chosen, FTP_ITC.1 is not part of the TOE and therefore not


Security Target                                         49                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

mapped to O.Ctrl_Auth_Loader. However due to the confidentiality and integrity protection of downloaded
user data andone-way authentication from user towards Flash Loader, the loader can still be controlled in an
effective way and prevent misuse of unauthorized usage.
The loader SFR FTP_ITC.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader describe the requirement of a trusted
channel with role based access control in order to use the loader functionality. This prevents loading of
unauthorized software by unauthorized subjects and maps to O.Prot_TSF_Confidentiality. In case EA is chosen,
the Flash Loader requests a one-way authentication instead of a mutual authentication. FTP_ITC.1 is not part
of the TOE. However the objective is still met, because the one-way authentication and role based access
control together with the environmental objective OE.Prevent_Masquerade prevent unauthorized and
manipulative usage.
The justification of the security objective and the additional requirements show that they do not contradict the
rationale already given in [PP0084] for the assumptions, policy and threats defined there.
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions
are used as specified and that the User Data processed by these functions are protected as defined for the
application context. The TOE only provides the tool to implement the policy defined in the context of the
application.

6.3.1.1            Dependencies of Security Functional Requirements
The dependencies of security functional requirements are defined and described in [PP0084] section 6.3.2,
7.2.3, 7.3.1, 7.3.2, 7.4.1 and section 7.4.2 for the following security functional requirements: FDP_SDC.1,
FDP_SDI.2, FDP_ITT.1, FDP_IFC.1, FPT_ITT.1, FPT_PHP.3, FPT_FLS.1, FRU_FLT.2, FMT_LIM.1, FMT_LIM.2,
FCS_RNG.1. FAU_SAS.1, FIA_API.1, FMT_LIM.1/Loader, FMT_LIM.2/Loader, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1,
FDP_ACC.1/Loader, FDP_ACF.1/Loader.
The dependencies of the additional security functional requirements (the functional requirements in addition
to the ones defined in [PP0084]) are analysed in the following description.

Table 25      Dependency for cryptographic operation requirement
 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
 FPT_TST.2                           None                        n.a.
 FDP_ACC.1                           FDP_ACF.1                   Yes
                                     FDP_ACC.1                   Yes
 FDP_ACF.1
                                     FMT_MSA.3                   Yes
                                     FMT_MSA.1                   Yes
 FMT_MSA.3
                                     FMT_SMR.1                   Yes
                                     FDP_ACC.1 or FDP_IFC.1      Yes
 FMT_MSA.1                           FMT_SMR.1                   Yes
                                     FMT_SMF.1                   Yes
 FMT_SMF.1                           None                        n.a.
 FMT_SMR.1                           FIA_UID.1                   No, see comment 1
 FCS_COP.1                           FCS_CKM.4                   Yes
                                     [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]
 FCS_CKM.4                           [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]

Security Target                                        50                                                    v4.0
                                                                                                       2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
                                     [FCS_CKM.2,
 FCS_CKM.1                                                       Yes, FCS_CKM.4
                                     FCS_COP.1, FCS_CKM.4]
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UCT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UIT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
 FDP_ACF.1/Loader                    FMT_MSA.3                   No, see comment 3
 FMT_MTD.1/Loader                    FMT_SMR.1, FMT_SMF.1        Yes
 FMT_SMR.1/Loader                    FIA_UID.2                   Yes
 FMT_SMF.1/Loader                    FIA_UID.2                   Yes

Comment 1:
As the privileged mode and the non-privileged mode identified in FMT_SMR.1 are implicitly identified by the
MPU, the dependency to FIA_UID.1 is not applicable.
End of comment.
Comment 2:
The security functional requirement “Cryptographic operation (FCS_COP.1)” met by the TOE has the following
dependencies:
    [FDP_ITC.1 Import of user data without security attributes, or
    FDP_ITC.2 Import of user data with security attributes or
    FCS_CKM.1 Cryptographic key generation]
 encryption of the transmitted data and encrypting the nonce in the first step of PACE. The keys
are agreed between the TOE and the terminal as part of the PACE protocol according to FCS_CKM.1/DH_PACE.


FCS_COP.1/PACE_MAC             MAC Cryptographic operation – MAC
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_MAC      The TSFshall perform secure messaging – message authentication code in
                   accordance with a specified cryptographic algorithm CMAC and Retail-MAC and
                   cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant to
                   [ICAO_SAC] .
Application Note: In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used in Retail
mode for secure messaging.


6.3.2               Class FIA Identification and Authentication


FIA_AFL.1/PACE         Authentication failure handling – PACE authentication using non-blocking
authorisation data

CC Document                                           17                                                      3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchicalto:    No other components.
Dependencies:      FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE   The TSF shall detect when one unsuccessful authentication attempt occurs related to
                   authentication attempts using the PACE password as shared password
FIA_AFL.1.2/PACE   When the defined number of unsuccessful authentication attempts has been met, the
                   TSF shall increasingly slow down the performance up to a maximum not higher than 7
                   seconds verifying the authentication token.


FIA_UID.1/PACE     Timing of identification
Hierarchical to:   No other components.
Dependencies:      No dependencies.
FIA_UID.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carry out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS
                   4. none
                   on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE   The TSF shall require each user to be successfully identified before allowing any other
                   TSF-mediated actions on behalf of that user.


FIA_UAU.1/PACE     Timing of authentication
Hierarchical to:   No other components.
Dependencies:      FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE
FIA_UAU.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carrying out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS,
                   4. none
                   on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE           The TSF shall require each user to be successfully authenticated before allowing
                           any other TSF-mediated actions on behalf of that user.




FIA_UAU.4/PACE     Single-use authentication of the Terminals by the TOE


CC Document                                         18                                                    3.5
                                                                                                   2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchical to:      No other components.
Dependencies:         No dependencies.
FIA_UAU.4.1/PACE      The TSF shall prevent reuse of authentication data related to
                      1. PACE Protocol according to [ICAO_SAC]
                      2. Authentication Mechanism based on Triple-DES
                      3. none


FIA_UAU.5/PACE        Multiple authentication mechanisms
Hierarchi                                    type

                                                                                                  Hardware
                                                                                                                    SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
® TÜV, TUEV and TUV are registered trademarks  FMT_SMR.1 for BAC
FMT_MTD.1.1/INI_ENA The TSF shall restrict the ability to write the Initialisation Data and Pre-personalisation
                    Data to the Manufacturer.
Application Note: The application note 42 of [PP_BAC] applies. This application note provides a definition, what
is meant by “Pre-personalization Data”. This definition is also applicable to FMT_MTD.1/INI_ENA from
[PP_SAC]. Therefore FMT_MTD.1/INI_ENA from [PP_BAC] and [PP_SAC] can be combined.



CC Document                                            15                                                     3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

6.2.3              Class FPT Protection of the Security Functions
FPT_TST.1               TSF testing
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_TST.1.1             The TSF shall run a suite of self tests during initial start-up, to demonstrate the correct
                        operation of the TSF.
FPT_TST.1.2             The TSF shall provide authorised users with the capability to verify the integrity of the
                        TSF data.
FPT_TST.1.3             The TSF shall provide authorised users with the capability to verify the integrity of
                        stored TSF executable code.
Application Note: There is no contradiction between application note 46 of [PP_BAC] and application note 52 of
[PP_SAC]. In fact, although the wording is slightly different, the meaning of these application notes is identical.
Therefore either of these application notes applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be
combined.


FPT_PHP.3               Resistance to physical attack
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_PHP.3.1             The TSF shall resist physical manipulation and physical probing to the TSF by
                        responding automatically such that the SFRs are always enforced.
Application Note: Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application note 48 of
[PP_BAC] is only informative to the reader in the sense, that it provides a context to an older CC standard, but
not relevant for the interpretation of FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or
application note 53 of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.


6.3                SFRs specifically from [PP_SAC]

6.3.1              Class FCS: Cryptographic Support
FCS_CKM.1/DH_PACE Cryptographic key generation – Diffie-Hellman for PACE session keys
Hierarchical to:        No other components.
Dependencies:           [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic operation]
                        Justification: A Diffie-Hellman key agreement is used in order to have no key
                        distribution, therefore FCS_CKM.2 makes no sense in this case. FCS_CKM.4
                        Cryptographic key destruction: fulfilled by FCS_CKM.4
FCS_CKM.1.1/DH_PACE       The TSF shall generate cryptographic keys in accordance with a specified
                   cryptographic key generation algorithm Diffie-Hellman-Protocol compliant to
                   [PKCS#3], ECDH compliant to [TR_ECC] and specified cryptographic key size Table 6
                   column key size that meet the following: [ICAO_SAC].


CC Document                                              16                                                       3.5
                                                                                                           2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Table 6       FCS_CKM/DH_PACE Key Sizes
 algorithm                                                                Key size
 ECDH key agreement algorithm                                             192, 224, 256, 320, 384, 512, 521
 DH key agreement algorithm                                               1024, 1280, 1536, 2048
 AES session keys                                                         128, 192, 256
 TDES session keys                                                        112



FCS_COP.1/PACE_ENC Cryptographic operation – Encryption / Decryption AES / 3DES
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_ENC      The TSF shall perform secure messaging – encryption and decryption in
                   accordance with a specified cryptographic algorithm AES and 3DES in CBC mode and
                   cryptographic key sizes 112, 128, 192 and 256 bit that meet the following: compliant to
                   [ICAO_SAC]
Application Note: 3DES in CBC mode is used with key size of 112 bit. AES in CBC mode is used with key size of
128, 192 or 256 bit. The TOE implements the cryptographic primitives (i.e. Triple-DES and AES) for secure
messaging with encryption of the transmitted data and encrypting the nonce in the first step of PACE. The keys
are agreed between the TOE and the terminal as part of the PACE protocol according to FCS_CKM.1/DH_PACE.


FCS_COP.1/PACE_MAC             MAC Cryptographic operation – MAC
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_MAC      The TSFshall perform secure messaging – message authentication code in
                   accordance with a specified cryptographic algorithm CMAC and Retail-MAC and
                   cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant to
                   [ICAO_SAC] .
Application Note: In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used in Retail
mode for secure messaging.


6.3.2               Class FIA Identification and Authentication


FIA_AFL.1/PACE         Authentication failure handling – PACE authentication using non-blocking
authorisation data

CC Document                                           17                                                      3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchicalto:    No other components.
Dependencies:      FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE   The TSF shall detect when one unsuccessful authentication attempt occurs related to
                   authentication attempts using the PACE password as shared password
FIA_AFL.1.2/PACE   When the defined number of unsuccessful authentication attempts has been met, the
                   TSF shall increasingly slow down the performance up to a maximum not higher than 7
                   seconds verifying the authentication token.


FIA_UID.1/PACE     Timing of identification
Hierarchical to:   No other components.
Dependencies:      No dependencies.
FIA_UID.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carry out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS
                   4. none
                   on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE   The TSF shall require each user to be successfully identified before allowing any other
                   TSF-mediated actions on behalf of that user.


FIA_UAU.1/PACE     Timing of authentication
Hierarchical to:   No other components.
Dependencies:      FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE
FIA_UAU.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carrying out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS,
                   4. none
                   on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE           The TSF shall require each user to be successfully authenticated before allowing
                           any other TSF-mediated actions on behalf of that user.




FIA_UAU.4/PACE     Single-use authentication of the Terminals by the TOE


CC Document                                         18                                                    3.5
                                                                                                   2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchical to:      No other components.
Dependencies:         No dependencies.
FIA_UAU.4.1/PACE      The TSF shall prevent reuse of authentication data related to
                      1. PACE Protocol according to [ICAO_SAC]
                      2. Authentication Mechanism based on Triple-DES
                      3. none


FIA_UAU.5/PACE        Multiple authentication mechanisms
Hierarchi                                    type

                                                                                                  Hardware
                                                                                                                    SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                             Platform Build ID: 0261A7

                                                                                                                             eUICC plug-in                                        1.5.129

                                                                                                                    JCOP5.2                                 ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????                      R2.01.1

                                                                                                                             Platform ID: N5C2M0029E7D0600
                                                                                                  Software
                                                                                                  TOE
                                                                                                                             Platform Build ID: 029E7D

                                                                                                                             eUICC plug-in                                        1.5.146

                                                                                                                    JCOP5.2                                                       R2.02.1

                                                                                                                             Platform ID: N5C2M002A62D0600

                                                                                                                             Platform Build ID: 02A62D

                                                                                                                             eUICC plug-in                                        1.5.148


                                                                                                 To ensure secure usage a set of guidance documents is provided together with the NXP JCOP 5.2 on
                                                                                                 SN100.C58 Secure Element. Details can be found in section “Documentation” of this report.
                                                                                                 For a detailed and precise description of the TOE lifecycle refer to the [ST], chapter 1.3.3.
                                                                                                 Page: 7/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.2       Security Policy
                                                                                                 The TOE is a composite product on top of CC certified Hardware, Firmware and Crypto Library. The
                                                                                                 overall product consists of a Secure Micro-Controller and a software stack. The Micro-Controller
                                                                                                 provides an Integrated NFC controller and an embedded Secure Element core. The software stack
                                                                                                 creates 2 separate domains to provide a converged product consisting of a familiar Java Card Secure
                                                                                                 Element domain and an eUICC domain providing UICC functionality and external ISO-7816
                                                                                                 connectivity.
                                                                                                 The TOE has the following features:
                                                                                                           Cryptographic algorithms and functionality:
                                                                                                                o 3DES for en-/decryption (CBC and ECB) and MAC generation and verification (2-
                                                                                                                     key3DES, 3-key 3DES, Retail-MAC, CMAC and CBC-MAC).
                                                                                                                o AES (Advanced Encryption Standard) for en-/decryption (GCM, CBC and ECB) and
                                                                                                                     MAC generation and verification (CMAC, CBC-MAC).
                                                                                                                o RSA and RSA CRT for en-/decryption and signature generation and verification.
                                                                                                                o RSA and RSA CRT key generation.
                                                                                                                o SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                                                                                                                o Secure SHA-1, Secure SHA-224, Secure SHA-256, Secure SHA-384, Secure SHA-
                                                                       NXP Secure Sm                                                512 hash algorithm.
                                                                                                                o HMAC.
                                                                                                                o ECC over GF(p) for signature generation and verification (ECDSA).
                                                                                                                o ECC over GF(p) key generation for key agreement.
                                                                                                                o Random number generation according to class DRG.3 of AIS 20.
                                                                                                           Java Card 3.0.5 functionality.
                                                                                                           GlobalPlatform 2.3 functionality including Amendments A,B,C,D,E,F,H and I and is compliant
                                                                                                            with the Common Implementation Configuration.
                                                                                                           GSMA ’Remote SIM Provisioning Architecture for consumer Devices’.
                                                                                                           Cryptographic Service Provider (CSP) features.
                                                                                                           NXP Proprietary Functionality:
                                                                                                                o MiFare functionality accessible via Applets using the MiFare API – no security
                                                                                                                     functionality is claimed.
                                                                                                                o OSSCA (Chinese Crypto) functionality accessible via Applets using the OSSCA API –
                                                                                                                     No security functionality is claimed.
                                                                                                                o Felica functionality accessible via Applets using the Felica API - no security
                                                                                                                     functionality is claimed for this functionality.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                o Config Applet: JCOP5.2 OS includes a Config Applet that can be used for
                                                                                                                     configuration of the TOE.
                                                                                                                o OS Update Component: Proprietary functionality that can update JCOP5.2 OS or
                                                                                                                     UpdaterOS.
                                                                                                                o UAI update component: Proprietary functionality that is can update JCOP5.2 OS- no
                                                                                                                     security functionality is claimed.
                                                                                                                o Restricted Mode: In Restricted Mode only very limited functionality of the TOE is
                                                                                                                     available such as, e.g.: reading logging information or resetting the Attack Counter.
                                                                                                                o Error Detection Code (EDC) API.
                                                                                                           Functionality introduced in R2, for which there are no specific additional security claims:
                                                                                                                o CAT-TP, with limitations as described in the [AGD_UGM] Section 8.1.
                                                                                                                o 5G features as per SIM Alliance 2.3, as in [AGD_UGM] Section 2.4.4 and 8.1.
                                                                                                                o Extension to Global Platform Amendment H, as in [AGD_UGM] Section 3.5.7.
                                                                                                                o CPLC data made available through SystemInfo, as in [AGD_UGM] Section 2.1.3.22.

                                                                                                 2.3       Assumptions and Clarification of Scope

                                                                                                 2.3.1      Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in section 5.2 of the
                                                                                                 [ST].
                                                                                                 Page: 8/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.
                                                                                                 Note that proprietary applications have been included in the TOE, but as there are no security claims
                                                                                                 on these functionalities, these application functionality has not been assessed, only the self-protection
                                                                                                 of the TSF.

                                                                                                 2.4     Architectural Information
                                                                                                 The TOE consists of a certified Hardware IC, with Micro Controller Firmware (Boot OS, Factory OS
                                                         art Card
  Controller P6022y VB
  Security Targe                                        and Flash driver software) and certified security software library consisting of a crypto library and
                                                                                                 services software. All these parts are depicted in the figure below with the shaded box marked
                                                                                                 SE100_SE. Since, this TOE is a composite on top of this certified platform, this block is not depicted
                                                                                                 in more detail.
                                                                                                 The Software stack consists of the JCOP Core parts marked with salmon coloured blocks
                                                                                                 implementing the Native OS, Global platform functionality and the Java Card 3.05 functionality. The
                                                                                                 TOE also implements a Cryptographic Service Provider marked with an orange coloured block. It
                                                                                                 implements a number of NXP proprietary features like the JCOP extension APIs for MiFare, Felica,
                                                                                                 Updater O/S and Config applet (note there are no security claims relating to MiFare and Felica).
                                                                                                 Furthermore the TOE implements GSMA ‘Remote SIM Provisioning Architecture for consumer
                                                                                                 Devices’, referred to as eUICC. The JCOP O/S supports the eUICC APIs and uses the Broker API to
                                                                                                 forward to the eSIM/SIM/UICC/ISIM commands to the eUICC Plugin Library.
                                                                                                 The TOE supports two domains, the eSE for the Java Card Secure Element domain and an eUICC
                                                                                                 domain providing UICC functionality in accordance with the GSMA Specification.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 9/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.5     Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                  JCOP Version       Identifier                                                        Version
                                                                                                  JCOP 5.2 R1        [AGD_UGM52R1] JCOP 5.2 R1.01.1 User Guidance Manual               1.8, 2019-10-30
                                                                                                                     [AGD_UGMSEMS52R1] JCOP 5.2 R1.01.1 User Guidance
                                                                                                                                                                                       1.1, 2019-10-17
                                                                                                                     Manual Addendum for SEMS API
                                                                                                                     [AGD_CSP52R1] JCOP 5.2 R1.01.1 User Guidance Manual
                                                                                                                                                                                       1.6, 2019-10-15
                                                                                                                     Addendum for CSPAPI
                                                                                                  JCOP 5.2 R2        [AGD_UGM52R2] JCOP 5.2 R2, User Guidance Manual,
                                                                                                                                                                                       1.3, 2020-06-08
                                                                                                                     doc. no. 608813
                                                                                                                     [AGD_UGMSEMS52R2] JCOP 5.2 R2, User Guidance
                                                                                                                                        t Lite
  Rev. 2.1 — 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document inf                                               1.2, 2020-06-08
                                                                              ormation
Informat            Assets .......................................10
3.2       Threats .............................................................10
3.3       Organizational Security Policies ...................... 10
3.4       Assumptions .................................................... 10
4       Security Objectives ...........................................11
4.1       Security Objectives for the TOE ...................... 11
4.2       Security Objectives for the IC Embedded
          Software ...........................................................12
4.3       Security Objectives for the Operational
          Environment .....................................................12
4.4       Security Objectives Rationale ..........................12
5       Extended Components Definition ....................13
6       Security Requirements ..................................... 14
6.1       Security Functional Requirements ................... 14
6.1.1     SFRs from the Protection Profile and the
          Security Target of the platform ........................ 14
6.1.2     Security Functional Requirements added in
          this Security Target ......................................... 14
6.2       Security Assurance Requirements ...................20
6.2.1     Refinements of the Security Assurance
          Requirements for EAL6+ ................................. 21
6.3       Security Requirements Rationale .................... 21
6.3.1     Rationale for the Security Functional
          Requirements ...................................................21
6.3.2     Extended requirements ....................................23
6.3.3     Dependencies of security requirements ...........23
6.3.4     Rationale for the Assurance Requirements ..... 23
7       TOE Summary Specification ............................ 24
7.1       IT Security Functionality .................................. 24
7.1.1     Security Services of the TOE .......................... 24
7.1.1.1   SS.RSA ............................................................24
7.1.1.2   SS.RSA_Pad ................................................... 24




                                                            ty,    (www.infineon.com).
Published by                                condition or quality of the product. Before
Infineon Technologies AG                    implementation of the product, the recipient of this
                                            application note must verify any function and other    WARNINGS
81726 Munich, Germany                       technical information given herein in the real         Due to technical requirements products may
                                            application.    Infineon    Technologies    hereby     contain dangerous substances. For information on
                                            disclaims any and all warranties and liabilities of    the types in question please contact your nearest
© 2020 Infineon Technologies AG.            any kind (including without limitation warranties of   Infineon Technologies office.
                                            non-infringement of intellectual property rights of
All Rights Reserved.                        any third party) with respect to any and all
                                            information given in this Security Target.             Except as otherwise explicitly approved by Infineon
                                                                                                   Technologies in a written document signed by
Do you have a question about this                                                               © NXP B.V. 2019.                                                                            All rights reserved.
                                                               authorized      representatives     of     Infineon
document?                                   The data contained in this document is exclusively     Technologies, Infineon Technologies’ products may
                                            intended for technically trained staff. It is the      not be used in any applications where a failure of
Email: erratum@infineon.com                 responsibility of customer’s technical departments     the product or any consequences of the use thereof
                                            to evaluate the s                 uitability of the product for the     can reasonably be expected to result in personal
<DOC_Number>                                intended application and the completeness of the       injury.
Document reference                          product information given in this document with
                                                For more information, please visit: http://www.nxp.com
                                                                                     For sales office addresses, please send an email to: salesaddresses@nxp.com
                  res                                            pect to such applicati                                                               on.
                    Date of release: 5 June 2019
rity functional requirements of the TOE an additional family (FCS_RNG) of the Class FCS
(cryptographic support) is defined in the PP [9]. This family describes the functional requirements for random
number generation used for cryptographic purposes.

Please note that the national regulation are outlined in PP [9] chapter 7.5.1 and in AIS31 [13]. These regulations
apply for this TOE.

Note 12:
The functional requirements FCS_RNG.1/TRNG, FCS_RNG.1/HPRG, FCS_RNG.1/DRNG, FCS_RNG.1/KSG, are
iterations of the FCS_RNG.1 defined in the PP [9] according to “Anwendungshinweise und Interpretationen zum
Schema (AIS)” respectively “A proposal for: Functionality classes for random number generators” [13].
End of note.

Note 13:
The Physical True Random Number Generator PTRNG implements total failure test of the random source and a
continuous RNG test according to:
National Institute of Standards and Technology, Security Requirements for Cryptographic Modules, Federal
Information Processing Standards Publication (FIPS) 140-2, 2002-03-12, chapter 4.9.2.
End of note.

Together with the guidelines in [6] the hybrid PTRNG of this TOE provides random numbers conformant to
several quality metrics as defined in [13]. Depending on the user configuration the TOE provide the according
random number quality. For each addressed quality metric of [13] the definitions are made in the following
chapters.




CC Document                                              65                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.1.1     True Random Number Generation, meeting AIS31 PTG.2


      FCS_RNG.1/TRNG         Random Number Generation
          Hierarchical to:   No other components
           Dependencies:     No dependencies
      FCS_RNG.1/TRNG         Random numbers generation Class PTG.2 according to [13]
      FCS_RNG.1.1/TRNG       The TSF shall provide a physical random number generator that
                             implements:
                  PTG.2.1    A total failure test detects a total failure of entropy source immediately when
                             the RNG has started. When a total failure is detected, no random numbers
                             will be output.
                  PTG.2.2    If a total failure of the entropy source occurs while the RNG is being operated,
                             the RNG prevents the output of any internal random number that depends on
                             some raw random numbers that have been generated after the total failure of
                             the entropy source.
                  PTG.2.3    The online test shall detect non-tolerable statistical defects of the raw
                             random number sequence (i) immediately when the RNG has started, and (ii)
                             while the RNG is being operated. The TSF must not output any random
                             numbers before the power-up online test has finished successfully or when a
                             defect has been detected.
                  PTG.2.4    The online test procedure shall be effective to detect non-tolerable
                             weaknesses of the random numbers soon.
                  PTG.2.5    The online test procedure checks the quality of the raw random number
                             sequence. It is triggered continuously. The online test is suitable for detecting
                             non-tolerable statistical defects of the statistical properties of the raw random
                             numbers within an acceptable period of time.
      FCS_RNG.1.2/TRNG       The TSF shall provide numbers in the format 8- or 16-bit that meet
                PTG.2.6      Test procedure A, as defined in [13] does not distinguish the internal random
                             numbers from output sequences of an ideal RNG.
                  PTG.2.7    The average Shannon entropy per internal random bit exceeds 0.997.




CC Document                                        66                                                         1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                          Hybrid Random Number Generation, meeting AIS31 PTG.3



  FCS_RNG.1/HPRG         Random Number Generation
      Hierarchical to:   No other components
       Dependencies:     No dependencies
  FCS_RNG.1/HPRG         Random numbers generation Class PTG.3 according to [13]
  FCS_RNG.1.1/HPRG       The TSF shall provide a hybrid physical random number generator that implements:
             PTG.3.1     A total failure test detects a total failure of entropy source immediately when the RNG
                         has started. When a total failure has been detected no random numbers will be
                         output.
              PTG.3.2    If a total failure of the entropy source+ occurs while the RNG is being operated, the
                         RNG prevents the output of any internal random number that depends on some raw
                         random numbers that have been generated after the total failure of the entropy
                         source.
              PTG.3.3    The online test shall detect non-tolerable statistical defects of the raw random
                         number sequence (i) immediately when the RNG has started, and (ii) while the RNG is
                         being operated. The TSF must not output any random numbers before the power-up
                         online test and the seeding of the DRG.3 post-processing algorithm have been finished
                         successfully or when a defect has been detected.
              PTG.3.4    The online test procedure shall be effective to detect non-tolerable weaknesses of the
                         random numbers soon.
              PTG.3.5    The online test procedure checks the raw random number sequence. It is triggered
                         continuously. The online test is suitable for detecting non-tolerable statistical defects
                         of the statistical properties of the raw random numbers within an acceptable period of
                         time.
                         Note:
                         Continuously means that the raw random bits are scanned continuously.
                         The algorithmic post-processing belongs to Class DRG.3 with cryptographic state
                         transition function and cryptographic output function. The output data rate of the
                         post-processing algorithm shall not exceed its input data rate.
                         End of note.
              PTG.3.6    The algorithmic post-processing algorithm belongs to Class DRG.3 with cryptographic
                         state transition function and cryptographic output function, and the output data rate
                         of the post-processing algorithm shall not exceed its input data rate.
  FCS_RNG.1.2/HPRG       The TSF shall provide numbers in the format 8- or 16-bit that meet
            PTG.3.7      Statistical test suites cannot practically distinguish the internal random numbers from
                         output sequences of an ideal RNG. The internal random numbers must pass test
                         procedure A.




CC Document                                             67                                                        1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




Deterministic Random Number Generation (DRNG) AIS31 DRG.3

  FCS_RNG.1/DRNG          Random Number Generation
       Hierarchical to:   No other components
       Dependencies:      No dependencies
  FCS_RNG.1/DRNG          Random numbers generation Class DRG.3 according to [13]
  FCS_RNG.1.1/DRNG        The TSF shall provide a deterministic random number generator that implements:
              DRG.3.1     If initialized with a random seed using a PTRNG of class PTG.2 as random source the
                          internal state of the RNG shall have at least 100 bit of entropy.
                          Note:
                          Furthermore, the length of the internal state shall have at least 200 bit. (For the
                          DRG.3 under consideration, the internal state has 351 bit.). The seed is provided by a
                          certified PTG.2 physical TRNG with guaranteed 7,976 bit of entropy per byte.
                          End of note.
            DRG.3.2       The RNG provides forward secrecy.
            DRG.3.3       The RNG provides backward secrecy even if the current internal state is known.
  FCS_RNG.1.2/DRNG        The TSF shall provide numbers in the format 8- or 16-bit that meet
            DRG.3.4       The RNG, initialized with a random seed, where the seed has at least 100 bit of
                          entropy and is derived by a PTG.2 certified PTRNG. The RNG generates output for
                          which any consecutive 234 strings of bit length 128 are mutually different with a
                          probability that is greater than 1 – 2(-16).
              DRG.3.5     Statistical test suites cannot practically distinguish the random numbers from the
                          output sequences of an ideal RNG. The random numbers must pass test procedure A
                          and the U.S. National Institute of Standards and Technology (NIST) test suite for
                          RNGs used for cryptographic purposes [41] containing following 16 tests:
                          Frequency (Monobit) Test, Frequency Test within a Block, Runs Tests, Test for the
                          Longest-Run-of-Ones in a Block, Binary Matrix Rank Test, Discrete Fourier Transform
                          (Spectral) Test, Non-overlapping (Aperiodic) Template Matching Test, Overlapping
                          (Periodic) Template Matching Test, Maurer´s “Universal Statistical” Test, Liner
                          Complexity Test, Serial Test, Approximate Entropy Test, Cumulative Sums (Cusums)
                          Test, Random Excursions Test and Random Excursions Variant Test.




CC Document                                             68                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.1.2      Deterministic Random Number Generation (DRNG) AIS31 DRG.2

This additional operation mode is named Key Stream Generation (KSG), which is a stream cipher generation. It is
conformant to DRG.2 and implements therefore forward and additional backward secrecy.


  FCS_RNG.1/KSG         Random Number Generation
     Hierarchical to:   No other components
     Dependencies:      No dependencies
  FCS_RNG.1/KSG         Random numbers generation Class DRG.2 according to [13]
  FCS_RNG.1.1/KSG       The TSF shall provide a deterministic random number generator that implements:
            DRG.2.1     If initialized with a random seed using a PTRNG of class PTG.2 as random source, the
                        applied seed shall have at least 100 bits of entropy, the internal state of the RNG shall
                        have at least the size of 200 bit – in this case the size of the internal state amounts to
                        351 bit, has the work factor for breaking the algorithm of 2127 due to the restriction on
                        the maximum amount of keystream computed from a given seed, required guess work
                        amounts to 2127 as well.
          DRG.2.2       The RNG provides forward secrecy.
          DRG.2.3       The RNG provides backward secrecy.
  FCS_RNG.1.2/KSG       The TSF shall provide numbers in the format 8- or 16-bit that meet
          DRG.2.4       The RNG, initialized with a random seed of length at least 100 bit delivered by an
                        PTRNG of the class PTG.2, generates output for which any consecutive 234 strings of the
                        length 128 bits are mutually different with probability greater than 1-2(-16).
              DRG.2.5   Statistical test suites cannot practically distinguish the random numbers from the
                        output sequences of an ideal RNG. The random numbers must pass test procedure A.
                        Note:
                        The random numbers have been shown to fulfill all statistical tests of the AIS 20/31
                        statistical tests of procedure A. The random numbers are in the format 8- or 16 Bit.
                        End of Note.




CC Document                                             69                                                        1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.1.2        FAU_SAS
During testing at the end of Phase 3 before TOE Delivery, the TOE shall be able to store some data (for instance
about the production history or identification data of the individual die or other data to be used after delivery).
Therefore, the security functional component Audit storage (FAU_SAS.1) has been added and is described in the
PP [9].
The TOE shall meet the requirement “Audit storage (FAU_SAS.1)” as specified below, PP [9]:

 FAU_SAS.1                Audit Storage
      Hierarchical to:    No dependencies
      Dependencies:       No dependencies.
 FAU_SAS.1.1              The TSF shall provide the test process before TOE Delivery with the capability to store
                          the Initialization Data (GCIM) and/or Pre-personalization Data and/or supplements of
                          the Security IC Embedded Software in the not changeable configuration page area and
                          non-volatile memory.



7.1.2          Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests
can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

 FPT_TST.2             Subset TOE testing
    Hierarchical to:   No other components.
    Dependencies:      No dependencies.
 FPT_TST.2.1           The TSF shall run a suite of self-tests at the request of the authorized user to demonstrate
                       the correct operation of the alarm lines and/or following environmental sensor
                       mechanisms:
                                     More information is given in the confidential security target [8].




CC Document                                             70                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.3          Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent that
one application can access code and/or data of another application. For this reason the TOE provides Area based
Memory Access Control. The underlying memory management unit (MMU) is documented in section 4 in the
hardware reference manual HRM [1].
The security service being provided is described in the Security Function Policy (SFP) Memory Access Control
Policy. The security functional requirement “Subset access control (FDP_ACC.1)” requires that this policy is in
place and defines the scope were it applies. The security functional requirement “Security attribute based
access control (FDP_ACF.1)” defines security attribute usage and characteristics of policies. It describes the
rules for the function that implements the Security Function Policy (SFP) as identified in FDP_ACC.1. The
decision whether an access is permitted or not is taken based upon attributes allocated to the software. The
Smartcard Embedded Software defines the attributes and memory areas. The corresponding permission control
information is evaluated “on-the-fly” by the hardware so that access is granted/effective or denied/inoperable.
The security functional requirement “Static attribute initialization (FMT_MSA.3)” ensures that the default
values of security attributes are appropriately either permissive or restrictive in nature. Alternative values can be
specified by any subject provided that the Memory Access Control Policy allows that. This is described by the
security functional requirement “Management of security attributes (FMT_MSA.1)”. The attributes are
determined during TOE manufacturing (FMT_MSA.3) or set at run-time (FMT_MSA.1).
From TOE’s point of view the different roles in the Smartcard Embedded Software can be distinguished
according to the memory based access control. However the definition of the roles belongs to the user software.
The following Security Function Policy (SFP) Memory Access Control Policy is defined for the requirement
“Security attribute based access control (FDP_ACF.1)”:

Memory Access Control Policy
The TOE shall control read, write, delete and execute accesses of software running at the privilege levels as defined
below. Any access is controlled, regardless whether the access is on code or data or a jump on any other privilege
level outside the current one.

The memory model provides distinct, independent privilege levels separated from each other in the virtual
address space. The access rights are controlled by the MMU and related to the privilege level. More information
is given in the confidential Security Target [8].

The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below.

 FDP_ACC.1               Subset access control
 Hierarchical to:        No other components.
 Dependencies:           FDP_ACF.1 Security attribute based access control
 FDP_ACC.1.1             The TSF shall enforce the Memory Access Control Policy on all subjects (software
                         running at the defined and assigned privilege levels), all objects (data including code
                         stored in memories) and all the operations defined in the Memory Access Control Policy,
                         i.e. privilege levels.




CC Document                                               71                                                        1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below.
   FDP_ACF.1          Security attribute based access control
   Hierarchical to:   No other components.
   Dependencies:      FDP_ACC.1 Subset access control
                      FMT_MSA.3 Static attribute initialization
   FDP_ACF.1.1        The TSF shall enforce the Memory Access Control Policy to objects based on the
                      following:
                      Subject:
                      - software running at the IFX, OS1 and OS2 privilege levels required to securely operate
                      the chip. This includes also privilege levels running interrupt routines.
                      - software running at the privilege levels containing the application software
                      Object:
                      - data including code stored in memories
                      Attributes:
                      - the memory area where the access is performed to and/or
                      - the operation to be performed.
   FDP_ACF.1.2        The TSF shall enforce the following rules to determine if an operation among
                      controlled subjects and controlled objects is allowed:
                      evaluate the corresponding permission control information of the relevant memory range
                      before and during the access so that accesses to be denied cannot be utilized by the
                      subject attempting to perform the operation.
   FDP_ACF.1.3        The TSF shall explicitly authorize access of subjects to objects based on the following
                      additional rules:
                      none.
   FDP_ACF.1.4        The TSF shall explicitly deny access of subjects to objects based on the following
                      additional rules: none.




CC Document                                            72                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Static attribute initialisation (FMT_MSA.3)” as specified below.
   FMT_MSA.3               Static attribute initialisation
   Hierarchical to:        No other components.
   Dependencies:           FMT_MSA.1 Management of security attributes
                           FMT_SMR.1 Security roles
   FMT_MSA.3.1             The TSF shall enforce the Memory Access Control Policy to provide well defined1 default
                           values for security attributes that are used to enforce the SFP.
   FMT_MSA.3.2             The TSF shall allow any subject, provided that the Memory Access Control Policy is
                           enforced and the necessary access is therefore allowed2, to specify alternative initial
                           values to override the default values when an object or information is created.

The TOE shall meet the requirement “Management of security attributes (FMT_MSA.1)” as specified below:
   FMT_MSA.1               Management of security attributes
   Hierarchical to:        No other components.
   Dependencies:           [FDP_ACC.1 Subset access control or
                           FDP_IFC.1 Subset information flow control]
                           FMT_SMF.1 Specification of management functions
                           FMT_SMR.1 Security roles
   FMT_MSA.1.1             The TSF shall enforce the Memory Access Control Policy to restrict the ability to change
                           default, modify or delete the security attributes permission control information to the
                           software running on the privilege levels.

The TOE shall meet the requirement “Specification of management functions (FMT_SMF.1)” as specified below:
   FMT_SMF.1               Specification of management functions
   Hierarchical to:        No other components
   Dependencies:           No dependencies
   FMT_SMF.1.1             The TSF shall be capable of performing the following security management functions:
                           access the configuration registers of the MMU.




          1
              The static definition of the access rules is documented in the hardware reference manual as listed in chapter 1.1
                         2
                           The Smartcard Embedded Software is intended to set the memory access control policy


CC Document                                                         73                                                                   1.8
                                                                                                                                  2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4               Support of Cipher Schemes
The following additional specific security functionality is implemented in the TOE:
FCS_COP.1 Cryptographic operation requires a cryptographic operation to be performed in accordance with a
specified algorithm and with a cryptographic key of specified sizes. The specified algorithm and cryptographic
key sizes can be based on an assigned standard; dependencies are discussed in chapter 0.

The following additional specific security functionality is implemented in the TOE:
    Rivest-Shamir-Adleman (RSA)1
    Elliptic Curve Cryptography (EC)1
    Advanced Encryption Standard (AES)
    Triple Data Encryption Standard (TDES)
    Cipher based Message Authentication Code (CMAC)
    CIPURSE™ Cryptographic Library (CCL)

The RSA cryptographic library, regardless of the version chosen, is offered in two parts: The 2k part of the RSA
library can be used for key lengths of up to 2048 bits and the 4k part of the RSA library can be used for key
lengths of up to 4096 bits.

Note 14:
This TOE can come with both crypto co-processors accessible, or with a blocked SCP or with a blocked
Crypto2304T, or with both crypto co-processors blocked. The blocking depends on the customer demands prior
to the production of the hardware. In case the SCP is blocked, no AES and DES respectively CMAC computation,
as well as CCL operation supported by hardware is possible. In case the Crypto2304T is blocked, no RSA and EC
computation supported by hardware is possible. No accessibility of the deselected cryptographic co-processors is
without impact on any other security policy of the TOE; it is exactly equivalent to the situation where the user
decides just not to use the cryptographic co-processors.
End of note.




1
    For the case the TOE comes without RSA and/or EC library, the TOE provides basic HW-related routines for RSA and/or EC calculations.
      For a secure library implementation the user has to implement additional countermeasures himself.


CC Document                                                          74                                                              1.8
                                                                                                                              2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.1        Preface regarding Security Level related to Cryptography
Implemented cryptography, regardless whether proprietary or following public standards is subject of ageing
due to the evolution and progress of technology, mathematics and analysis methods. For that reason,
guarantees for the absence of exploitable properties cannot be given - by anybody. But, the risk for the absence
of such properties is severely reduced if the implementation is based on a long time published and publicly
discussed standard algorithm.
If the vendor implements a proprietary algorithm, then the BSI analyses this algorithm in the course and time
frame of the certification process. It is obvious that this local, one party and short timed analysis cannot replace a
long time publicly discussed standard algorithm. Possible risk mitigation, if not an industrial secret, is the
publication of the proprietary standard and starting the public discussion. This transparency could provide on
one hand some mitigation of risk; on the other hand, the algorithm is then directly a valuable analyst target. In
that case, also no one can say, when such publication is sufficiently discussed; and again guarantees for the life
time being in the field can no one give.
As of today, using public standards is often not possible due to compromises with regard to acceptable
computing time and available energy. For that reason it is up to the user to decide. The SFR claims assign
whether an algorithm or proprietary or following a standard or implementing a standard with deviations.

The BSI states that the strength of the cryptographic algorithms is not rated in the course of the product
certification (see [25] Section 9, Para.4, Clause 2). But cryptographic functionalities with a security level of lower
than 100 bits can no longer be regarded as secure without considering the application context. Therefore, for
these functions it shall be checked whether the related cryptographic operations are appropriate for the
intended system. The assignment to the 100 Bit level by BSI can be read in the certification report issued by BSI.
Some further hints and guidelines can be derived from the Technische Richtlinie BSI TR-02102,
www.bsi.bund.de.




CC Document                                               75                                                        1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.2       Cryptography by the Symmetric Cryptographic Coprocessor SCP
 7.1.4.2.1    Triple-DES Operation
The DES Operation of the SCP of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)”
and “Cryptographic key destruction” (FCS_CKM.4) as specified below:

  FCS_COP.1/TDES       Cryptographic operation
      Hierarchical to: No other components.
      Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security attributes, or
                       FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                       FCS_CKM.1 Cryptographic key management]
                       FCS_CKM.4 Cryptographic key destruction.
  FCS_COP.1.1/TDES The TSF shall perform encryption and decryption in accordance with a specified
                       cryptographic algorithm TDES in
                            the Electronic Codebook Mode (ECB)
                            the Cipher Block Chaining Mode (CBC)
                            the Cipher Block Chaining Message Authentication Code (CBC-MAC)
                            the Cipher Block Chaining Message Authentication Code Encrypt Last Block
                              (CBC-MAC-ELB)
                            the Blinding Mode (BLD)
                            the Recrypt Mode
                       and cryptographic key sizes of 112 and 168 bit that meet the following standards:
                            ECB, CBC:
                              o National Institute of Standards and Technology (NIST) 800-67 [20],
                                 standard allows encryption with 168 bit keys only
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                            CBC_MAC
                              o National Institute of Standards and Technology (NIST) 800-67 [20]
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                              o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                            CBC-MAC-ELB:
                              o National Institute of Standards and Technology (NIST) 800-67 [20]
                              o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                              o ISO/IEC 18033-3 [30]
                              o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                            BLD, Recrypt Mode
                              Proprietary, description given in the hardware reference manual HRM [1]




CC Document                                         76                                                   1.8
                                                                                                  2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)



Notes for FCS_COP.1/TDES:

   1.   The proprietary BLD and Recrypt operation modes are described in the hardware reference manual HRM [1] while
        the implementations of the other modes follow the referenced standards. Also the BLD is compliant to the
        referenced standards but is operated in a masked way. The proprietary modes offer increased protection against
        failure and side channel analysis.
   2.   Using the TDES algorithm with three keys of which two keys equal is a so called two key triple DES operation. This
        operation can be configured and managed by the user but does not meet the national requirements issued by BSI
        and achieves therefore not the 100 Bits security level.
        End of note.


    FCS_CKM.4/TDES                 Cryptographic key destruction – TDES
    Hierarchical to:               No other components.
    Dependencies:                  [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
    FCS_CKM.4.1/TDES               The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method overwriting or zeroing that meets the
                                   following:
                                   None

Note for FCS_CKM.4/TDES:
The key destruction can be done by overwriting the key register interfaces or by software reset of the SCP which
provides immediate zeroing of all SCP key registers.
End of note.




CC Document                                                   77                                                      1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.2.2    AES Operation
The AES Operation the TOE shall meet the requirement Cryptographic operation (FCS_COP.1) and
Cryptographic key destruction (FCS_CKM.4) as specified below:

     FCS_COP.1/AES       Cryptographic operation
        Hierarchical to: No other components.
        Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security
                         attributes, or
                         FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                         FCS_CKM.1 Cryptographic key generation]
                         FCS_CKM.4 Cryptographic key destruction
     FCS_COP.1.1/AES The TSF shall perform decryption and encryption in accordance with a specified
                         cryptographic algorithm AES in
                              the Electronic Codebook Mode (ECB)
                              the Cipher Block Chaining Mode (CBC)
                              the Cipher Block Chaining Message Authentication Code (CBC-MAC)
                              the Cipher Block Chaining Message Authentication Code Encrypt Last
                                 Block
                                 (CBC-MAC-ELB)
                              the Blinding Mode (BLD)
                              the Recrypt Mode
                         and cryptographic key sizes of 128 bit or 192 bit or 256 bit that meet the following
                         standards:
                              ECB, CBC:
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                              CBC_MAC
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                                 o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                              CBC-MAC-ELB:
                                 o Federal Information Processing Standards Publication 197 [31]
                                 o National Institute of Standards and Technology (NIST) SP 800-38A [21]
                                 o ISO/IEC 18033-3 [30]
                                 o ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]
                              BLD, Recrypt Mode
                                 Proprietary, description given in the hardware reference manual HRM [1]

Note for FCS_COP.1/AES:
The proprietary BLD and Recrypt operation modes are proprietary and described in the hardware reference
manual HRM [1] while the implementations of the other modes follow the referenced standards. Also the BLD is
compliant to the referenced standards but is operated in a masked way. The proprietary modes offer increased
protection against failure and side channel analysis.
End of note.

CC Document                                             78                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)



      FCS_CKM.4/AES        Cryptographic key destruction – AES
      Hierarchical to:     No other components.
      Dependencies:        [FDP_ITC.1 Import of user data without security attributes, or
                           FDP_ITC.2 Import of user data with security attributes, or
                           FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/AES       The TSF shall destroy cryptographic keys in accordance with a specified
                           cryptographic key destruction method overwriting or zeroing that meets the
                           following:
                           None

Note for FCS_CKM.4/AES:
The key destruction can be done by overwriting the key register interfaces or by software reset of the SCP which
provides immediate zeroing of all SCP key registers.
End of Note.




CC Document                                            79                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.3      Cryptography by the Symmetric Cryptographic Library SCL
                             The following holds true for both alternative versions.

 7.1.4.3.1    Triple-DES Operation for both SCL versions
The DES Operation of the SCL of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)”
and “Cryptographic key destruction” (FCS_CKM.4) as specified below:

      FCS_COP.1/TDES-SCL-1        Cryptographic operation – TDES
      or
      FCS_COP.1/TDES-SCL-2
                 Hierarchical to: No other components.
                 Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without
                                  security attributes, or
                                  FDP_ITC.2 Import of user data of the Composite TOE with security
                                  attributes, or
                                  FCS_CKM.1 Cryptographic key management]
                                  FCS_CKM.4 Cryptographic key destruction.
      FCS_COP.1.1/TDES-SCL-1      The TSF shall perform encryption and decryption in accordance with a
      or                          specified cryptographic algorithm TDES in
      FCS_COP.1.1/TDES-SCL-2            the Electronic Codebook Mode (ECB)
                                        the Cipher Block Chaining Mode (CBC)
                                        the Counter Mode (CTR)
                                        the Cipher Feedback Mode (CFB)
                                        the Propagating Cipher Block Chaining (PCBC)
                                  and cryptographic key sizes of 112 and 168 bit that meet the
                                  following standards:
                                        National Institute of Standards and Technology (NIST)
                                          SP 800-67 [20], standard allows encryption with 168 bit keys
                                          only
                                        The ECB, CBC, CTR and CFB modes refer to:
                                          National Institute of Standards and Technology (NIST)
                                          SP 800-38A [21]
                                        The PCBC mode refers to:
                                          Bruce Schneier, Applied Cryptography, Second Edition, John
                                          Wiley & Sons, 1996 section 9.10 [36]. This standard should be
                                          implemented considering the Security Guidelines only.




CC Document                                           80                                                   1.8
                                                                                                    2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


     FCS_CKM.4/TDES-SCL-1            Cryptographic key destruction – TDES
     or
     FCS_CKM.4/TDES-SCL-2
     Hierarchical to:                No other components.
     Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or
                                     FCS_CKM.1 Cryptographic key generation]
     FCS_CKM.4.1/TDES-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
     or                              specified cryptographic key destruction method overwriting or zeroing
     FCS_CKM.4.1/TDES-SCL-2          that meets the following:
                                     None

Note for FCS_CKM.4/TDES-SCL-1 and FCS_CKM.4/TDES-SCL-2:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             81                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




 7.1.4.3.2    AES Operation for both SCL versions
The AES Operation the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and
“Cryptographic key destruction” (FCS_CKM.4) as specified below:

     FCS_COP.1/AES-SCL-1        Cryptographic operation – AES
     or
     FCS_COP.1/AES-SCL-2
               Hierarchical to: No other components.
               Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without security
                                attributes, or
                                FDP_ITC.2 Import of user data of the Composite TOE with security
                                attributes, or
                                FCS_CKM.1 Cryptographic key generation]
                                FCS_CKM.4 Cryptographic key destruction
     FCS_COP.1.1/AES-SCL-1      The TSF shall perform decryption and encryption in accordance with a
     or                         specified cryptographic algorithm AES in
     FCS_COP.1.1/AES-SCL-2            the Electronic Codebook Mode (ECB)
                                      the Cipher Block Chaining Mode (CBC)
                                      the Counter Mode (CTR)
                                      the Cipher Feedback Mode (CFB)
                                      the Propagating Cipher Block Chaining (PCBC)
                                and cryptographic key sizes of 128 bit or 192 bit or 256 bit that meet the
                                following standards:
                                      The AES advanced encryption standard refers to:
                                        National Institute of Standards and Technology (NIST)
                                        FIPS PUB 197 [31]
                                      The ECB, CBC, CTR and CFB modes refer to:
                                        National Institute of Standards and Technology (NIST)
                                        SP 800-38A [21]
                                      The PCBC mode refers to:
                                        Bruce Schneier, Applied Cryptography, Second Edition, John
                                        Wiley & Sons, 1996, section 9.10[36]. This standard should be
                                        implemented considering the Security Guidelines only.




CC Document                                            82                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


      FCS_CKM.4/AES-SCL-1           Cryptographic key destruction – AES
      or
      FCS_CKM.4/AES-SCL-2
      Hierarchical to:              No other components.
      Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                                    FDP_ITC.2 Import of user data with security attributes, or
                                    FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/AES-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
      or                            specified cryptographic key destruction method overwriting or zeroing
      FCS_CKM4.1/AES-SCL-2          that meets the following:
                                    None

Note for FCS_CKM.4/AES-SCL-1 or FCS_CKM.4/AES-SCL-2:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             83                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.3.3    CMAC Operation on for the SCL version v2.04.002
The CMAC operation of this SCL version of the TOE shall meet the requirement Cryptographic operation
(FCS_COP.1) and Cryptographic key destruction (FCS_CKM.4) as specified below:

      FCS_COP.1/CMAC-SCL-1         Cryptographic operation – CMAC
                  Hierarchical to: No other components.
                   Dependencies: [FDP_ITC.1 Import of user data of the Composite TOE without
                                   security attributes, or
                                   FDP_ITC.2 Import of user data of the Composite TOE with security
                                   attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
                                   FCS_CKM.4 Cryptographic key destruction
      FCS_COP.1.1/CMAC-SCL-1       The TSF shall perform computation of a cipher based message
                                   authentication code in accordance with a specified cryptographic
                                   algorithm CMAC using
                                        AES or
                                        TDES
                                   and cryptographic key sizes of 128 bit or 192 bit or 256 bit for AES
                                   and 168 bit for TDES that meet the following standards:
                                        CMAC: National Institute of Standards and Technology
                                           (NIST) SP 800-38B [37]
                                        AES
                                          o Federal Information Standards Publication 197 [31]
                                        TDES
                                          o National Institute of Standards and Technology
                                             SP 800-67 [20]




CC Document                                           84                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


      FCS_CKM.4/CMAC-SCL-1           Cryptographic key destruction – CMAC
      Hierarchical to:               No other components.
      Dependencies:                  [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or
                                     FCS_CKM.1 Cryptographic key generation]
      FCS_CKM4.1/CMAC-SCL-1          The TSF shall destroy cryptographic keys in accordance with a
                                     specified cryptographic key destruction method overwriting or
                                     zeroing that meets the following:
                                     None

Note for FCS_CKM.4/CMAC-SCL-1:
The key destruction is triggered from the SCL to the SCP at every entry and exit. The key storage in the SCL is
wiped with random values.
End of note.




CC Document                                             85                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.4      Cryptography by CIPURSE™ Cryptographic Library
The CIPURSE™ CL is a delivery option. If the CCL is on board the belonging security functional requirements are
fulfilled else the functionality is not on board and the security functional requirements are not covered.

 7.1.4.4.1    CIPURSE™ CL Cryptographic Functions
The CCL shall meet the security functional requirement FCS_COP.1/CCL as specified below.

   FCS_COP.1/CCL       Cryptographic Operation CCL Trusted Channel
      Hierarchical to: No other components.
      Dependencies: [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/CCL The TSF shall perform
                            an authentication and cryptographic protected protocol
                       in accordance with a specified cryptographic algorithm
                            CIPURSE™ V2 Cryptographic Protocol
                       and cryptographic key sizes of 128 Bit that meet the following:
                            Federal Information Processing Standards Publication 197 [31]
                            NIST Special Publication SP 800-38A, chapter 6.1 AES in ECB mode [21]
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 5.2 Session key Derivation
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.2 Key Derivation for the
                               first frame
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.3 Integrity Protection
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.4 Confidential
                               Communication
                            CIPURSE™ V2 Cryptographic Protocol Errata and Precision list
                               [35-2] chapters P.2




CC Document                                            86                                                    1.8
                                                                                                      2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The CCL shall meet the security functional requirement FCS_CKM.1/CCL as specified below.

 FCS_CKM.1/CCL         Cryptographic key generation
      Hierarchical to: No other components.
      Dependencies: [FCS_CKM.2 Cryptographic key distribution, or
                       FCS_COP.1 Cryptographic operation]
                       FCS_CKM.4 Cryptographic key destruction
                       FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/CCL The TSF shall generate cryptographic keys in accordance with a specified
                       cryptographic key generation algorithm:
                            In the mode confidential communication:
                              session key derivation and key derivation for the exchange protocol
                            In the mode integrity protection:
                              session key derivation
                       and specified cryptographic key sizes of 128 bits that meet the following:
                            CIPURSE™ V2 Cryptographic Protocol [35-1] chapters 5.2 and 6.2

The CCL shall meet the security functional requirement FCS_CKM.1/CCL as specified below.

 FCS_CKM.4/CCL            Cryptographic key destruction
 Hierarchical to:         No other components.
 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or
                          FDP_ITC.2 Import of user data with security attributes, or
                          FCS_CKM.1 Cryptographic key generation]
 FCS_CKM4.1/CCL           The TSF shall destroy cryptographic keys in accordance with a specified
                          cryptographic key destruction method overwriting with random value that meets the
                          following
                          None

Note for FCS_CKM.4/CCL:
The key destruction is triggered by the SCP at every entry and exit. The key storage in the SCP is wiped with
random values.
End of note.




CC Document                                             87                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.4.5       The Asymmetric Cryptographic Library v2.08.007 and v2.07.003
 7.1.4.5.1    Rivest-Shamir-Adleman (RSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

   FCS_COP.1/RSA-1      Cryptographic operation
   or
   FCS_COP.1/RSA-2
   Hierarchical to:     No other components.
   Dependencies:        [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                        or FDP_ITC.2 Import of user data of the Composite TOE with security attributes]

                        FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/RSA-1    The TSF shall perform encryption, decryption, signature generation and signature
   or                   verification in accordance with in accordance with a specified cryptographic
   FCS_COP.1.1/RSA-2    algorithm Rivest-Shamir-Adleman (RSA) and cryptographic key sizes from 512 bits
                        up to 4096+128 bits in 1 Bit stepping that meet the following:
                        Encryption:
                        1. According to section 5.1.1 RSAEP in PKCS [22]:
                               Supported for n < 24096 + 128
                             5.1.1(1) not supported
                        2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
                        Supported for n < 24096 + 128
                        Decryption (with or without CRT):
                        1. According to section 5.1.2 RSADP in PKCS [22] for u = 2, i.e.,
                        without any (ri, di, ti), i > 2
                               5.1.2(1) not supported
                               5.1.2(2.a) supported for n < 22048 + 64
                               5.1.2(2.b) supported for p  q < 24096 + 128
                             5.1.2(2.b) (ii)&(v) not applicable due to u = 2
                        2. According to section 8.2.3 IEEE [29]:
                               8.2.1(I) supported for n < 22048 + 64
                               8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported




CC Document                                             88                                                1.8
                                                                                                   2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                      Signature Generation (with or without CRT):
                      1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e.,
                      without any (ri, di, ti), i >2
                             5.2.1(1) not supported
                             5.2.1(2.a) supported for n < 22048 + 64
                             5.2.1(2b) supported for p  q < 24096 + 128
                           5.2.1(2b) (ii)&(v) not applicable due to u = 2
                      2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                             8.2.1(I) supported for n < 22048 + 64
                             8.2.1(II) supported for p  q < 24096 + 128
                           8.2.1(III) not supported
                      Signature Verification:
                      1. According to section 5.2.2 RSAVP1 in PKCS [22]:
                      supported for n < 24096 +128
                           5.2.2(1) not supported
                      2. According to section 8.2.5 IEEE [29]:
                             Supported for n < 24096 +128
                             8.2.5(1) not supported


                          Please consider also the statement of chapter 7.1.4.1.




CC Document                                           89                                          1.8
                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.2     Rivest-Shamir-Adleman (RSA) key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

The RSA cryptographic library is offered in two parts: The 2k part of the RSA library can be used for key lengths
of up to 2048 bits and the 4k part of the RSA library can be used for key lengths of up to 4096 bits.

   FCS_CKM.1/RSA-1       Cryptographic key generation
   or
   FCS_CKM.1/RSA-.2
        Hierarchical to: No other components.
         Dependencies: FCS_CKM.2 Cryptographic key distribution, or
                         FCS_COP.1 Cryptographic operation]
                         FCS_CKM.4 Cryptographic key destruction
                         FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/RSA-1     The TSF shall generate cryptographic keys in accordance with a specified
   or                    cryptographic key generation algorithm implemented by following functions:
   FCS_CKM.1.1/RSA-2      CryptoRSAKeyGen
                             CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrime or
                              CryptoGeneratePrimeMask
                             CryptoRSAKeyGenMask_D plus CryptoGeneratePrime or
                              CryptoGeneratePrimeMask
                              CryptoRSAKeyGenMask_N plus CryptoGeneratePrime or
                                 CryptoGeneratePrimeMask
                            and specified cryptographic key sizes of 512 up to 4096+128 bits that meet the
                            following:
                            RSA key generation according to Infineon key generation methods. The generated
                            keys are in conformance with:
                            1. According to sections 3.1 and 3.2 in PKCS [22], for u = 2,
                            i.e. without any (ri, di, ti), i > 2:
                                     3.1 supported for n < 24096 + 128
                                     3.2.(1) supported for n < 22048 + 64
                                     3.2.(2) supported for p x q < 24096 + 128
                            2. According to section 8.1.3.1 in IEEE [29]:
                                     8.1.3.1(1) supported for n < 22048 + 64
                                     8.1.3.1(2) supported for p x q < 24096 + 128
                                     8.1.3.1(3) supported for p x q < 22048 + 64

Notes for FCS_CKM.1.1/RSA-1 or FCS_CKM.1.1/RSA-2:
1. The function CryptoGeneratePrime has been assigned to the appropriate security level by BSI. The proprietary
CryptoGeneratePrimeMask function has not been cryptographic-analytically evaluated and certified by BSI.
End of note.

2. The minimum key length follows the national recommendations by the BSI which means that RSA key lengths
below 1976 bits are not included in the certificate. The key length requirements can differ between the countries.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

CC Document                                             90                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


3. For easy integration of RSA functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
Please consider also the statement of chapter 7.1.4.1.
End of note.

4. The TOE can be delivered with or without one of the RSA libraries. In the case of coming without the RSA
library – regardless of the version – the TOE does not provide the Additional Specific Security Functionality
Rivest-Shamir-Adleman Cryptography (RSA) realized with the security functional requirements FCS_COP.1/RSA-
1 respectively FCS_COP.1/RSA-2 and FCS_CKM.1/RSA-1 and FCS_CKM.1/RSA-2. In case of a blocked
Crypto2304T the optionally delivered cryptographic and the supporting Toolbox cannot be used in that TOE
product.
End of notes.




CC Document                                             91                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.3     General Preface regarding Elliptic Curve Cryptography
The EC library is delivered as object code and in this way integrated in the user software. The security functional
requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,
224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
with size n є [41-1; 521] are supported.

Elliptic Curve DSA (ECDSA) operation

  FCS_COP.1/ECDSA-1          Cryptographic operation
  or
  FCS_COP.1/ECDSA-2
  Hierarchical to:    No other components.
  Dependencies:       [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                      or
                      FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                      FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDSA-1 The TSF shall perform signature generation and signature verification in
  or                  accordance with a specified cryptographic algorithm ECDSA and cryptographic key
  FCS_COP.1.1/ECDSA- sizes 160, 163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the
  2                   following:
                      ECDSA Signature Generation:
                       1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                    Deviation of step c) and f):
                                         o The jumps to step a) were substituted by a return of the function with
                                              an error code, the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                     Chapter 6.4.3.7 is not supported
                                  Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                  Deviation of step (3) and (4):
                                       o The jumps to step 1 were substituted by a return of the function with
                                           an error code, the jumps are emulated by another call to our function
                             ECDSA Signature Verification:




CC Document                                                92                                                         1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                           1. According to section 7.4.1 in ANSI [23]

                                  Step b) and c) are not supported.
                                  The output of step c) has to be provided as input to our function by the caller.
                                  Deviation of step d):
                                       o Beside noted calculation, our algorithm adds a random multiple of
                                            BasepointerOrder n to the calculated values u1 and u2.
                           2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                Chapter 6.4.4.2 is not supported
                                Chapter 6.4.4.3 is not supported:
                                       o The hash-code H of the message has to be provided by the caller as
                                            input to our function
                           3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-1 and FCS_COP.1/ECDSA-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                              93                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.4    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-1         Cryptographic key generation
   or
   FCS_CKM.1/EC-2
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-1       The TSF shall generate cryptographic keys in accordance with a specified
   or                     cryptographic key generation algorithm implemented by following functions which
   FCS_CKM.1.1/EC-2       can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note for FCS_CKM.1/EC-1 and FCS_CKM.1/EC-2:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             94                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.5.5     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-1          Cryptographic operation
  or
  FCS_COP.1/ECDH-2
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-1        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
  or                        with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
  FCS_COP.1.1/ECDH-2        163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section 7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Notes for: FCS_COP.1/ECDH-1 and FCS_COP.1/ECDH-2:

1. The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163 and 192 bits are supported. Numerous other curve types, being also secure in terms of
side channel attacks on this TOE, exist, which the user optionally can add in the composition certification
process.
End of note

2. For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

3. The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not
provide the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security
functional requirements FCS_COP.1/ECDSA-1 or FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-1 or
FCS_COP.1/ECDH-2 and FCS_CKM.1/EC-1 or FCS_CKM.1/EC-2. In case of a blocked Crypto2304T, the RSA and
EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered cryptographic
RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

4. The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of notes.

CC Document                                             95                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)




7.1.4.6       The Asymmetric Cryptographic Library v2.06.003
 7.1.4.6.1    Rivest-Shamir-Adleman (RSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

   FCS_COP.1/RSA-3      Cryptographic operation
   Hierarchical to:     No other components.
   Dependencies:        [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                        or FDP_ITC.2 Import of user data of the Composite TOE with security attributes]

                        FCS_CKM.4 Cryptographic key destruction
   FCS_COP.1.1/RSA-3    The TSF shall perform encryption, decryption, signature generation and signature
                        verification in accordance with a specified cryptographic algorithm Rivest-Shamir-
                        Adleman (RSA) and cryptographic key sizes from 512 bits up to 4096+128 bits in 1 Bit
                        stepping that meet the following:
                        Encryption:
                        1. According to section 5.1.1 RSAEP in PKCS [22]:
                               Supported for n < 24096 + 128
                              5.1.1(1) not supported
                        2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
                        Supported for n < 24096 + 128
                        Decryption (with or without CRT):
                        1. According to section 5.1.2 RSADP in PKCS [22]
                        for u = 2, i.e., without any (ri, di, ti), i > 2
                               5.1.2(1) not supported
                               5.1.2(2.a) supported for n < 22048 + 64
                               5.1.2(2.b) supported for p  q < 24096 + 128
                             5.1.2(2.b) (ii)&(v) not applicable due to u = 2
                        2. According to section 8.2.3 IEEE [29]:
                               8.2.1(I) supported for n < 22048 + 64
                               8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported




CC Document                                             96                                                  1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                          Signature Generation (with or without CRT):
                          1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e.,
                          without any (ri, di, ti), i >2

                                  5.2.1(1) not supported
                                  5.2.1(2.a) supported for n < 22048 + 64
                                  5.2.1(2b) supported for p  q < 24096 + 128
                               5.2.1(2b) (ii)&(v) not applicable due to u = 2
                          2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                                  8.2.1(I) supported for n < 22048 + 64
                                  8.2.1(II) supported for p  q < 24096 + 128
                               8.2.1(III) not supported
                          Signature Verification:
                          1. According to section 5.2.2 RSAVP1 in PKCS [22]:
                          supported for n < 24096 +128
                               5.2.2(1) not supported
                          2. According to section 8.2.5 IEEE [29]:
                                  Supported for n < 24096 +128
                                  8.2.5(1) not supported


Please consider also the statement of chapter 7.1.4.1.




CC Document                                                97                                 1.8
                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.2     Rivest-Shamir-Adleman (RSA) key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

The RSA cryptographic library is offered in two parts: The 2k part of the RSA library can be used for key lengths
of up to 2048 + 64 bits and the 4k part of the RSA library can be used for key lengths of up to 4096 + 128 bits.

   FCS_CKM.1/RSA-3      Cryptographic key generation
       Hierarchical to: No other components.
       Dependencies: FCS_CKM.2 Cryptographic key distribution, or
                        FCS_COP.1 Cryptographic operation]
                        FCS_CKM.4 Cryptographic key destruction
                        FMT_MSA.2 Secure security attributes
   FCS_CKM.1.1/RSA-3 The TSF shall generate cryptographic keys in accordance with a specified
                        cryptographic key generation algorithm implemented by following functions:
                         CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_D plus CryptoGeneratePrimeMask
                         CryptoRSAKeyGenMask_N plus CryptoGeneratePrimeMask
                        and specified cryptographic key sizes of 512 – 4096 bits that meet the following:
                        RSA key generation according to Infineon key generation methods. The generated
                        keys are in conformance with:
                        1. According to sections 3.1 and 3.2 in PKCS [22],
                        for u = 2, i.e. without any (ri, di, ti), i > 2:
                                 3.1 supported for n < 24096 + 128
                                 3.2.(1) supported for n < 22048 + 64
                                 3.2.(2) supported for p x q < 24096 + 128
                        2. According to section 8.1.3.1 in IEEE [29]:
                                 8.1.3.1(1) supported for n < 22048 + 64
                                 8.1.3.1(2) supported for p x q < 24096 + 128
                                 8.1.3.1(3) supported for p x q < 22048 + 64

Note 1 for FCS_CKM.1.1/RSA-3:
The minimum key length follows the national recommendations by the BSI which means that RSA key lengths
below 1976 bits are not included in the certificate. The key length requirements can differ between the countries.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

Note 2 for FCS_CKM.1.1/RSA-3:
The TOE can be delivered with or without the RSA library. In the case of coming without the RSA library the TOE
does not provide the Additional Specific Security Functionality Rivest-Shamir-Adleman Cryptography (RSA)
realized with the security functional requirements FCS_COP.1/RSA and FCS_CKM.1/RSA. In case of a blocked
Crypto2304T the optionally delivered cryptographic and the supporting Toolbox cannot be used in that TOE
product.
End of note.

 7.1.4.6.3     General Preface regarding Elliptic Curve Cryptography
The EC library is delivered as object code and in this way integrated in the user software. The security functional
requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,

CC Document                                              98                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
  All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
                                        with size n є [41-1; 521] are supported.

 7.1.4.6.4     Elliptic Curve DSA (ECDSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.
 FCS_COP.1/ECDSA-3           Cryptographic operation
 Hierarchical to:            No other components.
 Dependencies:               [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                             or
                             FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                             FCS_CKM.4 Cryptographic key destruction
 FCS_COP.1.1/ECDSA-3         The TSF shall perform signature generation and signature verification in accordance
                             with a specified cryptographic algorithm ECDSA and cryptographic key sizes 160,
                             163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                             ECDSA Signature Generation:
                             1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                   Deviation of step c) and f):
                             The jumps to step a) were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                  Chapter 6.4.3.7 is not supported
                             Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                   Deviation of step (3) and (4):
                             The jumps to step 1 were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function
                             ECDSA Signature Verification:
                             1. According to section 7.4.1 in ANSI [23]
                                     Step b) and c) are not supported.
                                     The output of step c) has to be provided as input to our function by the caller.
                                     Deviation of step d):
                                         o Beside noted calculation, our algorithm adds a random multiple of
                                              BasepointerOrder n to the calculated values u1 and u2.

CC Document                                                 99                                                         1.8
                                                                                                                2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                            2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                   Chapter 6.4.4.2 is not supported
                                   Chapter 6.4.4.3 is not supported:
                                        o The hash-code H of the message has to be provided by the caller as
                                             input to our function
                            3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             100                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.5    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-3         Cryptographic key generation
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-3       The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm implemented by following functions which
                      BSI-DSZ-CC-0879-V4-2020

                       for

   Infineon Security Controller M7893 B11 with
 optional RSA2048/4096 v2.03.008, EC v2.03.008,
SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox
v2.03.008 and with specific IC dedicated software
                    (firmware)

                      from

           Infineon Technologies AG
                     BSI - Bundesamt für Sicherheit in der Informationstechnik, Postfach 20 03 63, D-53133 Bonn
                      Phone +49 (0)228 99 9582-0, Fax +49 (0)228 9582-5477, Infoline +49 (0)228 99 9582-111




Certification Report V1.0                                                                                         CC-Zert-327 V5.25
      BSI-DSZ-CC-0879-V4-2020 (*)
      Infineon Security Controller M7893 B11 with optional RSA2048/4096
      v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
      Toolbox v2.03.008 and with specific IC dedicated software (firmware)

      from                       Infineon Technologies AG
      PP Conformance:            Security IC Platform Protection Profile, Version 1.0,                             SOGIS
                                 15 June 2007, BSI-CC-PP-0035-2007                                           Recognition Agreement

      Functionality:             PP conformant plus product specific extensions
                                 Common Criteria Part 2 extended
      Assurance:                 Common Criteria Part 3 conformant
                                 EAL 6 augmented by ALC_FLR.1



The IT Product identified in this certificate has been evaluated at an approved evaluation
facility using the Common Methodology for IT Security Evaluation (CEM), Version 3.1
extended by Scheme Interpretations, by advice of the Certification Body for components
beyond EAL5 and CC Supporting Documents as listed in the Certification Report for
conformance to the Common Criteria for IT Security Evaluation (CC), Version 3.1. CC and
CEM are also published as ISO/IEC 15408 and ISO/IEC 18045.
(*) This certificate applies only to the specific version and release of the product in its
evaluated configuration and in conjunction with the complete Certification Report and
Notification. For details on the validity see Certification Report part A chapter 5.
The evaluation has been conducted in accordance with the provisions of the certification
scheme of the German Federal Office for Information Security (BSI) and the conclusions
                                                                                                             Common Criteria
of the evaluation facility in the evaluation technical report are consistent with the                    Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                                                  4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................12
   3. Security Policy............................................................................................................15
   4. Assumptions and Clarification of Scope.....................................................................15
   5. Architectural Information.............................................................................................16
   6. Documentation...........................................................................................................16
   7. IT Product Testing.......................................................................................................16
   8. Evaluated Configuration.............................................................................................17
   9. Results of the Evaluation............................................................................................18
   10. Obligations and Notes for the Usage of the TOE.....................................................19
   11. Security Target..........................................................................................................20
   12. Regulation specific aspects (eIDAS, QES)..............................................................20
   13. Definitions.................................................................................................................20
   14. Bibliography..............................................................................................................23
C. Excerpts from the Criteria..............................................................................................26

D. Annexes.........................................................................................................................27




                                                                                                                                 5 / 33
Certification Report                                                               BSI-DSZ-CC-0879-V4-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carried out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BSI Schedule of Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]
●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.

1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     Schedule of Cost for Official Procedures of the Bundesamt für Sicherheit in der Informationstechnik
     (BSI-Kostenverordnung, BSI-KostV) of 3 March 2005, Bundesgesetzblatt I, p. 519



                                                                                                           6 / 33
BSI-DSZ-CC-0879-V4-2020                                                              Certification Report




●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
               can be used independently of each other:
                            ECC_ECDSAKeyGen
                            ECC_ECDSAKeyGenMask
                          specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
                          224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                          ECDSA Key Generation:
                          1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
                          The optional cofactor h is not supported.
                          2. According to section “6.4.2 Generation of signature key and verification key” in
                          ISO/IEC [27].
                          3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Note1 for FCS_CKM.1/EC-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             101                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.6     Elliptic Curve Diffie-Hellman (ECDH) key agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.

  FCS_COP.1/ECDH-3          Cryptographic operation
  Hierarchical to:          No other components.
  Dependencies:             [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                            or FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                            FCS_CKM.1 Cryptographic key generation]
                            FCS_CKM.4 Cryptographic key destruction
  FCS_COP.1.1/ECDH-3        The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance
                            with a specified cryptographic algorithm ECDH and cryptographic key sizes 160,
                            163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                            1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                            Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.
                            2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
                            The function enables the operations described in appendix D.6
                            3. According to section “7.2.1 ECSVHDP-DH” in IEEE [29]
                            Unlike section 7.2.1 our implementation not only returns the x-coordinate of the
                            shared secret, but rather the x-coordinate and the y-coordinate.

Note for FCS_COP.1/ECDH-3:
The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 224, 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI.
Furthermore, 160, 163, 192 bits are supported. Numerous other curve types, being also secure in terms of side
channel attacks on this TOE, exist, which the user optionally can add in the composition certification process.
End of note

Note 2 for FCS_COP.1/ECDH-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.

Note 3 for FCS_COP.1/ECDH-3:
The TOE can be delivered with or without the EC library. In the case the TOE comes without, it does not provide
the Additional Specific Security Functionality Elliptic Curve Cryptography realized with the security functional
requirements FCS_COP.1/ECSA, FCS_COP.1/ECDH and FCS_CKM.1/EC. In case of a blocked Crypto2304T, the
RSA and EC cryptographic library cannot be used. In case of a blocked Crypto2304T the optionally delivered
cryptographic RSA and EC, as well as the supporting Toolbox cannot be used in that TOE product.
End of note.

Note 4 for FCS_COP.1/ECDH-3:
The EC primitives allow the selection of various curves. The selection of the curves depends to the user.
End of note.



CC Document                                             102                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.5          Data Integrity FDP_SDI.2 and FDP_SDC.1
The TOE shall meet the requirement Stored data integrity monitoring and action (FDP_SDI.2) as specified below:

    FDP_SDI.2           Stored data integrity monitoring and action
    Hierarchical to:    FDP_SDI.1 stored data integrity monitoring
    Dependencies:       No dependencies
    FDP_SDI.2.1         The TSF shall monitor user data of the Composite TOE stored in containers controlled
                        by the TSF for data integrity and one- and/or more-bit-errors on all objects, based on
                        the following attributes: corresponding EDC value for RAM, ROM and SOLID FLASH™
                        NVM and error correction ECC for the SOLID FLASH™ NVM.
    FDP_SDI.2.2         Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                        FLASH™ NVM automatically and inform the user about more bit errors.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.

The TOE shall meet the requirement “Stored data confidentiality (FDP_SDC.1)” as specified below:
   FDP_SDC.1             Stored data confidentiality
     Hierarchical to:    No other components
     Dependencies:       No dependencies
   FDP_SDC.1.1           The TSF shall ensure the confidentiality of the information of the user data of the
                         Composite TOE while it is stored in the RAM, ROM, Cache and SOLID FLASH™ NVM.




CC Document                                              103                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.1.6          Application Note to FPT_FLS.1 Failure with preservation of secure state
The SFR FPT_FLS.1 is defined in the PP [9] but with application note 14 it is required to describe the secure state:
Where ever FPT_FLS.1 is claimed it depends on the source or affected piece of data the failure was detected.
Induced failures on other than memory contents could in the worse lead to exploitable situations if not
discovered and treated properly. This includes i.e. internal transported keys and other TSF data. For that reasons
the integrity of the transport ways and also the modules the TSF and critical data are used is protected against
failure.
Depending on the criticality where the failure occurred and in most cases a security reset is triggered. Only in
case of a peripheral bus error or an address translation mismatch, a user software action is required as described
in the user guidance.
In case of a security reset, the user cannot take any action. The chip immediately stops operation and reboots.


7.2            Support by the Flash Loader

The TOE provides the Flash Loader to download user data into the SOLID FLASH™ NVM, either during
production of the TOE or at customer site. The Flash Loader is dedicated for usage by authorized users only in
secured and insecure environment during the production up to Phase 6 Security IC Personalisation.
The Flash Loader has to be permanently deactivated before entering Phase 7 Security IC end-usage.
For this reason the TOE shall meet the requirements as defined and described in the PP [9] section 7.3 Packages
for Loader and 7.2 Package Authentication of the Security IC:
     Limited capabilities (FMT_LIM.1/Loader),
     Limited availability – Loader (FMT_LIM.2/Loader),
     Authentication Proof of Identity (FIA_API.1),
     Inter-TSF trusted channel (FTP_ITC.1),
     Basic data exchange confidentiality (FDP_UCT.1),
     Data exchange integrity (FDP_UIT.1),
     Subset access control – Loader (FDP_ACC.1/Loader) and
     Security attribute based access control – Loader (FDP_ACF.1/Loader)
as defined in the PP [9], section 7.2 and 7.3.

The Flash Loader supports the following security function policy (SFP):
    Loader SFP:
        provides the mutual authentication between the TOE and the administrator user or download operator
        user and the download of the user data into the memory of the TOE.

The Flash Loader supports the following two subjects:
    Administrator user:
        is enabled performing mutual authentication with the keys Kc and Kd, to manage (set, exchange, delete)
        the keys Kc, Kd and Kfdi and to process the download of the user data into the memory of the TOE.
    Download operator user:
        is enabled performing mutual authentication with Kd, to exchange the key Kd and to perform the
        download of the user data into the memory of the TOE. He can also delete Kfdi.




CC Document                                             104                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The Flash Loader supports the following object:
    User data:
        Data loaded into the memory of the TOE.

The TOE shall meet the requirement “Limited capabilities (FMT_LIM.1/Loader)” as specified below:

 FMT_LIM.1/Loader          Limited capabilities
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.2 Limited availability.
 FMT_LIM.1.1/Loader        The TSF shall be designed and implemented in a manner that limits its capabilities so
                           that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                           enforced:
                           Deploying Loader functionality after permanent deactivation does not allow stored user
                           data of the Composite TOE to be disclosed or manipulated by unauthorized user.

The TOE shall meet the requirement “Limited availability – Loader (FMT_LIM.2/Loader)” as specified below:
 FMT_LIM.2/Loader          Limited availability – Loader
      Hierarchical to:     No other components.
      Dependencies:        FMT_LIM.1 Limited capabilities.
 FMT_LIM.2.1/Loader        The TSF shall be designed in a manner that limits its availability so that in
                           conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced:

                           The TSF prevents deploying the Loader functionality after permanent deactivation.

The TOE shall meet the requirement “Limited availability – Loader (FIA_API.1)” as specified below:
  FIA_API.1              Authentication Proof of Identity
      Hierarchical to:   No other components.
      Dependencies:      No dependencies.
  FIA_API.1.1            The TSF shall provide an authentication mechanism according to [34] ISO/IEC 9798-2
                         section 6.2.2 Mechanism 4: Three-path authentication based on the security attributes
                         (keys) Kc or Kd to prove the identity of the TOE to an external entity.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.




CC Document                                             105                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FTP_ITC.1)” as specified below:
  FTP_ITC.1              Inter-TSF trusted channel
     Hierarchical to:    No other components.
     Dependencies:       No dependencies.
  FTP_ITC.1.1            The TSF shall provide a communication channel between itself and the administrator
                         user and the Download Operator user as described in the Loader SFP that is logically
                         distinct from other communication channels and provides assured identification of its
                         end points and protection of the channel data from modification or disclosure.
  FTP_ITC.1.2            The TSF shall permit another trusted IT product to initiate communication via the
                         trusted channel.
  FTP_ITC.1.3            The TSF shall initiate communication via the trusted channel for deploying Loader for
                         downloading user data.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UCT.1)” as specified below:
  FDP_UCT.1               Basic data exchange confidentiality
      Hierarchical to:    No other components.
      Dependencies:       No dependencies.
  FDP_UCT.1.1             The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                          unauthorised disclosure.

The TOE shall meet the requirement “Limited availability – Loader (FDP_UIT.1)” as specified below:
 FDP_UIT.1            Data exchange integrity
     Hierarchical to: No other components.
      Dependencies: [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                      [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control].
 FDP_UIT.1.1          The TSF shall enforce the Loader SFP to receive user data in a manner protected from
                      modification, deletion or insertion errors.
 FPP_UIT.1.2          The TSF shall be able to determine on receipt of user data, whether modification,
                      deletion or insertion have occurred.

Note regarding the Flash Loader:
The algorithm strength of the Flash Loader has not been cryptographic-analytically evaluated by the BSI, as
Infineon has implemented a proprietary extension.
End of note.




CC Document                                            106                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


The TOE shall meet the requirement “Limited availability – Loader (FDP_ACC.1/Loader)” as specified below:
 FDP_ACC.1/Loader           Subset access control – Loader
       Hierarchical to:     No other components.
       Dependencies:        FDP_ACF.1 Security attribute based access control.
 FDP_ACC.1.1/Loader         The TSF shall enforce the Loader SFP on
                               (1) the subjects Administrator user and the Download operator user,
                               (2) the objects User data in the SOLID FLASH™ NVM memory of the TOE,
                               (3) the operation deployment of the Loader.

Additional requirement to the environment with regard to GBIC: If the GBIC process is to be applied, the keys Kc,
Kd and Kfdi shall be generated with sufficient entropy considering the requirements by GBIC as outlined in
section 10 to prove the identity of the TOE to an external entity.

The TOE shall meet the requirement “Limited availability – Loader (FTP_ACF.1/Loader)” as specified below:
 FDP_ACF.1/Loader             Security attribute based access control – Loader
             Hierarchical to: No other components.
             Dependencies: FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        The TSF shall enforce the Loader SFP to objects based on the following:
                                 (1) the subjects Administrator user and the Download operator user with
                                     security attributes Kc, Kd and Kfdi
                                 (2) the objects user data in data loaded into the SOLID FLASH™ NVM
                                     memory of the TOE with security attributes Kfdi.

      FDP_ACF.1.2/Loader          The TSF shall enforce the following rules to determine if an operation among
                                  controlled subjects and controlled objects is allowed:
                                     (1) evaluate the corresponding access control information of the relevant
                                          subject, administrator user and download operator user, before the
                                          access, so that accesses to be denied cannot be utilized by the subject
                                          attempting to perform the operation. The subsequent download is then
                                          protected by the key Kfdi.

      FDP_ACF.1.3/Loader          The TSF shall explicitly authorise access of subjects to objects based on the
                                  following additional rules:
                                                                       None

      FDP_ACF.1.4/Loader          The TSF shall explicitly deny access of subjects to objects based on the
                                  following additional rules:
                                                                       None




CC Document                                            107                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


Note 15:
Regarding FDP_ACF.1.4/Loader it is added in the User Guidance that the Flash Loader has to be permanently
deactivated prior delivery to the end-user.
End of note.

Note 16:
The security functional requirements FMT_LIM.1/Loader, FMT_LIM.2/Loader, FIA_API.1, FTP_ITC.1, FDP_UCT.1,
FDP_UIT.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader apply only at TOE products coming with activated Flash
Loader enabled for user data download. In other cases the Flash Loader is not available anymore and the user
software or data download is completed. Depending on the capabilities of the user software these security
functional requirements may then reoccur as subject of the composite TOE.
The permanent locking of the Flash Loader after finalizing the download and prior delivery to the end-user is
added to package 2 with LIM1/Loader and FMT_LIM.2/Loader.
End of note.


7.3             TOE Security Assurance Requirements

The evaluation assurance level is EAL6 augmented with ALC_FLR.1.
In the following table, the security assurance requirements are given. The augmentation of the assurance
components compared to the Protection Profile [9] is expressed with bold letters.

                                     Table 13     Assurance Components
              Aspect               Acronym                        Description                    Refinement
 Development                    ADV_ARC.1          Security Architecture Description            In PP [9]
                                ADV_FSP.5          Complete semi-formal functional              in ST
                                                   specification with additional error
                                                   information
                                ADV_IMP.2          Complete mapping of the                      in ST
                                                   implementation representation of the
                                                   TSF
                                ADV_INT.3          Minimally complex internals
                                ADV_TDS.5          Complete semi-formal modular design
                                ADV_SPM.1          Formal TOE security policy model
 Guidance Documents             AGD_OPE.1          Operational user guidance                    in PP [9]
                                AGD_PRE.1          Preparative procedures                       in PP [9]
 Life-Cycle Support             ALC_CMC.5          Advanced support                             in ST
                                ALC_CMS.5          Development tools CM coverage                in ST
                                ALC_DEL.1          Delivery procedures                          in PP [9]
                                ALC_DVS.2          Sufficiency of security measures             in PP [9]
                                ALC_LCD.1          Developer defined life-cycle model
                                ALC_TAT.3          Compliance with implementation
                                                   standards – all parts
                                ALC_FLR.1          Basic Flaw Remediation
 Security Target Evaluation     ASE_CCL.1          Conformance claims
                                ASE_ECD.1          Extended components definition
                                ASE_INT.1          ST introduction
CC Document                                           108                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              Aspect                 Acronym                         Description                    Refinement
                                 ASE_OBJ.2           Security objectives
                                 ASE_REQ.2           Derived security requirements
                                 ASE_SPD.1           Security problem definition
                                 ASE_TSS.1           TOE summary specification
 Tests                           ATE_COV.3           Rigorous analysis of coverage                  In ST
                                 ATE_DPT.3           Testing: modular design
                                 ATE_FUN.2           Ordered functional testing
                                 ATE_IND.2           Independent testing – sample
 Vulnerability Assessment        AVA_VAN.5           Advanced methodical vulnerability testing      in PP [9]


7.3.1           Refinements
Some refinements are taken unchanged from the PP [9]. In some cases a clarification is necessary. In Table 17 an
overview is given where the refinement is done.
The refinements from the PP [9] have to be discussed here in the Security Target, as the assurance level is
increased. The refinements from the PP [9] are included in the chosen assurance level EAL 6 augmented with
ALC_FLR.1.
7.3.1.1         Development (ADV)
ADV_IMP Implementation Representation:
The refined assurance package ADV_IMP.1 implementation representation of the TSF requires the availability of
the entire implementation representation, a mapping of the design description to the implementation
representation with a level of detail that the TSF can be generated without further design decisions. In addition,
the correspondence of design description and implementation representation shall be demonstrated.
The covered higher assurance package ADV_IMP.2 requires a complete and not curtailed mapping of the
implementation representation of the TSF, and the mapping of the design description to the entire
implementation representation. In addition, the correspondence of design description and the implementation
representation shall be demonstrated. The ADV_IMP.1 aspect and refinement remains therefore valid. The
enhancement underlines the refinement in the PP [9] and by that the entirely complete design i.e. not curtailed
representation with according mapping was provided, demonstrated and reviewed.

ADV_FSP Functional Specification:
The ADV_FSP.4 package requires a functional description of the TSFIs and there assignment to SFR-enforcing,
SFR-supporting, SFR-non-interfering, including related error messages, the assurance package. The
enhancement of ADV_FSP.5 requires additionally a complete semi-formal functional specification with
additional error information. In addition the package includes a tracing from the functional specification to the
SFRs, as well as the TSFIs descriptions including error messages not resulting from an invocation of a TSFI.
These aspects from ADV_FSP.5 are independent from the ADV_FSP.4 refinements from the PP [9] but
constitute an enhancement of it. By that the aspects of ADV_FSP.4 and its refinement in the PP [9] apply also
here. The assurance and evidence was provided accordingly.

ADV_SPM Formal Security Policy Model
It is the objective of this family to provide additional assurance from the development of a formal security policy
model of the TSF, and establishing a correspondence between the functional specification and this security
policy model. Preserving internal consistency the security policy model is expected to formally establish the
security principles from its characteristics by means of a mathematical proof.



CC Document                                             109                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


   ADV_SPM.1          Formal TOE security policy model
   Hierarchical to:   No other components
   Dependencies:      ADV_FSP.4 Complete function description
   ADV_SPM.1.1D       The developer shall provide a formal security policy model for the
                      Memory Access Control Policy and the corresponding SFRs
                          FDP_ACC.1 Subset Access Control
                          FDP_ACF.1 Security attribute based access control
                          FMT_MSA.1 Management of Security Attributes
                          FMT_MSA.3 Static Attribute Initialization.
                      Moreover, the following SFRs shall be addressed by the formal security policy model:
                         FDP_SDI.2 Stored data integrity monitoring and action
                         FDP_SDC.1 Stored data confidentiality
                         FDP_ITT.1 Basic Internal Transfer Protection
                         FDP_IFC.1 Information Flow Control
                         FPT_ITT.1 Basic internal TSF data transfer protection
                         FPT_PHP.3 Resistance to physical attack
                         FPT_FLS.1 Failure with preservation of secure state
                         FRU_FLT.2 Limited fault tolerance
                         FMT_LIM.1 Limited capabilities
                         FMT_LIM.2 Limited availability
                         FAU_SAS.1 Audit storage
                         FMT_SMF.1 Specification of Management Functions
                       Moreover, the following SFRs of the package authentication of the IC PP [9] and the
                         loader packages PP [9] shall be addressed by the formal security policy model:
                         FIA_API.1
                         FMT_LIM.1/Loader
                         FMT_LIM.2/Loader
                         FTP_ITC.1
                         FDP_UCT.1
                         FDP_UIT.1
                         FDP_ACC.1/Loader
                         FDP_ACF.1/Loader
   ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify
                the relevant portions of the statement of SFRs that make up that policy.
   ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and
                any formal functional specification.
   ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model
                and the functional specification.

Note:
All HSL versions implement tearing save behavior for the SOLID Flash™ NVM. Its features are close to physical
SOLID Flash™ NVM behavior which is not part of the SPM. Therefore, the HSL functionality contributing to
FPT_FLS:1, FPT_PHP.3 and FDP_SDI.2 is excluded from the SPM even though it contributes to the named SFRs
which are listed and modelled in the ADV_SPM.1.1D definition.
End of note.


CC Document                                            110                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.3.1.2        Life-cycle Support (ALC)
ALC_CMS Configuration Management Scope:
The refinement of ALC_CMS.4 in the PP [9] defines with some conditions the possibility that the Security IC
embedded firmware can be part of the delivered TOE. This is the case as the Security IC embedded firmware –
regardless of the version in use - and the optional software are part of TOE and delivered together with the TOE
as the firmware and optional software are stored in the ROM and/or SOLID FLASH™ NVM. The presence of the
optional parts belongs to the user order. Both, the firmware and software delivered with the TOE are controlled
entirely by Infineon Technologies.
In addition, the TOE offers the possibility that the user can download his software at his own premises. These
parts of the software are user controlled only and are not part of this TOE. The download of this solely user
controlled software into the SOLID FLASH™ NVM is protected by strong authentication means. In addition, the
download itself could also be encrypted.
The requirements by ALC_CMS.4 are fulfilled including the refinements from the PP [9].
The ALC_CMS.5 implements the additional requirement to include development tools and related information
into the configuration list. This add on has no influence on the refinement of ALC_CMS.4 in the PP [9] as the
delivery of Security IC embedded firmware is independent from the TOE development tools and related
information. The package ALC_CMS.5 is therefore an enhancement to ACL_CMS.4 and the package with its
refinement in the PP [9] remains valid. The assurance and evidence was provided accordingly.

ALC_CMC Configuration Management Capabilities:
The PP refinement from the assurance package ALC_CMC.4 Production support, acceptance procedures and
automation points out that the configuration items comprise all items defined under ALC_CMS to be tracked
under configuration management. In addition a production control system is required guaranteeing the
traceability and completeness of different charges and lots. Also the number of wafers, dies and chips must be
tracked by this system as well as procedures applied for managing wafers, dies or complete chips being removed
from the production process in order to verify and to control predefined quality standards and production
parameters. It has to be controlled that these wafers, dies or assembled devices are returned to the same
production stage from which they are taken or they have to be securely stored or destroyed otherwise.
The additionally covered extended package of ALC_CMC.5 Advance Support requires advanced support
considering the automatisms configuration management systems, acceptance and documentation procedures
of changes, role separation with regard to functional roles of personnel, automatisms for tracking and version
controlling in those systems, and includes also production control systems. The additional aspects of
ADV_CMC.5 constitute an enhancement of ACL_CMC.4 and therefore the aspects and ACL_CMC.4 refinements
in the PP [9] remain valid. The assurance and evidence was provided.

ALC_DVS Development Security:
The requirement ALC_DVS.2 is refined in the PP [9] requiring the development security documentation
comprising all the physical, procedural, personnel, and other security measures that are necessary to protect the
confidentiality and integrity of the TOE design and implementation in its development environment.
The documentation and evidence was given, reviewed, audited and thus the assurance and evidence was
provided accordingly.

Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the:
      keys are generated with sufficient entropy
      the keys are stored within a HSM as integral part of the vendor environment
      the keys are stored in the non-volatile memory of the chip
All these requirements were subject of an audit; assurance and evidence was provided.



CC Document                                            111                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


ALC_DEL Delivery Procedure:
Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the delivery process of the Flash Loader keys - as referenced in the section 10 - is separated from the chip
delivery to the user.


7.3.1.3         Tests (ATE)
ATE_COV Test Coverage:
The PP refined assurance package ATE_COV.2 Analysis of coverage addresses the extent to which the TSF is
tested, and whether or not the testing is sufficiently extensive to demonstrate that the TSF operates as specified.
It includes the test documentation of the TSFIs in the functional specification. In particular the refinement
requires that The TOE must be tested under different operating conditions within the specified ranges. In
addition, the existence and effectiveness of mechanisms against physical attacks should be covered by evidence
that the TOE has the particular physical characteristics. This is furthermore detailed in the PP [9].
This assurance package ATE_COV.2 has been enhanced to ATE_COV.3 to cover the rigorous analysis of
coverage. This requires the presence of evidence that exhaustive testing on rigorous entirely all interfaces as
documented in the functional specification was conducted. By that ATE_COV.2 and refinements as given in the
PP [9] are enhanced by ATE_COV.3 and remain as well. The TSFIs were completely tested according to
ATE_COV.3 and the assurance and evidence was provided.


7.3.1.4         AVA_VAN Vulnerability Analysis
The assurance package AVA_VAN remains unchanged compared to the forerunner processes and requires
advanced methodical vulnerability analysis.




CC Document                                             112                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.4           Security Requirements Rationale

7.4.1         Rationale for the Security Functional Requirements
The objectives O.Authentication and OE.TOE_Auth are discussed in the PP [9] chapter 7.2.1.
The objectives O.Cap_Avail_Loader and OE.Lim_Block_Loader and the covering security functional
requirements FMT_LIM.1/Loader and FMT_LIM.2/Loader are discussed in the PP [9] chapter 7.3.1.
The policy P.Ctrl_Loader and the objectives O.Ctrl_Auth_Loader and OE.Loader_usage are discussed in the PP
[9] chapter 7.3.2.

Additionally, the objective O.Add-Function includes the objectives implemented by the CIPURSE™
Cryptographic Library versions: O.Ctrl_Auth_CCL, O.Prot_Integrity and O.Prot_Confidentiality.
These extended objectives are discussed in this ST in chapter 5.5 P.Add functions.

The additional objectives O.Prot_TSF_Confidentiality is defined in chapter 5.1 and 5.8 in this document.
PP [9] chapter 6.1 includes also the definition of FDP_SDI.2 „Stored data integrity monitoring and action“.
While the above mentioned security functional requirements rationale of the TOE are defined and described in
PP [9] section 6.3.1, the additional introduced SFRs are listed and discussed below:

                              Table 14     Rational for additional SFR in the ST
         Objective                                TOE Security Functional Requirements
                             FCS_COP.1/RSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDH-1 Cryptographic operation for ACL-1
                             FCS_CKM.1/RSA-1 Cryptographic key generation for ACL-1
                             FCS_CKM.1/EC-1 Cryptographic key generation for ACL-1
                             FCS_COP.1/RSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDH-2 Cryptographic operation for ACL-2
                             FCS_CKM.1/RSA-2 Cryptographic key generation for ACL-2
                             FCS_CKM.1/EC-2 Cryptographic key generation for ACL-2
O.Add-Functions
                             FCS_COP.1/RSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDH-3 Cryptographic operation for ACL-3
                             FCS_CKM.1/RSA-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/EC-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/CCL Cryptographic key generation for CCL
                             FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel for CCL
                             FCS_CKM.4/CCL Cryptographic key destruction for CCL
                             FCS_COP.1/CMAC-SCL-1 Cryptographic operation CMAC for SCL-1
                             FCS_CKM.4/CMAC-SCL-1 Cryptographic key destruction CMAC for SCL-1
O.Phys-Manipulation          FPT_TST.2 Subset TOE security testing
                             FDP_ACC.1 Subset access control
O.Mem-Access                 FDP_ACF.1 Security attribute based access control
                             FMT_MSA.3 Static attribute initialization

CC Document                                           113                                                   1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


         Objective                                TOE Security Functional Requirements
                             FMT_MSA.1 Management of security attributes
                             FMT_SMF.1 Specification of Management Functions
O.Malfunction                FDP_SDI.2 Stored data integrity monitoring and action
                             FCS_RNG.1/TRNG Generation of Random Numbers –TRNG
                             FCS_RNG.1/HPRG Generation of Random Numbers – HPRG
O.RND
                             FCS_RNG.1/DRNG Generation of Random Numbers –DRNG
                             FCS_RNG.1/KSG Generation of Random Numbers – KSG
                             FTP_ITC.1 Inter-TSF-trusted channel
O.Prot_TSF_
                             FDP_ACC.1/Loader Subset access control –Loader
Confidentiality
                             FDP_ACF.1/Loader Security attribute based access control – Loader
                             FCS_COP.1/TDES-SCL-1 Cryptographic operation – TDES by SCL-1
                             FCS_CKM.4/TDES-SCL-1 Cryptographic key destruction – TDES by SCL-1
                             FCS_COP.1/TDES-SCL-2 Cryptographic operation – TDES by SCL-2
O.TDES
                             FCS_CKM.4/TDES-SCL-2 Cryptographic key destruction – TDES by SCL-2
                             FCS_COP.1/TDES Cryptographic operation – TDES by SCP
                             FCS_CKM.4/TDES Cryptographic key destruction – TDES by SCP
                             FCS_COP.1/AES-SCL-1 Cryptographic operation – AES by SCL-1
                             FCS_CKM.4/AES-SCL-1 Cryptographic key destruction – AES by SCL-1
                             FCS_COP.1/AES-SCL-2 Cryptographic operation – AES by SCL-2
O.AES
                             FCS_CKM.4/AES-SCL-2 Cryptographic key destruction – AES by SCL-2
                             FCS_COP.1/AES Cryptographic operation – AES by SCP
                             FCS_CKM.4/AES Cryptographic key destruction – AES by SCP
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Ctrl_Auth_CCL              FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Integrity             FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL
                             FCS_COP.1/CCL Cryptographic operation –by CCL
O.Prot_Confidentiality       FCS_CKM.1/CCL Cryptographic key generation –by CCL
                             FCS_CKM.4/CCL Cryptographic key destruction –by CCL

The table above gives an overview, how the security functional requirements are combined to meet the security
objectives.




CC Document                                          114                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


For clarity please find following assignment to versions:
     ACL-1 covers version v2.08.007
     ACL-2 covers version v2.07.003
     ACL-3 covers version v2.06.003
     SCL-1 covers version v2.04.002
     SCL-2 covers version v2.02.010
     CCL covers version v02.00.0004


 7.4.1.1       Cryptographic Aspects
The justification related to the security objective “Additional Specific Security Functionality (O.Add-Functions)”
is as follows:
The security functional requirement(s) “Cryptographic operation (FCS_COP.1)” exactly require(s) those functions
to be implemented which are demanded by O.Add-Functions:
      The ACL library – regardless of the version chosen – implements the SFRs FCS_CKM.1/RSA, supporting
          the generation of RSA keys, and the FCS_CKM.1/EC, supporting the generation of EC keys, needed for
          these cryptographic operations.
          To sum up, the ACL versions implement the SFRs as follows:
              o FCS_COP.1/RSA-1, FCS_COP.1/ECDSA-1, FCS_COP.1/ECDH-1, FCS_CKM.1/RSA-1, and
                  FCS_CKM/EC-1 respectively
              o FCS_COP.1/RSA-2, FCS_COP.1/ECDSA-2, FCS_COP.1/ECDH-2, FCS_CKM.1/RSA-2, and
                  FCS_CKM/EC-2 respectively
              o FCS_COP.1/RSA-3, FCS_COP.1/ECDSA-3, FCS_COP.1/ECDH-3, FCS_CKM.1/RSA-3, and
                  FCS_CKM/EC-3
      The SCL library of version v2.04.002 implements the function of cipher based message authentication
          code CMAC, supporting the authenticity and integrity of data blocks for example used for messages.
      The CIPURSE™ Cryptographic Library implements the SFRs FCS_COP.1/CCL Cryptographic Operation
          CCL Trusted Channel, establishing the trusted channel between two authenticated entities and
          FCS_CKM.1/CCL Cryptographic key generation, supporting the generation of the keys used for
          authentication and confidentiality. The CIPURSE™ CL operation requires the presence of the SCP.

The implementation covers the functional requirements and meets the objective O.Add-Functions.
The use of the supporting library Toolbox has no impact on any security functional requirement nor does the use
generate additional requirements. The Toolbox library is not part of the TOE Security Functionality (TSF).

All these requirements have to be fulfilled to support OE.Resp-Appl for the SFRs implemented by the:
      SCP:
             o FCS_COP.1/TDES
             o FCS_COP.1/AES
      SCL for version v2.04.002:
             o FCS_COP.1/TDES-SCL-1
             o FCS_COP.1/AES-SCL-1
             o FCS_COP.1/CMAC-SCL-1
      SCL for version v2.02.010:
             o FCS_COP.1/TDES-SCL-2
             o FCS_COP.1/AES-SCL-2
      CCL for version v02.00.0004:
CC Document                                             115                                                    1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


              o   FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel,
              o   FCS_CKM.1/CCL Cryptographic key generation
              o   FCS_CKM.4/CCL Cryptographic key destruction

Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. These issues are addressed by the specific security functional requirements:
     [FDP_ITC.1 Import of user data of the Composite TOE without security attributes or
        FDP_ITC.2 Import of user data of the Composite TOE with security attributes or
        FCS_CKM.1 Cryptographic key generation],
     FCS_CKM.4 Cryptographic key destruction

The security functional requirements required to meet the security objectives O.Leak-Inherent, O.Phys-Probing,
    O.Malfunction, O.Phys-Manipulation and O.Leak-Forced define how to implement the specific security
functionality. However, key-dependent functions could be implemented in the Smartcard Embedded Software.

The usage of cryptographic algorithms requires the use of appropriate keys. Otherwise these cryptographic
functions do not provide security. The keys have to be unique with a very high probability, and must have a
certain cryptographic strength etc. In case of a key import into the TOE (which is usually after TOE delivery) it
has to be ensured that quality and confidentiality are maintained. Keys for DES and AES are provided by the
environment. Keys for RSA and EC algorithms can be provided either by the TOE or the environment.

The justification of the security objective and the additional requirements (both for the TOE and its environment)
show that they do not contradict to the rationale already given in the Protection Profile for the assumptions,
policy and threats defined there.




CC Document                                              116                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.4.1.2       Hardware related Aspects
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and functions
provided by the TOE can be tested after TOE Delivery. This security functional component is used instead of the
functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to know which
security functions or mechanisms can be tested. The functional component FPT_TST.1 does not mandate to
explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of the integrity
of TSF data and stored TSF executable code which might violate the security policy.
The tested security enforcing functions are SF_DPM Device Phase Management, SF_CS Cryptographic Support
and SF_PMA Protection against modifying attacks.

The justification related to the security objective “Protection against Physical Manipulation (O.Phys-
Manipulation)” is as follows:
The security functional requirement FPT_TST.2 will detect attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation. The physical manipulation
will be tried to overcome security enforcing functions.

The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1 and FMT_SMF.1 cover this security objective. The implementation of
these functional requirements is represented by the dedicated privilege level concept.

The justification of the security objective and the additional requirements show that they do not contradict to
the rationale already given in the Protection Profile for the assumptions, policy and threats defined there.
Moreover, these additional security functional requirements cover the requirements by the PP [9] user data of
the Composite TOE protection of chapter 1.2.5 claim 35 and 36 which are not refined by the PP [9].
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions are
used as specified and that the User data of the Composite TOE processed by these functions are protected as
defined for the application context. The TOE only provides the tool to implement the policy defined in the
context of the application.

The justification related to the security objective Protection against Malfunction due to Environmental Stress
(O.Malfunction) is as follows:
The security functional requirement Stored data integrity monitoring and action (FDP_SDI.2) requires the
implementation of an integrity observation and correction which is implemented by the Error Detection (EDC)
and Error Correction (ECC) measures. The EDC is present throughout all memories of the TOE while the ECC is
realized in the SOLID FLASH™ NVM. These measures detect and inform about one and more bit errors. In case
of the SOLID FLASH™ NVM 1 bit errors of the data are corrected automatically. The ECC mechanism protects
the TOE from the use of corrupt data. Therefore FDP_SDI.2 is suitable to meet the security objective
O.Malfunction.

The presence of true random numbers is the security goal 4 (SG4) which is formalized in the objective O.RND
Random Numbers. This objective must be covered by fulfillment of the security functional requirement
FCS_RNG. This is defined in the PP [9] chapter 5.1. The requirement implements a quality metric which is defined
by national regulations. The implemented random number generation fulfils the definitions of AIS 31 [13] in the
quality classes as outlined in chapter 7.1.1.1. Therefore the SFR FCS_RNG and the objective O.RND are covered.




CC Document                                              117                                                       1.8
                                               the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.
This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 33
Certification Report                                                       BSI-DSZ-CC-0879-V4-2020




4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-0879-V3-2018. Specific
results from the evaluation process BSI-DSZ-CC-0879-V3-2018 were re-used.
The evaluation of the product Infineon Security Controller M7893 B11 with optional
RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
Toolbox v2.03.008 and with specific IC dedicated software (firmware), was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 11 February 2020.
TÜV Informationstechnik GmbH is an evaluation facility (ITSEF) 5 recognised by the
certification body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and in the Security Target.
For the meaning of the assurance components and assurance levels please refer to CC
itself. Detailed references are listed in part C of this report.
The Certificate issued confirms the assurance of the product claimed in the Security Target
at the date of certification. As attack methods evolve over time, the resistance of the
certified version of the product against new attack methods needs to be re-assessed.
Therefore, the sponsor should apply for the certified product being monitored within the
assurance continuity program of the BSI Certification Scheme (e.g. by a re-assessment or
re-certification). Specifically, if results of the certification are used in subsequent evaluation
and certification procedures, in a system integration process or if a user's risk
management needs regularly updated results, it is recommended to perform a re-
assessment on a regular e.g. annual basis.
In order to avoid an indefinite usage of the certificate when evolved attack methods would
require a re-assessment of the products resistance to state of the art attack methods, the
maximum validity of the certificate has been limited. The certificate issued on 12 February
2020 is valid until 11 February 2025. Validity can be re-newed by re-certification.
The owner of the certificate is obliged:

5
     Information Technology Security Evaluation Facility



                                                                                             8 / 33
BSI-DSZ-CC-0879-V4-2020                                                        Certification Report




     1. when advertising the certificate or the fact of the product's certification, to refer to
        the Certification Report as well as to provide the Certification Report, the Security
        Target and user guidance documentation mentioned herein to any customer of the
        product for the application and usage of the certified product,
     2. to inform the Certification Body at BSI immediately about vulnerabilities of the
        product that have been identified by the developer or any third party after issuance
        of the certificate,
     3. to inform the Certification Body at BSI immediately in the case that security relevant
        changes in the evaluated life cycle, e.g. related to development and production sites
        or processes, occur, or the confidentiality of documentation and information related
        to the Target of Evaluation (TOE) or resulting from the evaluation and certification
        procedure where the certification of the product has assumed this confidentiality
        being maintained, is not given any longer. In particular, prior to the dissemination of
        confidential documentation and information related to the TOE or resulting from the
        evaluation and certification procedure that do not belong to the                                                              2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.4.1.3       Flash Loader related Aspects
The justification related to the Flash Loader security objectives are as follows. Note that the following objectives
and related rationales apply only at TOE products coming with activated Flash Loader enabled for software or
data download by the user. In other cases the Flash Loader is not available anymore and the user data download
is completed. Depending on the capabilities of the user software these security functional requirements may
then reoccur as subject of the composite TOE.
The Flash Loader related objectives are:

The objective O.Authentication requires the presence of an authentication mechanism proving the identity of a
given security IC to an external entity. This objective is covered by the functional requirement FIA_API
Authentication Proof of Identity. The Flash Loader implements this functionality and outputs identification data
to external requesting entity. The user guidance describes in more detail how this authentication request is
applied and conducted by the external entity. As the functional requirements are met by the Flash Loader the
objective is covered.

The objective O.Cap_Avail_Loader requires limited capabilities of the Loader functionality and irreversible
termination of the Loader. First, this is covered by the functional requirement FMT_LIM.1/Loader which
implements protection against data manipulation and disclosure by unauthorized users after permanent
deactivation of the Flash Loader. Second, the functional requirement FMT_LIM.2/Loader limits the Flash Loader
availability after the download has been finished by the user. The Flash Loader provides a final locking command
which irreversibly terminates the Flash Loader availability. This command execution must be applied after user
has finalized his download. As the functional requirements are met by the Flash Loader the objective is covered.

The objectives O.Ctrl_Auth_Loader and O.Prot_TSF_Confidentiality require that a trusted communication
channel with an authorized user, a confidentiality protection during the download and authentication of the user
data and access control for the usage of the Loader functionality are provided by the Loader.
Without successfully passing the authentication functionality of the Flash Loader no usage of the Flash Loader is
possible. Passing the authentication successfully assigns also a user role to the current user.
The Flash Loader implements mutual authentication functionality and if successfully passing this mutual
authentication, the TOE and the external user are established as trusted entities. Furthermore, the Flash Loader
enforces the exchange of the download key by the user which provides clear separation from the hardware
vendor and preserves confidentiality of the user data download. In addition, the Flash Loader preserves the
integrity of the downloaded data against for example induced errors by hashing functionality.
As the functional requirements are met by the Flash Loader the objective is covered.

Note regarding the Flash Loader:
The algorithm strength of the Flash Loader has not been cryptographic-analytically evaluated by the BSI, as
Infineon has implemented a proprietary extension.
End of note




CC Document                                              118                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.4.1.4       Dependencies of Security Functional Requirements
The dependencies of the security functional requirements are defined and described in PP [9] section 6.3.2, with
FDP_SDI.2, and with regard to the Flash Loader related security functional requirements, the description is given
at the individual package chapters 7.2.3, 7.3.1 and 7.3.2.

      FDP_ITT.1             FDP_IFC.1              FPT_ITT.1             FPT_PHP.3                FPT_FLS.1
     FRU_FLT.2              FMT_LIM.1             FMT_LIM.2              FCS_RNG.1                FAU_SAS.1
     FDP_SDI.2              FDP_SDC.1          FMT_LIM.1/Loader      FMT_LIM.2/Loader         FDP_ACC.1/Loader
 FDP_ACF.1/Loader

The security functional requirements FIA_API.1 and FTP_ITC.1 have no dependencies.
The security functional requirements FIA_API.1, FMT_LIM.1/Loader, FMT_LIM.2/Loader, FTP_ITC.1, FDP_UCT.1,
FDP_UIT.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader apply only at TOE products which are delivered with
activated Flash Loader.

Further dependencies of security functional requirements are given in following table:

                     Table 15      Dependency for cryptographic operation requirement
      Security Functional                                                                Fulfilled by Security
         Requirement                             Dependencies                               Requirements


ACL-1, ACL-2 and ACL-3
FCS_COP.1/RSA-1                   FDP_ITC.1 or FDP_ITC.2 (if not FCS_CKM.1)      Yes, see comment 2
FCS_COP.1/RSA-2                   FCS_CKM.4                                      Yes, see comment 2
FCS_COP.1/RSA-3
FCS_CKM.1/RSA-1                   FCS_CKM.2 or FCS_COP.1                         Yes
FCS_CKM.1/RSA-2                   FCS_CKM.4                                      Yes, see comment 2
FCS_CKM.1/RSA-3
FCS_COP.1/ECDSA-1                 [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]           Yes, see comment 2
FCS_COP.1/ECDSA-2                 FCS_CKM.4                                      Yes, see comment 2
FCS_COP.1/ECDSA-3
FCS_CKM.1/EC-1                    FCS_CKM.2 or FCS_COP.1                         Yes
FCS_CKM.1/EC-2                    FCS_CKM.4                                      Yes, see comment 2
FCS_CKM.1/EC-3
FCS_COP.1/ECDH-1                  [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]           Yes, see comment 2
FCS_COP.1/ECDH-2                  FCS_CKM.4
FCS_COP.1/ECDH-3


SCL-1 and SCL-2
FCS_COP.1/TDES-SCL-1 and          [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]           Yes, see comment 2
FCS_COP.1/TDES-SCL-2              FCS_CKM.4                                      Yes, see comment 2
FCS_CKM.4/TDES-SCL-1 and          [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]          Yes, see comment 2
FCS_CKM.4/TDES-SCL-2
FCS_COP.1/AES-SCL-1 and           [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]           Yes, see comment 2
FCS_COP.1/AES-SCL-2               FCS_CKM.4


CC Document                                            119                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


      Security Functional                                                  Fulfilled by Security
         Requirement                       Dependencies                       Requirements
FCS_CKM.4/TDES-SCL-1 and     [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]   Yes, see comment 2
FCS_CKM.4/TDES-SCL-2
FCS_COP.1/CMAC-SCL-1         [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]    Yes, see comment 2
(by SCL-1 only, v2.04.002)   FCS_CKM.4
FCS_CKM.4/CMAC-SCL-1         [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]   Yes, see comment 2
(by SCL-1 only, v2.04.002)


CCL
FCS_COP.1/CCL                [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]   Yes, see comment 4
                             FCS_CKM.4
FCS_CKM.1/CCL                None                                    Yes, see comment 4
FCS_CKM.4/CCL                FCS_CKM.1                               Yes, see comment 4


Hardware and Firmware
FCS_COP.1/TDES               [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]    Yes, see comment 2
(by SCP)                     FCS_CKM.4                               Yes, see comment 2
FCS_CKM.4/TDES               [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]   Yes, see comment 2
(by SCP)
FCS_COP.1/AES                [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM1]    Yes, see comment 2
(by SCP)                     FCS_CKM.4                               Yes, see comment 2
FCS_CKM.4/AES                [FDP_ITC.1 or FDP_ITC.2 or FCS_CKM.1]   Yes, see comment 2
(by (SCP)
FPT_TST.2                    No dependencies                         Yes
FDP_ACC.1                    FDP_ACF.1                               Yes
                             FMT_MSA.3                               Yes
FDP_ACF.1
                             FDP_ACC.1                               Yes
                             FMT_MSA.1                               Yes
FMT_MSA.3
                             FMT_SMR.1                               Not required, see comment 1
                             FDP_ACC.1 or FDP_IFC.1                  Yes
FMT_MSA.1                    FMT_SMR.1                               Not required, see comment 1
                             FMT_SMF.1                               Yes
FMT_SMF.1                    None                                    N/A
FMT_LIM.1/Loader             FMT_LIM.2/Loader                        Yes
FMT_LIM.2/Loader             FMT_LIM.1/Loader                        Yes
FTP_ITC.1                    None                                    Yes, see comment 3
                             [FTP_ITC.1 or FTP_TRP.1]                Yes
FDP_UCT.1
                             [FDP_ACC.1 or FDP_IFC.1]                Yes
                             [FTP_ITC.1 or FTP_TRP.1]                Yes
FDP_UIT.1
                             [FDP_ACC.1 or FDP_IFC.1]                Yes
FDP_ACC.1/Loader             FDP_ACF.1/Loader                        Yes
CC Document                                     120                                                1.8
                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


       Security Functional                                                            Fulfilled by Security
          Requirement                            Dependencies                            Requirements
                                  FMT_MSA.3                                      Yes, see comment 3
FDP_ACF.1/Loader
                                  FDP_ACC.1/Loader                               Yes, see comment 3

Comment 1:
The dependency FMT_SMR.1 introduced by the two components FMT_MSA.1 and FMT_MSA.3 is considered to
be satisfied because the access control specified for the intended TOE is not role-based but enforced for each
subject. Therefore, there is no need to identify roles in form of a security functional requirement FMT_SMR.1.
End of comment.

Comment 2:
These requirements all address the appropriate management of cryptographic keys used by the specified
cryptographic function and are not part of the PP [9]. Most requirements concerning key management shall be
fulfilled by the environment since the Smartcard Embedded Software is designed for a specific application
context and uses the cryptographic functions provided by the TOE.
For the security functional requirements:
         SCP:
              o FCS_COP.1/TDES and
              o FCS_COP.1/AES
      SCL-1:
              o FCS_COP.1/TDES-SCL-1
              o FCS_COP.1/AES-SCL-1
              o FCS_COP.1/CMAC-SCL-1
      SCL-2:
              o FCS_COP.1/TDES-SCL-2
              o FCS_COP.1/AES-SCL-2
the respective dependencies FCS_CKM.1, FDP_ITC.1 or FDP_ITC.2 have to be fulfilled by the environment,
because the TOE does not provide the accompanying functionality; i.e. generate and import keys.
That means that the environment shall meet the requirements FCS_CKM.1, FDP_ITC.1 or FDP_ITC.2 as defined
in Common Criteria Part 2 [11], section 10.1 and 11.7.
The cryptographic key destruction can be done by overwriting the key register interfaces or by software reset of
the SCP which provides immediate zeroing of all SCP key registers. Please refer also to the application notes 41
and 42 in the PP [9].
These requirements all address the appropriate management of cryptographic keys used by the specified
cryptographic function and are not part of the PP [9]. Most requirements concerning key management shall be
fulfilled by the environment since the Smartcard Embedded Software is designed for a specific application
context and uses the cryptographic functions provided by the TOE.




CC Document                                            121                                                    1.8
                                                                                                       2020-04-22
Publi and data to a privilege
level model. The MMU controls the address permissions of up to seven privileged levels and gives the software
the possibility to define different access rights for the user available privileged levels. The address permissions of
the privilege levels are controlled by the MMU. In case of an access violation the MMU will trigger a reset and
then a trap service routine can react on the access violation. The policy of setting up the MMU and specifying the
memory ranges for the privilege levels – with the exception of the IFX level – is defined from the user software
(OS). The privilege levels 0, 1 and 2 are reserved for TOE internal operations. The privilege levels 3 and 4 are
reserved for operation systems and the privilege levels 5, 6 and 7 are reserved for applications.
Therefore, the TOE provides support for secure separation of memory areas covering the security functional
requirements FPT_PHP.3 “Resistance to physical attack”, FDP_ACC.1 “Subset access control”, FDP_ACF.1
“Security attribute based access control”, FMT_MSA.1 “Management of security attributes”, FMT_MSA.3 “Static
attribute initialization” and FMT_SMF.1 “Specification of Management functions”.

The TOE provides the possibility to protect the property rights of user code and data by the encryption of the
SOLID FLASH™ NVM areas with a specific key defined by the user. Due to this key management FDP_ACF.1 is
fulfilled. In addition, each memory present on the TOE is encrypted using either mask specific or chip individual
or even session keys, assigned by a complex key management. Induced errors are recognized by the Integrity
Guard concept and lead to an alarm with high feasibility. In case of security critical errors a security alarm is
generated and the TOE ends up in a secure state. The covered security functional requirements are FPT_PHP.3
CC Document                                              131                                                       1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


“Resistance to physical attack”, FPT_ITT.1 “Basic internal transfer protection”, FDP_IFC.1 “Subset information
flow control” and FPT_FLS.1 “Failure with preservation of secure state”.

Beside the access protection and key management, also the use of illegal operation code is detected and will
release a security reset. The covered security functional requirements FDP_ITT.1 “Basic internal transfer
protection” and FPT_FLS.1 “Failure with preservation of secure state”.


8.4.1          Listing of SFRs implemented by SF_PLA Protection against Logical
Attacks
Table 19   Security Functional Requirements covered by SF_PLA Protection against Logical Attacks
   1. FDP_ACC.1 Subset access control
   2. FDP_ACF.1 Security attribute based access control
   3. FMT_MSA.1 Management of security attributes
   4. FMT_MSA.3 Static attribute initialisation
   5. FPT_PHP.3 Resistance to physical attack
   6. FPT_ITT.1 Basic internal transfer protection
   7. FDP_IFC.1 Subset information flow control
   8. FPT_FLS.1 Failure with preservation of secure state
   9. FMT_SMF.1 Specification of Management functions


8.5            SF_CS: Cryptographic Support
The TOE is equipped with several hardware accelerators and software modules to support the standard
symmetric and asymmetric cryptographic operations. This security function is introduced to include the
cryptographic operation in the scope of the evaluation as the cryptographic function respectively mathematic
algorithm itself is not used from the TOE security policy. On the other hand these functions are of special interest
for the use of the hardware as platform for the software. The components are a cryptographic co-processor
supporting the DES and AES algorithms and a combination of a co-processor and software library modules to
support RSA cryptography, RSA key generation, ECDSA signature generation and verification, ECDH key
agreement and EC public key calculation and public key testing.
Note that the additional function of the EC library, ECC_ADD providing the primitive elliptic curve operations,
does not add specific security functionality and that the according user guidance abbreviates the Elliptic Curve
cryptographic functions with ECC.

Note 17:
The symmetric cryptographic library SCL in two alternative versions is a delivery option. Therefore the TOE may
come with or without one of the SCLs. In the case of coming without any of the alternative SCLs, the TOE does
not provide the related AES and TDES security functional requirements. The equal case applies if the symmetric
cryptographic coprocessor is blocked. Then neither the SCL versions nor the SCP implement the related AES and
TDES security functional requirements. The SCL requires the presence of the SCP.
End of note.

Note 18:
Not used. Kept for consistency.

Note 19:
The cryptographic libraries RSA, EC and the Toolbox library are delivery options, regardless of the version
chosen. Therefore the TOE may come with free combinations of or even without these libraries. In the case of
coming without one or any combination of the cryptographic libraries RSA and EC, the TOE does not provide the
CC Document                                             132                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


Additional Specific Security Functionality Rivest-Shamir-Adleman Cryptography (RSA) and/or Elliptic Curve
Cryptography (EC). The Toolbox Library is no cryptographic library, provides no additional specific security
functionality and thus the Toolbox library is not part of the TOE Security Functionality (TSF).
End of note.

Note 20:
This TOE can come with both crypto co-processors accessible, or with a blocked SCP or with a blocked
Crypto2304T, or with both crypto co-processors blocked. The blocking depends on the customer demands prior
to the production of the hardware. In case the SCP is blocked, no AES and DES computation supported by
hardware is possible. In case the Crypto2304T is blocked, no RSA and EC computation supported by hardware is
possible. No accessibility of the deselected cryptographic co-processors is without impact on any other security
policy of the TOE; it is exactly equivalent to the situation where the user decides just not to use the cryptographic
co-processors.
End of note.

Note 21:
The presence of the alternative cryptographic library CIPURSE™ CL is a delivery option.
Therefore the TOE may come with free combinations with the other libraries of or without these libraries.
In the case of coming without the CIPURSE™ CL the TOE does not provide the specific security functionality
implemented by this software.
End of note.


8.5.1     Implementation of AES and TDES by the Symmetric Cryptographic
Coprocessor SCP

 8.5.1.1       Triple DES
The TOE supports the encryption and decryption in accordance with the specified cryptographic algorithm Triple
Data Encryption Standard (TDES) with cryptographic key sizes of 112 and 168 bits meeting the standard:

                       National Institute of Standards and Technology (NIST), SP 800-67 [20]
                                                 ISO/IEC 18033-3 [30]

The TOE implements the following alternative block cipher modes for the user:
    the Electronic Codebook Mode (ECB),
    the Cipher Block Chaining Mode (CBC),
    the Blinding Feedback Mode (BLD),
    the Cipher Block Chaining Mode Message Authentication Code (CBC-MAC),
    the CBC-MAC- encrypt-last-block (CBC-MAC-ELB) and
    the Recrypt Mode.

The CBC-MAC and CBC-MAC-ELB complies with the standard:
                               ISO/IEC 9797-1 Mac Algorithm 1 [32]

The Recrypt Mode and the BLD are described in the hardware reference manual HRM [1], while the
implementation of ECB, CBC and CFB follow the standard:
                    National Institute of Standards and Technology (NIST), SP 800-38A [21]

Note that the BLD follows also the standard, but in a masked way.


CC Document                                              133                                                      1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


The key destruction as required by FCS_CKM.4 can be done by overwriting the key register interfaces or by
software reset of the SCP which provides immediate zeroing of all SCP key registers.
Please consider also the statement of chapter 7.1.4.1.
The covered security functional requirements are FCS_COP.1/TDES and FCS_CKM.4/TDES.

 8.5.1.2      AES
The TOE supports the encryption and decryption in accordance with the specified cryptographic algorithm
Advanced Encryption Standard (AES) and cryptographic key sizes of 128 bit or 192 bit or 256 bit that meet the
standard:
                                            ISO/IEC 18033-3 [30]
                                                FIPS 197 [31]

The TOE implements the following alternative block cipher modes for the user:
    The Electronic Codebook Mode (ECB),
    the Cipher Block Chaining Mode (CBC),
    the Blinding Feedback Mode (BLD),
    the Cipher Block Chaining Mode Message Authentication Code (CBC-MAC),
    the CBC-MAC- encrypt-last-block (CBC-MAC-ELB) and
    the Recrypt Mode.

The CBC-MAC and CBC-MAC-ELB complies deliverables
        according to the Certification Report part B, or for those where no dissemination
        rules have been agreed on, to third parties, the Certification Body at BSI has to be
        informed.
In case of changes to the certified version of the product, the validity can be extended to
the new versions and releases, provided the sponsor applies for assurance continuity (i.e.
re-certification or maintenance) of the modified product, in accordance with the procedural
requirements, and the evaluation does not reveal any security deficiencies.

6.      Publication
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has been included in the BSI list of
certified products, which is published regularly (see also Internet: https://www.bsi.bund.de
and [5]). Further information can be obtained from BSI-Infoline +49 228 9582-111.
Further copies of this Certification Report can be requested from the developer 6 of the
product. The Certification Report may also be obtained in electronic form at the internet
address stated above.




6
     Infineon Technologies AG
     Am Campeon 1-12
     85579 Neubiberg



                                                                                              9 / 33
Certification Report                                                    BSI-DSZ-CC-0879-V4-2020




B.      Certification Results
The following results represent a summary of
●   the Security Target of the sponsor for the Target of Evaluation,
●   the relevant evaluation results from the evaluation facility, and
●   complementary notes and stipulations of the certification body.




                                                                                         10 / 33
BSI-DSZ-CC-0879-V4-2020                                                           Certification Report




1.     Executive Summary
The Target of Evaluation (TOE) is an Infineon Security Controller M7893 B11 with optional
Software Library RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010
libraries, and Toolbox v2.03.008, as well as with specific IC dedicated software (firmware).
The TOE provides a real 16-bit CPU-architecture and is compatible to the 80251
microcontroller architecture. The major components of the core system are the two CPUs
(Central Processing Units), acting as one, the MMU (Memory Management Unit) and MED
(Memory Encryption/Decryption Unit). The dual interface controller is able to communicate
using either the contact based or the contactless interface.
The TOE consists of the hardware part, the firmware parts and the software parts.
The software parts are differentiated into the cryptographic libraries RSA, EC, and SHA-2,
symmetric cryptographic libraries and the supporting libraries Toolbox and Base. The Base
Library does not provide any specific security functionality on its own. However it is a
necessary perquisite in order to use the RSA, EC and Toolbox libraries.
This TOE is intended to be used in smart cards and other form factors for particularly
security-relevant applications and for its prevalent use as developing platform for smart
card operating systems. The term Smartcard Embedded Software is used in the following
for all operating systems and applications stored and executed on the TOE. The TOE is
the platform for the Smartcard Embedded Software.
The Security Target [6] is the basis for this certification. It is based on the certified
Protection Profile Security IC Platform Protection Profile, Version 1.0, 15 June 2007, BSI-
CC-PP-0035-2007 [8]. The TOE Security Functional Requirements are implemented by
the following TOE Security Functionality:
  TOE Security Functionality         Addressed issue
  SF_DPM                             Device Phase Management:
                                     The life cycle of the TOE is split up into several
                                     phases. Different operation modes help to protect
                                     the TOE during each phase of its lifecycle.
  SF_PS                              Protection against Snooping:
                                     The TOE uses various means to protect from
                                     snooping of memories and busses and prevents
                                     single stepping.
  SF_PMA                             Protection against Modifying Attacks:
                                     This TOE implements protection against
                                     modifying attacks of memories, alarm lines and
                                     sensors.
  SF_PLA                             Protection against Logical Attacks:
                                     The memory access control of the TOE uses a
                                     memory management unit (MMU) to control the
                                     access to the available physical memory by using
                                     virtual memory addresses and to segregate the
                                     code and data to a privilege level model. The
                                     MMU controls the address permissions of up
                                     seven privileged levels and gives the software the
                                     possibility to define different access rights. The
                                     address permissions of the privilege levels are




                                                                                                11 / 33
Certification Report                                                         BSI-DSZ-CC-0879-V4-2020




  TOE Security Functionality           Addressed issue
                                       controlled by the MMU. In case of an access
                                       violation the MMU will trigger a reset and then a
                                       trap service routine can react on the access
                                       violation.
  SF_CS                                Cryptographic Support:
                                       The TOE is equipped with several hardware
                                       accelerators and software modules to support the
                                       standard      symmetric     and       asymmetric
                                       cryptographic operations. The components are a
                                       coprocessor supporting the DES and AES
                                       algorithms and a combination of a coprocessor
                                       and software modules to support RSA
                                       cryptography, RSA key generation, ECDSA
                                       signature generation and verification, ECDH key
                                       agreement and EC public key calculation and
                                       public key testing. Furthermore, the TOE is
                                       equipped with an optional SHA-2 library and
                                       HASH module as well as well as an AIS31
                                       conformant TRNG that meets the functionality
                                       class PTG.2. In addition the optional Symmetric
                                       library (SCL) provides a high-level interface to
                                       3DES and AES symmetric cryptographic
                                       operation implemented on the symmetric
                                       hardware coprocessor.

                               Table 1: TOE Security Functionalities
For more details please refer to the Security Target [6] and [9], chapter 8.
The assets to be protected by the TOE are defined in the Security Target [6] and [9],
chapter 4.1.2. Based on these assets the TOE Security Problem is defined in terms of
Assumptions, Threats and Organisational Security Policies. This is outlined in the Security
Target [6] and [9], chapter 4.
This certification covers the configurations of the TOE as outlined in chapter 8.
The vulnerability assessment results as stated within this certificate do not include a rating
for those cryptographic algorithms and their implementation suitable for encryption and
decryption (see BSIG Section 9, Para. 4, Clause 2).
The certification results only apply to the version of the product indicated in the certificate
and on the condition that all the stipulations are kept as detailed in this Certification
Report. This certificate is not an endorsement of the IT product by the Federal Office for
Information Security (BSI) or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT product by BSI or any other organisation that
recognises or gives effect to this certificate, is either expressed or implied.

2.      Identification of the TOE
The Target of Evaluation (TOE) is called:
 Infineon Security Controller M7893 B11 with optional RSA2048/4096 v2.03.008, EC
   v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008 and with
                     specific IC dedicated software (firmware),
The following table outlines the TOE deliverables:



                                                                                              12 / 33
BSI-DSZ-CC-0879-V4-2020                                                                 Certification Report




           No Type        Identifier                    Release           Form of Delivery
           1    HW        M7893 Smart Card IC           B11 (produced in Complete modules, with or
                                                        Dresden)         without inlay mounting, with or
                                                                         without inlay antenna mounting,
                                                                         in form of plain wafers, in an IC
                                                                         case or in bare dies
           2    SW        RSA library (optional)        RSA2048           Object code in electronic form
                                                        v2.03.008
                                                        RSA4096
                                                        v2.03.008
           3    SW        EC library (optional)         EC v2.03.008      Object code in electronic form
           4    SW        SHA-2 library (optional)      SHA-2 v1.01       Object code in electronic form
           5    SW        Toolbox library (optional)    Toolbox           Object code in electronic form
                                                        v2.03.008
           6    SW        SCL library (optional)        v2.02.010         Object code in electronic form
           7    FW        STS Self Test Software (the   FW-identifier     Stored in test ROM on the IC
                          IC Dedicated Test Software)   78.019.03.4       (patch in SOLID FLASH)
           8    FW        RMS Resource              FW-identifier         Stored in reserved area of user
                          Management System (the IC 78.019.03.4           ROM on the IC (patch in SOLID
                          Dedicated Support                               FLASH)
                          Software)
           9    FW        Service Algorithm (SA)        FW-identifier     Stored in reserved area of user
                                                        78.019.03.4       ROM on the IC (patch in SOLID
                                                                          FLASH)
           10   FW        Flash Loader                  FW-identifier     Stored in reserved area of user
                                                        78.019.03.4       ROM and parts of it in SOLID
                                                                          FLASH on the IC (patch in
                                                                          SOLID FLASH)
           11   SW        ROM code (including           --                Stored in User ROM on the IC.
                          Embedded Software and
                                                                          Only in case the IC Embedded
                          crypto libraries)
                                                                          Software Developer provides
                                                                          Infineon with code for ROM.
           12   SW        NVM image (including          --                Stored in Flash memory on the
                          Embedded Software and                           IC.
                          crypto libraries)
                                                                          Only in case the IC Embedded
                                                                          Software Developer provides
                                                                          Infineon with code for Flash
                                                                          memory.
           13   DOC       SLx 70 Family Production      2015-04-01        Personalized pdf-file
                          and Personalization User’
                          Manual
           14   DOC       M7893 Hardware Reference 19-06-24               Personalized pdf-file
                          Manual 3.0
           15   DOC       M7893 Errata Sheet 4.2        2019-08-07        Personalized pdf-file
           16   DOC       M7893 Security Guidelines     2019-09-25        Personalized pdf-file
           17   DOC       16-bit Security Controller    2019-02-19        Personalized pdf-file
                          Family SLE 70
                          Programmer’s Reference
                          Manual 9.10




                                                                                                     13 / 33
Certification Report                                                            BSI-DSZ-CC-0879-V4-2020




             No Type    Identifier                    Release           Form of Delivery
             18   DOC   SLE70 Asymmetric Crypto       2019-07-15        Personalized pdf-file (optional)
                        Library for Crypto@2304T
                        RSA / ECC / Toolbox User
                        Interface (2.03.008)
             19   DOC   SCL78 Symmetric Crypto        2016-12-09        Personalized pdf-file (optional)
                        Library for SCP v3,
                        DES/AES, 16-bit Security
                        Controller, User Interface
                        (2.02.010)
             20   DOC   Crypto@2304T User Manual 2010-03-23             Personalized pdf-file
             21   DOC   SLx70 Family Secure Hash      2009-11-06        Personalized pdf-file (optional)
                        Algorithm SHA-2 (SHA
                        256/224, SHA 512/384)
                        Library Version V1.01
             22   DOC   AMM Advanced Mode NRG         2019-10-22        Personalized pdf-file (optional)
                        SAM Addendum 2.0

                                     Table 2: Deliverables of the TOE

The delivery documentation describes all procedures that are necessary to maintain
security when distributing versions of the TOE or parts of it to the user’s site including the
necessary intermediate delivery procedures.
Furthermore, the delivery documentation describes in a sufficient manner how the various
procedures and technical measures provide for the detection of modifications and any
discrepancies between the TOE respective parts of it send by the TOE Manufacturer and
the version received by the Composite Product Manufacturer.
Three different delivery procedures have to be taken into consideration:
    ●   Delivery of the IC dedicated software components (IC dedicated SW, guidance)
        from the TOE Manufacturer to the IC Embedded Software Developer.
    ●   Delivery of the IC Embedded Software (ROM / Flash data, initialisation and pre-
        personalisation data) from the IC Embedded Software Developer to the TOE
        Manufacturer.
    ●   Delivery of the final TOE from the TOE Manufacturer to the Composite Product
        Manufacturer. After phase 3 the TOE is delivered in form of wafers or sawn wafers,
        after phase 4 in form of modules (with or without inlay antenna).
Respective distribution centers are listed in Appendix B (see below).
The individual TOE hardware is uniquely identified by its identification data. The
identification data contains the lot number, the wafer number and the coordinates of the
chip on the wafer. Each individual TOE can therefore be traced unambiguously and thus
assigned to the entire development and production process.
The hardware part of the TOE is identified by M7893 B11. Another characteristic of the
TOE are the chip identification data. These chip identification data is accessible via the
Generic Chip Identification Mode (GCIM) see [16] chapter 7.10.3.
The firmware part of the TOE is also identified also via the GCIM for all of the firmware
parts.




                                                                                                    14 / 33
BSI-DSZ-CC-0879-V4-2020                                                       Certification Report




The SCL (optional), RSA (optional), EC (optional), SHA-2 (optional), Toolbox (optional),
and Base library (optional), as separate software parts of the TOE, are also identified by
their unique version numbers. The user can identify these versions by calculating the hash
signatures of the provided library files. The mapping of these hash signatures to the
version numbers is provided in the Security Target [6] and [9] section 10.
For further, detailed information regarding TOE identification see [9], section 1.2.
Please also note, that as the TOE is under control of the user software, the TOE
Manufacturer can only guarantee the integrity up to the delivery procedure. It is in the
responsibility of the Composite Product Manufacturer to include mechanisms in the
implemented software (developed by the IC Embedded Software Developer) which allows
detection of modifications after the delivery.

3.       Security Policy
The Security Policy is expressed by the set of Security Functional Requirements and
implemented by the TOE. It covers the following issues:
Symmetric cryptographic block cipher algorithms (Triple-DES and AES), to ensure the
confidentiality of plain text data by encryption and to support secure authentication
protocols and it will provide a random number generation of appropriate quality.
The RSA library is used to provide a high level interface to RSA (Rivest, Shamir, Adleman)
cryptography implemented on the hardware component Crypto2304T and includes
countermeasures against SPA, DPA and DFA attacks. The EC library is used to provide a
high level interface to Elliptic Curve cryptography implemented on the hardware
component Crypto2304T and includes countermeasures against SPA, DPA and DFA
attacks. The SHA-library provides the calculation of a hash value of freely chosen data
input in the CPU.
As the TOE is a hardware security platform, the security policy of the TOE is also to
provide protection against leakage of information (e.g. to ensure the confidentiality of
cryptographic keys during AES, Triple-DES, RSA and EC cryptographic functions
performed by the TOE), against physical probing, against malfunctions, against physical
manipulations and against abuse of functionality.
Hence the TOE shall
     ●   maintain the integrity and the confidentiality of data stored in the memory of the
         TOE and
     ●   maintain the integrity, the correct operation and the confidentiality of security
         functionalities (security mechanisms and associated functions) provided by the
         TOE.

4.       Assumptions and Clarification of Scope
The Assumptions defined in the Security Target and some aspects of Threats and
Organisational Security Policies are not covered by the TOE itself. These aspects lead to
specific security objectives to be fulfilled by the TOE-Environment. The following topics are
of relevance: OE.Plat-Appl (Usage of Hardware Platform), OE.Resp-Appl (Treatment of
User Data) and OE.Process-Sec-IC (Protection during Composite product manufacturing).
Details can be found in the Security Target [6] and [9], chapter 5.2.




                                                                                           15 / 33
Certification Report                                                        BSI-DSZ-CC-0879-V4-2020




5.       Architectural Information
The TOE is an integrated circuit (IC) providing a platform for an operating sytem and
application software used in smartcards but also in any other device or form factor
requiring a high level of resistance against attackers. A top level block diagram and a list of
subsystems can be found within the TOE description of the Security Target [6], chapter
2.1.
The TOE consists of a core system, memories, computing peripherals, system peripherals,
standard peripherals, an analogue module and the connecting busses. The major
components of the core system are the double CPU (Central Processing Units) including
the internal encryption leaving no plain data, the MMU (Memory Management Unit) and
MED (Memory Encryption/Decryption Unit). The Block diagram provides a simplified
overview upon the hardware subsystems in the Security Target [6] and [9], figure 1.
The symmetric co-processor (SCP) combines both AES and Triple-DES with dual-key or
triple-key hardware acceleration. The Asymmetric Crypto Co-processor is called
Crypto2304T and provides hardware support for asymmetric algorithms like RSA and EC.
The software part of the TOE consists of the cryptographic RSA-, EC-, SCL- and the SHA-
2 libraries and the supporting Toolbox and Base libraries. If RSA or EC or Toolbox or
combinations hereof are part of the shipment, automatically the Base Library of the same
version is included.

6.       Documentation
The evaluated documentation as outlined in table 2 is being provided with the product to
the customer. This documentation contains the required information for secure usage of
the TOE in accordance with the Security Target.
Additional obligations and notes for secure usage of the TOE as outlined in chapter 10 of
this report have to be followed.

7.       IT Product Testing
The developer performed five categories of tests:
     ●   Simulation Tests (design verification): The simulation tests are carried out in the
         course of the development of the TOE during the IC design phase. They verify that
         the designed circuits satisfy the specifications.
     ●   Qualification Tests: For each mask version a qualification test is performed. Via the
         results of these tests a qualification report is generated. The positive result of the
         qualification is one part of the necessary testing results documented with the
         qualification report. The qualification report is completed after the verification testing
         (see below) and the security evaluation (see below) are performed successfully.
         The tests performed and their results are listed in the qualification report. The
         results of the tests are the basis on which it is decided, whether the TOE is released
         to production.
     ●   Verification Tests: With these tests in user mode the functionality of the end user
         environment is checked.
     ●   Security Evaluation Tests: In the context of security evaluation testing the security
         mechanisms is tested again in the user mode only focusing on security. Here is not



                                                                                             16 / 33
BSI-DSZ-CC-0879-V4-2020                                                       Certification Report




         only verified that the security functionality is working as this was already tested on
         every single TOE during production, but also it is tested how well the security
         functionality is working and the effectiveness is calculated. This step is necessary
         as the mechanisms work together and that must be evaluated in the user mode.
     ●   Production Tests: Before delivery on every chip production tests are performed.
         These tests use the CRC checksums attained by the simulation tests. The aim of
         these tests is to check whether each chip is functioning correctly.
The developer tests cover all security functionalities and all security mechanisms as
identified in the functional specification.
The evaluators were able to repeat the tests of the developer either using the library of
programs, tools and prepared chip samples delivered to the evaluator or at the developers
site. They performed independent tests to supplement, augment and to verify the tests
performed by the developer. The tests of the developer were repeated by sampling, by
repetition of complete regression tests and by software routines developed by the
evaluators and computed on samples with an evaluation operating system. For the
developer tests repeated by the evaluators other test parameters were used and the test
equipment was varied. Security features of the TOE realised by specific design and layout
measures were checked by the evaluators during layout inspections both in design data
and on the final product.
The evaluation has shown that the actual version of the TOE provides the security
functionalities as specified by the developer. The test results confirm the correct
implementation of the TOE security functionalities.
For penetration testing the evaluators took all security functionalities into consideration.
Intensive penetration testing was planned based on the analysis results and performed for
the underlying mechanisms of security functionalities using bespoke equipment and expert
know how. The penetration tests considered both the physical tampering of the TOE and
attacks which do not modify the TOE physically. The penetration tests results confirm that
the TOE is resistant to attackers with high attack potential in the intended environment for
the TOE.

8.       Evaluated Configuration
This certification covers the following configurations of the TOE:
     ●   Smartcard IC M7893 B11.
Depending on the blocking configuration, a M7893 product can have a different user
available configuration as described in Security Target Lite [6], chapter 1.1. The M7893
B11 allows for a maximum of configuration possibilities defined by the customer order
following the market needs. For example, a M7893 B11 product can come in one project
with the fully available ROM and SOLID FLASH™ Non Volatile Memory (NVM) or in
another project without any user available ROM and with any other SOLID FLASH™ NVM-
size below the physical implementation size, or with a different RAM size. Even more, the
user has the free choice, whether he needs the symmetric co-processor SCP, or the
asymmetric co-processor Crypto2304T, or both, or none of them. In addition, the user
decides, whether the TOE comes with a combination of software libraries or without any.
And, to be even more flexible, various interface options can be chosen as well.




                                                                                           17 / 33
Certification Report                                                      BSI-DSZ-CC-0879-V4-2020




9.        Results of the Evaluation
9.1.       CC specific results
The Evaluation Technical Report (ETR) [7] was provided by the ITSEF according to the
Common Criteria [1], the Methodology [2], the requirements of the Scheme [3] and all
interpretations and guidelines of the Scheme (AIS) [4] as relevant for the TOE.
The Evaluation Methodology CEM [2] was used for those components up to EAL 5
extended by advice of the Certification Body for components beyond EAL 5 and guidance
specific for the technology of the product [4] (AIS 34).
The following guidance specific for the technology was used:
(i)        The Application of CC to Integrated Circuits,
(ii)       The Application of Attack Potential to Smartcards,
(iii)      Functionality classes and evaluation methodology of physical random number
           generators,
(see [4] e.g., AIS 25, AIS 26 and AIS 31).
For RNG assessment the scheme interpretations AIS xx was used (see [4]).
To support composite evaluations according to AIS 36 the document ETR for composite
evaluation [10] was provided and approved. This document provides details of this
platform evaluation that have to be considered in the course of a composite evaluation on
top.
The assurance r keys that
                             are imported and/or derived from other keys. This implies that appropriate key
                             management has to be implemented in the environment. In addition, the treatment of
                             User Data comprises the implementation of a multi-application operating system that
                             does not disclose security relevant User Data of one application to another one. These
                             measures make sure that the assumption A.Key-Function is still covered by the
                             security objective OE.Resp-Appl although additional functions are being supported
                             according to P.Add-Components.
                       The justification related to the assumption "Check of initialisation data by the Security IC
                       Embedded Software (A.Check-Init)" is as follows:
                       Since OE.Check-Init requires the Security IC Embedded Software developer to implement
                       a function assumed in A.Check-Init, the assumption is covered by the objective.
                       The justification of the additional policy and the additional assumptions show that they do
                       not contradict to the rationale already given in the PP [6] for the assumptions, policy and
                       threats defined there.




                                         All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                             Rev. 4.4 — 29 October 2018                                                                35 of 87
PUBLIC
NXP Semiconductors                                           P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                   Security Target Lite




5. Extended Components Definition
                       This Security Target does not define extended components.
                       Note that the PP “Security IC Protection Profile” [6] defines extended security functional
                       requirements in chapter 5, which are included in this Security Target.
                       The extended component definition used for Random Number Generator has been taken
                       from [8].




                                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                          Rev. 4.4 — 29 October 2018                                                                36 of 87
PUBLIC
NXP Semiconductors                                            P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                    Security Target Lite




6. Security Requirements
                       This part of the Security Target defines the detailed security requirements that shall be
                       satisfied by the TOE. The statement of TOE security requirements shall define the
                       functional and assurance security requirements that the TOE needs to satisfy in order to
                       meet the security objectives for the TOE. This chapter consists of the sections “Security
                       Functional Requirements”, “Security Assurance Requirements” and “Security
                       Requirements Rationale”.
                       The CC allows several operations to be performed on security requirements (on the
                       component level); refinement, selection, assignment, and iteration are defined in
                       paragraph 8.1 of Part 1 of the CC [1]. These operations are used in the PP [6] and in this
                       Security Target, respectively.
                       The refinement operation is used to add details to requirements, and, thus, further
                       restricts a requirement. Refinements of security requirements are denoted in such a way
                       that added words are in bold text and changed words are crossed out.
                       The selection operation is used to select one or more options provided by the PP [6] or
                       CC in stating a requirement. Selections having been made are denoted as italic text.
                       The assignment operation is used to assign a specific value to an unspecified
                       parameter, such as the length of a password. Assignments having been made are
                       denoted by showing as italic text.
                       The iteration operation is used when a component is repeated with varying operations. It
                       is denoted by showing brackets “[iteration indicator]” and the iteration indicator within the
                       brackets.
                       For the sake of a better readability, the iteration operation may also be applied to some
                       single components (being not repeated) in order to indicate belonging of such SFRs to
                       same functional cluster. In such a case, the iteration operation is applied to only one
                       single component.
                       Whenever an element in the PP [6] contains an operation that the PP author left
                       uncompleted, the ST author has to complete that operation.

                 6.1 Security Functional Requirements
                       The Security Functional Requirements (SFRs) of the TOE are presented in the following
                       sections to support a better understanding of the combination of PP “Security IC
                       Protection Profile” [6] and Security Target.
                  6.1.1 SFRs of the Protection Profile
                       Table 21 below shows all SFRs, which are specified in the PP [6] (in the order of definition
                       in the PP). Some of the SFRs are CC Part 2 extended and defined in the PP [6]. This is
                       shown in the third column of the table.

                       Table 21.   SFRs taken from the PP [6]
                        SFR                    Title                                                                         Defined in
                           FRU_FLT.2                   Limited fault tolerance                                               CC, Part 2
                           FPT_FLS.1                   Failure with preservation of secure state                             CC, Part 2




                                       All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                           Rev. 4.4 — 29 October 2018                                                                37 of 87
PUBLIC
NXP Semiconductors                                               P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                       Security Target Lite



                           SFR                            Title                                                                 Defined in
                           FMT_LIM.1                      Limited capabilities                                                  PP, Section 5.2
                           FMT_LIM.2                      Limited availability                                                  PP, Section 5.2
                           FAU_SAS.1                      Audit storage                                                         PP, Section 5.3
                           FPT_PHP.3                      Resistance to physical attack                                         CC, Part 2
                           FDP_ITT.1                      Basic internal transfer protection                                    CC, Part 2
                           FPT_ITT.1                      Basic internal TSF data transfer protection                           CC, Part 2
                           FDP_IFC.1                      Subset information flow control                                       CC, Part 2
                           FCS_RNG.1                      Random number generation                                              PP, Section 5.1

                       The operations for all SFR except for the SFR FAU_SAS.1 and FCS_RNG.1 are already
                       performed in the PP [6]. They are not changed compared to the Protection Profile. The
                       open assignments and selections for FAU_SAS.1 and FCS_RNG.1 are included in the
                       following.
                       For the SFR FAU_SAS.1 the PP [6] leaves the assignment operation open for the
                       non-volatile memory type in which initialisation data, pre-personalisation data and/or other
                       supplements for the Security IC Embedded Software are stored. This assignment
                       operation is filled in by the following statement. Note that the assignment operations for
                       the list of subjects and the list of audit information have already been filled in by the PP [6].
                       FAU_SAS.1[HW]                             Audit storage
                       Hierarchical to:                          No other components.
                       Dependencies:                             No dependencies.
                       FAU_SAS.1.1[HW]                           The TSF shall provide the test process before TOE Delivery 9
                                                                 with the capability to store the Initialisation Data and/or Pre-
                                                                 personalisation Data or other data 10 in the EEPROM 11.
                       For FCS_RNG.1.1 the PP [6] partially fills in the assignment for the security capabilities of
                       the RNG by requiring a total failure test of the random source and adds an assignment
                       operation for additional security capabilities of the RNG.
                       In addition, for FCS_RNG.1.2 the PP [6] partially fills in the assignment operation for the
                       defined quality metric for the random numbers by replacing it by a selection and
                       assignment operation.
                       For the above operations the original operations defined in chapter 5 of the PP [6] have
                       been replaced by operations defined in chapter 3 of [8] and the open operations of the
                       partially filled in operations in the statement of the security requirements in section 4.4 of
                       [8] for better readability. Note that the selection operation for the RNG type has already
                       been filled in by the PP [6].
                       FCS_RNG.1[HW]                             Random number generation (Class PTG.2)
                       Hierarchical to:                          No other components.
                       Note:                                     The definition of the Security Functional Requirement
                                                                 FCS_RNG.1 hasgister, as well as Security Functional
                       Requirement, the specific meaning is given in the context
SO                     Security Objective
SOLID FLASH™           An Infineon Trade Mark and Stands for Flash EEPROM Technology
SPA                    Simple Power Analysis
ST                     Security Target
STS                    Self Test Software
SW                     Software


                                                                                       22 / 33
BSI-DSZ-CC-0879-V4-2020                                                      Certification Report




TOE                       Target of Evaluation
TM                        Test Mode (STS)
TRNG                      True Random Number Generator
TSC                       TOE Security Functions Control
TSF                       TOE Security Functionality
UART                      Universal Asynchronous Receiver/Transmitter
UM                        User Mode (STS)
UmSLC                     User Mode Security Life Control
WDT                       Watch Dog Timer
3DES                      Triple DES Encryption Standards


13.2. Glossary
Augmentation - The addition of one or more requirement(s) to a package.
Collaborative Protection Profile - A Protection Profile collaboratively developed by an
International Technical Community endorsed by the Management Committee.
Extension - The addition to an ST or PP of functional requirements not contained in CC
part 2 and/or assurance requirements not contained in CC part 3.
Formal - Expressed in a restricted syntax language with defined semantics based on well-
established mathematical concepts.
Informal - Expressed in natural language.
Object - A passive entity in the TOE, that contains or receives information, and upon which
subjects perform operations.
Package - named set of either security functional or security assurance requirements
Protection Profile - A formal document defined in CC, expressing an implementation
independent set of security requirements for a category of IT Products that meet specific
consumer needs.
Security Target - An implementation-dependent statement of security needs for a specific
identified TOE.
Semiformal - Expressed in a restricted syntax language with defined semantics.
Subject - An active entity in the TOE that performs operations on objects.
Target of Evaluation - An IT Product and its associated administrator and uswith the standard:
                       ISO/IEC 9797-1 Mac Algorithm 1 and 2 respectively [32]

The Recrypt Mode and the BLD are described in the hardware reference manual HRM [1], while the
implementation of ECB and CBC follow the standard:
                    National Institute of Standards and Technology (NIST) SP 800-38A [21]

The key destruction as required by FCS_CKM.4 can be done by overwriting the key register interfaces or by
software reset of the SCP which provides immediate zeroing of all SCP key registers.
Please consider also the statement of chapter 7.1.4.1.
The covered security functional requirement is FCS_COP.1/AES and FCS_CKM.4/AES.




CC Document                                           134                                                    1.8
                                                                                                      2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


8.5.2     Implementation of TDES, AES and CMAC by the Symmetric
Cryptographic Library SCL

 8.5.2.1      Triple DES for both versions
The SCL of the TOE supports the encryption and decryption in accordance with the specified cryptographic
algorithm Triple Data Encryption Standard (TDES) with cryptographic key sizes of 168 bits meeting the standard:
                      National Institute of Standards and Technology (NIST), SP 800-67 [20]

The TOE implements the following alternative block cipher modes for the user:
    The Electronic Codebook Mode (ECB),
    the Cipher Block Chaining Mode (CBC),
    the Counter Mode (CTR),
    the Cipher Block –Feedback Mode (CFB) and the
    Propagating Cipher Block Chaining (PCBC) mode.

ECB, CBC, CTR and CFB modes refer to the standard:
                    National Institute of Standards and Technology (NIST) SP 800-38A [21]

The PCBC mode refers to the standard:
            Bruce Schneier, Applied Cryptography, Second Edition, John Wiley & Sons,1996 [36].
                This standard should be implemented considering the Security Guidelines only.

The covered security functional requirement is FCS_COP.1/TDES-SCL-1, FCS_COP.1/TDES-SCL-2,
FCS_CKM.4/TDES-SCL-1 and FCS_CKM.4/TDES-SCL-2.


 8.5.2.2      AES for both versions
The SCL of the TOE supports the encryption and decryption in accordance with the specified cryptographic
algorithm Advanced Encryption Standard (AES) and cryptographic key sizes of 128 bit or 192 bit or 256 bit that
meet the standard:
                    National Institute of Standards and Technology (NIST) SP 800-38A [21]

The TOE implements the following alternative block cipher modes for the user:
    The Electronic Codebook Mode (ECB),
    the Cipher Block Chaining Mode (CBC),
    the Counter Mode (CTR),
    the Cipher Feedback Mode (CFB) and
    the Propagating Cipher Block Chaining (PCBC) mode.

The AES advanced encryption standard refers to:
             National Institute of Standards and Technology (NIST)
             FIPS PUB 197 [31]

ECB, CBC, CTR and CFB modes refer to the standard
              National Institute of Standards and Technology (NIST) SP 800-38A [21]

The PCBC mode refers to the standard:
            Bruce Schneier, Applied Cryptography, Second Edition, John Wiley & Sons,1996 [36].
CC Document                                           135                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


              This standard should be implemented considering the Security Guidelines only.

The covered security functional requirement is FCS_COP.1/AES-SCL-1, FCS_COP.1/AES-SCL-2,
FCS_CKM.4/AES-SCL-1 and FCS_CKM.4/AES-SCL-2.



 8.5.2.3      CMAC only for version v2.04.002
The SCL of the TOE supports the computation of cipher based message authentication codes CMAC hat meet
the standard:
                 CMAC: National Institute of Standards and Technology (NIST) SP 800-38B [38]

The CMAC algorithm uses for the computation either the AES or TDES algorithms according to following
standards:
     AES
           o Federal Information Standards Publication 197 [31]
     TDES
           o National Institute of Standards and Technology 800-67 Rev.1 [20]

The covered security functional requirement is FCS_COP.1/CMAC-SCL-1 and FCS_CKM.4/CMAC-SCL-1.




CC Document                                          136                                                 1.8
                                                                                                  2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


8.5.3             RSA Cryptographic Library for all versions
Encryption, Decryption, Signature Generation and Verification
The TSF shall perform encryption and decryption in accordance with a specified cryptographic algorithm Rivest-
Shamir-Adleman (RSA) and cryptographic key sizes 512 – 4096 bits that meet the following standards:

         Encryption:
         1. According to section 5.1.1 RSAEP in PKCS [22]:
                   Supported for n < 24096 + 128
              5.1.1(1) not supported
         2. According to section 8.2.2 IFEP-RSA in IEEE [29]:
         Supported for n < 24096 + 128
         Decryption (with or without CRT):
         1. According to section 5.1.2 RSADP in PKCS [22] for u = 2, i.e., without any (ri, di, ti), i > 2
                   5.1.2(1) not supported
                   5.1.2(2.a) supported for n < 22048 + 64
                   5.1.2(2.b) supported for p  q < 24096 + 128
              5.1.2(2.b) (ii)&(v) not applicable due to u = 2
         2. According to section 8.2.3 IEEE [29]:
                   8.2.1(I) supported for n < 22048 + 64
                   8.2.1(II) supported for p  q < 24096 + 128
                   8.2.1(III) not supported
         Signature Generation (with or without CRT):
         1. According to section 5.2.1 RSASP1 in PKCS [22] for u = 2, i.e., without any (ri, di, ti), i >2
                   5.2.1(1) not supported
                   5.2.1(2.a) supported for n < 22048 + 64
                   5.2.1(2b) supported for p  q < 24096 + 128
              5.2.1(2b) (ii)&(v) not applicable due to u = 2
         2. According to section 8.2.4 IFSP-RSA1 in IEEE [29]:
                   8.2.1(I) supported for n < 22048 + 64
                   8.2.1(II) supported for p  q < 24096 + 128
                   8.2.1(III) not supported
         Signature Verification:
         1. According to section 5.2.2 RSAVP1 in PKCS [22]: supported for n < 24096 +128
              5.2.2(1) not supported
         2. According to section 8.2.5 IEEE [29]:
                   Supported for n < 24096 +128
                   8.2.5(1) not supported

Please consider also the statement of chapter 7.1.4.1.



Asymmetric Key Generation
CC Document                                                       137                                               1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


The TSF shall generate cryptographic keys in accordance with a specified cryptographic key generation
algorithm RSA specified in PKCS#1 [22] and specified cryptographic key sizes of 512 – 4096 bits that meet the
following standard:

         RSA key generation:

         1. According to sections 3.1 and 3.2 in PKCS [22], for u = 2, i.e. without any (ri, di, ti), i > 2:
                 3.1 supported for n < 24096 + 128
                 3.2.(1) supported for n < 22048 + 64
                 3.2.(2) supported for p x q < 24096 + 128
         2. According to section 8.1.3.1 in IEEE [29]:
                 8.1.3.1(1) supported for n < 22048 + 64
                 8.1.3.1(2) supported for p x q < 24096 + 128
                 8.1.3.1(3) supported for p x q < 22048 + 128

FCS_CKM.1/RSA is covered by the standards as stated above.

Note 22:
Following the national BSI recommendations, RSA key lengths below 1976 bits are not included in the certificate.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.
End of note.

The covered security functional requirements are FCS_COP.1/RSA and FCS_CKM.1/RSA.




CC Document                                                   138                                                     1.8
                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


8.5.4             Elliptic Curves Cryptographic Library for all versions
The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 233, 256, 283, 320, 384, 409, 512 or 521 Bits, due to national AIS32 regulations by the BSI. Note that
numerous other side channel attack resistant curve types exist, which the user optionally can add in the
composition certification process.
All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
with size n є [41-1; 521] are supported.

Signature Generation and Verification
The TSF shall perform signature generation and signature verification in accordance with a specified
cryptographic algorithm ECDSA and cryptographic key sizes of 160, 163, 192, 224, 233, 256, 283, 320, 384, 409,
512 or 521 bits that meet the following standard:

         ECDSA Signature Generation:
         1. According to section 7.3 Signing Process in ANSI [23]
                  Step d) and e) are not supported
                  The output of step e) has to be provided as input to our function by the caller.
                Deviation of step c) and f):
                     o The jumps to step a) were substituted by a return of the function with an error
                          code, the jumps are emulated by another call to our function.
         2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                  Chapter 6.4.3.3 is not supported
                  Chapter 6.4.3.5 is not supported
                      o The hash-code of H of the message has to be provided by the caller as input for
                          our function.
                  Chapter 6.4.3.7 is not supported
              Chapter 6.4.3.8 is not supported
         3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                  Deviation of step (3) and (4):
                      o The jumps to step 1 were substituted by a return of the function with an error
                           code, the jumps are emulated by another call to our function
         ECDSA Signature Verification:
         1. According to section 7.4.1 in ANSI [23]
                Step b) and c) are not supported.
                The output of step c) has to be provided as input to our function by the caller.
                Deviation of step d):
                     o Beside noted calculation, our algorithm adds a random multiple of
                          BasepointerOrder n to the calculated values u1 and u2.
         2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                Chapter 6.4.4.2 is not supported
                Chapter 6.4.4.3 is not supported:
                     o The hash-code H of the message has to be provided by the caller as input to our
                          function
         3. According to section 7.2.8 ECVP-DSA in IEEE [29].

ECC ADD point addition
CC Document                                                 139                                                        1.8
                                                                                                                2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


The TOE further provides functions to perform a full ECC point addition ECC_ADD according to section 2.3.1 in
BSI TR [38]. These functionalities are additionally assessed by the ITSEF performing evaluation.

Asymmetric Key Generation
The TSF shall generate cryptographic keys in accordance with a specified cryptographic key generation
algorithm Elliptic Curve EC specified in [23], [27] and [29] and specified cryptographic key sizes 160, 163, 192,
224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following standard:

         ECDSA Key Generation:
         1. According to the appendix “A4.3 Elliptic Curve Key Pair Generation” in ANSI [23]:
              The optional cofactor h is not supported.
         2. According to section “6.4.2 Generation of signature key and verification key” in ISO/IEC [27].
         3. According to appendix “A.16.9 An algorithm for generating EC keys” in IEEE [29]

Asymmetric Key Agreement
The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance with a specified cryptographic
algorithm ECDH and cryptographic key sizes 160, 163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits
that meet the folloing standard:
         1. According to section “5.4.1 Standard Diffie-Hellman Primitive” in ANSI [24]
                Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the shared
                 secret, but rather the x-coordinate and the y-coordinate.
         2. According to “Appendix D.6 Key agreement of Diffie-Hellman” type in ISO/IEC [28]
              The function enables the operations described in appendix D.6
         3. According to section “7.2.1 ECSVHDP-DH” in IEEE [29]
                  Unlike section 7.2.1 our implementation not only returns the x-coordinate of the shared
                   secret, but rather the x-coordinate and the y-coordinate.

The covered security functional requirements are FCS_COP.1/ECDSA, FCS_CKM.1/EC and FCS_COP.1/ECDH.



8.5.5             Toolbox Library for all versions
The Toolbox provides the following basic long integer arithmetic and modular functions in software, supported
by the cryptographic coprocessor: Addition, subtraction, division, multiplication, comparison, reduction,
modular addition, modular subtraction, modular multiplication, modular inversion and modular exponentiation.
No security relevant policy, mechanism or function is supported. The Toolbox library is deemed for software
developers as support for simplified implementation of long integer and modular arithmetic operations.
The Toolbox does not cover security functional requirements and thus the Toolbox library is not part of the TOE
Security Functionality (TSF).




CC Document                                               140                                                       1.8
                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


8.5.6          CIPURSE™ Cryptographic Library
The order option CIPURSE™ Cryptographic Library (CCL) provides cryptographic functionality to implement a
CIPURSE™ V2 conformant protocol [35-1].
This protocol provides a secure mutual authentication of two entities, namely the terminal (denoted as PCD =
Proximity Coupling Device (CIPURSE™-compliant terminal)) and a smart card or a token in other form factors
which is called PICC. PICC stands for Proximity Integrated Circuit Card (CIPURSE™-compliant card).
Beside the mutual authentication, the protocol implements cryptographic measures to maintain the integrity of
the transferred data and preserves in parallel the confidentiality of the transferred data.

The CIPURSE™ CL covers the following cryptographic security functional requirements as follows:
CCL in version v02.00.0004
    FCS_CKM.1/CCLCryptographic key generation,
    FCS_CKM.4/CCLCryptographic key destruction – AES
    FCS_COP.1/CCLCryptographic Operation – CCL Trusted Channel

                     The implemented cryptographic operation applies following standards:
       Federal Information Processing Standards Publication 197 [31]
       NIST Special Publication SP 800-38A [21]
       CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 5.2 Session key Derivation
       CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.2 Key Derivation for the first frame
       CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.3 Integrity Protection
       CIPURSE™ V2 Cryptographic Protocol [35-1] chapter 6.4 Confidential Communication


8.5.7          Hybrid PTRNG
Random data is essential for cryptography as well as for security mechanisms. The TOE is equipped with a Hybrid
Physical True Random Number Generator (HPTRNG, FCS_RNG.1). The random data can be used from the
Smartcard Embedded Software and is also used from the security features of the TOE, i.e. masking. The
HPTRNG implements various topological means, masked bus interface and is self-checking.
The produced genuine random numbers are available as a security service for the user and are also used for
internal purposes. Together with the security guidelines in [6] the hybrid PTRNG operates in the following modes
of operation and is conformant to the named classes:
     True Random Number Generation, meeting AIS31 PTG.2
     Hybrid Random Number Generation, meeting AIS31 PTG.3
     Deterministic Random Number Generation (DRNG) AIS31 DRG.3
     Key Stream Generation (KSG), stream cipher generation AIS31 DRG.2

The details of AIS31 are given in [13].

The Hybrid PTRNG implements protected a protected peripheral bus interface is a synthesized module and
covers therefore FPT_PHP.3 “Resistance to physical attack”. The transferred random data are masked as well as
other configuration data transferred over the peripheral bus. This covers FDP_ITT.1 “Basic internal transfer
protection” and FPT_ITT.1 “Basic internal TSF data transfer protection”. The correct function of the Hybrid
PTRNG is subject of internal self-testing and in case of errors a secure state is achieved to protect the user from
random data with bad entropy. Therefore, the output of the Hybrid PTRNG is conformant to the above claimed
classes or there is no random data output. This covers FPT_FLS.1 “Failure with preservation of secure state”.



CC Document                                             141                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


The hybrid PTRNG covers the security functional requirements FCS_RNG.1 “Random Number Generation”,
FPT_PHP.3 “Resistance to physical attack”, FDP_ITT.1 “Basic internal transfer protection”, FPT_ITT.1 “Basic
internal TSF data transfer protection” and FPT_FLS.1 “Failure with preservation of secure state”.


8.5.8         Listing of SFRs implemented by SF_CS “Cryptographic Support”
Table 20    Security Functional Requirements covered by SF_CS “Cryptographic Support”
   1. FCS_COP.1/TDES Cryptographic Operation
   2. FCS_CKM.4/TDES Cryptographic key destruction TDES
   3. FCS_COP.1/AES Cryptographic Operation
   4. FCS_CKM.4/AES Cryptographic key destruction AES
   5. FCS_COP.1/TDES-SCL-1 Cryptographic Operation by SCL-1
   6. FCS_COP.1/TDES-SCL-2 Cryptographic Operation by SCL-2
   7. FCS_CKM.4/TDES-SCL-1 Cryptographic key destruction TDES by SCL-1
   8. FCS_CKM.4/TDES-SCL-2 Cryptographic key destruction TDES by SCL-2
   9. FCS_COP.1/AES-SCL-1 Cryptographic Operation by SCL-1
   10. FCS_COP.1/AES-SCL-2 Cryptographic Operation by SCL-2
   11. FCS_CKM.4/AES-SCL-1 Cryptographic key destruction AES by SCL-1
   12. FCS_CKM.4/AES-SCL-2 Cryptographic key destruction AES by SCL-2
   13. FCS_COP.1/CMAC-SCL-1 Cryptographic Operation by SCL-1
   14. FCS_CKM.4/CMAC-SCL-1 Cryptographic key destruction by SCL-1
   15. FCS_COP.1/RSA-1 Cryptographic Operation RSA the ACL version v2.08.007
   16. FCS_CKM.1/RSA-1 Cryptographic key generation RSA for ACL version v2.08.007
   17. FCS_COP.1/ECDSA-1 Cryptographic Operation ECDSA for ACL version v2.08.007
   18. FCS_CKM.1/EC-1 Cryptographic key generation Elliptic Curve for ACL version v2.08.007
   19. FCS_COP.1/ECDH-1 Cryptographic Operation ECDH for ACL version v2.08.007
   20. FCS_COP.1/RSA-2 Cryptographic Operation RSA the ACL version v2.07.003
   21. FCS_CKM.1/RSA-2 Cryptographic key generation RSA for ACL version v2.07.003
   22. FCS_COP.1/ECDSA-2 Cryptographic Operation ECDSA for ACL version v2.07.003
   23. FCS_CKM.1/EC-2 Cryptographic key generation Elliptic Curve for ACL version v2.07.003
   24. FCS_COP.1/ECDH-2 Cryptographic Operation ECDH for ACL version v2.07.003
   25. FCS_COP.1/RSA-3 Cryptographic Operation RSA the ACL version v2.06.003
   26. FCS_CKM.1/RSA-3 Cryptographic key generation RSA for ACL version v2.06.003
   27. FCS_COP.1/ECDSA-3 Cryptographic Operation ECDSA for ACL version v2.06.003
   28. FCS_CKM.1/EC-3 Cryptographic key generation Elliptic Curve for ACL version v2.06.003
   29. FCS_COP.1/ECDH-3 Cryptographic Operation ECDH for ACL version v2.06.003
   30. FPT_PHP.3 Resistance to physical attack
   31. FDP_ITT.1 Basic internal transfer protection
   32. FPT_ITT.1 Basic internal TSF data transfer protection
   33. FPT_FLS.1 Failure with preservation of secure state
   34. FCS_RNG.1/TRNG True Random Number Generation
   35. FCS_RNG.1/HPRG Hybrid Random Number Generation
   36. FCS_RNG.1/DRNG Deterministic Random Number Generation
   37. FCS_RNG.1/KSG Key Stream Generation
   38. FCS_CKM.1/CCL Cryptographic key generation for version v02.00.0004

CC Document                                           142                                                    1.8
                                                                                                      2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
TOE Summary Specification (ASE_TSS)


    39. FCS_CKM.4/CCL Cryptographic key destruction – AES for version v02.00.0004
    40. FCS_COP.1/CCL Cryptographic operation CCL Trusted Channel for version v02.00.0004


8.6        Assignment of Security Functional Requirements to TOE’s Security
Functionality
The justification and overview of the mapping between security functional requirements (SFR) and the TOE’s
security functionality (SF) is given in sections the sections above. The results are shown in Table 20. The security
functional requirements are addressed by at least one relating security feature.
The various functional requirements are often covered manifold. As described above the requirements ensure
that the TOE ier guidance
documentation that is the subject of an Evaluation.
TOE Ses checked for correct operating conditions and if a not correctable failure ocurity Functionality - Combined functionality of all hardware, software, and
firmware of a TOE that must be relied upon for the correct enfoccurs that a stored
secure state is achieved, accompanied by data integrity monitoringrcement of the SFRs.

14. Bibliography
[1]    Common Criteria for Information Technology Security Evalu and actions to maintain the integrity
although failures occurred. An overview iation, Version 3.1,
       Pas    the customer also performs the personalisation with biometric data and configuration of the
                TSF if necessary.
4. Operational Use
   - Step 7: once the personalization of the product is finished, the Java Card ID S OS is switched to its
       proprietary native mode usage of the TOE by the personalizer. Native mode switches off GP and
       identification commands to disallow tracking of the end user.




CC Document                                             9
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 3             Conformance Claims (ASE_CCL)

 3.1           CC Conformance Claim
This Security Target and the TOE is Common Criteria version v3.1 revision 5 part 2 [CCPart2] extended and
Common Criteria version v3.1 revision 5 part 3 [CCPart3] conformant.


 3.2           PP Claim
The TOE is strictly conformant
     -   to [PP_BAC], if a BIS chooses BAC as authentication method
     -   to [PP_SAC], if a BIS chooses PACE as authentication method
     -   to [PP_EAC], if a EIS choses PACE as authentication method and additionally uses Extended Access
         Control, which consists of two parts (i) the Chip Authentication Protocol Version 1 (v.1) and (ii) the
         Terminal Authentication Protocol Version 1 (v.1) as defined in [TR-03110_1].


 3.3           Package Claim
The assurance level for the TOE is EAL5 augmented with the components ALC_DVS.2 and AVA_VAN.5 in case
PACE is used and EAC is not used and conform to [PP_SAC].
The assurance level for the TOE is EAL5 augmented with the components ALC_DVS.2 and AVA_VAN.5 in case
PACE and EAC are used and conform to [PP_EAC].
The assurance level for the TOE is EAL4 augmented with the components ALC_DVS.2 in case BAC is chosen as
authentication method whereby conformancy to [PP_BAC] is claimed.




CC Document                                              10
                                                                                                           1.2
                                                                                                           2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 4            Security Problem Definition (ASE_SPD)
All assets, subjects and external entities, threats, organisational security policies and assumptions from
[PP_EAC], [PP_SAC] and [PP_BAC] section 3 “Security Problem Definition” are applicable for this TOE.




CC Document                                             11
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 5             Security Objectives (ASE_OBJ)
Here follows a concise description of the security objectives applying to this ST followed by a the security
objective rationale.

 5.1           Security Objectives defined in the claimed PPs
All Security Objectives provided by the TOE or by the operational environment as well as the security objectives
rationale from the claimed PPs [PP_EAC], [PP_SAC] and [PP_BAC] section 4 “Security Objectives” are applicable
for this TOE.

 5.2           Security Objectives defined in this ST
The following security objective is defined additionally in this ST to formally express the extra features of the
TOE not present in the claimed PPs:
OT.Active_Auth Travel document’s chip authenticity
The TOE shall support the Basic Inspection Systems to verify the identity and authenticity of the travel doc-
ument’s chip as issued by the identified issuing State or Organisation by means of the Active Authentication as
defined in [ICAO_9303_01]. The authenticity proof provided by travel document’s chip shall be protected
against attacks with high attack potential.



 5.3           Security Objective Rationale
The Security Objective Rationale from the claimed PPs [PP_EAC], [PP_SAC] and [PP_BAC] stays the same here.
The additionally defined in this ST security objective OT.Active_Auth above counters the threat T.Counterfeit
(threat defined in [PP_EAC].




CC Document                                              12
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 6            Extended Components Definition (ASE_ECD)
[PP_EAC], [PP_SAC] and [PP_BAC] respective sections 5 “Extended Components Definition” are applicable for
this TOE.




CC Document                                          13
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  7             Security Requirements (ASE_REQ)

  7.1           TOE Security Functional Requirements
 The security functional requirements (SFR) for this TOE are defined in this chapter.
This ST covers the three PPs [PP_SAC], [PP_EAC] and [PP_BAC] each two of which have a non empty
intersection of SFRs. In the rest of this section we provide a classification of the SFRs of these PPs depending on
where these SFRs are declared and if they need a refinement here in this ST.
 Table 1 lists all SFRs appearing both in [PP_SAC] and [PP_BAC].
 Table 2 lists all SFRs declared in [PP_SAC].
Table 3 lists all SFRs specific to [PP_BAC]. Note that some of the SFRs appear in both [PP_SAC] and [PP_BAC]
with same name but different content. In such cases the SFR is iterated with either the extension …/BAC or
…/PACE.
Table 4 lists all SFRs specific to [PP_EAC]. Note that [PP_EAC] is an extension of [PP_SAC], therefore all SFRs of
[PP_SAC] are SFRs in [PP_EAC], i.e. the SFRs listed in Table 3 and Table 4 are also SFRs of [PP_EAC].
Table 5 lists the SFRs introduced in this ST which are related to the Active Authentication mechanism
supported by the TOE.

Table 1       TOE SFRs equivalent from both [PP_SAC] and [PP_BAC]
  FCS_CKM.4
  FCS_RND.1
  FMT_MTD.1/INI_ENA
  FPT_TST.1
  FPT_PHP.3



Table 2       TOE SFRs specifically from [PP_SAC]
  FCS_CKM.1/DH_PACE
  FCS_COP.1/PACE_ENC
  FCS_COP.1/PACE_MAC
  FIA_AFL.1/PACE
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/PACE
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FDP_RIP.1

CC Document                                             14
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FDP_UCT.1/TRM
  FDP_UIT.1/TRM
  FTP_ITC.1/PACE
  FAU_SAS.1
  FMT_SMF.1
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/INI_DIS
  FMT_MTD.1/KEY_READ
  FMT_MTD.1/PA
  FPT_EMS.1
  FPT_FLS.1

Table 3

Table 4       TOE SFRs specifically from [PP_BAC]
  FCS_CKM.1
  FCS_COP.1/SHA
  FCS_COP.1/ENC
  FCS_COP.1/AUTH
  FCS_COP.1/MAC
  FIA_UID.1
  FIA_UAU.1
  FIA_UAU.4
  FIA_UAU.5
  FIA_UAU.6
  FIA_AFL.1
  FDP_ACC.1
  FDP_ACF.1
  FDP_UCT.1
  FDP_UIT.1
  FAU_SAS.1/BAC
  FMT_SMF.1/BAC
  FMT_SMR.1
  FMT_LIM.1/BAC
  FMT_LIM.2/BAC
  FMT_MTD.1/INI_DIS/BAC

CC Document                                          15
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FMT_MTD.1/KEY_WRITE
  FMT_MTD.1/KEY_READ/BAC
  FPT_EMSEC.1
  FPT_FLS.1/BAC




Table 5       TOE SFRs specifically from [PP_EAC]
  FCS_CKM.1/CA
  FCS_COP.1/CA_ENC
  FCS_COP.1/CA_MAC
  FCS_COP.1/SIG_VER
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/EAC
  FIA_API.1
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/CVCA_INI
  FMT_MTD.1/DATE
  FMT_MTD.1/CAPK
  FMT_MTD.1/CVCA_UPD
  FMT_MTD.1/KEY_READ
  FMT_MTD.3
  FPT_EMS.1




CC Document                                          16
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



Table 6       TOE SFRs introduced in this ST
 FIA_API.1/AA
 FMT_MTD.1/AA
 FCS_COP.1/SIG_GEN




7.1.1                About the Application Notes in this ST
Note that if an SFR has application notes as per the PPs [PP_SAC], [PP_EAC] and [PP_BAC] then these
application notes apply and can be found in the respective PPs.
Some SFRs contain additional application notes to ease the understanding of the specificities of this TOE.
These application notes do not come from the PPs and are prefixed with [IFX specific].



7.1.2                Common SFRs from [PP_BAC] and [PP_SAC]

7.1.2.1              Class FCS: Cryptographic Support




  FCS_CKM.4                Cryptographic key destruction – Session keys

  Hierarchical to:         No other components.

  Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                           user data with security attributes, or FCS_CKM.1 Cryptographic key generation]:
                           fulfilled by FCS_CKM.1 in case of BAC;
                           fulfilled by FCS_CKM.1/DH_PACE in case of PACE

  FCS_CKM.4.1              The TSF shall destroy cryptographic keys in accordance with a specified
                           cryptographic key destruction method overwriting the key values with random
                           values that meets the following: none

                           Application note 19 of [PP_BAC] and application note 28 of [PP_SAC] are both
 [IFX specific]            applicable for this SFR. There is no contradiction between the two application
 Application Note:         notes. While the application note from [PP_BAC] simply requests the encryption
                           and message authentication keys to be destroyed, the application note from
                           [PP_SAC] provides more detailed requests, when the session keys have to be
                           destroyed. Therefore FCS_CKM.4 from [PP_SAC] and [PP_BAC] can be combined.




CC Document                                            17
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_RND.1                Quality metric for random numbers

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FCS_RND.1.1              The TSF shall provide a mechanism to generate random numbers that meet
                          Random numbers generation Class PTG.3 according to [AIS31]

 [IFX specific]           There is no contradiction between application note 24 of [PP_BAC] and application
 Application Note:        note 31 of [PP_SAC]. Both application notes shall apply and therefore FCS_RND.1
                          from [PP_BAC] and [PP_SAC] can be combined, i.e. the random numbers shall be
                          used for the PACE, BAC and the authentication mechanism based on Triple-DES (as
                          defined in FIA_UAU.4/PACE and FIA_UAU.4).




7.1.2.2             Class FMT Security Management

 FMT_MTD.1/INI_ENA        Management of TSF data – Writing Initialisation and Pre-personalisation Data

 Hierarchical to:         No other components.

 Dependencies:            FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1 for
                          PACE; fulfilled by FMT_SMF.1/BAC for BAC
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE for PACE; fulfilled by
                          FMT_SMR.1 for BAC

 FMT_MTD.1.1/INI_ENA      The TSF shall restrict the ability to write the Initialisation Data and Pre-
                          personalisation Data to the Manufacturer.

 [IFX specific]           The application note 42 of [PP_BAC] applies. This application note provides a
 Application Note:        definition, what is meant by “Pre-Personalisation Data”. This definition is also
                          applicable to FMT_MTD.1/INI_ENA from [PP_SAC]. Therefore FMT_MTD.1/INI_ENA
                          from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            18
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.2.3             Class FPT Protection of the Security Functions


 FPT_TST.1                TSF testing

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_TST.1.1              The TSF shall run a suite of self tests during initial start-up, to demonstrate the
                          correct operation of the TSF.

 FPT_TST.1.2              The TSF shall provide authorised users with the capability to verify the integrity of
                          the TSF data.

 FPT_TST.1.3              The TSF shall provide authorised users with the capability to verify the integrity of
                          stored TSF executable code.



 [IFX specific]           There is no contradiction between application note 46 of [PP_BAC] and application
                          note 52 of [PP_SAC]. In fact, although the wording is slightly different, the meaning
 Application Note:
                          of these application notes is identical. Therefore either of these application notes
                          applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be combined.




 FPT_PHP.3                Resistance to physical attack

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_PHP.3.1              The TSF shall resist physical manipulation and physical probing to the TSF by
                          responding automatically such that the SFRs are always enforced.

 [IFX specific]           Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application
                          note 48 of [PP_BAC] is only informative to the reader in the sense, that it provides a
 Application Note:
                          context to an older CC standard, but not relevant for the interpretation of
                          FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or application note 53
                          of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            19
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.3                SFRs specifically from [PP_SAC]

7.1.3.1              Class FCS: Cryptographic Support


  FCS_CKM.1/DH_PACE        Cryptographic key generation – Diffie-Hellman for PACE session keys

  Hierarchical to:         No other components.

  Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                           operation]: fulfilled by FCS_CKM.4
                           Justihe CXRAM parity watchdog.
                           watchdog error               off)
                           configuration              • enabled after
                                                        watchdog
                                                        initialization
                                                        done
                                                      • enabled (always
                                                        on)
                           FXRAM parity               • disabled (always Configuration of the FXRAM parity watchdog.
                           watchdog error               off)
                           configuration              • enabled after
                                                        watchdog




                                             All information provided in this document is subject to legal disclaimers.           © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                 Rev. 4.4 — 29 October 2018                                                                      12 of 87
PUBLIC
NXP Semiconductors                                                  P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                 Security Target Lite



                           Name                    Value                                      Description
                                                            initialization
                                                            done
                                                      • enabled (always
                                                        on)
                           Selection of reset         • ISO13239/                             Selection of CRC algorithm for ISO7816 enhanced
                           value for UART               HDLC                                  protocol support.
                           CRC algorithm              • de facto PC/SC
                           Start-Up with Low          • YES                                   Start-Up with low CPU clock to enable specific low
                           CPU clock                  • NO                                    power applications. If this option is enabled the ISO
                           enabled                                                            start-up timing is not met.
                           RunMode                    • YES                                   Special start-up behavior in order to support a start-up
                           enabled                    • NO                                    with
                                                                                              • RST_N pad forced to LOW or not connected
                                                                                              and
                                                                                              • CLK pad forced HIGH or not connected.
                           Allow                      • YES                                   Disables the Low Frequency Sensor to allow parallel
                           simultaneous               • NO                                    operation via contact and contactless interfaces. The
                           operation of                                                       Low Frequency Sensor is disabled only when the CPU
                           ISO7816                                                            is free-running or runs at an internal clock.
                           and ISO14443
                           applications
                           Chip Health mode           • YES                                   Activation of read-out of IC identification items and
                           enabled                    • NO                                    start of built-in self test and ident routines is enabled or
                                                                                              not.
                           L_A / L_B input                                Additional capacitance (2x26 pF) between L_A/L_B
                                                      • 17 pF for class 1
                           capacitance                                    required meeting resonance frequency at ID1/2
                           configuration                (ID1) antennas    operation.
                                                        (default)
                                                      • 69 pF for class 2
                                                        (“half ID1”)
                                                        antennas
                           UID options                • Single FNUID,                         Defines size of the contactless communication protocol
                                                        four bytes                            unique identifier (set by Contactless Communication
                                                      • Double UID,                           Parameter ATQ0)
                                                        seven bytes

                          See Section 31.1 of the Data Sheet [9] for details on all minor configuration options listed in
                          Table 8. The availability of minor configuration options partly depends on the selected major
                          configuration option. However, in general the minor configuration options can be chosen
                          independently.
                1.4.2.3     Post Delivery Configuration
                          Post Delivery Configuration (PDC) can be applied by the customer himself after the TOE
                          has been delivered to that customer. These options can be used to tailor the TOE to the
                          specific customer requirements. The Post Delivery Configuration can be changed multiple
                          times but must be set permanently by the customer before the TOE is delivered to phase 7
                          of the life cycle.
                          The Post Delivery Configuration for the P60D024/016/012yVB(Y/Z/A)/yVF is listed in Table
                          9.




                                             All information provided in this document is subject to legal disclaimers.            © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                 Rev. 4.4 — 29 October 2018                                                                       13 of 87
PUBLIC
NXP Semiconductors                                                P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                        Security Target Lite


                          Table 9.     Post Delivery Configuration for P60D024/016/012yVB(Y/Z/A)/yVF
                           Name                Values            Description
                           EEPROM Size           Steps of 2KB                         This value determines the maximum size of the EEPROM
                                                                                      in steps of 2KB. Default EEPROM size is given by the
                                                                                      major configuration.
                           CXRAM Size            Steps of 128 Byte This value determines the maximum size of the CXRAM
                                                                   in steps of 128 Bytes. Default CXRAM size is given by the
                                                                   major configuration.
                           Fame2                 Enabled or                           This value determines whether the Fame2 coprocessor is
                           coprocessor           Disabled                             enabled or disabled. Default value is enabled.
                           AES                   Enabled or                           This value determines whether the AES coprocessor is
                                                 Disabled                             enabled or disabled. Default value is enabled.
                           Contactless           Enabled or                           This value determines whether the Contactless interface
                           Interface             Disabled                             is enabled or not. Default value is enabled.

                          By applying Post Delivery Configuration the Security Rows content is updated for the
                          changed configuration options and can therefore be used for identification of the TOE after
                          applying any Post Delivery Configuration. Further details regarding Security Rows content
                          and identification of the TOE after applying Post Delivery Configuration refer to [9].
                          The Post Delivery Configuration can be accessed using chip health mode functionality in
                          combination with the ISO/IEC 7816 contact interface.
                1.4.2.4         Evaluated package types
                          A number of package types are supported for each major configuration of the TOE. The
                          commercial types are named according to the following format.
                            • P60D024ypp(p)/9Brrff(o) for major configuration P60D024PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D016ypp(p)/9Brrff(o) for major configuration P60D016PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D012ypp(p)/9Brrff(o) for major configuration P60D012PVB(Y/Z/A)/MVB(Y/Z/A)
                            • P60D024ypp(p)/9Frrff(o) for major configuration P60D024yVF
                            • P60D016ypp(p)/9Frrff(o) for major configuration P60D016yVF
                            • P60D012ypp(p)/9Frrff(o) for major configuration P60D012yVF
                          The commercial type name of each major configuration varies with the package type as
                          indicated by the variable pp and with the Security IC Embedded Software as indicated by
                          the variables rr and ff. Variable y identifies the activation of the firmware emulations.
                          Variable o identifies the EEPROM size of MIFARE Software. The number 9 is used as Fab
                          identifier and B/F references to the silicon version also available at major configuration
                          naming as VB/VF. The variables are replaced according to the rules in Table 10.

                          Table 10. Variable definitions for commercial type names
                           Variable         Definition
                           y                     Emulation Option Configuration for Dual Interface Types (alpha numeric), e.g.
                                                 ‘M’ for MIFARE Plus.
                           pp(p)                 Package delivery type (alpha numeric, last character optional), e.g. “A4” for
                                                 MOB4 module.
                           rr                    ROM code number, which identifies the ROM mask.




                                           All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                               Rev. 4.4 — 29 October 2018                                                                14 of 87
PUBLIC
NXP Semiconductors                                                           P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                          Security Target Lite



                           Variable                               Definition
                           ff                                     FabKey number, which identifies the EEPROM content at TOE delivery.
                           (o)                                    Size of EEPROM area for firmware emulation, e.g. ‘2’ 2kByte MIFARE Plus
                                                                  Emulation. In case no firmware emulation is activated for a commercial type
                                                                  this character is left blank.

                       Table 11 depicts the package types, which are supported in this Security Target, and
                       assigns these to the major configurations. The two characters in each entry of the table
                       stand for the variable pp, and identify the package type. An empty cell means that the
                       Security Target does not support the respective package type for the corresponding major
                       configuration.

                       Table 11.               Supported Package Types
                                P60D024y


                                           P60D016y


                                                       P60D012y




                                                                                                                            Description



                                Ux         Ux         Ux            Wafer not thinner than 50 µm
                                                                    (The letter “x” in “Ux” stands for a capital letter or a number, which
                                                                    identifies the wafer type)
                                Xn         Xn         Xn            Module
                                                                    (The letter “n” in” Xn” stands for a capital letter or a number, which
                                                                    identifies the module type)
                                A4         A4                       MOB4 module
                                A6         A6                       MOB6 module
                                Ai         Ai                       Inlay
                                                                    (The letter ‘i” in “Ai” stands for a capital letter, which identifies both, the inlay
                                                                    type and the package type inside the inlay.)


                       For example, commercial type name P60D024PX0/9Brrff denotes major configuration
                       P60D024yVB(Y/Z/A)/yVF in PDM1.1 dual interface smart card module. The characters ‘rr’
                       and ‘ff’ are individual for each customer product.
                       The package types do not influence the security functionality of the TOE. They only define
                       which pads are connected in the package and for what purpose and in which environment
                       the chip can be used. Note that the security of the TOE is not dependent on which pad is
                       connected or not - the connections just define how the product can be used. If the TOE is
                       delivered as wafer the customer can choose the connections on his own.
                       Security during development and production is ensured for all package types listed above,
                       for details refer to section 1.4.4.
                       The commercial type name identifies major configuration and package type of the TOE as
                       well as the Security IC Embedded Software. However, the commercial type name does not
                       itemize the minor configuration options of the TOE, which are introduced in section 1.4.2.2.
                       Instead, minor configuration options are identified in the Order Entry Form, which is
                       assigned to the ROM code number and the FabKey number of the commercial type name.




                                                      All information provided in this document is subject to legal disclaimers.            © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                             Rev. 4.4 — 29 October 2018                                                                    15 of 87
PUBLIC
NXP Semiconductors                                               P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                     Security Target Lite



                          Minor configuration options as well as configuration options changed by means of Post
                          Delivery Configuration are coded in the Security Rows and can be read out for identification
                          of the TOE. Further details regarding Security Rows content and identification of the TOE
                          after applying Post Delivery Configuration refer to [9].


                  1.4.3 Logical Scope of TOE
                1.4.3.1     Hardware Description
                          The CPU of the P60D024/016/012yVB(Y/Z/A)/yVF supports a 32-/24-/16-/8-bit instruction
                          set and distinguishes five CPU modes, which are summarized in Table 12.

                          Table 12.    CPU modes of the TOE
                                            Super System Mode
                           Boot Mode            Test Mode                            Firmware Mode                     System Mode        User Mode

                          Boot Mode, Test Mode and Firmware Mode are sub-modes of the so-called Super System
                          Mode. These three modes are not available to the Security IC Embedded Software; they
                          are reserved for the Security IC Dedicated Software. The Security IC Dedicated Software is
                          composed of Security IC Dedicated Test Software and Security IC Dedicated Support
                          Software, (Boot-ROM Software and Firmware Operating System) as introduced in section
                          1.4.1. The three software components are mapped one-to-one to the three CPU modes: In
                          Boot Mode the TOE executes the Boot-ROM Software, in Test Mode the TOE executes the
                          IC Dedicated Test Software and in Firmware Mode the TOE executes the Firmware
                          Operating System. Please note that the Super System Mode is not a mode on its own:
                          When the TOE is in Super System Mode, it is always either in Boot Mode, Test Mode or
                          Firmware Mode.
                          The P60D024/016/012yVB(Y/Z/A)/yVF is able to control two different logical phases. After
                          production of the Security IC every start-up or reset completes with Test Mode and
                          execution of the IC Dedicated Test Software. The Test Mode is disabled at the end of the
                          production test. Afterwards, every start-up or reset ends up in System Mode and execution
                          of the Security IC Embedded Software.
                          In case the minor configuration option ‘Post Delivery Configuration’ is enabled and not finally
                          locked by the customer, the resource configuration functionality allows the customer to
                          enable or disable specific functionality of the hardware platform, refer to Table 9.
                          In case the minor configuration option ‘Chip Health/Ident Mode’ is enabled, during the boot
                          process routines either starting built-in self tests checking the functional integrity of the TOE
                          or sending back identification items of the TOE can be activated by the user.
                          System Mode and User Mode are available to the developer of the Security IC Embedded
                          Software. System Mode has unlimited access to the hardware components available to the
                          Security IC Embedded Software. User Mode has restricted access to the CPU, specific
                          Special Function Registers and the memories depending on the access rights granted by
                          software running in System Mode. The hardware components are controlled by the Security
                          IC Embedded Software via Special Function Registers. Special Function Registers are
                          interrelated to the activities of the CPU, the Memory Management Unit, interrupt control, I/O
                          configuration, EEPROM, timers, UART, the contactless interface and the coprocessors.




                                          All information provided in this document is subject to legal disclaimers.                   © NXP B.V. 2018. All rights reserved.

Evaluation documentation                              Rev. 4.4 — 29 October 2018                                                                              16 of 87
PUBLIC
NXP Semiconductors                                            P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                    Security Target Lite



                       The P60D024/016/012yVB(Y/Z/A)/yVF provides two types of interrupts: (i) exception
                       interrupts, called “exception” in the following and (ii) event interrupts, called “interrupts” in
                       the following. Exceptions and interrupts each force a jump to a specific fixed vector address
                       in the ROM. Any exception and interrupt can therefore be controlled and guided by a specific
                       part     of     the    Security     IC     Embedded       Software.      In     addition,    the
                       P60D024/016/012yVB(Y/Z/A)/yVF provides eight firmware vectors (FVEC) and 32 system
                       call vectors (SVEC). These vectors have to be explicitly called by the Security IC Embedded
                       Software. A jump to a firmware vector forces Firmware Mode and starts execution of the
                       Firmware Operating System, a jump to a system call vector forces System Mode.
                       The Watchdog timer is intended to abort irregular program executions by a time-out
                       mechanism and is enabled and configured by the Security IC Embedded Software.
                       The P60D024yVB(Y/Z/A)/yVF incorporates 352 kBytes of ROM, 8.125 kBytes of RAM and
                       24 kBytes of EEPROM. Access control to all three memory types is enforced by a Memory
                       Management Unit. The Memory Management Unit partitions each memory into two                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                       d control
and against download of malicious software before, during and after the user downloads his software. This is
formalized with the objectives O.Cap_Avail_Loader, O.Authentication and O.Ctrl_Auth_Loader requiring
authentication of the TOE to external entities and a trusted communication channel. The O.Authentication
implements a mutual authentication and involves the environment therefore.
And the policies cover also the environmental objective OE.Process-Sec-IC at user premises, as it must be
regardless in which environment the Flash Loader is operated.
The implemented mutual authentication requires first to authenticate the TOE to the external user. This requires
also knowledge by the user about the sequence of the protocol, interpretation of the transferred data and how to
start the authentication of the TOE. This authentication mean counters the threat T.Masquerade_TOE as only
the genuine TOE is able to identify itself correctly to the enabled user, which covers O.Authentication.
The second step of the mutual authentications mean implements the authentication of the user to the TOE. Only
the user enabled to present the correct authentication data and knowing about the sequence, data
interpretation and signaling of the authentication to the TOE is able to proceed further on.
This enforces OE.TOE_Auth, requiring the support of the verification mechanism and known authentication
reference data by the operational environment.

It is normal business that products enabled for software download by the user are either on their way to the user
or are already stored at user premises. At both situations it cannot be excluded that an attacker could manage to
steal such products enabled for software downloads. The ability to download software on a chip without
operating system and/or application is defined as open sample.
This situation generates the threat T.Open_Samples_Diffusion which is defined as follows:
The download of analysis software could enable an attacker to characterize the product and to construct an
attack path out of the gained information.
This threat is countered by the Flash Loader by following rational:
As long as the Flash Loader is active, controlled usage to the Flash Loader functionality (P.Ctrl_Loader) is
enforced which protects the TOE from achieving the status of being an open sample. And more, even the
attacker could observe, meaning in the sense of measurements during, or induce faults during an authorized
download, the Flash Loader protects the user data of the download by confidentiality and integrity protection
means. The Flash Loader functionalities of mutual authentication, establishing a dedicated trusted
communication channel, the encryption and integrity protection means cover the objectives
O.Prot_TSF_Confidentiality, O.Leak-Inherent and O.Leak-Forced.
The policy P.Ctrl_Loader covers also the environmental objective OE.Process-Sec-IC at user                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].            • functionality to calculate the Advanced Encryption Standard (AES) with different key
                        lengths,
                      • support for large integer arithmetic operations like multiplication, addition and logical
                        operations, which are suitable for public key cryptography (e.g. RSA or ECC),
                      • a True Random Number Generator,
                      • memory management control,
                      • cyclic redundancy check (CRC) calculation,
                      • ISO/IEC 7816 contact interface with UART, and
                      • ISO/IEC 14443 A contactless interface supporting.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           