         of an EEPROM block such that the integrity of the data read from EEPROM is ensured
                      even if the characteristics of the EEPROM changed e.g. due to ageing. Therefore,
                      FDP_SDI.2[HW] and FDP_SDI.2[FW] are suitable to meet the security objective.
                      The justification related to the security objective “Post Delivery Configuration of
                      Hardware” (O.CUST_RECONF_PLAIN) is as follows:
                      The security functional requirement “Specification of Management Functions
                      (FMT_SMF.1)” is used for the specification of the management functions to be
                      provided by the P6022y VB as demanded by O.CUST_RECONF_PLAIN. Therefore,
                      FMT_SMF.1[HW] is suitable to meet the security objective.
                      The justification related to the security objective "Sealing/Unsealing user data” (O.PUF) is
                      as follows:
                      The security functional requirement FCS_CKM.1[PUF] requires the generation of
                      cryptographic key from the key derivation function based on the PUF block and the
                      Random Number Generator (RNG). Since the PUF block and the Random Number
                      Generator provide a TOE specific data to the key derivation function, the user data which
                      is encrypted with this cryptographic key can be decrypted with the same TOE that the
                      user data was encrypted on. The security functional requirement FCS_CKM.4[PUF]
                      requires that the cryptographic keys which are derived by the key derivation function are
                      destroyed by the method of flushing of key registers. The SFR FCS_COP.1[PUF_AES]
                      defines the encryption and decryption of the user data using cryptographic algorithm
                      AES. The SFR FCS_COP.1[PUF_MAC] defines the calculation of a MAC as a PUF


P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       72 / 101
NXP Semiconductors
                                                                                                                                   P6022y VB
                                                                                                                                     Security Target Lite


                        authentication value. Therefore these SFRs together provide the functionality of sealing/
                        unsealing user data as required by the objective O.PUF.


               6.3.2 Dependencies of security functional requirements


              6.3.2.1   NXP Secure Smart Card Controller P6022y VB
                        The dependencies listed in the PP [6] are independent of the additional dependencies
                        listed in the table below. The dependencies of the PP [6] are fulfilled within the PP [6] and
                        at least one dependency is considered to be satisfied.
                        The following discussion demonstrates how the dependencies defined by Part 2 of the
                        Common Criteria [2] for the requirements specified in Section 6.1.1.2 and Section 6.1.1.3
                        are satisfied.
                        The dependencies defined in the Common Criteria are listed in the Table 35:

Table 35. Dependencies of security functional requirements
Security Functional Requirement        Dependencies                                                                  Fulfilled by security requirements in
                                                                                                                     this ST
FCS_COP.1[TDES]                        FDP_ITC.1 or FDP_ITC.2, or FCS_                                               See discussion below
                                       CKM.1
                                       FCS_CKM.4
FCS_CKM.4[TDES]                        FDP_ITC.1 or FDP_ITC.2, or FCS_                                               See discussion below
                                       CKM.1
FCS_COP.1[AES]                         FDP_ITC.1 or FDP_ITC.2, or FCS_                                               See discussion below
                                       CKM.1
                                       FCS_CKM.4
FCS_CKM.4[AES]                         FDP_ITC.1 or FDP_ITC.2, or FCS_                                               See discussion below
                                       CKM.1
FDP_ACC.1[MEM]                         FDP_ACF.1                                                                     Yes, by FDP_ACF.1[MEM]
FDP_ACC.1[SFR]                         FDP_ACF.1                                                                     Yes, by FDP_ACF.1[SFR]
FDP_ACF.1[MEM]                         FDP_ACC.1                                                                     Yes, by FDP_ACC.1[MEM]
                                       FMT_MSA.3                                                                     Yes, by FMT_MSA.3[MEM]
FDP_ACF.1[SFR]                         FDP_ACC.1                                                                     Yes, by FDP_ACC.1[SFR]
                                       FMT_MSA.3                                                                     Yes, by FMT_MSA.3[SFR]
FMT_MSA.3[MEM]                         FMT_MSA.1                                                                     Yes, by FMT_MSA.1[MEM]
                                       FMT_SMR.1                                                                     See discussion below
FMT_MSA.3[SFR]                         FMT_MSA.1                                                                     Yes, by FMT_MSA.1[SFR]
                                       FMT_SMR.1                                                                     See discussion below
FMT_MSA.1[MEM]                         FDP_ACC.1 or FDP_IFC.1                                                        Yes, by FDP_ACC.1[MEM]
                                       FMT_SMR.1                                                                     See discussion below
                                       FMT_SMF.1                                                                     Yes, by FMT_SMF.1[HW]
FMT_MSA.1[SFR]                         FDP_ACC.1 or FDP_IFC.1                                                        Yes, by FDP_ACC.1[SFR]
                                       FMT_SMR.1                                                                     See discussion below
                                       FMT_SMF.1                                                                     Yes, by FMT_SMF.1[HW]




P6022y VB                               All information provided in this document is subject to legal disclaimers.                      © NXP B.V. 2018. All rights reserved.

Evaluation document                                     Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                                          73 / 101
NXP Semiconductors
                                                                                                                                   P6022y VB
                                                                                                                                     Security Target Lite


Security Functional Requirement        Dependencies                                                                  Fulfilled by security requirements in
                                                                                                                     this ST
FCS_COP.1[PUF_AES]                     FDP_ITC.1, or FDP_ITC.2 or FCS_                                               Yes, by FCS_CKM.1[PUF]
                                       CKM.1                                                                         Yes, by FCS_CKM.4[PUF]
                                       FCS_CKM.4
FCS_COP.1[PUF_MAC]                     FDP_ITC.1, or FDP_ITC.2 or FCS_                                               Yes, by FCS_CKM.1[PUF]
                                       CKM.1                                                                         Yes, by FCS_CKM.4[PUF]
                                       FCS_CKM.4
FCS_CKM.1[PUF]                         FCS_CKM.2 or FCS_COP.1                                                        Yes, by FCS_COP.1[PUF_AES]
                                       FCS_CKM.4                                                                     Yes, by FCS_CKM.4[PUF]
FCS_CKM.4[PUF]                         FDP_ITC.1 or FDP_ITC.2 or FCS_                                                Yes, by FCS_CKM.1[PUF]
                                       CKM.1

                        The developer of the Security IC Embedded Software must ensure that the
                        additional security functional requirements FCS_COP.1[TDES], FCS_CKM.4[TDES],
                        FCS_COP.1[AES] and FCS_CKM.4[AES] are used as specified and that the User Data
                        processed by the related security functionality is protected as defined for the application
                        context.
                        The dependent requirements of FCS_COP.1[TDES], FCS_CKM.4[TDES],
                        FCS_COP.1[AES] and FCS_CKM.4[AES] completely address the appropriate
                        management of cryptographic keys used by the specified cryptographic function and
                        the management of access control rights as specified for the memory access control
                        function. All requirements concerning these management functions shall be fulfilled by
                        the environment (Security IC Embedded Software).
                        The dependency FMT_SMR.1 introduced by the two components FMT_MSA.1 and
                        FMT_MSA.3 must be fulfilled by the Security IC Embedded Software. The definition and
                        maintenance of the roles that act on behalf of the functions provided by the hardware
                        must be subject of the Security IC Embedded Software.


               6.3.3 Rationale for the Security Assurance Requirements


              6.3.3.1   NXP Secure Smart Card Controller P6022y VB
                        The selection of assurance components is based on the underlying PP [6]. The Security
                        Target for the P6022y VB uses the same augmentations as the PP, but chooses a higher
                        assurance level. The level EAL6 is chosen in order to meet assurance expectations of
                        digital signature applications and electronic payment systems.
                        The rationale for the augmentations is the same as in the PP. The assurance level EAL6
                        is an elaborated pre-defined level of the CC, part 3 [3]. The assurance components in an
                        EAL level are chosen in a way that they build a mutually supportive and complete set of
                        components. The requirements chosen for augmentation do not add any dependencies,
                        which are not already fulfilled for the corresponding requirements contained in EAL6,
                        respectively. Therefore, these components add additional assurance to EAL6, but the
                        mutual support of the requirements is still guaranteed.
                        As stated in the Section 6.3.3 of the PP [6], it has to be assumed that attackers with high
                        attack potential try to attack smartcards used for digital signature applications or payment
                        systems. Therefore specifically AVA_VAN.5 was chosen by the PP [6] in order to assure
                        that even these attackers cannot successfully attack the P6022y VB.

P6022y VB                               All information provided in this document is subject to legal disclaimers.                      © NXP B.V. 2018. All rights reserved.

Evaluation document                                     Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                                          74 / 101
NXP Semiconductors
                                                                                                                    P6022y VB
                                                                                                                    Security Target Lite



               6.3.4 Security Requirements are Internally Consistent


              6.3.4.1   NXP Secure Smart Card Controller P6022y VB
                        The discussion of security functional requirements and assurance requirements in the
                        preceding sections has shown that mutual support and consistency are given for both
                        groups of requirements. The arguments given for the fact that the assurance components
                        are adequate for the functionality of the P6022y VB also show that the security functional
                        requirements and assurance requirements support each other and that there are no
                        inconsistencies between these groups.
                        The security functional requirements FDP_SDC.1 and FDP_SDI.2 address the
                        protection of user data in the specified memory areas against compromise and
                        manipulation. The security functional requirements required to meet the security
                        objectives O.Leak-Inherent, O.Phys-Probing, O.Malfunction, O.Phys-Manipulation and
                        O.Leak-Forced also protect the cryptographic algorithms, the integrity support of data
                        stored in EEPROM and the memory access/separation control function as well as the
                        access control to Special Function Register implemented according to the security
                        functional requirement FCS_COP.1[TDES], FCS_CKM.4[TDES], FCS_COP.1[AES],
                        FCS_CKM.4[AES], FDP_SDI.2[HW], FDP_SDI.2[FW], FDP_SDI.2[EEPROM],
                        FDP_SDI.2[RAM], FDP_SDI.2[ROM], FDP_SDC.1[EEPROM], FDP_SDC.1[RAM], and
                        FDP_ACC.1[MEM], FDP_ACC.1[SFR] with reference to the Access Control Policies
                        defined in FDP_ACF.1[MEM] and FDP_ACF.1[SFR]. Therefore, these security functional
                        requirements support the secure implementation and operation of FCS_COP.1[TDES],
                        FCS_CKM.4[TDES], FCS_COP.1[AES], FCS_CKM.4[AES] and of FDP_ACC.1 with
                        FDP_ACF.1 as well as the dependent security functional requirements.
                        A hardware platform including the IC Dedicated Software requires Security IC Embedded
                        Software to build a secure product. Thereby the Security IC Embedded Software must
                        support the security functionality of the hardware as well as the IC Dedicated Support
                        Software and implement a sufficient management of the security services implemented
                        by the hardware platform including the IC Dedicated Software. The realisation of the
                        Security Functional Requirements within the P6022y VB provides a good balance
                        between flexible configuration and restrictions to ensure a secure behaviour of the
                        P6022y VB.




P6022y VB                              All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                    Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                        75 / 101
NXP Semiconductors
                                                                                                                     P6022y VB
                                                                                                                     Security Target Lite


7       TOE Summary Specification
                        This chapter is composed of sections “Portions of the TOE Security Functionality” and
                        “TOE Summary Specification Rationale”.


                 7.1 Portions of the TOE Security Functionality
                        The TOE Security Functionality (TSF) directly corresponds to the TOE security functional
                        requirements defined in Section 6. The Security Functionality provided by the TOE
                        P6022y VB is split into Security Services (SS) and Security Features (SF). Both are
                        active and applicable to phases 4 to 7 of the Security IC product life-cycle.
                        Note: Parts of the security functionality are configured at the end of phase 3 and all
                        security functionality is active after phase 3 or phase 4 depending on the delivery form.
                        The TOE also comprises security mechanisms, which are not listed as security
                        functionality in the following. Such mechanisms do not implement a complete Security
                        Services or Security Features. They can be used to implement further Security Services
                        and/or Security Features based on Security IC Embedded Software using these security
                        mechanisms, e.g. the Fame2 coprocessor for asymmetric cryptographic algorithms.


               7.1.1 Security Services of the TOE

              7.1.1.1   NXP Secure Smart Card Controller P6022y VB
                        SS.RNG: Random Number Generator
                        The Random Number Generator continuously produces random numbers with a
                        length of one byte. The P6022y VB implements SS.RNG by means of a physical
                        hardware Random Number Generator working stable within the valid ranges of operating
                        conditions, which are guaranteed by SF.OPC.
                        The TSF provides a hardware test functionality, which can be used by the Security
                        IC Embedded Software to hardware detects or bad quality of the produced random
                        numbers.
                        According to AIS31 [7] the Random Number Generator claims the functionality class
                        PTG2. This means that the Random Number Generator is suitable for generation of
                        signature key pairs, generation of session keys for symmetric encryption mechanisms,
                        random padding bits, zero-knowledge proofs, the generation of seeds for DRNGs and
                        fulfils the online test requirements defined in [7].
                        SS.TDES: Triple-DES coprocessor
                        The P6022y VB provides the Triple Data Encryption Standard (Triple-DES) according
                        to the Data Encryption Standard (DES) [23]. SS.TDES is a modular basic cryptographic
                        function, which provides the Triple-DES algorithm as defined by NIST SP 800-67 [23]
                        by means of a hardware coprocessor and supports (a) the 3-key Triple-DES algorithm
                        according to keying option 1 and (b) the 2-key Triple-DES algorithm according to keying
                        option 2 in NIST SP 800-67 [23]. The two/three 56-bit keys (112-/168-bit) for the 2-key/3-
                        key Triple-DES algorithm shall be provided by the Security IC Embedded Software.
                        SS.TDES also supports hardware XOR-operation of two data blocks to support chaining
                        modes of the encryption of Triple-DES if this is configured by the Security IC Embedded


P6022y VB                               All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                     Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                         76 / 101
NXP Semiconductors
                                                                                                                    P6022y VB
                                                                                                                    Security Target Lite


                        Software. Note that the hardware support for the CBC mode of SS.TDES is limited to
                        encryption.
                        SS.AES: AES coprocessor
                        The P6022y VB provides the Advanced Encryption Standard (AES) algorithm according
                        to the Advanced Encryption Standard as defined by FIPS PUB 197 [20]. SS.AES is a
                        modular basic cryptographic function, which provides the AES algorithm by means of a
                        hardware coprocessor and supports the AES algorithm with three different key lengths of
                        128, 192 or 256 bit. The keys for the AES algorithm shall be provided by the Security IC
                        Embedded Software.
                        SS.AES also supports hardware XOR-operation of two data blocks to support chaining
                        modes of the encryption of AES if this is configured by the Security IC Embedded
                        Software. Note that the hardware support for the CBC mode of SS.AES is limited to
                        encryption.
                        SS.RECONFIG: Post Delivery Configuration
                        SS.RECONFIG realizes the Post Delivery Configuration. The Hardware Post Delivery
                        Configuration can be used by the customer to set the accessible size of the EEPROM
                        and CXRAM and to enable or disable the Fame2 coprocessor, the AES coprocessor
                        and the contactless interface. The configuration values of the Hardware Post Delivery
                        Configuration options are stored in a special area in the Security Row (see SF.COMP).
                        Note that if the Fame2 coprocessor and the AES coprocessor are disabled, both will no
                        longer be available to the Security IC Embedded Software and attempting to use it will
                        raise an exception. This means the availability of SS.AES is configurable.
                        The customer can change the values of Hardware Post Delivery Configuration through
                        invoking the Hardware Post Delivery Configuration functionality in Firmware Operating
                        System (see SF.MEM_ACC). This functionality is invoked by using the FVEC interface
                        (FVEC0.15).
                        The customer can change these values as many times as he wishes. However, once he
                        calls this Firmware Operating System using FVEC0.15 with a certain parameter set to a
                        specific value, the options are locked permanently, and can no longer be changed. The
                        options must be locked before the P6022y VB is delivered to the customer before phase
                        7 of the Security IC product life-cycle.


               7.1.2 Security Features
                        In this section, the security features of the TOE P6022y VB are described.


              7.1.2.1   NXP Secure Smart Card Controller P6022y VB
                        SF.OPC: Control of Operating Conditions
                        SF.OPC ensures correct operation of the P6022y VB (functions offered by the
                        microcontroller including the standard CPU as well as the Triple-DES coprocessor, AES
                        coprocessor, the arithmetic coprocessor, the memories, registers, I/O interfaces and the
                        other system peripherals) during execution of the IC Dedicated Support Software and
                        Security IC Embedded Software. This includes all security mechanisms of the P6022y
                        VB, which directly contribute to a Security Service or a Security Feature.
                        The P6022y VB ensures its correct operation and prevents any malfunction using the
                        following mechanisms: filtering of power supply, clock frequency and reset input as well
                        as monitoring of voltage supply, clock frequency input and the temperature of the chip
P6022y VB                              All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                    Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                        77 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      by means of sensors. There are multiple voltage and frequency sensors for the different
                      ISO/IEC 7816 voltage classes and the contactless operation mode. Light sensors are
                      distributed over the chip surface and used to detect light attacks. In addition to the light
                      sensors the EEPROM provides two functions to detect light attacks. The Security IC
                      Embedded Software can enable/disable the EEPROM double read function.
                      Specific functional units of the P6022y VB are equipped with further fault injection
                      detection. This comprises the Secure Fetch for the processing of code and data by the
                      CPU or special circuitry within a functional unit. The functional units are the Program
                      Counter, the stack pointer, the CPU control register, the MMU address cache and control
                      registers, the SBC interface for the Triple-DES and the AES coprocessors, the Fame2
                      coprocessor, Copy Machine control registers and hardware configuration as well as test
                      control registers. Furthermore the P6022y VB contains a watchdog timer which can be
                      enabled and configured by the Security IC Embedded Software to protect the program
                      execution.
                      If one of the monitored parameters is out of the specified range, either (i) a reset is forced
                      and the actually running program is aborted or (ii) an exception is raised which interrupts
                      the program flow and allows a reaction of the Security IC Embedded Software. In case
                      minor configuration option “Inverse EEPROM Error Correction” is enabled (see Section
                      1.4.2.2) the probability to detect fault injection attack detectors at the EEPROM memory
                      and interface increases and the error correction logic raises an exception when detecting
                      an error. The RAM memory is equipped with additional parity bits which are checked
                      when the corresponding data stored in RAM is read. Additionally a RAM parity watchdog
                      mechanism is supported which checks the parity bits of the complete RAM in random
                      order when the Security IC Embedded Software is not accessing the RAM. In case of
                      detected RAM parity attack detectors both mechanisms trigger a security reset. In case
                      the P6022y VB processes a reset all components of the P6022y VB are initialised with
                      their reset values and the P6022y VB provides a reset cause indicator to the Security IC
                      Embedded Software. In the case an exception is raised an indicator for the reason of the
                      exception is provided. The P6022y VB defends the sensors from being disabled by the
                      Security IC Embedded Software.
                      The P6022y VB controls the specified range of the stack pointer. The stack pointer and
                      the related control logic are implemented threefold for the User Mode, System Mode
                      and Super System Mode (comprising Boot Mode, Test Mode and Firmware Mode). An
                      exception is generated in case the specified limits are exceeded.
                      In addition, SF.OPC comprises a sensor, which checks the high voltage of the write
                      process to the EEPROM during each write sequence. The result of this sensor must
                      be read from a Special Function Register and does not force an automatic event (e.g.
                      exception).
                      SF.PHY: Protection against Physical Manipulation
                      SF.PHY protects the P6022y VB against manipulation of (i) the IC hardware, (ii) the
                      IC Dedicated Software in ROM, (iii) the Security IC Embedded Software in ROM and
                      EEPROM, (iv) the Application Data in EEPROM and RAM including TSF data in the
                      Security Rows. It also protects User Data and TSF data against disclosure by physical
                      probing when stored or while being processed by the P6022y VB.
                      The protection of the P6022y VB comprises several security mechanisms in design and
                      construction, which make reverse-engineering and tamper attacks more difficult. These
                      mechanisms comprise dedicated shielding techniques for the P6022y VB and specific
                      encryption- and check mechanisms for the memories and internal buses. SF.PHY
                      supports the efficiency of other portions of the security functionality.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       78 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.PHY also supports the integrity of the EEPROM, RAM and the ROM. The EEPROM
                      is able to correct a 1-bit error within each byte. The EEPROM corrects these attack
                      detectors automatically without user interaction. The RAM and the ROM provide a parity
                      check. In both cases a reset is forced based on a parity error.
                      The CRC coprocessor is used in Boot Mode by the IC dedicated Software for calculation
                      of a CRC checksum for integrity protection of TSF data.
                      SF.PUF: User Data Protection using PUF
                      SF.PUF implements a mechanism to seal/unseal the user data stored in shared
                      memory against unintended disclosure. SF.PUF encrypts/decrypts the user data with
                      a cryptographic key derived from the PUF data. SF.PUF calculates a MAC as a PUF
                      authentication value. SF.PUF provides this sealing/unsealing mechanism through the
                      specified interfaces FVEC2 (see Fig. 2) only.
                      SF.LOG: Logical Protection
                      SF.LOG implements security mechanisms to limit or eliminate the information in the
                      shape and amplitude of signals or in the time between events, which might be found by
                      measuring such signals. This comprises the power supply, signals on other pads, which
                      are not intentionally used for communication by the terminal or the Security IC Embedded
                      Software as well as emanation of the hardware platform. Thereby SF.LOG prevents from
                      disclosure of User Data and TSF data stored and/or processed in the Security IC through
                      measurement of power consumption or emanation and subsequent complex signal
                      analysis. This protection of the P6022y VB is enforced by several security mechanisms in
                      the design, which support these portions of security functionality.
                      The Triple-DES coprocessor includes specific security mechanisms to prevent SPA/
                      DPA analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the Triple-DES coprocessor further ensures that the calculation time is
                      independent from the chosen key value and plain/cipher text.
                      The AES coprocessor includes specific security mechanisms to prevent SPA/DPA
                      analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the AES coprocessor further ensures that the calculation time is
                      independent from the chosen key any plain/cipher text for a given key length.
                      The Fame2 coprocessor provides measures to prevent timing attacks on basic modular
                      function. The calculation time of an operation depends on the lengths of the operands,
                      but not on the value of the operands, with the following exceptions: multiplication with
                      reduction, modular inversion and modular division. These three operations have no
                      constant timing due to correction cycles that are needed based on the calculation
                      method. In addition, mechanisms are included, which provide limitations of the capability
                      for the analysis of shape and amplitude of the power consumption. Of course the Fame2
                      coprocessor does not realise an algorithm on its own and algorithm-specific leakage
                      countermeasures have to be added by the Security IC Embedded Software when using
                      the Fame2 coprocessor.
                      Additional security mechanisms can be configured by the Security IC Embedded
                      Software. This comprises the configuration of the clock that can be used to prevent the
                      synchronisation between internal operations and external clock or characteristics of the
                      power consumption that can be used as trigger signal to support leakage attacks (DPA or
                      timing attacks)
                      Some mechanisms described for SF.PHY (e.g. the encryption mechanisms) and for
                      SF.OPC (e.g. the filter mechanisms) support SF.LOG.
                      SF.COMP: Protection of Mode Control
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      79 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      SF.COMP provides control of the CPU mode for (i) Boot Mode, (ii) Test Mode and
                      (iii) Firmware Mode. This includes protection of electronic fuses stored in a protected
                      memory area, the so-called Security Rows, and the possibility to store initialisation or
                      pre-personalisation data in the so-called FabKey Area.
                      Control of the CPU mode for Boot Mode, Test Mode and Firmware Mode prevents abuse
                      of test functions after TOE delivery. It also inhibits abuse of features, which are used
                      during start-up or reset to configure the P6022y VB.
                      The integrity control of electronic fuses ensures secure storage and setup of
                      configuration and calibration data, during the start-up in Boot Mode. The protection
                      of electronic fuses especially ensures that configuration options with regard to the
                      security functionality cannot be changed, abused or influenced in any way. The transfer
                      of the content of the electronic fuses into the related hardware configuration registers
                      is protected by a CRC checksum generated using the CRC coprocessor. SF.COMP
                      ensures that activation or deactivation of security mechanisms cannot be influenced by
                      the Security IC Embedded Software so that the TSF provides self-protection against
                      interference and tampering by untrusted Security IC Embedded Software.
                      SF.COMP protects CPU mode switches regarding Boot Mode, Test Mode and Firmware
                      Mode in the following way: Switching from Boot Mode to Test Mode or Firmware Mode is
                      allowed, switching from these modes back to Boot Mode is prevented. Switching to Test
                      Mode is prevented as well after TOE delivery, because Test Mode then is permanently
                      disabled. SF.COMP also ensures that Boot Mode is active only in the boot phase during
                      start-up or reset of the P6022y VB, and cannot be invoked afterwards. Therefore, once
                      the P6022y VB has left the test phase and each time the P6022y VB completed start-up
                      or reset, Firmware Mode is the only Super System Mode available.
                      The TSF controls access to the Security Rows, the top-most 512 Bytes of the EEPROM
                      memory, accessible at reserved addresses in the memory map. The available EEPROM
                      memory space for the Security IC Embedded Software is reduced by this area.
                      SF.COMP provides three memory areas in the Security Rows, which can be used by the
                      Security IC Embedded Software. These are
                      • the User Read Only Area
                      • the User Write Protected Area and
                      • the User Write Once Area.
                      The User Read Only Area contains 32 bytes, which are read-only for the Security IC
                      Embedded Software. The User Write Protected area contains 16 bytes, which can be
                      write-protected by the Security IC Embedded Software on demand. The User Write Once
                      Area contains 32 bytes of which each bit can separately be set to ‘1’ once only, and not
                      reset to ‘0’.
                      SF.COMP also provides a memory area in the Security Row where the current values
                      for the Post Delivery Configuration (see SS.RECONFIG). This area cannot be accessed
                      by the Security IC Embedded Software, but it can be accessed by the Resource
                      Configuration Firmware.
                      If minor configuration option “Card Disable” feature is used (refer to section 1.4.2.2)
                      SF.COMP inhibits any start-up of the Security IC Embedded Software once the Security
                      IC Embedded Software disables the card.
                      If minor configuration option “EEPROM application content erase” is used (see Section
                      1.4.2.2) SF.COMP erases the application data stored in the EEPROM once the Security
                      IC Embedded Software has activated this security feature.


P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       80 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.COMP also provides the FabKey Area where initialisation and identification data can
                      be stored. The FabKey area does not belong to the Security Rows and is not protected
                      by hardware mechanisms. The FabKey Area as well as the Security Rows can be used
                      by SF.COMP to store a unique identification for each die.
                      The complete EEPROM is initialized during wafer testing and pre-personalisation. The
                      values for the Security Row depend on the configuration options and choice of the
                      Security IC Embedded Software developer. The values for the application EEPROM
                      depend on the choice of the Security IC Embedded Software developer and are
                      included in the Order Entry Form. The User Write Protected Area and the User Write
                      Once Area are designed to store the identification of a (fully personalised) Security IC
                      (e.g. smartcard) or a sequence of events over the life-cycle, that can be coded by an
                      increasing number of bits set to "one" or protecting bytes, respectively.
                      SF.COMP limits the capabilities of the test functions and provides test personnel during
                      phase 3 with the capability to store identification and/or pre-personalisation data and/or
                      supplements of the Security IC Embedded Software in the EEPROM. SF.COMP provides
                      self-protection against interference and tampering by untrusted subjects both in the Test
                      Mode and in the other modes. It also enforces the separation of domains regarding the
                      IC Dedicated Software and the Security IC Embedded Software.
                      SF.MEM_ACC: Memory Access Control
                      SF.MEM_ACC controls access of any subject (program code comprising processor
                      instructions) to the memories of the P6022y VB through the Memory Management Unit.
                      Memory access is based on virtual addresses that are mapped to physical addresses.
                      The CPU always uses virtual addresses. The Memory Management Unit performs the
                      translation from virtual to physical addresses and the physical addresses are passed
                      from the Memory Management Unit to the memory interfaces to access the memories.
                      Access control is conducted in two ways:
                      • Memory partitioning: Each memory type ROM, RAM and EEPROM is partitioned into
                        two parts. In Boot Mode and Firmware Mode the CPU has access to the Firmware
                        EEPROM, Firmware RAM and Test-ROM. In System Mode and User Mode the CPU
                        has access to the Application EEPROM, Application RAM and Application ROM.
                        Access to both parts of each type is allowed in Test Mode for testing.
                      • Memory segmentation in User Mode: The three accessible parts of the memory in
                        ROM, RAM and EEPROM can be segmented into smaller memory areas. Access
                        rights (read/write or execute) can be defined for these segments. The operation read
                        and write are considered as one kind of operation, if one is allowed, so is the other.
                        However, in general the access to a segment can be denied.
                        In addition, access rights to Special Function Registers related to hardware
                        components can be defined for code executed in User Mode.
                      Memory partitioning is fixed and cannot be changed. It is determined during
                      production of the P6022y VB and is solely dependent on the major configuration (see
                      Section 1.4.2.1.1) and Post Delivery Configuration (see Section 1.4.2.3.1).
                      Memory segmentation can be defined in System Mode. The segmentation is active when
                      the CPU switches to User Mode. The segments, their access rights and the access
                      rights to Special Function Registers related to hardware components are defined in the
                      MMU Segment Table. The MMU Segment Table stores five values for each segment:
                      The memory access rights, the virtual start address of the segment, the virtual end
                      address of the segment, the address offset for the segment and the access rights to
                      Special Function Registers for code that is executed in the segment. The address offset
                      is used to relocate the segment anywhere in the memory map. The resulting address
                      computed by the Memory Management Unit can not overrule memory partitioning. Up
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      81 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      to 64 segments can be defined in the MMU Segment Table. Special configurations of
                      the memory access rights allow to specify less than 64 segments and to split the MMU
                      Segment Table into several parts being stored at different locations in memory.
                      Note that the MMU Segment Table itself is stored in the memory and therefore the table
                      itself can be placed in a segment accessible in User Mode.
                      In addition, SF.MEM_ACC permanently checks whether accessed addresses point to
                      physically implemented memory. Any access outside the boundaries of the physical
                      implemented memory in all CPU modes except the Test Mode and access to forbidden
                      memory addresses in User Mode are notified by raising an exception.
                      The Memory Management Unit also handles access rights to Special Function Registers
                      related to hardware components for code running in Firmware Mode. The configuration
                      of the access rights for User Mode and Firmware Mode are used by SF.SFR_ACC to
                      grant or block access to the related Special Function Registers. The access rights can
                      be defined for up to 16 groups of Special Function Registers, which are related to 16
                      hardware peripherals or memories described in [9], section 12.4. Thus, User Mode
                      and Firmware Mode can be restricted in their access to the Special Function Registers
                      related to hardware components on demand of the Security IC Embedded Software.
                      Note that SF.MEM_ACC only provides the access rights to SF.SFR_ACC, the access
                      control is enforced by SF.SFR_ACC.
                      SF.SFR_ACC: Special Function Register Access Control
                      SF.SFR_ACC controls access to the Special Function Registers and CPU mode
                      switches based on specific Special Function Register. SF.SFR_ACC implements access
                      control to the Special Function Registers as specified in the Access Control Policy and
                      the Security Functional Requirements FDP_ACC.1[SFR] and FDP_ACF.1[SFR].
                      The function of the Special Function Register and the CPU mode determine, whether
                      read and/or write access to a Special Function Register is allowed or not. Key registers
                      cannot be read since they are write-only to support the confidentiality of keys. Write
                      access is granted depending on the CPU mode. Similar for the output register of the
                      Random Number Generator, which is read-only based on its function, and read access is
                      granted based on the CPU mode.
                      SF.SFR_ACC controls accesses to Special Function Registers. If the access is not
                      allowed or the Special Function Register addressed by the code is not implemented an
                      exception is triggered. The Security IC Embedded Software can react on this exception.
                      Some Special Function Registers are implemented threefold, one for User Mode, a
                      second one for System Mode and a third one for Super System Mode meaning Boot
                      Mode, Test Mode and Firmware Mode. Hence, such Special Function Registers are
                      inherently separated and enforce the separation between the CPU modes.
                      SF.SFR_ACC relies on access rights to Special Function Registers related to hardware
                      components, which are provided by SF.MEM_ACC. Access rights to all other Special
                      Function Registers are pre-defined and cannot be configured by the code running on the
                      hardware platform.
                      This implies that code running in User Mode or Firmware Mode is not able to use
                      SS.RNG, SS.TDES, and SS.AES until access to the respective group of Special Function
                      Registers is explicitly granted by code running in System Mode. This holds for all 16
                      hardware components, which are controlled by the 16 groups of Special Function
                      Registers related to hardware components.
                      SF.SFR_ACC also implements transitions among CPU modes based on specific Special
                      Function Register.
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      82 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      The CPU mode changes by the following operations.
                      • Call of a system call vector (SVEC) address or a firmware vector (FVEC) address. A
                        call of a SVEC enables System Mode, a call of a FVEC sets enables Firmware Mode.
                        Calls of SVEC addresses are allowed in User Mode only, otherwise an exception is
                        raised.
                      • Execution of an exception or interrupt. Any event that leads to the execution of an
                        exception leads to a special status of the related CPU mode. Any further exception in
                        this special status forces a reset. Interrupts can be executed in User Mode or in System
                        Mode as well as in Firmware Mode. The Security IC Embedded Software running in
                        System Mode can configure this option at run time.
                      • Return from an exception/interrupt or vector call with a RETI instruction. This restores
                        the CPU mode before the event occurred. A RETI in User Mode is allowed only in case
                        interrupts are allowed to be executed in User Mode and an interrupt is actually active,
                        otherwise an exception is raised.
                      • Execution of an LCALL/ACALL/ECALL instruction to a specific address. A call of
                        address 0x800000 in System Mode enables User Mode and starts execution at this
                        (virtual) address. This is similar to a FVEC or SVEC call, but no return address is
                        pushed onto the stack.
                      • Direct modification of the specific Special Function Register. Hardware provided by
                        SF.SFR_ACC ensures that the bits can only be cleared. Therefore it is not possible
                        for code running in User Mode to enter System Mode, but System Mode can switch to
                        User Mode.
                      Two CPU modes are available to the Security IC Embedded Software, which are System
                      Mode and User Mode. System Mode is the more privileged CPU mode since it allows
                      access to all Special Function Registers related to hardware components and for system
                      management (i.e. configuration of Memory Management Unit, clock settings and some
                      mechanisms provided by SF.LOG). User Mode is the less privileged, but in regard to
                      hardware components it can be made as powerful as System Mode.
                      SF.SFR_ACC and SF.COMP together ensure that other CPU modes are not available
                      to the Security IC Embedded Software, but reserved for specific purposes fulfilled by the
                      IC Dedicated Software. As described above, SF.MEM_ACC provides the access control
                      information to Special Function Registers related to hardware components in Firmware
                      Mode and User Mode.
                      SF.FFW: Firmware Firewall
                      SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                      data of the different firmware applications (NXP firmware functionality) running in
                      Firmware Mode by means of a firewall separating the application data between each
                      other. The firewall mechanism is based on the security features SF.MEM_ACC and
                      SF.SFR_ACC.
                      SF.FIRMWARE: Firmware Support
                      SF.FIRMWARE (Firmware Operating System) implements specific basic support
                      functionality for the Security IC Embedded Software. The basic support functionality is
                      implemented in a way that the protection and separation of the different type of User
                      Data is enforced. The security feature SF.FIRMWARE is based on the security features
                      SF.MEM_ACC, SF.SFR_ACC and SF.FFW.




P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      83 / 101
NXP Semiconductors
                                                                                                                        P6022y VB
                                                                                                                        Security Target Lite



              7.1.2.2 NXP Secure Smart Card Controller P6022M VB/P6022D VB/P6022J VB
                        The security features of the P6022M VB/P6022D VB/P6022J VB include the security
                        features of the P6022P VB/P6022X VB, except for SF.FFW and SF.FIRMWARE. The
                        security features SF.FFW and SF.FIRMWARE of the P6022M VB/P6022D VB/P6022J
                        VB are described in this section.
                        SF.FFW: Firmware Firewall
                        SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                        data of the different firmware applications (NXP firmware functionality and MIFARE
                        Software) runni                                                                         - Applet ROM masking added.




© IDEMIA. All rights reserved.




Specifications and information are subject to change without notice.

The products described in this document are subject to continuous development and improvement.

All trademarks and service marks referred to herein, whether registered or not in specific countries, are the properties of their respective owners.




                                                      - Printed versions of this document are uncontrolled -
                                    Security Target Lite
                                                                                                                  Ref.:
                             IDeal Pass v2.3-n JC with Privacy
                                                                                                            2018_2000036361
                             Protection (SAC/EAC/Polymorphic
                                                                                                               Page: 3/150
                                   eMRTD Configuration)

Table of Contents

 TABLE OF CONTENTS ....................................................................................................... 3

 TABLE OF FIGURES .......................................................................................................... 6

 TABLE OF TABLES ............................................................................................................. 7

 1            ST INTRODUCTION ............................................................................................... 8
     1.1    ST IDENTIFICATION .......................................................................................................... 8
     1.2    TOE REFERENCE .............................................................................................................. 9
     1.3    TOE OVERVIEW............................................................................................................... 9
     1.4    TOE DESCRIPTION ..........................................................................................................11
       1.4.1    TOE Definition ......................................................................................................11
       1.4.2    TOE usage and security features for operational use ...............................................12
       1.4.3    TOE life cycle ........................................................................................................17
 2            CONFORMANCE CLAIMS ..................................................................................... 24
     2.1    CC CONFORMANCE CLAIM .................................................................................................24
     2.2    PP CLAIM ......................................................................................................................24
     2.3    PACKAGE CLAIM ..............................................................................................................25
     2.4    PP CONFORMANCE RATIONALE ...........................................................................................25
       2.4.1    Main aspects .........................................................................................................25
       2.4.2    Overview of differences between the PP and the ST ................................................25
 3            SECURITY PROBLEM DEFINITION ..................................................................... 27
     3.1    ASSETS .........................................................................................................................27
       3.1.1    Primary Assets travel document .............................................................................27
       3.1.2    Secondary Assets travel document .........................................................................28
       3.1.3    Additionals Assets .................................................................................................29
       3.1.4    Assets related to Polymorphic eMRTD ....................................................................29
     3.2    USERS / SUBJECTS...........................................................................................................30
       3.2.1    Subjects listed in PP PACE .....................................................................................30
       3.2.2    Additional Subjects ................................................................................................32
       3.2.3    Subjects related to Polymorphic eMRTD .................................................................33
     3.3    THREATS .......................................................................................................................36
       3.3.1    Threats listed in PP PACE .......................................................................................36
       3.3.2    Additional Threats .................................................................................................38
       3.3.3    Threats related to Polymorphic eMRTD ...................................................................39
     3.4    ORGANISATIONAL SECURITY POLICIES ..................................................................................40
       3.4.1    OSP listed in PP PACE ............................................................................................41
       3.4.2    Additional OSPs from PP EAC .................................................................................42
       3.4.3    OSPs related to Polymorphic eMRTD ......................................................................43
     3.5    ASSUMPTIONS ................................................................................................................45
       3.5.1    Assumptions listed in PP PACE ...............................................................................45
       3.5.2    Assumptions listed in PP EAC .................................................................................45
       3.5.3    Assumptions related to Active Authentication ..........................................................46
       3.5.4    Assumptions related to Polymorphic eMRTD ...........................................................46
 4            SECURITY OBJECTIVES ...................................................................................... 50
     4.1    SECURITY OBJECTIVES FOR THE TOE ...................................................................................50
       4.1.1    Security Objectives listed in PP PACE ......................................................................50
       4.1.2    Additional Security Objectives from PP EAC ............................................................52
                                   Security Target Lite
                                                                                                              Ref.:
                            IDeal Pass v2.3-n JC with Privacy
                                                                                                        2018_2000036361
                            Protection (SAC/EAC/Polymorphic
                                                                                                           Page: 4/150
                                  eMRTD Configuration)

      4.1.3    Security Objectives related to Polymorphic eMRTD ..................................................53
    4.2    SECURITY OBJECTIVES FOR THE OPERATIONAL ENVIRONMENT ....................................................55
      4.2.1    Issuing State or Organisation .................................................................................55
      4.2.2    Travel document Issuer and CSCA: travel document PKI (issuing) branch ................56
      4.2.3    Terminal operator: Terminal receiving branch .........................................................57
      4.2.4    Travel document holder Obligations .......................................................................58
      4.2.5    Receiving State or Organisation .............................................................................58
      4.2.6    Oes related to Polymorphic eMRTD ........................................................................60
    4.3    SECURITY OBJECTIVES RATIONALE ......................................................................................63
      4.3.1    Threats ................................................................................................................63
      4.3.2    Organisational Security Policies ..............................................................................67
      4.3.3    Assumptions .........................................................................................................69
      4.3.4    SPD and Security Objectives ..................................................................................71
5           EXTENDED REQUIREMENTS ............................................................................... 76
    5.1     DEFINITION OF THE FAMILY FAU_SAS .................................................................................76
    5.2     DEFINITION OF THE FAMILY FCS_RND ................................................................................76
    5.3     DEFINITION OF THE FAMILY FIA_API ..................................................................................77
    5.4     DEFINITION OF THE FAMILY FMT_LIM .................................................................................78
    5.5     DEFINITION OF THE FAMILY FPT_EMS .................................................................................80
6           SECURITY REQUIREMENTS ................................................................................ 81
    6.1    SECURITY FUNCTIONAL REQUIREMENTS ................................................................................81
      6.1.1    Class Cryptographic Support (FCS) .........................................................................83
      6.1.2    Class FIA Identification and Authentication .............................................................87
      6.1.3    Class FDP User Data Protection ..............................................................................95
      6.1.4    Class FTP Trusted Path/Channels ......................................................................... 100
      6.1.5    Class FAU Security Audit ...................................................................................... 101
      6.1.6    Class FMT Security Management .......................................................................... 101
      6.1.7    Class FPT Protection of the Security Functions ...................................................... 107
      6.1.8    Class FPR ........................................................................................................... 109
    6.2    SECURITY ASSURANCE REQUIREMENTS................................................................................ 110
    6.3    SECURITY REQUIREMENTS RATIONALE ................................................................................ 110
      6.3.1    Security Objectives for the TOE ........................................................................... 110
      6.3.2    Rationale tables of Security Objectives and SFRs................................................... 115
      6.3.3    Dependencies ..................................................................................................... 119
      6.3.4    Rationale for the Security Assurance Requirements ............................................... 122
      6.3.5    AVA_VAN.5 Advanced methodical vulnerability analysis ......................................... 123
      6.3.6    ALC_DVS.2 Sufficiency of security measures ......................................................... 123
7           TOE SUMMARY SPECIFICATION ....................................................................... 124
    7.1    TOE SUMMARY SPECIFICATION ......................................................................................... 124
      7.1.1    SF.IA Identification and Authentication ................................................................. 124
      7.1.2    SF.CF Cryptographic functions support ................................................................. 125
      7.1.3    SF.ILTB Protection against interference, logical tampering and bypass ................... 125
      7.1.4    SF.AC Access control / Storage and protection of logical travel document data ....... 126
      7.1.5    SF.SM Secure Messaging ..................................................................................... 126
      7.1.6    SF.LCM Security and life cycle management ......................................................... 126
    7.2    SFRS AND TSS............................................................................................................. 129
      7.2.1    SFRs and TSS - Rationale .................................................................................... 129
8           ANNEX .............................................................................................................. 138

GLOSSARY .................................................................................................................... 138
                               Security Target Lite
                                                                                                      Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                                2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                                   Page: 5/150
                              eMRTD Configuration)

ABBREVIATIONS .......................................................................................................... 149

REFERENCES ................................................................................................................ 149
                                Security Target Lite
                                                                                                Ref.:
                         IDeal Pass v2.3-n JC with Privacy
                                                                                          2018_2000036361
                         Protection (SAC/EAC/Polymorphic
                                                                                             Page: 6/150
                               eMRTD Configuration)

Table of figures
Figure 1: TOE ......................................................................................................12
Figure 2: TOE life-cycle .........................................................................................18
                                Security Target Lite
                                                                                                Ref.:
                         IDeal Pass v2.3-n JC with Privacy
                                                                                          2018_2000036361
                         Protection (SAC/EAC/Polymorphic
                                                                                             Page: 7/150
                               eMRTD Configuration)


Table of tables
Table 1 Threats and Security Objectives - Coverage .................................................71
Table 2 Security Objectives and Threats - Coverage .................................................72
Table 3 OSPs and Security Objectives - Coverage ....................................................73
Table 4 Security Objectives and OSPs - Coverage ....................................................74
Table 5 Assumptions and Security Objectives for the Operational Environment -
    Coverage .......................................................................................................75
Table 6 Security Objectives for the Operational Environment and Assumptions -
    Coverage .......................................................................................................75
Table 7 Security Objectives and SFRs - Coverage .................................................. 118
Table 8 SFRs Dependencies ................................................................................ 121
Table 9 SARs Dependencies ................................................................................ 122
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                 Page: 8/150
                       eMRTD Configuration)

1 ST Introduction
The aim of this document is to describe the Security Target for IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration), the
Machine Readable Travel Document (MRTD) with the ICAO application, Password
Authenticated Connection Establishment (covering PACE-GM, PACE-IM and PACE-
CAM), Extended Access Control and Polymorphic eMRTD on NXP JCOP 3 P60.

1.1 ST Identification
                Security Target Lite IDeal Pass v2.3-n JC with Privacy
Title
                Protection (SAC/EAC/Polymorphic eMRTD Configuration)
Reference       2018_2000036361
Version         1.1
Certification
                NSCIB
Body
Author          IDEMIA
CC Version      3.1 Revision 5
Assurance
                EAL5 augmented with ALC_DVS.2 and AVA_VAN.5
Level
                Protection Profile Machine Readable Travel Document with ICAO
                Application, Extended Access Control with PACE (EAC PP) BSI-
                CC-PP-0056-V2-2012, Version 1.3.2, 5th December 2012 [EAC-
Protection      PP-V2]
Profiles
                Protection Profile Machine Readable Travel Document using
                Standard Inspection Procedure with PACE, BSI-CC-PP-0068-V2-
                MA-01, Version 1.0.1, 22 July 2014, BSI [PACE-PP].
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 9/150
                        eMRTD Configuration)

1.2 TOE Reference
                 IDeal Pass v2.3-n JC with Privacy Protection
TOE name
                 (SAC/EAC/Polymorphic eMRTD Configuration)
TOE              7126-9301-0311 for applet loaded in EEPROM
identification   7126-9301-0319 for applet loaded in ROM
TOE version      v2.3.0.14
Name of          NXP JCOP 3 P60 certified by the Dutch NSCIB certification body
Platform         (CC-18-98209/2) on 29-11-2018
                 Platform ID: “JxHyyy0019790400” (SVN 6521; “OSB RC9”)
Platform
                 Patch ID: 00 00 00 00 00 00 00 00 (no patch)
identification
                           04 00 00 00 00 00 00 00 (PL4)
                 NXP Secure Smart Card Controller P6022y VB including IC
IC reference     Dedicated Software certified by the German BSI certification
                 body (BSI-DSZ-CC-1059-2018) on 18-05-2018
Crypto Lib       Crypto Library V3.1.x on P6022y VB certified by the Dutch
reference        NSCIB certification body (CC-18-67206) on 31-05-2018



1.3 TOE Overview
The Security Target (ST) defines the security objectives and requirements for a
contact or contactless based chip of machine readable travel documents (MRTD)
based on the requirements and recommendations of the International Civil
Aviation Organization (ICAO), EU requirements for biometric European passport
(Council Regulation (EC) No 2252/2004 and Commission Implementing Decision
6181) and Biometric European Resident Permit (REGULATION (EU) 2017/1954
and Commission Implementing Decision 6178). This product is intended to
enable verification of the authenticity of the travel document and to identify its
holder during a border control, using an inspection system. The verification
process is based on Extended Access Control with Password Authenticated
Connection Establishment (PACE) and optionally Active Authentication (AA).

The main features and their origin are the following:
 Password Authenticated Connection Establishment (PACE)
   according to ICAO Technical Report “Supplemental Access Control” [ICAO-
   9303] part 11 and strictly conform to BSI-CC-PP-0068-V2 [PACE-PP] for
   protection of the communication between terminal and chip. The following
   PACE mapping modes are supported and covered by the TOE:
      o    Generic Mapping (PACE-GM)
      o    Integrated Mapping (PACE-IM)
      o    Chip Authentication Mapping (PACE-CAM), which combines PACE-GM
           with Chip Authentication into a single protocol.
                         Security Target Lite
                                                                       Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 10/150
                        eMRTD Configuration)

   Chip Authentication v1
    according to BSI TR-03110 parts 1 and 3 [TR-03110-1], [TR-03110-3] and
    strictly conform to BSI-CC-PP-0056-V2-2012 [EAC-PP-V2], authenticates the
    travel document’s chip to the inspection system.
   Terminal Authentication v1
    according to BSI TR-03110 parts 1 and 3 [TR-03110-1], [TR-03110-3] and
    strictly conform to BSI-CC-PP-0056-V2-2012 [EAC-PP-V2], authenticates the
    inspection system to travel document’s chip and protects the confidentiality
    and integrity of the sensitive biometric reference data during their
    transmission from the TOE to the inspection system.

As a feature that can be optionally configured the TOE supports:
   Active Authentication
    which according to [ICAO-9303] prevents copying the SOD and proves that it
    has been read from the authentic chip. It proves that the chip has not been
    substituted.


   Polymorphic Authentication
    which according to [PCA-eMRTD] provides additional privacy by randomisation
    of returned Polymorphic Identities, Polymorphic Pseudonyms and
    Complementary Polymorphic ID attributes in combination with standard ICAO
    and EAC1 eMRTD protocols specified in ICAO Doc 9303 [ICAO-9303] and BSI
    TR-03110 parts 1 and 3 [TR-03110-1] and [TR 03110-3].

The TOE may also be used as an ISO driving license, compliant to ISO/IEC 18013
or ISO/IEC TR 19446 supporting PACE, AA and CA, as both applications (MRTD
and IDL) share the same protocols and data structure organization. Therefore, in
the rest of the document, the word “MRTD” MAY be understood either as a MRTD
in the sense of ICAO, or a driving license compliant to ISO/IEC 18013 or ISO/IEC
TR 19446 depending on the targeted usage envisioned by the issuer.

Application note
This TOE claims an assurance level EAL5 augmented with AVA_VAN.5 and
ALC_DVS.2. AVA_VAN.5 implies that the TOE is resistant to attacks performed by
an attacker possessing "High attack potential".
Not all key sizes specified in this security target have sufficient cryptographic
strength for satisfying the AVA_VAN.5 “high attack potential”. In order to be
protected against attackers with a "high attack potential", sufficiently large
cryptographic key sizes SHALL be configured for this TOE. References can be
found in national and international document standards. Further details have
been specified in the TOE’s guidance documentation [AGD_PRE].
                         Security Target Lite
                                                                   Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                               Page: 11/150
                        eMRTD Configuration)

1.4 TOE Description

1.4.1 TOE Definition
The Target of Evaluation (TOE) addressed by the current security target is an
electronic travel document representing a contactless / contact based smart card
or passport programmed according to Logical data structure (LDS) and protocols
specified in ICAO Doc 9303 [ICAO-9303] and additionally providing the Extended
Access Control according to BSI TR-03110 part 1 [TR-03110-1] and part 3 [TR-
03110-3] and Active Authentication according to [ICAO-9303]. The
communication between terminal and chip shall be protected by Password
Authenticated Connection Establishment (PACE), optionally with Chip
Authentication Mapping (PACE CAM) according to Electronic Passport using
Standard Inspection Procedure with PACE (PACE PP), BSI-CC-PP-0068-V2 [PACE-
PP]. Polymorphic eMRTD extensions are present on the TOE that enable secure
authentication with enhanced privacy protection features. It provides the holder
the possibility to authenticate towards a service provider in a non-traceable and
non-linkable manner thanks to usage of Polymorphic Pseudonyms and other
Polymorphic ID attributes.

The TOE (IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
eMRTD Configuration)) is composed of
    the NXP JCOP 3 P60, composed of
      o the circuitry of the MRTD’s chip (NXP Secure Smart Card Controller
         P6022y VB including IC Dedicated Software) with hardware for the
         contact and contactless interface;
       o   the Crypto Library V3.1.x on P6022y VB;
       o   the IC Embedded Software (operating system): NXP JCOP 3;
      The MRTD application IDeal Pass v2.3-n JC with Privacy Protection
       (SAC/EAC/Polymorphic eMRTD Configuration) loaded in ROM or in
       EEPROM;
      the associated guidance documentation in [AGD_PRE] and [AGD_OPE];
      the Personalisation Agent Key set.


The TOE utilizes the evaluation of NXP JCOP 3 P60 which has been certified by
the Dutch NSCIB certification body (CC-18-98209/2).

A schematic overview of the TOE is shown in Figure 1:
 The MRTD’s chip circuitry and the IC dedicated software forming the Smart
   Card Platform (Hardware Platform and Hardware Abstraction Layer);
 The IC embedded software running on the Smart Card Platform consisting of
      o Java Card virtual machine, ensuring language-level security;
      o Java Card runtime environment, providing additional security features
         for Java card technology enabled devices;
      o Java card API, providing access to card’s resources for the Applet;
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 12/150
                        eMRTD Configuration)

        o  Global Platform Card Manager, responsible for management of Applets
           on the card.
        o Mifare implementation can be enabled or disabled for this TOE.
        o Crypto Library.
    The Applet Layer is IDeal Pass v2.3-n JC with Privacy Protection
     (SAC/EAC/Polymorphic eMRTD Configuration) applet.




                                        Figure 1: TOE



1.4.2 TOE usage and security features for operational use
Depending on its configuration during pre-personalisation and personalisation,
the TOE can be used as:
    ICAO/EAC eMRTD,
    Polymorphic eMRTD and
    EU/ISO Driving Licence.

The ICAO/EAC eMRTD, Polymorphic eMRTD and Driver Licence are installed as a
separate application instances of the applet having their own dedicated
application identifiers and personalisation. The following TOE configurations are
covered within the scope of this Security Target:

    Configuration ICAO/EAC            Polymorphic        Driver licence
                  eMRTD               eMRTD
    0             present             -                  -
    2             present             present            -
    3             -                   -                  present
    4             -                   present            present
    5             -                   Present            -

The authentication protocols PACEv2, Chip authentication (CAv1), Active
Authentication and Terminal Authentication (TAv1) specified in [ICAO-9303] and
                         Security Target Lite
                                                                             Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                       2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                         Page: 13/150
                        eMRTD Configuration)

[TR-03110] have also been refered to in ISO18013 for EU driving licences. The
BAP-1 protocol defined in ISO18013 is equal to Basic Access Protocol (BAC)
defined in [ICAO-9303]. As to the logical data structure, the ISO18013 uses the
same concept of Passive Authentication defined in [ICAO-9303], but specifies
different ISO7816-4 elementary file identifiers for storing the ICAO defined
content of DG3, DG4 and DG15.

When an Issuing state is using the product as an ISO compliant Driving licence,
the following name mapping of roles, definitions, data groups and protocol is
applicable within the scope of this security target:

                        MRTD                           ISO Driving License
                        MRTD                                   IDL
                         ICAO                                                                                               penetration tests.
                                                                                                 For composite evaluations, please consult the [ETRfC] for details.

                                                                                                 2.7     Re-used evaluation results
                                                                                                 This is a re-certification. Documentary evaluation results of the earlier version of the TOE have been
                                                                                                 re-used, but vulnerability analysis and penetration testing has been renewed.
                                                                                                 Note that this fourth issue of the Certification Report addresses the following changes of the
                                                                                                 underlying platform certification: updated guidance, additional production sites and an additional
                                                                                                 hardware configuration.
                                                                                                 Note that in the second certification of this TOE, the ST was updated to remove all claims regarding
                                                                                                 the security of ECC parameter verification. If the security of a composite or end product relies on this
                                                                                                 functionality, appropriate evaluation of the security properties of this functionality is required.
                                                                                                 Note that in the third certification of this TOE, the scope of the underlying platform certification was
                                                                                                 updated: MIFARE is now out of all scopes, production sites were added and an additional variant was
                                                                                                 included.
                                                                                                 The security evaluation re-used the evaluation results of previously performed evaluations. For this
                                                                                                 fourth issue of the Certification report a full, up to date vulnerability analysis has been made, as well
                                                                                                 as renewed testing.
                                                                                                 There has been extensive re-use of the ALC aspects for the sites involved in the software component
                                                                                                 of the TOE (NXP Semiconductors Hamburg, NXP Semiconductors Austria GmbH Styria, NXP
                                                                                                 Semiconductors Leuven) by the use of site certificates and site re-use report approaches. Sites
                                                                                                 involved in the development and production of the hardware platform were re-used by composition.
                                                                                                 No sites have been visited as part of this evaluation.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 2.8     Evaluated Configuration
                                                                                                 The TOE is defined uniquely by its name and version number Crypto Library V3.1.x on P6022y VB.
                                                                                                 The TOE consists of a hardware part and a software part. This certification covers the configurations
                                                                                                 of the TOE identified as follows:
                                                                                                       •The authenticity of the hardware part of the TOE is checked following the guidance and
                                                                                                        certification report of the hardware.
                                                                                                       •The reference of the software part of the TOE is checked by calculating the SHA-256 hash value
                                                                                                        of the delivered files and comparing them to reference values provided in the user guidance.

                                                                                                 2.9     Results of the Evaluation
                                                                                                                                                                            2
                                                                                                 The evaluation lab documented their evaluation results in the [ETR] which references an ASE
                                                                                                 Intermediate Report and other evaluator documents. To support composite evaluations according to
                                                                                                 [CCDB-2007-09-01] a derived document [ETRfC] was provided and approved. This document
                                                                                                 provides details of the TOE evaluation that have to be considered when this TOE is used as platform
                                                                                                 in a composite evaluation.


                                                                                                 2
                                                                                                  The Evaluation Technical Report contains information proprietary to the developer and/or the
                                                                                                 evaluator, and is not releasable for public review.
                                                                                                 Page: 13/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 The verdict of each claimed assurance requirement is “Pass”.
                                                                                                 Based on the above evaluation results the evaluation lab concluded the Crypto Library V3.1.x on
                                                                                                 P6022y VB, to be CC Part 2 extended, CC Part 3 conformant, and to meet the requirements of EAL
                                                                                                 6 augmented with ASE_TSS.2 and ALC_FLR.1. This implies that the product satisfies the security
                                                                                                 requirements specified in Security Target [ST].
                                                                                                 The Security Target claims ’strict’ conformance to the Protection Profile [BSI-PP-0084].

                                                                                                 2.10 Comments/Recommendations
                                                                                                 The user guidance as outlined in section 2.5 contains necessary information about the usage of the
                                                                                                 TOE. Certain aspects of the TOE’s security functionality, in particular the countermeasures against
                                                                                                 attacks, depend on accurate conformance to the user guidance of both the software and the hardware
                                                                                                 part of the TOE. There are no particular obligations or recommendations for the user apart from
                                                                                                 following the user guidance. Please note that the documents contain relevant details with respect to
                                                                                                 the resistance against certain attacks.
                                                                                                 In addition all aspects of assumptions, threats and policies as outlined in the Security Target not
                                                                                                 covered by the TOE itself need to be fulfilled by the operational environment of the TOE.
                                                                                                 The customer or user of the product shall consider the results of the certification within his system risk
                                                                                                 management process. In order for the evolution of attack methods and techniques to be covered, he
                                                                                                 should define the period of time until a re-assessment for the TOE is required and thus requested from
                                                                                                 the sponsor of the certificate.
                                                                                                 The strength of the implemented cryptographic algorithms and protocols was not rated in the course of
                                                                                                 this evaluation. This specifically applies to the following proprietary or non-standard algorithms,
                                                                                                 protocols and implementations: MIFARE (out of scope).
                                                                                                 To fend off attackers with high attack potential appropriate cryptographic algorithms with adequate key
                                                                                                 lengths must be used (references can be found in national and international documents and
                                                                                                 standards).
                                                                                                 The user of the Crypto Library must implement the advice of the hardware user guidance.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 14/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                   ecified below:

FCS_COP.1/RSA/<iteration>           Cryptographic operation
Hierarchical to:                    No other components.
Dependencies:                       [FDP_ITC.1 Import of user data of the Composite TOE without security
                                    attributes, or
                                    FDP_ITC.2 Import of user data of the Composite TOE with security
                                    attributes, or
                                    FCS_CKM.1 Cryptographic key management]
                                    FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/RSA/<iteration>         The TSF shall perform [assignment: list of cryptographic operations] in
                                    accordance with a specified cryptographic algorithm [assignment:
                                    cryptographic algorithm]
                                    and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                    meet the following standards: [assignment: list of standards]




Table 18      Cryptographic table for FCS_COP.1/RSA
 <iteration>       [assignment:     [assignment:        [assignment:          [assignment: list of standards]
                   list of          cryptographic       cryptographic key
                   cryptographic    algorithm]          sizes]
                   operations]
 ENC               RSA              RSAEP,              512 – 2112 Bits       [RSA-PKCSB], ch. 5.1.1
                   encryption       IFEP-RSA                                  [IEEE1363], ch. 8.2.2
 DEC               RSA              RSADP,              512 – 2112 Bits       [RSA-PKCSB], ch. 5.1.2
                   decryption       IFDP-RSA                                  [IEEE1363], ch. 8.2.1(I) and 8.2.3
 DEC_CRT           RSA              RSADP (CRT),        512 – 4224 Bits       [RSA-PKCSB], ch. 5.1.2
                   decryption       IFDP-RSA (CRT)                            [IEEE1363], ch. 8.2.1(II) and 8.2.3
 SIG               RSA signature    RSASP1              512 – 2112 Bits       [RSA-PKCSB], ch. 5.2.1
                   generation       IFSP-RSA1                                 [IEEE1363], ch. 8.2.1(I) and 8.2.4
 SIG_CRT           RSA signature    RSASP1 (CRT)        512 – 4224 Bits       [RSA-PKCSB], ch. 5.2.1
                   generation       IFSP-RSA1 (CRT)                           [IEEE1363], ch. 8.2.1(II) and 8.2.4
 VER               RSA              RSAVP1              512 – 4224 Bits       [RSA-PKCSB], ch. 5.2.2
                   signature        IFVP-RSA1                                 [IEEE1363], ch. 8.2.5
                   verification

Note:         RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.1/RSA/<iteration>           Cryptographic key generation
Hierarchical to:                    No other components.
Dependencies:                       FCS_CKM.2 Cryptographic key distribution, or

Security Target                                           33                                                       v4.0
                                                                                                             2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                          FCS_COP.1 Cryptographic operation]
                                          FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/RSA/<iteration>               The TSF shall generate cryptographic keys in accordance with a specified
                                          cryptographic key generation algorithm [assignment: list of cryptographic
                                          operations]and specified cryptographic key sizes of [assignment:
                                          cryptographic key sizes that meet the following: [assignment: list of
                                          standards]



Table 19         Cryptographic table for FCS_CKM.1/RSA/
<iteration> Operation                                        Key size (bits)                Standards
CRT               IFX RSA CRT key generation                 512 – 4224 Bits                [RSA-PKCSB], ch. 3.1 and
                                                                                            3.2 (2)
                                                                                            [IEEE1363], ch. 8.1.3.1(2)
n_d               IFX RSA key generation (i.e. without       512 - 2112 Bits                [RSA-PKCSB] , ch. 3.1 and
                  CRT) and return of (n, d)                                                 3.2 (1)
                                                                                            [IEEE1363] , ch. 8.1.3.1(1)
p_q_d             IFX RSA key generation (i.e. without       512 – 2112 Bits                [IEEE1363] , ch. 8.1.3.1(3)
                  CRT) and return of (p , q, d)

Note:            RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.4/RSA                      Cryptographic key destruction
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/RSA                    The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method destruction of RAM key during system or
                                   power on reset1 that meets the following: None2

Note:            The TOE can be delivered with or without the optional RSA library. If the RSA library is not deliverd, the
                 TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
                 delivered cryptographic RSA library cannot be used and therefore the SFRs of this chapter are also not
                 applicable.

6.1.3.4                 Elliptic Curve Cryptography (ECC)
For cryptographic ECC functionality, the TOE shall meet the requirement cryptographic operation (FCS_COP.1)
and cryptographic key construction (FCS_CKM .1) as specified below:

FCS_COP.1/ECC/<iteration>                 Cryptographic operation
Hierarchical to:                          No other components.
Dependencies:                             [FDP_ITC.1 Import of user data of the Composite TOE without security
                                          attributes, or

1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               34                                                       v4.0
                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                     FDP_ITC.2 Import of user data of the Composite TOE with security
                                     attributes, or
                                     FCS_CKM.1 Cryptographic key management]
                                     FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/ECC/<iteration>          The TSF shall perform [assignment: list of cryptographic operations] in
                                     accordance with a specified cryptographic algorithm [assignment:
                                     cryptographic algorithm]
                                     and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                     meet the following standards: [assignment: list of standards]

Table 20      Cryptographic table for FCS_COP.1/ECC
 <iteration>      [assignment: list of     [assignment: [assignment:             [assignment: list of standards]
                  cryptographic            cryptographic cryptographic
                  operations]              algorithm]    key sizes]

 SIG              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.3
                  generation               ECSP-DSA                              [IEEE1363], ch. 7.2.7
 VER              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.4.1
                  verification             ECVP-DSA                              [IEEE1363], ch. 7.2.8
 DH               ECDH key agreement ECDH                    160 – 521 Bits      [ANSX9.63], ch. 5.4.1
                                     ECSVHDP-DH                                  [ISO11770_3], appendix D.6
                                                                                 [IEEE1363], ch. 7.2.1
 ADD              EC point addition        C = A+B           160 – 521 Bits      n.a.

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

Note:         For the /SIG iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step d) is not supported

Note:         For the /VER iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step b) is not supported.
              Beside noted calculation, our algorithm adds a random multiple of order of the basepoint to the
              calculated values u1 and u2.

Note:         For the/ DH iteration, the implementation always returns the y-coordinate in addition to the x-
              coordinate.

Note:         For the /ADD iteration, the elliptic curve points A, B and C are considered as secrets.

Note:         Cofactor multiplication is not supported

FCS_CKM.1/ECC                 Cryptographic key generation
Hierarchical to               No other components.
Dependencies                  FCS_CKM.2 Cryptographic key distribution, or
                              FCS_COP.1 Cryptographic operation]

Security Target                                            35                                                    v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/ECC                 The TSF shall generate cryptographic keys in accordance with a specified
                                cryptographic key generation algorithm EC key generation1 and specified
                                cryptographic key sizes of 160-521 bits2 that meet the following: [ANSX9.62], ch.
                                A4.3 and [IEEE1363], ch. A.16.9.3

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

FCS_CKM.4/ECC                   Cryptographic key destruction
Hierarchical to:                No other components.
Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                FDP_ITC.2 Import of user data with security attributes, or
                                FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/ECC                 The TSF shall destroy cryptographic keys in accordance with a specified
                                cryptographic key destruction method destruction of RAM key during system or
                                power on reset4 that meets the following: None5


Note:         The TOE can be delivered with or without the optional ECC library. If the ECC library is not deliverd, the
              TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
              delivered cryptographic ECClibrary cannot be used and therefore this SFR is also not applicable. .




6.1.4                Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

FPT_TST.2                       Subset TOE testing
Hierarchical to:                No other components.
Dependencies:                   No dependencies
FPT_TST.2.1                     The TSF shall run a suite of self tests at the conditions request of the Security IC
                                Embedded Software1 to demonstrate the correct operation of the alarm lines
                                and/or the environmental sensor mechanisms:


1
  [assignment: list of cryptographic operations]
2
  [assignment: cryptographic key sizes
3
  [assignment: list of standards]
4
  [assignment: cryptographic key destruction method]
5
  [assignment: list of standards]

Security Target                                             36                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                       Please refer to the confidential Security Target2


6.1.5                  Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent
that one application can access code and/or data of another application. For this reason the TOE provides Area
based Memory Access Control. The underlying Memory Protection Unit (MPU) is documented in Appendix B3.5
of the ARMv7 M architecture reference manual [ARMv7M].
In particular, the MPU provides full support for:
 Protection regions.
 Overlapping protection regions, with ascending region priority:
  − Region 7 = highest priority.
  − Region 0 = lowest priority.
 Access permissions.
   MPU mismatches and permission violations invoke the programmable-priority MemManage fault handler.

The MPU can be used to:
   Enforce privilege rules, preventing user applications from corrupting operating system data.
   Separate processes, blocking the active task from accessing other tasks’ data.
   Enforce access rules, allowing memory regions to be defined as read-only or detecting unexpected memory
    accesses.

The SFRs are provided by the Memory Access Control Policy (FDP_ACC.1 and dependencies).


6.1.5.1                Subjects, objects and operations of the Memory Access Control Policy
Subjects:
 MPU

Objects:
 memory/code addresses

Operations:
 Read a/o write a/o execute access


6.1.5.2                Security attributes of the Memory Access Control Policy
Security Attribute which define the roles for Subject MPU:
 Npriv flag defining privilege/non-privilege mode


Security Attribute which control the behavior of the Subject MPU:



1
  [selection: during initial start-up, periodically during normal operation, at the request of the authorized user, and/or at the conditions
     [assignment: conditions under which self test should occur]]
2
  [assignment: functions and/or mechanisms]

Security Target                                                      37                                                                 v4.0
                                                                                                                                  2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 MPU enable/disable bit.
 8 regions with the following attributes
    − a unique priority
    − the enable bit
    − the xn (execute never) bit
    − the start address and size
    − an access matrix which defines if an Operation of the MPU (Subject) to a memory/code address (Object)
     lying in the region is allowed or denied
 A bit defining the acces behavior of the default region, i.e. memory/code addresses not covered by one of the
  8 MPU regions.


Security Attributes for objects:
There are no security attributes for objects.


6.1.5.3            Access control rules of the Memory Access Control Policy
The following generic rules shall apply in case the MPU is enabled. In case the MPU is disabled, a privileged and
unprivileged code has full read/write/execute rights to all addresses.
 If an address is contained in multiple enabled regions, then the region with the highest priority defines the
    access rights.
   If an address is contained in no region then the default region defines the access rights.
   The region defining the access rights checks if the Subject has access to the Object with respect to the desired
    Operation. In case the access is denied the MPU throws an access violation exception. The checks are done
    according to the access matrix inTable 21.
   overlapping regions, have access to other regions with ascending region priority:
    region 7 = highest priority, region 0 = lowest priority
   execution of code is bound to the read access of Table 21 and the xn bit. If the xn bit is cleared and read
    access is enabled then execution of code is defined by Table 21. If the xn bit is set then execution is never
    allowed.

Table 21      Access matrix for read(execute)/write access
 Privileged Mode Permissions            User Mode                             Description
                                        Permissions
 No access                              No access                             All accesses in user mode and
                                                                              privileged mode generate a
                                                                              permission fault
 Read/write                             No access                             Privilege mode has full access
                                                                              while any access from user mode
                                                                              leads to a permission fault.
 Read/write                             Read(execute) only                    Privileged mode has full access
                                                                              while the user mode has no write
                                                                              access rights. Execute access in
                                                                              User mode further depends on the
                                                                              xn bit.
 Read/write                             Read(execute)/write                   Privileged mode has read and
                                                                              execute access rights. Write

Security Target                                         38                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Privileged Mode Permissions                 User Mode                                      Description
                                                Permissions
                                                                                               accesses from privileged mode
                                                                                               lead to a permission fault.
                                                                                               Any access of the user mode leads
                                                                                               to a permission fault.
    Read only                                   No access                                      Privileged mode has read and
                                                                                               execute access rights. Write
                                                                                               accesses lead to a permission
                                                                                               fault.
                                                                                               The same holds for the user mode,
                                                                                               except execute access further
                                                                                               depends on the xn bit.
    Read only                                   Read(execute) only                             All accesses in user mode and
                                                                                               privileged mode generate a
                                                                                               permission fault


6.1.5.4                SFRs of the Memory Access Control Policy
FDP_ACC.1                    Subset access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy as1 defined in section 6.1.5.12.


FDP_ACF.1                    Security attribute based access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACC.1 Subset access control
                             FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1                  The TSF shall enforce the Memory Access Control Policy3 to objects based on the
                             following: Attributes as specified in section 6.1.5.24 .
FDP_ACF.1.2                  The TSF shall enforce the following rules to determine if an operation among
                             controlled subjects and controlled objects is allowed: As specified in the section
                             6.1.5.35.
FDP_ACF.1.3                  The TSF shall explicitly authorize access of subjects to objects based on the following
                             additional rules: none6.
FDP_ACF.1.4                  The TSF shall explicitly deny access of subjects to objects based on the following
                             additional rules: none1.


1
  editorially refined
2
  [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]
3
  [assignment: access control SFP]
4
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
5
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
6
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]

Security Target                                                      39                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)


FMT_MSA.3                    Static attribute initialization
Hierarchical to:             No other components.
Dependencies:                FMT_MSA.1 Management of security attributes
                             FMT_SMR.1 security roles
FMT_MSA.3.1                  The TSF shall enforce the Memory Access Control Policy2 to provide restrictive3 default
                             values for security attributes that are used to enforce the SFP.
FMT_MSA.3.2                  The TSF shall allow the privilege mode4 to specify alternative initial values to override
                             the default values when an object or information is created.


FMT_MSA.1                    Management of security attributes
Hierarchical to:             No other components.
Dependencies:                [FDP_ACC.1 Subset access control or FDP_IFC.1 Subset information flow control]
                             FMT_SMF.1 Specification of management functions
                             FMT_SMR.1 Security roles
FMT_MSA.1.1                  The TSF shall enforce the Memory Access Control Policy5 to restrict the ability to
                             modify6 the security attributes Security Attribute which control the behavior of the
                             Subject MPU7 to the privilege mode8.


FMT_SMF.1                    Specification of management functions
Hierarchical to:             No other components
Dependencies:                No dependencies
FMT_SMF.1.1                  The TSF shall be capable of performing the following security management functions:
                             modifying the security attributes9.


FMT_SMR.1                    Security roles
Hierarchical to:             No other components.
Dependencies:                FIA_UID.1 Timing of identification
FMT_SMR.1.1                  The TSF shall maintain the roles privilege mode and non-privilege mode10.
FMT_SMR.1.2                  The TSF shall be able to associate users with roles.

6.1.6                  Data Integrity
FDP_SDI.2                    Stored data integrity monitoring and action


1
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
2
  [assignment: access control SFP, information flow control SFP]
3
  [selection, choose one of: restrictive, permissive, [assignment: other property]]
4
  [assignment: the authorised identified roles]
5
  [assignment: access control SFP(s), information flow control SFP(s)]
6
  [selection: change_default, query, modify, delete, [assignment: other operations]]
7
  [assignment: list of security attributes]
8
  [assignment: the authorised identified roles]
9
  [assignment: list of management functions to be provided by the TSF]
10
   [assignment: the authorised identified roles]

Security Target                                                       40                                             v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Hierarchical to:             FDP_SDI.1 stored data integrity monitoring
Dependencies:                No dependencies
FDP_SDI.2.1                  The TSF shall monitor user data stored in containers controlled by the TSF for data
                             integrity and one- and/or more-bit-errors1 on all objects, based on the following
                             attributes: error correction ECC for the SOLID FLASHҹ NVM2.
FDP_SDI.2.2                  Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                             FLASHҹ NVM automatically and inform the user about other bit errors3.



FDP_SDC.1                    Stored data confidentiality
Hierarchical to:             No other components
Dependencies:                No dependencies
FDP_SDC.1.1                  The TSF shall ensure the confidentiality of the information of the user data while it is
                             stored in the RAM and SOLID FLASHҹ NVM4.




6.1.7                  Support of Flash Loader
The TOE provides a Flash Loader to download user data into the SOLID FLASHҹ NVM, either during production
of the TOE or at customer site. Depending on the configuration option EA the Flash Loader claims different sets
of SFRs. [PP0084] section 7.3.1 “Package 1: Loader dedicated for usage in secured environment only” is claimed
for both options. [PP0084] section 7.2 Package “Authentication of the Security IC” and [PP0084] section 7.3.2
“Package 2: Loader dedicated for usage by authorized users only” is only claimed in case TOE is ordered with
EA unavailable, however a subset of SFRs from loader package 2 is also claimed, if TOE is ordered with EA
available.




6.1.8                  Flash Loader Policy
The table as follows shows the Flash Loader SFR claims in dependency of the order option EA.

Table 22       Flash loader SFR claims
EA unavailable                                                  EA available
Limited capabilities (FMT_LIM.1/Loader)                         Limited capabilities (FMT_LIM.1/Loader)
Limited availability – Loader (FMT_LIM.2/Loader)                Limited availability – Loader (FMT_LIM.2/Loader)
Authentication Proof of Identity (FIA_API.1)                    -
Inter-TSF trusted channel (FTP_ITC.1)                           -
Basic data exchange confidentiality (FDP_UCT.1)                 Basic data exchange confidentiality (FDP_UCT.1)
Data exchange integrity (FDP_UIT.1)                             Data exchange integrity (FDP_UIT.1)

1
  [assignment: integrity errors]
2
  [assignment: user data attributes]
3
  [assignment: action to be taken]
4
  [assignment: memory area]

Security Target                                               41                                                      v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

EA unavailable                                                EA available
Subset access control – Loader (FDP_ACC.1/Loader)             Subset access control – Loader (FDP_ACC.1/Loader)
Security attribute based access control – Loader              Security attribute based access control – Loader
(FDP_ACF.1/Loader)                                            (FDP_ACF.1/Loader)
Management of TSF data – Loader                               Management of TSF data – Loader
(FMT_MTD.1/Loader)                                            (FMT_MTD.1/Loader)
Security Roles – Loader (FMT_SMR.1/Loader)                    Security Roles – Loader (FMT_SMR.1/Loader)
Specification of Management Functions – Loader                Specification of Management Functions – Loader
(FMT_SMF.1/Loader)                                            (FMT_SMF.1/Loader)
User Identification before any action – Loader                User Identification before any action – Loader
(FIA_UID.2/Loader)                                            (FIA_UID.2/Loader)



The TOE shall meet the loader SFRs as specified below:

FMT_LIM.1/Loader            Limited Capabilities
    Hierarchical to:         No other components.
    Dependencies:            No other components
    FMT_LIM.1.1/Loader       The TSF shall be designed and implemented in a manner that limits its capabilities so
                             that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                             enforced: Deploying Loader functionality after permanent deactivation does not
                             allow stored user data to be disclosed or manipulated by unauthorized user1.



FMT_LIM.2/Loader            Limited availability - Loader
    Hierarchical to:         No other components.
Dependencies:               FMT_LIM.1 Limited capabilities.
    FMT_LIM.2.1/Loader       The TSF shall be designed in a manner that limits its availability so that in conjunction
                             with “Limited capabilities (FMT_LIM.1)” the following policy is enforced: The TSF
                             prevents deploying the Loader functionality after permanent deactivation2.

Regarding FMT_LIM.1.1/Loader the User Guidance requires the Flash Loader to be permanently deactivated
prior delivery to the end user (Phase 7).
 FTP_ITC.1               Inter-TSF trusted channel
    Hierarchical to:         No other components.
    Dependencies:            No dependencies.
    FTP_ITC.1.1              The TSF shall provide a communication channel between itself and administrator
                             user, or Download operator user3, that is logically distinct from other communication
                             channels and provides assured identification of its end points and protection of the
                             channel data from modification or disclosure.




1
  [assignment: Limited capability policy]
2
  [assignment: Limited availability policy]
3
  [assignment: users authorized for using the Loader]

Security Target                                             42                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    FTP_ITC.1.2              The TSF shall permit another trusted IT product1 to initiate communication via the
                             trusted channel.
    FTP_ITC.1.3              The TSF shall initiate communication via the trusted channel for deploying Loader for
                             downloading user data2.

    FDP_UCT.1                Basic data exchange confidentiality
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP3 to receive4 user data in a manner protected
                             from unauthorised disclosure.

    FDP_UIT.1                Data exchange integrity
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP5 to receive6 user data in a manner protected
                             from modification, deletion, insertion7 errors.
FDP_UIT.1.2                 The TSF shall be able to determine on receipt of user data, whether modification,
                            deletion, insertion8 has occurred.



FDP_ACC.1/Loader            Subset access control - Loader
    Hierarchical to:         No other components.
    Dependencies:            FDP_ACF.1 Security attribute based access control.
    FDP_ACC.1.1/Loader       The TSF shall enforce the Loader SFP9 on
                              the subjects Administrator User, Download Operator User and Image Provider,
                              the objects user data in SOLID FLASHҹ NVM memory of the TOE,
                              the operation deployment of Loader10




    FDP_ACF.1/Loader         Security attribute based access control - Loader
    Hierarchical to:         No other components.


1
  [selection: the TSF, another trusted IT product]
2
  [assignment: list of functions for which a trusted channel is required][assignment: rules]
3
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
4
  [selection: transmit, receive]
5
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
6
  [selection: transmit, receive]
7
  [selection: modification, deletion, insertion, replay]
8
  [selection: modification, deletion, insertion, replay]
9
  [assignment: access control SFP]
10
   [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]

Security Target                                                    43                                            v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:             FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        FDP_ACF.1.1 The TSF shall enforce the Loader SFP1 to objects based on the following:
                              the subjects and objects of FDP_ACC.1.1/Loader without security attributes2
    FDP_ACF.1.2/Loader        FDP_ACF.1.2 The TSF shall enforce the following rules to determine if an operation
                              among controlled subjects and controlled objects is allowed:
                              The authenticated Administrator User or authenticated Download Operator User can
                              modify the user data by new user data when the new user data is authorized by the
                              Image Provider3
    FDP_ACF.1.3/Loader        FDP_ACF.1.3 The TSF shall explicitly authorise access of subjects to objects based on
                              the following additional rules: none4.
    FDP_ACF.1.4/Loader        The TSF shall explicitly deny access of subjects to objects based on the following
                              additional rules: none5.

Note:          The security functional requirements FIA_API.1, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1, FDP_ACC.1/Loader
               and FDP_ACF.1/Loader apply only to TOE products with activated Flash Loader. In other cases the
               Flash Loader is not available anymore and the user data download is completed.

The following SFRs have been added to the SFRs from Flash Loader package 2 of [PP0084] in order to describe
the management of the various Flash Loader authentication keys.



FMT_MTD.1/Loader               Management of TSF data
    Hierarchical to:           No other components.
    Dependencies:              FMT_SMR.1 Security roles
                               FMT_SMF.1 Specification of Management Functions
    FMT_MTD.1.1/Loader         The TSF shall restrict the ability to change_default, modify, delete6 the Authentication
                               keys for Administrator User, Download Operator User and Image Provider7 to
                               Administrator User, Download Operator User8.

Note:          The Administrator User can manage the keys for Administration User, Download Operator User and
               Image Provider. The Download Operator User can delete the key for Image Provider and Download
               Operator, otherwise manage the keys for the Download Operator User only. The image provider cannot
               modify any keys or perform authentication with the Flash Loader. It can simply built authentic
               loadable images.

FMT_SMR.1/Loader               Security roles
    Hierarchical to:           No other components.


1
  [assignment: access control SFP]
2
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
3
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
4
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]
5
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
6
  [selection: change_default, query, modify, delete, clear, [assignment: other operations]]
7
  [assignment: list of TSF data]
8
  [assignment: the authorised identified roles]

Security Target                                                      44                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMR.1.1/Loader       The TSF shall maintain the roles Administrator User, Download Operator User, Image
                             provider1.
    FMT_SMR.1.2/Loader       The TSF shall be able to associate users with roles.



FMT_SMF.1/Loader             Specification of Management Functions
    Hierarchical to:         No other components.
    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMF.1.1/Loader       The TSF shall be capable of performing the following management functions: Change
                             Key, Invalidate Key2.

Note:          “Change Key” of this SFR combines the “Change default” and “modify” operations from SFR
               FMT_MTD.1/Loader. “Invalidate Key” of this SFR is equivalent to the “delete” operation from SFR
               FMT_MTD.1/Loader.

    FIA_UID.2/Loader         User Identification before any action
    Hierarchical to:         FIA_UID.1
    Dependencies:            No dependencies.
    FIA_UID.2.1/Loader       The TSF shall require each user to be successfully identified before allowing any other
                             TSF-mediated actions on behalf of that user.


6.1.9                  Support of Authentication of the Security IC
The Flash Loader provides a security IC authentication service.



FIA_API.1                   Authentication Proof of Identity
Hierarchical to:            No other components.
Dependencies:               No dependencies.
FIA_API.1.1                 The reased by
means of configuration options.
The key lengths used for the AES and DES functionality follow the national AIS32 regulation regarding the 100
bit security level issued by the BSI1. This regulation excludes the single DES operation from the certification as it
is considered to be not sufficiently secure from algorithm perspective.
For both versions, the certification covers the SCL cryptographic functionality of the AES algorithm with key
lengths of 128, 192, 256 bits and the TDEA or TripleDES (TDES) algorithm with an effective key size of 112 and
168 Bits. For the version v2.04.002 the certification covers the CMAC functionality too.

Beside the inclusion and support of cryptographic libraries this TOE comes with the optional Hardware Support
Library (HSL) in different alternative versions significantly simplifying the management of the SOLID FLASH™
NVM functionality. The HSL (all versions) constitutes an application interface (API) accessing the HSL state
machine and abstracting low level properties like special function registers and settings of specific hardware

           1 German: Bundesamt für Sicherheit in der Informationstechnik, English: Federal Office for Information Security


CC Document                                                      29                                                                 1.8
                                                                                                                             2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


features. In short the HSL provides a user friendly also use case oriented interface considering endurance,
reliability and performance.
All HSL library versions are delivered as object code.
The HSL is delivered as object code and in this way integrated in the user software.
All HSL versions implement, beyond the low level driver, the basic method In-place Update leveraging the
dedicated advantages of the new SOLID FLASH™ NVM technology.
In addition to the above, all HSL versions provide an advanced additional method called Incremental Write (IWR).
This method provides enhanced endurance of the SOLID FLASH NVM even beyond the erase endurance limits
for often written objects. Thus this method serves applications with a demand for high endurance and fast
writing times. On the other hand, the read times using this method are slower than the other methods provided.
The HSL versions provide tearing save behavior, whereas we define tearing as an untimed power cut off which
could occur anytime and in the worse therewith could also occur during writing to or erasing of pages in the
SOLID FLASH™ NVM.
If the HSL – all versions are meant - comes with the TOE and the user implements the offered configuration and
dedicated functions tearing save behaviour of the SOLID FLASH™ NVM is provided. In these cases the user does
not need to care about tearing events since either the old data or the new data are correctly in place.
In addition to the versions 01.22.4346 and 02.01.6634, the HSLs in versions 03.11.8339 and 03.12.8812 provide a
furthermore improved method for the Incremental Write (IWR).
But, even in the cases where the user decides not to use the HSL and did also not implement own routines
preserving the consistency of the SOLID FLASH™ NVM, the hardware protection means prevent from operation
of inconsistent data. Therefore, in no cases a tearing event leads to an exploitable situation respectively
vulnerability.
Anyhow, the user should be aware and is recommended to use either the HSL or implement own routines
managing tearing events since if there would occur a faulty programmed SOLID FLASH™ NVM location the TOE
ends operation at that point.

The order option CIPURSE™ Cryptographic Library (CIPURSE™ CL) provides cryptographic functionality to
implement a CIPURSE™ V2 conformant protocol.
This protocol provides a secure mutual authentication of two entities, namely the terminal (denoted as PCD =
Proximity Coupling Device (CIPURSE™-compliant terminal)) and a smart card or a token in other form factors
which is called PICC. PICC stands for Proximity Integrated Circuit Card (CIPURSE™-compliant card).
Beside the mutual authentication, the protocol implements measures to maintain the integrity of the after
passing successfully the authentication transferred data. It depends on the chosen operation mode whether the
user requires integrity protection only, for example if the exchange is used in a secure environment only, or
whether complete protection including the encrypted transfer of user data between the two authentication
entities is an issue. Both operation modes are part of the CIPURSE™ open standard and offered as integrity
protection mode and as confidential communication mode.
By that the CIPURSE™ CL supports the user to implement systems conformant to the CIPURSE™ open standard
implementing a secured, interoperable and flexible transit fare collection solution, including ISO 7816, ISO/IEC
14443-4 communication and AES-128 bit cryptography for multiple payment types.
The CIPURSE™ CL is conformant to the CIPURSE™ open standard [18] for both, the PICC and then PCD software
parts. It implements the by the OSPT alliance standardized application interface for the card and the terminal
side.
The scope of this certification of this TOE covers all parts of the CIPURSE™ CL which are later implemented by
the user on the user card respectively token based on this TOE and the functionality of the PCD software part
which is implemented in the terminal side. The PCD software operates also on the hardware of this TOE which is
implemented in the terminal.
The CIPURSE™ CL implements the by the OSPT alliance standardized application interface for the card and the
terminal side.
The certification comprises the entire functionality of the optional CIPURSE™ CL implemented and operated on
the TOE hardware. On one hand the TOE can operate the PICC side software part as a token and on the other
hand, a second TOE product operates the PCD side software part if used inside a terminal or similar system.
CC Document                                            30                                                    1.8
                                                                                                      2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


The environment on the terminal, the terminal systems, their security and their interfaces to the background
systems are not in the scope of this certification. The user operating system and further applications
implemented on the TOE are also out of scope of this certification.
To summarize, if used with the PCD software the certification view equals to the case where the TOE is running
the PICC software: The TOE operates one of the optional software parts of the CIPURSE™ CL – regardless
whether PICC or PCD part - and is enabled to communicate via the selected interfaces. The surrounding
environment is in both cases out of scope. The CIPURSE™ CL is delivered as object code and in this way
integrated in the user software.

The NRG software is a further order option, which implements the routines for a NRG interface. The NRG
implements an operating system handling the emulation of an NRG card together with the RF interface. One
part of the NRG software is permanently stored in the ROM and the second part consisting of patch and API is
located in the SOLID FLASH™ NVM. The second part is only present if the NRG is a part of the delivery. If the
NRG is not part of the delivery the ROM part is present but not used. The NRG implements tearing safe
behaviour in context with the SOLID FLASH™ NVM management and is therefore independent from the HSL.
The NRG NVM part is – if ordered – delivered as object code and in this way integrated in the user software.
The NRG is not part of the TOE Security Functionality (TSF).

Note 1:
The asymmetric cryptographic libraries regardless of the version chosen are delivery options.
Therefore the TOE may come with free combinations with the other libraries of or without these libraries. In the
case of coming without one or any combination of the asymmetric libraries the TOE does not provide the
Additional Specific Security Functionality Rivest-Shamir-Adleman Cryptography (RSA) and/or Elliptic Curve
Cryptography (EC).

The symmetric cryptographic library SCL, in two alternative versions, is a delivery option.
Therefore the TOE may come with free combinations with the other libraries of or without these libraries. In the
case of coming without the SCL the TOE does not provide the specific security functionality implemented by this
software. Even in case of a TOE coming without SCL, the symmetric cryptographic functionality is unchanged
covered by the hardware symmetric cryptographic coprocessor SCP.

The presence of the cryptographic library CIPURSE™ CL is a delivery option.
Therefore the TOE may come with free combinations with the other libraries of or without these libraries. In the
case of coming without the CIPURSE™ CL, the TOE does not provide the specific security functionality
implemented by this software.
End of note.




CC Document                                            31                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


The firmware and software parts of the TOE comprise:

Firmware
     in several alternative versions,
      whereas the latter version provides additional functionality regarding the TOE identification as order
      option
     Boot Software (BOS)
     Resource Management System (RMS)
     Flash Loader (FL)
     RFAPI functions
      The RFAPI is not part of the TOE Security Functionality (TSF).
     NRG basic functions in ROM.
      The NRG is not part of the TOE Security Functionality (TSF).

Optional Software
    RSA cryptographic library in three alternative versions
    EC cryptographic library in three alternative versions
    Toolbox library in three alternative versions.
      None of the Toolbox libraries is part of the TOE Security Functionality (TSF).
    SCL library in two alternative versions
    HSL library in four alternative versions
    CIPURSE™ Cryptographic Library
    NRG library.
      The NRG is not part of the TOE Security Functionality (TSF).


2.2.3          Interfaces of the TOE
       The physical interface of the TOE to the external environment is the entire surface of the IC.
       The electrical interface of the TOE to the external environment is constituted by the pads of the chip,
        particularly ISO pads, the CLK and power supply pads, as well as the pads used for contactless and
        contact based interfacing.
        A further electrical interface are the La and Lb pads used for the antenna connection and alternatively for
        the ACLB communication mode connecting an external reader chip which is not part of the TOE.
       The RF interface (radio frequency power and signal interface) enables contactless communication
        between a PICC (proximity integration chip card, PICC) and a PCD reader/writer (proximity coupling
        device, PCD). Power supply is received and data are received or transmitted by an antenna which
        consists of a coil with a few turns directly connected to the IC. Depending on customer orders the
        contactless interface options are set by means of blocking either at Infineon premises or at the premises
        of the user.
       The data-oriented I/O interface to the TOE is formed by the pads used for contact based or contactless
        communication.
       The interface to the firmware – regardless of the version chosen – is constituted by special registers used
        for hardware configuration and control (Special Function Registers, SFR).
       The interface of the TOE to the operating system is constituted by the RMS and by the instruction set of
        the TOE.
       The interface of the TOE to the test routines is formed by the BOS test routine call, i.e. entry to the test
        modes.

CC Document                                             32                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


       The interface to the RSA calculations is defined from the RSA library interface. This is regardless of the
        version chosen.
       The interface to the EC calculations is defined from the EC library interface. This is regardless of the
        version chosen.
       The interface to the Toolbox is defined by the Toolbox library interface. This is regardless of the version
        chosen.
       The interface to the SCL is defined by the Symmetric Cryptographic Library interface. This is regardless
        of the version chosen.
       The interface to the HSL is defined by the functions of the Hardware Support Library interface. This is
        regardless of the version chosen.
       The interface to the CIPURSE™ CL is defined by the functions of the CIPURSE™ cryptographic library
        (each version). This is regardless of the version chosen.
       The NRG interface is defined by the functions of the NRG Software.

Note that the interfaces to the optional software parts are only present, if the TOE comes with the belonging
software part depending on the customer order.


2.2.4          Guidance documentation
The following provides a brief overview of the document set constituting the user guidance for this TOE. The
exact document titles and versions are given in chapter 9.
    The document Hardware Reference Manual HRM [1] is the user data book of the TOE and contains the
        relevant module, function and feature description
    The document Production and Personalization User Manual [2] contains detailed information about the
        usage of the Flash Loader
    The document Programmers Reference Manual [3] describes the usage and interfaces of the Resource
        Management System RMS, of the NRG Software and of the RFAPI.
    The document [6] Security Guidelines User Manual provides the guidance and recommendations to
        develop secure software for and secure usage of this TOE.
    The document [7] Errata Sheet contains latest updates and corrections of the TOE relevant for the user
        and it is a kind addendum to the hardware reference manual HRM [1]. The Errata Sheet can be changed
        during the life cycle of the TOE. New Errata Sheet releases are reported in a monthly updated list
        provided from Infineon Technologies AG to the user. This list is not part of the certification process. Part
        of the TOE certification is the released version valid at the point in time the certificate was issued.
    The document asymmetric Cryptographic Library ACL [4-1] for Crypto@2304T user interface for the
        version v2.08.007 contains all interfaces of the RSA, EC and Toolbox library and are only delivered to the
        user in case the RSA library and/or the EC library is/are part of the delivered TOE.
    The document asymmetric Cryptographic Library ACL [4-2] for Crypto@2304T user interface for the
        version v2.07.003 contains all interfaces of the RSA, EC and Toolbox library and are only delivered to the
        user in case the RSA library and/or the EC library is/are part of the delivered TOE.
    The document asymmetric Cryptographic Library ACL [4-3] for Crypto@2304T user interface for the
        version v2.06.003 contains all interfaces of the RSA, EC and Toolbox library and are only delivered to the
        user in case the RSA library and/or the EC library is/are part of the delivered TOE.
    The document [5] Crypto@2304T User Manual describes the architecture of cryptographic coprocessor
        on register level. It also provides a functional description of the register architecture, instruction set and
        gives programming guidance. This document is not required if one of Infineon’s asymmetric
        cryptographic libraries ACL is used. The ACL takes properly care about the low level hardware interfaces.


CC Document                                               33                                                       1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


      The user guidance for the optional Symmetric Cryptographic Library SCL [16-1] in version v2.04.002
       contains all user interfaces required to have a simplified and secure use of the symmetric cryptographic
       coprocessor. This user guidance is only delivered if the optional SCL is part of the delivery to the user.
      The user guidance for the optional Symmetric Cryptographic Library SCL [16-2] in version v2.02.010
       contains all user interfaces required to have a simplified and secure use of the symmetric cryptographic
       coprocessor. This user guidance is only delivered if the optional SCL is part of the delivery to the user.
      The user guidance for the CIPURSE™ Cryptographic Library [17-1] provides detailed information and the
       complete application interface for the user for implementation of an OSPT™ compliant PCD / PICC
       communication solution.
      The document reference [15-1] for the Hardware Support Library (HSL) in version 03.12.8812 provides an
       application interface (API) accessing the HSM state machine and abstracting low level properties like
       special function registers and settings of specific hardware features.
      The document reference [15-2] for the Hardware Support Library (HSL) in version 03.11.8339 provides an
       application interface (API) accessing the HSM state machine and abstracting low level properties like
       special function registers and settings of specific hardware features.
      The document reference [15-3] for the Hardware Support Library (HSL) in version 02.01.6634 provides an
       application interface (API) accessing the HSM state machine and abstracting low level properties like
       special function registers and settings of specific hardware features.
      The document reference [15-4] for the Hardware Support Library (HSL) in version 01.22.4346 provides an
       application interface (API) accessing the HSM state machine and abstracting low level properties like
       special function registers and settings of specific hardware features.
      Finally the certification report by BSI may contain an overview of the recommendations to the software
       developer regarding the secure use of the TOE. These recommendations are also included in the ordinary
       user documentation, the Security Guidelines User Manual [6].
      The user guidance of the optional NRG library is included in the Programmers Reference Manual [3] and
       in the Security Guidelines [6].




CC Document                                            34                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


2.2.5          Forms of delivery
The TOE can be delivered:
    in form of complete modules
    with or without inlay mounting
    with or without inlay antenna mounting
    in form of plain wafers
    in any IC case (for example TSSOP28, VQFN32, VQFN40, CCS-modules, etc.)
    in no IC case or package, simply as bare dies
    or in whatever type of package

The form of delivery does not affect the TOE security and it can be delivered in any type, as long as the processes
applied and sites involved have been subject of the appropriate audit.
The delivery can therefore be at the end of phase 3 or at the end of phase 4 which can also include pre-
personalization steps according to PP [9]. Nevertheless in both cases the TOE is finished and the extended test
features are removed. In this document are always both cases mentioned to avoid incorrectness but from the
security policy point of view the two cases are identical.
The delivery to the software developer (phase 2  phase 1) contains the development package and is delivered
in form of documentation as described above, data carriers and/or download from a secure server containing the
tools and emulators as development and debugging tool.
Part of the software delivery can also be the Flash Loader software running on the TOE and receiving the
transmitted information of the user software to be loaded into the SOLID FLASH™ NVM. The download is only
possible after successful mutual authentication and the user software can also be downloaded in an encrypted
way. This download can also be done at a third party acting as download service provider for the user. This
organization is subject of the user.
In any case, the user is after finalization of the download and prior delivery to the field obligated to permanently
lock further use of the Flash Loader. How the user can do this is detailed in the user guidance [2].
Note that it depends on the procurement order, whether the Flash Loader program is present or not.

The belonging user guidance documents are delivered in electronic form: Either by user downloads from a secure
server or alternatively on request as encrypted email attachment.




CC Document                                              35                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description




                                        Table 4       TOE delivery types

      TOE Component             Delivered Format              Delivery Method                Comment

                                                      Hardware

  All derivatives as stated   Plain wafers, bare dies,        Postal transfer in    All materials are delivered to
        in chapter 1          complete modules, IC             cages or metal       distribution centres in locked
                               cases of any type (for              boxes                cages or metal boxes.
                                example TSSOP28,
                                VQFN32, VQFN40,
                                CCS-modules, etc.),
                                  with or without
                                antenna mounting,
                               with or without inlay
                                  mounting, or in
                                 whatever package

                                                      Firmware

              All                         –                           –               Stored on the delivered
                                                                                            hardware.

                                                      Software

    All software libraries      Precompiled object            Secured download                    –
                              format code – L251 file          as zipped-file (1)
                              type with ending “.lib”

                                              Guidance Documentation

     All User Guidance             Personalized pdf        Secured download                       –
         documents                                        (1) or on demand by
                                                            encrypted email.

   (1) Users having an account on the secure server can login and download the according document-
       respectively software files




CC Document                                              36                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Target of Evaluation Description


2.2.6          Production sites
The TOE may be handled in different production sites until delivery, but the wafers of this TOE are produced in
Taiwan at two different production sites. For logistic and capacity reasons the production lines have been
doubled and thus this certification comprises the products of both production lines.
To distinguish the different production sites in the field, the two sites are coded into the Generic Chip Ident Mode
(GCIM) data. The exact coding of the generic chip identification data is described in the hardware reference
manual HRM [1].
The delivery measures are described in the ALC_DVS aspect.

The production lines are coded as follows:
Taiwan: One production line is coded with »0Dh« and the other is coded with »0Ah«




CC Document                                              37                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Conformance Claims (ASE_CCL)




3             Conformance Claims (ASE_CCL)
This Security Target (ST) and the TOE claim conformance to Common Criteria version v3.1 and in particular,
conformance is claimed for:
               Common Criteria part 2 extended [11] and Common Criteria part 3 conformant [12].

PP Claim
This Security Target is in strict conformance to the Security IC Platform Protection Profile [9].
The targeted EAL6+ level includes already the highest assurance families AVA_VAN.5 and ALC_DVS.2 from
Common Criteria part 3 [12]. To achieve an additional augmentation, this Security Target is assurance package
augmented compared to the Security IC Platform Protection Profile [9].
The augmentation is achieved – with regard to CCv3.1 Part 3 [12]: Security assurance components by including:

                        Table 5      Augmentations of the assurance level of the TOE
          Assurance Class                      Assurance Family                         Description
         Life-cycle support                       ALC_FLR.1                        Basic flaw remediation

The Security IC Platform Protection Profile with Augmentation Packages is registered and certified by the
Bundesamt für Sicherheit in der Informationstechnik (BSI) under the reference:
                            BSI-CC-PP-0084-2014, Version 1.0, dated 2014-01-13.
The security assurance requirements of the TOE are according to the Security IC Platform Protection Profile [9]
and to Part 3 of the Common Criteria version v3.1 [12].

Package Claim
This Security Target claims conformance to the following additional packages taken from the Security IC
Platform Protection Profile [9]:

•       Package Authentication of the Security IC, section 7.2, augmented
•       Package Loader, Package 1: Loader dedicated for usage in secured environment only, section 7.3.1,
conformant
This package is optional and fulfilled only by TOE products coming with Flash Loader.
•       Package Loader, Package 2: Loader dedicated for usage by authorized users only,
section 7.3.2, conformant
This package is optional and fulfilled only by TOE products coming with Flash Loader.
•       Package TDES ; section 7.4.1, augmented
The symmetric cryptographic coprocessor SCP can be blocked and the symmetric cryptographic library SCL is an
optional software. Thus this package is optional, but if one of both is available the claim is fulfilled and
augmented.
•       Package AES ; section 7.4.2, augmented
The symmetric cryptographic coprocessor SCP can be blocked and the symmetric cryptographic library SCL is an
optional software. Thus this package is optional, but if one of both is available the claim is fulfilled and
augmented.

                                     The assurance level of this TOE is:
                                        EAL6 augmented (EAL6+)
                          with the component ALC_FLR.1 and additional packages




CC Document                                            38                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Conformance Claims (ASE_CCL)


The highest assurance component AVA_VAN.5 Vulnerability Assessment, advanced methodical vulnerability
analysis, is already standard requirement for the EAL6. Thus the augmentation is achieved by another assurance
class.

Conformance Rationale
This security target claims strict conformance only to the PP [9].
The Target of Evaluation (TOE) is a typical security IC as defined in PP chapter 1.2.2 comprising:
•       the circuitry of the IC (hardware including the physical memories),
•       configuration data, initialization data related to the IC Dedicated Software and the behavior of the
security functionality
                                                                            JCAPI                Java Card Application Programming Interface
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 JCRE                 Java Card Runtime Environment
                                                                                                 JCVM                 Java Card Virtual Machine
                                                                                                 JIL                  Joint Interpretation Library
                                                                                                 MAC                  Message Authentication Code
                                                                                                 NSCIB                Netherlands scheme for certification in the area of IT security
                                                                                                 PP                   Protection Profile
                                                                                                 RNG                  Random Number Generator
                                                                                                 RSA                  Rivest-Shamir-Adleman Algorithm
                                                                                                 SHA                  Secure Hash Algorithm
                                                                                                 Page: 13/13 of report number: NSCIB-CC-180212-CR2, dated 20 March 2020




                                                                                                 5 Bibliography

                                                                                                 This section lists all referenced documentation used as source material in the compilation of this
                                                                                                 report:
_                                                                                                [CC]                 Common Criteria for Information Technology Security Evaluation, Parts I, II and III,
                                                                                                                      Version 3.1 Revision 5, April 2017.
                                                                                                 [CEM]                Common Methodology for Information Technology Security Evaluation, Version 3.1
                                                                                                                      Revision 5, April 2017.
                                                                                                 [CR-N7121]           BSI-DSZ-CC-1040-2019, NXP Smart Card Controller N7121 with IC Dedicated
                                                                                                                      Software and Crypto Library from NXP Semiconductors Germany GmbH, v1.0, 14-
                                                                                                                      06-2019, BSI
                                                                                                 [N7121-ETRfC]        ETR for Composition, NXP Secure Smart Card Controller N7121 with IC Dedicated
                                                                                                                      Software and Crypto Library (N7121) according to AIS36, 18-RPT-788 v8.0, 31
                                                                                                                      May 2019, Brightsight
                                                                                                 [N7121-ST]           NXP Secure Smart Card Controller N7121 with IC Dedicated Software and Crypto
                                                                                                                      Library Security Target, Rev. 1.5, 31 May 2019
                                                                                                 [ETR]                Evaluation Technical Report JCOP 4 P71, 19-RPT-542, Version 5.0, 19 March
                                                                                                                      2020.
                                                                                                 [ETRfC]              ETR for Composite Evaluation JCOP 4 P71, 19-RPT-177, Version 7.0, 19 March
                                                                                                                      2020.
                                                                                                 [GP]                 GlobalPlatform Card Specification, v2.3, GlobalPlatform Inc., October 2015
                                                                                                 [JCAPI]              Java Card 3 Platform, Application Programming Interface, Classic Edition, Version
                                                                                                                      3.0.5, May 2015, Published by Oracle
                                                                                                 [JCRE]               Java Card 3 Platform, Runtime Environment Specification, Classic Edition, Version
                                                                                                                      3.0.5, May 2015, Published by Oracle
                                                                                                 [JCVM]               Java Card 3 Platform, Virtual Machine Specification, Classic Edition, Version 3.0.5,
                                                                                                                      May 2015, Published by Oracle.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECC over GF(p) Library                1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECDAA                                 1.0
                                                                                                                  SN200x Crypto Library: User Manual – TwdEdMontGfp Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – eUICC Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Symmetric Cipher Library (SymCfg)     1.1
                                                                                                                  SN200x Crypto Library: User Manual – Utils Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – HASH Library                          1.0
                                                                                                                  SN200x Crypto Library: Errata sheet                                        1.0


                                                                                                 Table 4 Manuals of SN200_SE B1.1 specific for C04
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 2.6      IT Product Testing
                                                                                                 Testing (depth, coverage, functional tests, independent testing): The evaluators examined the
                                                                                                 developer’s testing activities documentation and verified that the developer has met their testing
                                                                                                 responsibilities.

                                                                                                 2.6.1      Testing approach and depth
                                                                                                 The developer has performed extensive testing on functional specification, subsystem and modules
                                                                                                 (according to EAL6 requirements). The testing was largely automated using industry standard and
                                                                                                 proprietary test suites. Test scripts were extensively used to verify that the functions return the
                                                                                                 expected values.
                                                                                                 For the testing performed by the evaluators, the developer has provided samples and a test
                                                                                                 environment. The evaluators have reproduced a selection of the developer tests, as well as a small
                                                                                                 number of test cases designed by the evaluator. For the evaluator defined tests the developer
                                                                                                 delivered samples (and support in writing scripts). However, Riscure’s test environment was used for
                                                                                                 these ATE_IND tests.
                                                                                                 The underlying hardware and crypto-library test results are extendable to composite evaluations, as
                                                                                                 the underlying platform is operated according to its guidance and the composite evaluation
                                                                                                 requirements are met.
                                                                                                 Page: 11/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                 2.6.2    Independent Penetration Testing
                                                                                                 The evaluator independent penetration tests were conducted according to the following testing
                                                                                                 approach:
                                                                                                     • During evaluation of the ADV, ATE and ALC classes the evaluators hypothesized possible
                                                                                                        vulnerabilities. This resulted in a shortlist of possible vulnerabilities to be further analysed in
                                                                                                        AVA using the design knowledge gained in particular from the source code analysis in IMP.
                                                                                                        This resulted in a shortlist of potential vulnerabilities to be tested.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    