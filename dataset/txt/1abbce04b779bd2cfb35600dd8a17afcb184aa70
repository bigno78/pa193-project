tiated (applet resides in ROM or in EEPROM)
      2. PRE-PERSONALISATION state
      3. PERSONALISATION state
      4. OPERATIONAL state
      5. TERMINATED state (irreversibly)
  Each life-cycle phase (or state) has its typical user acting as role holder.
                          Security Target Lite
                                                                     Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                Page: 128/150
                         eMRTD Configuration)

                     Life-cycle state (maintained
Life-cycle phase                                    Role
                     by applet)
Manufacturing        - (Applet not instantiated)    IC Manufacturer
phase                                               MRTD Manufacturer Platform
                     - (Applet not instantiated)
                                                    initialisation)
                                                    MRTD Manufacturer (Pre-
                     PRE-PERS  Germany


                                                                                                                  Evaluation facility:             Brightsight
                                                                                                                                                   Brassersplein 2
                                                                                                                                                   2612 CT Delft
                                                                                                                                                   The Netherlands


                                                                                                                  Report number:                   NSCIB-CC-67206-CR4.1

                                                                                                                  Report version:                  4.1

                                                                                                                  Project number:                  67206

                                                                                                                  Author(s):                       Wouter Slegers
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                  Date:                            25 August 2020

                                                                                                                  Number of pages:                 15

                                                                                                                  Number of appendices:            0




                                                                                                                  Reproduction of this report is authorized provided the report is reproduced in its entirety.




                                                                                                 Headoffice:                        Location Leek:                   info@nl.tuv.com                   TÜV Rheinland Nederland B.V. is a
                                                                                                 Westervoortsedijk 73               Eiberkamp 10                     www.tuv.com/nl                    registered company at the Dutch
                                                                                                 NL-6827 AV Arnhem                  NL-9351 VT Leek                                                    Chamber of Commerce under
                !                                                                                                                                                     Tel. +31 (0)88 888 7 888          number 27288788
                                                                                                 P.O. Box 2220                      P.O. Box 37                      Fax +31 (0)88 888 7 879
                                                                                                 NL-6802 CE Arnhem                  NL-9350 AA Leek                                                    VAT number: NL815820380B01
                                                                                                 The Netherlands                    The Netherlands                                                    IBAN: NL61DEUT0265155096
                                                                                                 Page: 3/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                 comparing them to reference values provided in the user guidance.
                                                                                                 For the identification of the Hardware please refer to the hardware certification.
                                                                                                 Page: 9/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 2.2     Security Policy
                                                                                                 The TOE provides the cryptographic algorithms AES, DES, Triple-DES (3DES), RSA, RSA key
                                                                                                 generation, RSA public key computation, ECDSA (ECC over GF(p)) signature generation and
                                                                                                 verification, ECDSA (ECC over GF(p)) key generation, ECDH (ECC Diffie-Hellmann key-exchange, full
                                                                                                 point addition (ECC over GF(p)), standard security level SHA 1, SHA-224, SHA-256, SHA-384, SHA-
                                                                                                 512 algorithms in addition to the functionality described in the Hardware Security Target [ST-HW] for
                                                                                                 the hardware platform. The cryptographic algorithms (except SHA) are resistant against Side Channel
                                                                                                 Attacks, including Simple Power Analysis (SPA), Differential Power Analysis (DPA), Differential Fault
                                                                                                 Analysis (DFA) and timing attacks. SHA is only resistant against Side Channel Attacks and timing
                                                                                                 attacks. Details on the resistance claims are provided in the Security Target [ST], relevant details are
                                                                                                 provided in the user guidance documents.
                                                                                                 The TOE implements a software (pseudo) random number generator, which is initialised (seeded) by
                                                                                                 the hardware random number generator of the SmartMX2.
                                                                                                 The TOE also a secure copy routine, a secure compare routine, secure modular multiply routine, a
                                                                                                 secure modular add and subtract routine and includes internal security measures for residual
                                                                                                 information protection.
                                                                                                 Note that the TOE does not restrict access to the functions provided by the hardware: these functions
                                                                                                 are still directly accessible to the Smartcard embedded Software.

                                                                                                 2.3     Assumptions and Clarification of Scope

                                                                                                 2.3.1    Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in chapter 4 of the [ST].

                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.

                                                                                                 2.4     Architectural Information
                                                                                                 This chapter provides a high-level description of the IT product and its major components based on
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 the evaluation evidence described in the Common Criteria assurance family entitled “TOE design
                                                                                                 (ADV_TDS)”. The intent of this chapter is to characterise the degree of architectural separation of the
                                                                                                 major components and to show dependencies between the TOE and products using the TOE in a
                                                                                                 composition (e.g. dependencies between HW and SW).
                                                                                                 The TOE contains a Crypto Library, which provides a set of cryptographic functionalities that can be
                                                                                                 used by the Smartcard Embedded Software. The Crypto Library consists of several binary packages
                                                                                                 that are intended to be linked to the Smartcard Embedded Software. The Smartcard Embedded
                                                                                                 Software developer links the binary packages that he needs to his Smartcard Embedded Software and
                                                                                                 the whole is subsequently implemented in arbitrary memory. Please note that the crypto functions are
                                                                                                 supplied as a library rather than as a monolithic program, and hence a user of the library may include
                                                                                                 only those functions that are actually required. However, some dependencies exist; details are
                                                                                                 described in the User Guidance.
                                                                                                 The TOE is implemented as a set of subsystems. The division into subsystems is chosen according to
                                                                                                 the cryptographic algorithms provided. The whole TOE provides AES, DES, Triple-DES (3DES), RSA,
                                                                                                 RSA key generation, RSA public key computation, ECDSA (ECC over GF(p)) signature generation
                                                                                                 and verification, ECDSA (ECC over GF(p)) signature generation and verification, ECDSA (ECC over
                                                                                                 GF(p)) key generation, ECDH (ECC Diffie-Hellmann) key-exchange, full point addition (ECC over
                                                     Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bon                                             GF(p), SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 algorithms in addition to the functionality
                                                                                                 described in the Hardware Security Target [ST-HW] for the hardware platform. In addition, the TOE
                                                                                                 implements a software (pseudo) random number generator, which is initialised (seeded) by the
                                                                                                 hardware random number generator of the SmartMX2.
                                                                                                 Page: 10/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 Finally, the TOE provides a secure copy routine, a secure compare routine, a secure modular multiply
                                                                                                 routine, a secure modular add and subtract routine, and includes internal security measures for
                                                                                                 residual information protection.

                                                                                                 2.5      Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                 Type             Name                              Release     Date         Form of delivery


                                                                                                 Documents User Guidance Manual                    1.6 n
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                   2018-02-28   Electronic document
                                                                                                                                            4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification...................................................................................................     eripheral Configuration and Use, Data     1.4       PDF via NXP Doc-
                         Sheet addendum [20]                                                 Store
 Document                SmartMX3 N7021 MMU configuration & FW interface,          1.5       PDF via NXP Doc-
                         Data Sheet addendum [18]                                            Store
 Document                SmartMX3 N7021 Inter-Card Communication, Data Sheet       1.1       PDF via NXP Doc-
                         addendum [17]                                                       Store
 Document                SmartMX3 N7021 NVM Operate Function, Data Sheet           1.0       PDF via NXP Doc-
                         addendum [19]                                                       Store
 Document                NXP Secure Smart Card Controller N7021 Information on     1.4       PDF via NXP Doc-
                         Guidance and Operation, Guidance and Operation Man-                 Store
                         ual [13]
 Deliverables of the Flashloader OS
 IC Dedicated Support    Flashloader OS                                            20.0      On-chip software
 Software
 Document                SmartMX3 N7021 FlashLoader, Product Data Sheet ad-        1.3       PDF via NXP Doc-
                         dendum [15]                                                         Store
 Deliverables of the Shared OS Libraries
 IC Dedicated Support    Shared OS Libraries                                       20.0      On-chip software
 Software
 Library File            libComm                                                             SDK installer via NXP
                                                                                             DocStore
 Library File            libCrc                                                              SDK installer via NXP
                                                                                             DocStore
 Library File            libMem                                                              SDK installer via NXP
                                                                                             DocStore
 Library File            libFL                                                               SDK installer via NXP
                                                                                             DocStore
 Document                SmartMX3 N7021 Shared OS libraries, Data Sheet ad-        1.2       PDF via NXP Doc-
                         dendum [22]                                                         Store
 Deliverables of the System Mode OS
 IC Dedicated Support    System Mode OS                                            20.0      On-chip software
 Software




Final                                                                                          ©NXP N.V. 2019. All rights reserved.

Evaluation documentation                        Rev. 2.3 – 2019-06-04                                                 6 of 95
 NXP Semiconductors                                                                         N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



  Type                   Name                                                    Version     Form of Delivery
  Document               SmartMX3 N7021 NXP System Mode OS Interface, Data       1.6         PDF via NXP Doc-
                         Sheet addendum [23]                                                 Store
  Deliverables of the Symmetric Crypto Library
  IC Dedicated Support   Crypto Library Iron                                     2.0.6-01    On-chip software
  Software
  Library Files          Crypto Library Iron                                     2.0.6-01    SDK installer via NXP
                                                                                             DocStore
  Document               Crypto Library V1.0 on N7021 VA, Symmetric Cipher Li-   1.2         PDF via NXP Doc-
                         brary (SymCfg), User manual [28]                                    Store
  Document               N7021 Crypto Library, RNG Library, User manual [27]     1.3         PDF via NXP Doc-
                                                                                             Store
  Document               N7021 Crypto Library, Utils Library, User manual [29]   1.1         PDF via NXP Doc-
                                                                                             Store
  Document               Crypto Library Iron on N7021 VA, Information on Guid-   2.0         PDF via NXP Doc-
                         ance and Operation, Guidance and Operation Manual [7]               Store

                                            Tab. 1.1: Components of the TOE

The IC Hardware is delivered to the customer by secure transport in parcels sealed with special tape. The
customer can examine the tape sealing to make sure that the TOE has not been manipulated during transport.
The documentation can be downloaded by the customer from the NXP DocStore website after registration. Library
files (object files, header files and linker scripts) are also made available to the customer via NXP DocStore, as
part of a downloadable and installable SDK.
The logical dependencies of the TOE components are given in Section 1.4.3.2.
The IC Hardware is identified by a nameplate that is located in the layout of the chip (see [24] how to inspect the
nameplate). The IC Dedicated Software is identified by ’IC Dedicated Software version’, which can be read out by
the Security IC Embedded Software via a GetVersion command as described in [14].

1.4.2     Evaluated Configurations
The N7021 VA can be delivered with various configuration options as described in this section. The configu-
ration options are divided into two groups: major configuration options according to section 1.4.2.1 and minor
configuration options according to section 1.4.2.2.

1.4.2.1   Major configuration options
Three major configurations can be chosen by the customer during the ordering process:

     • Configuration based on 320 kBytes of Flash memory as code space

     • Configuration based on 240 kBytes of Flash memory as code space

     • Configuration based on 144 kBytes of ROM memory as code space



 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                               7 of 95
 NXP Semiconductors                                                                                             N7021 VA
                                                                                                                 Security Target Lite
                                                                                                                                            Public



Each major configuration is provided with several minor configuration options, which are introduced in Section
1.4.2.2. Each major configuration also provides customers with several options for reconfiguration (Post Delivery
Configuration), which are described in Section 1.4.2.3 in detail.

1.4.2.2       Minor configuration options
Minor configurations are chosen by the customer during the ordering process as detailed in Table 1.2.

   Product option            Choices                                    Description
   Customer Type             System Mode Customer, User                 Select the hierarchical interaction model of the Security IC
                             Mode Customer                              Embedded Software.
   Use Flash Loader          Yes, No                                    If selected, allow the download of an arbitrary card image into
                                                                        logical card B using the Flashloader.
   UID Option                7B UID, 4B FNUID, 10B UID                  Determines the UID setting.
   Enable Contactless        Enabled, Disabled                          If enabled, the contactless interface is activated in the product
   Interface                                                            configuration.
   Input Capacitance         17pF, 56pF, 70pF                           Nominal input capacitance for ISO/IEC 14443 contactless in-
                                                                        terface.
   Data Rate                 All, 106kbps, 106-848kbps, 106-            Set the available data rates.
                             848kbps and VHBR rates up to
                             3.2Mbps
   Enable Contact In-        Enabled, Disabled                          If enabled, the contact interface is activated in the product
   terface                                                              configuration.
   PUF option                Enabled, Disabled                          If enabled, the device supports the PUF security functionality.
   MIFARE       DESFire      Disabled, 2K, 4K, 8K, 32K                  Configure the available MIFARE DESFire image in logical
                 1
   EV2 Option                                                           card A of the system1 .
   MIFARE Plus EV1           Disabled, 2K, 4K                           Configure the available MIFARE PLUS2 image in logical card
          1
   Option                                                               A of the system1 .
   Enable Chip Health        Enabled, Disabled                          Enable the availability of Chip Health Mode (CHM).
   Mode

                                             Tab. 1.2: Evaluated minor configuration options

Regardless of the minor configuration options selected, the TOE will always remain in a certified configuration.

1.4.2.3       Post Delivery Configuration
Post Delivery Configuration (PDC) can be used by the customer after the TOE has been delivered by NXP. These
options can be used to tailor the TOE to specific customer requirements. The Post Delivery Configuration settings
can be changed multiple times but must be set permanently by the customer before the TOE is delivered to phase
7 of the life-cycle.


    1 MIFARE   emulations are not part of the TSF and are therefore not in scope of this certification.




 Final                                                                                                              ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                                   Rev. 2.3 – 2019-06-04                                                          8 of 95
 NXP Semiconductors                                                                                      N7021 VA
                                                                                                         Security Target Lite
                                                                                                                                    Public



Table 1.3 lists those configuration parameters that can be set by PDC in the NXP Secure Smart Card Controller
N7021 VA.

     PDC option                             Description
     Total requested Flash size             Define the total number of customer available Flash pages. PDC can only re-
                                            duce this value.
     Contact/contactless/dual operation     Define the operation mode which can be either "contact only", "contactless
     mode                                   only", or "dual". Interfaces can only be deactivated by PDC if they were se-
                                            lected during ordering.
     Disable cryptographic functions        Define the available cryptographic options. Each of the three functions (DES,
                                            AES, PKCC) can be independently disabled.
     Outside Anti-Wear partition size       Defines the outside anti-wear partition flash size available for logical card B.
     Card B
     Inside Anti-Wear partition size Card   Defines the inside anti-wear partition flash page size of logical card B and the
     B and Free Page Pool (FPP) size        number of additional Free Page Pool pages. Wear-levelling increases Flash
                                            endurance.
     Default logical card                   Define which logical card SM (A or B) should be launched after finishing the
                                            boot sequence.
     Default OS                             Define which operating system (either OS 1 or OS 2) should be launched after
                                            finishing the boot sequence of the selected logical card.
     Card A/Card B RAM partition split      Define how the RAM is split between Card A and Card B.
     Basic control setting and codebase     Set the codebase (memory offset) and options for OS1 in Card B.
     for OS1 in Card B
     Basic control setting and codebase     Set the codebase (memory offset) and options for OS2 in Card B.
     for OS2 in Card B

                                             Tab. 1.3: Post Delivery Configuration

As indicated in the description of the PDC options, they can only be used to downgrade some configurations,
it is not possible to enable functionality. The Post Delivery Configuration can be accessed using chip health
mode functionality in combination with the ISO/IEC 7816 contact interface. PDC configures the availability of
TSF. Deactivating TSF is identical to not utilizing the functionality and therefore the TOE will remain in a certified
configuration. For further details regarding PDC refer to [21].

1.4.2.4     Dependencies on minor configuration and PDC
Depending on the minor configuration options chosen during the ordering process, and on the changes made
using PDC, some of the security functionality mentioned in this ST is no longer available. Table 1.4 below lists
these dependencies.

   Option                   Feature              SFRs comment
   Use Flash Loader         SS.Loader            SFRs are still in place to ensure correct blocking of functionality.




 Final                                                                                                      ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                            Rev. 2.3 – 2019-06-04                                                         9 of 95
 NXP Semiconductors                                                                                    N7021 VA
                                                                                                        Security Target Lite
                                                                                                                                  Public



     Option                Feature                 SFRs comment
     Chip Health Mode      SS.RECONFIG             Feature CHM is not available, SS.RECONFIG itself is still available. PDC
                                                   also available via System Mode API.
     Disable DES           SS.HW_TDES,             Related SFRs are deactivated. (SF.Object_Reuse is still available)
                           SS.SW_DES
     Disable AES           SS.HW_AES,              Related SFRs are deactivated. AES functionality is mandatory for SF.PUF.
                           SS.SW_AES,              SS.RECONFIG needs AES for PDC configuration and CHM authentication.
                           SF.PUF,                 (SF.Object_Reuse is still available)
                           SS.RECONFIG
     PUF option            SF.PUF                  Related SFRs are deactivated.

                                       Tab. 1.4: Dependencies on minor configuration and PDC

1.4.2.5       Evaluated package types
The commercial types are named according to the format P7nxeeeypp(p)/mvrrff(o).
The characters in the above format are coded as described in Table 1.5 and Table 1.6. The commercial type name
is composed of fixed symbols, which are detailed in Table 1.5, and variable entries, which are filled in according
to the rules in Table 1.6.

 Variable       Description                                    Values                             Evaluated Options
 n              indicates ROM or Flash product                 numeric                            ’0’ for ROM, ’1’ for Flash
 x              Interface and Feature Configuration            alpha numeric                      ’D’ for Dual Interface
 eee            Indication of Flash or ROM Size, depending     alpha numeric
                on variable n
 y              MIFARE Emulation Option Configuration          alphanumeric                       ’P’ for no MIFARE emulation,
                                                                                                  ’D’ for DESFire EV2, ’M’ for
                                                                                                  MIFARE Plus EV1
 pp(p)          Package delivery type                          alpha numeric                      see table 1.6
 /              separator (mandatory)
 m              Manufacturer identifier                        alpha numeric                      ’9’ for TSMC
 v              Version of mask set                            alphabetic                         ’A’ for HW version VA
 rr             NCN number, which identifies the NXP con-      alpha numeric                      specific to a certain combi-
                tent at TOE delivery                                                              nation of major and minor
                                                                                                  options and IC Dedicated
                                                                                                  Software version and other
                                                                                                  NXP data elements
 ff             CCN number, which identifies the customer      alpha numeric                      specific to customer identity
                content at TOE delivery                                                           and content of code and data
                                                                                                  to be uploaded on behalf of
                                                                                                  the customer
 (o)            Option                                         alpha numeric, optional




 Final                                                                                                    ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                              Rev. 2.3 – 2019-06-04                                                   10 of 95
 NXP Semiconductors                                                                                 N7021 VA
                                                                                                    Security Target Lite
                                                                                                                               Public



 Variable     Description                                  Values                              Evaluated Options

                                 Tab. 1.5: Variable Definitions for Commercial Type Names



     Type     Description
     Unn      Wafer not thinner than 50µm. The numbers ”nn” in ”Unn” identify a specific wafer delivery type (thickness,
              manufacturing process and packing option)
     Xnn      Chip card module. The numbers ”nn” in ”Xnn” identify a specific chip module delivery type (module type,
              manufacturing process and packing option)
     An       Contactless chip card module or inlay type (assembly containing the TOE and a contactless antenna on
              a carrier material. The ”n” in ”An” identifies a specific contactless module or inlay delivery type (type of
              contactless module or inlay, manufacturing process and packing option)

                                            Tab. 1.6: Supported Package Types

Security during development and production is ensured for all package types listed above, for details refer to
section 1.4.4.
The commercial type name identifies major configuration and package type of the TOE as well as the Security
IC Embedded Software. However, the commercial type name does not itemize the minor configuration options of
the TOE, which are introduced in section 1.4.2.2. Instead, minor configuration options are identified during the
ordering process, which is coupled to the NCN and CCN of the commercial type name.

1.4.3       Logical Scope of TOE
1.4.3.1     Hardware Description
The TOE distinguishes five TOE modes:

   1. Super System Mode (SSM)

   2. Configuration Mode (CM)

   3. Test Mode (Test Mode)

   4. System Mode (SM)

   5. User Mode (UM)

The Super System Mode is not available to the Security IC Embedded Software. In Super System Mode the
TOE executes the Boot Software resp. the IC Dedicated Test Software. Notice that the Firmware Interface also
executes in Super System Mode and other parts are executed in System Mode and can be accessed via so-
called system calls either from User Mode or System Mode. The Security IC Embedded Software may execute in
System Mode or User Mode. Note also that the CPU itself only distinguishes between the User Mode, the System
Mode and the Super System Mode. From CPU’s perspective there is no difference between the Test Mode, the



 Final                                                                                                 ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                          Rev. 2.3 – 2019-06-04                                                    11 of 95
 NXP Semiconductors                                                                        N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



Configuration Mode and the Super System Mode. The difference from system perspective is only that the Test
Mode and Configuration Mode can extend their access rights to Special Function Registers compared to what
is visible in Super System Mode (it can grant access to test features). However, this is enforced by the Memory
Management Unit where the Test Mode and Configuration Mode are modelled as an own mode that has extended
access rights compared to Super System Mode.
The N7021 VA is able to control two different logical phases. After production of the Security IC every start-up or
reset completes with execution of the IC Dedicated Test Software. The test functionality is disabled at the end of
the production test. Afterwards, every start-up or reset ends up in System Mode or User Mode, depending on the
minor configuration ’Customer Type’ selected by the customer.
System Mode and User Mode are available to the developer of the Security IC Embedded Software. System
Mode has broader access to the hardware components available to the Security IC Embedded Software. User
Mode has restricted access to the CPU, specific Special Function Registers and the memories depending on
the access rights granted by software running in System Mode. The hardware components are controlled by the
Security IC Embedded Software via Special Function Registers. Both are interrelated to the activities of the CPU,
the Memory Management Unit, interrupt control, I/O configuration, NVM, timers and the coprocessors.
The N7021 VA provides interrupts. Interrupts force a jump to a specific fixed vector address in the ROM or Flash.
Any interrupt can therefore be controlled and guided by a specific part of the Security IC Embedded Software. In
addition, N7021 VA provides user calls and system calls. These calls have to be explicitly done by the Security
IC Embedded Software via dedicated CPU instructions. A user call starts the execution of related code dedicated
to one lower privileged mode (Super System Mode to System Mode or System Mode to User Mode). A system
call starts the execution of related code dedicated to one higher privileged mode (User Mode to System Mode or
System Mode to Super System Mode).
The Watchdog timer is intended to abort irregular program executions by a time-out mechanism and is enabled
and configured by the Security IC Embedded Software.
The N7021 VA incorporates 320 kBytes of Flash, 10 kBytes of RAM and up to 188 kBytes of program memory
available in ROM. Access control to all three memory types is enforced by a Memory Management Unit (MMU).
The System Mode OS provides a simplification of the resource management (e.g. MMU firewall settings, dynamic
segment setup, peripheral access control). The MMU partitions each memory into several parts, defined as
objects in the Hardware Access Control Policy (see section 6.1.6).
The Triple-DES coprocessor supports single DES and Triple-DES operations. Only Triple-DES in 3-key operation
(168-bit) is in the scope of this evaluation. The AES coprocessor supports AES operation with three different key
lengths of 128, 192 or 256 bit. The Public Key Crypto Coprocessor (PKCC) coprocessor supplies basic arithmetic
functions to support implementation of asymmetric cryptographic algorithms by the Security IC Embedded Soft-
ware. The random number generator provides true random numbers without pseudo random calculation. The
deterministic random number generator provides pseudo-random calculation seeded by the true random number
generator. The CRC coprocessor provides CRC generation polynomial CRC-8, CRC-16 and CRC-32.
The N7021 VA operates with a single external power supply of 1.8V, 3V or 5V nominal. Alternatively the TOE can
be supplied via the RF interface by means of inductive coupling. The maximum external clock frequency used




 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                      Rev. 2.3 – 2019-06-04                                               12 of 95
 NXP Semiconductors                                                                            N7021 VA
                                                                                               Security Target Lite
                                                                                                                         Public



for synchronization of the ISO/IEC 7816 communication is 10 MHz nominal, the CPU and all coprocessors are
supplied exclusively with an internally generated clock signal which frequency can be selected by the Security IC
Embedded Software. The N7021 VA provides power saving modes with reduced activity. These are named IDLE
Mode and SLEEP Mode, of which the latter one includes CLOCK STOP Mode.
The TOE protects secret data, which are stored to and operated by the TOE, against physical tampering. A
memory encryption is added to the memories RAM, ROM and Flash such that data stored to these memories is
encrypted. Chip shielding is added in form of active and passive shield over the whole chip surface. Sensors in
form of light, voltage, temperature and frequency sensors are distributed over the chip area. The security func-
tionality of the IC hardware platform is mainly provided by the TOE, and completed by the Security IC Embedded
Software. This causes dependencies between the security functionality of the TOE and the security functionality
provided by the Security IC Embedded Software.

1.4.3.2   Software Description
Figure 1.2 illustrates the different pieces of software available on the TOE.

                                Card A                                      Card B


                    E.g. MIFARE Plus/              NXP Libraries
                     MIFARE Desfire                    NXP                     Customer UM
                                                     libCRC
            UM




                           OS
                                                         NXP
                                                      libMem
                                                        NXP
                                                     libComm
                                                       NXP               NXP             NXP
            SM




                                                       libFL                                   Customer
                       NXP SM OS                                         SM               FL
                                                                                                  SM
                                                                         OS              OS
                                                        NXP
                                                   libSymCipher


                                               Super System Mode OS
            SSM




                              (incl. Test Software, Boot Software, Firmware Interface)


                                        Fig. 1.2: Software Components of the TOE


The N7021 VA supports two logical cards (Card A and Card B). Both logical cards are divided into a User Mode
and a System Mode. The logical location of the Security IC Embedded Software. depends on the usage of the
IC hardware platform. Card A is reserved for Security IC Embedded Software developed by NXP (for example,
a MIFARE Operating System). This code is stored in the UM-A_Code_Seg (which is the User Mode of Card
A). Card B is available for Security IC Embedded Software developed by the customer, which can be stored in



 Final                                                                                           ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                                13 of 95
 NXP Semiconductors                                                                          N7021 VA
                                                                                             Security Target Lite
                                                                                                                        Public



either UM-B_Code_Seg (User Mode of Card B) or stored in the SM-B_Code_Seg (System Mode of Card B) if the
customer is a System Mode customer. If a customer did not order any NXP developed Security IC Embedded
Software product (such as MIFARE), then User Mode Card A is not present. The physical location of the Security
IC Embedded Software can be either in ROM or in Flash and is not in the scope of this evaluation.
The separation between two logical cards (Card A and Card B) is provided by the so-called ”Vertical IP firewall”
which allows having two completely separated logical cards on the same hardware without any unintended impact
on each other. Because a logical card is also divided into a User Mode and a System Mode, it is possible to
implement a security feature called ”Secure User Mode Box”.
The ”Secure User Mode Box” makes sure that NXP code and data residing in the User Mode of Card A (for
example, a MIFARE Operating System) cannot have any security impact on the certified IC configuration. This
is achieved because the System Mode OS in logical Card A restricts access of code executed in User Mode on
logical Card A such that no influence to any other mode and card is possible. For the ”Secure User Mode Box”
fixed values are NXP defined during production.
Using shared memory segments it is possible to share data or code between the separated logical cards. The
owner of a memory block has to explicitly allow this kind of sharing. The libraries are shared between the logical
cards using this mechanism, reducing the footprint, as code only has to be present on the device once. An
Intercard communication mechanism allows the currently active card to send a message to the inactive card with
a request for card switching. This mechanism allows for the handover of execution between the logical cards.
The IC Dedicated Test Software is developed by NXP and embedded in the Test Software. The IC Dedicated
Test Software includes the test operating system, test routines for the various blocks of the circuitry, control
flags for the status of the Flash’s manufacturer area and shutdown functions to ensure that security relevant test
routines cannot be executed illegally after phase 3. This is stored in the SSM_Data_Seg. Moreover, the IC
Dedicated Test Software is used to download patch code related to System Mode (stored in SM-A_Code_Seg or
SM-B_Code_Seg) or User Mode (stored in UM-A_Code_Seg or UM-B_Code_Seg).
The IC Dedicated Support Software comprises the following parts:

   1. The Boot Software is executed after each reset of the TOE, i.e. every time when the TOE starts. It sets up the
         TOE and does some basic configuration of the hardware based on the settings stored in SSM_Data_Seg,
         respectively. The Boot Software is stored in the SSM_Code_Seg.

   2. The Firmware Interface is stored in the SSM_Code_Seg. It provides low-level flash management, the Post
         Delivery Configuration feature and basic system functionality like self-testing, error-counter handling and
         reset functionality. Notice, that Boot Software and IC Dedicated Test Software also access the Firmware
         Interface.

   3. The System Mode OS is an Operating System developed by NXP and stored in the SM-A_Code_Seg and/or
         in the SM-B_Code_Seg and is accessed by the Security IC Embedded Software via system calls. It offers
         ready-to-use resource and access management for arbitrary customer applications that do not want to be
         exposed to the more low-level features such as MMU configuration. The System Mode OS on Card A is




 Final                                                                                          ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                               14 of 95
 NXP Semiconductors                                                                        N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



         mandatory when the Flashloader OS is part of the product, when library code is shared between the logical
         cards or when Card A is activated. The System Mode OS on Card B is mandatory for User Mode customers.
         For System Mode customers who do not need any NXP library and no Flashloader OS and no activated
         Card A, the System Mode OS is deactivated and cannot be executed.

   4. The Shared OS Libraries are an optional module and can be stored in any Card and mode. It provides
         simplified communication, CRC and memory functions to the Security IC Embedded Software. The Shared
         OS Libraries are required by the Flashloader OS.

   5. The Symmetric Crypto Library is an optional library which provides functions to access AES, DES, RNG and
         Secure Operations functionality to the Security IC Embedded Software. It is mandatory for the Flashloader
         OS. The physical location of the Symmetric Crypto Library depends on the configuration selected by the
         customer. For products that include the Flashloader OS, the Symmetric Crypto Library is located in ROM.
         For products without the Flashloader OS, the physical location depends on how the customer linked the
         Symmetric Crypto Library into their Security IC Embedded Software using the development tools.

   6. The Flashloader OS is an optional module and stored in the SM-B_Code_Seg and cannot be directly ac-
         cessed by the Security IC Embedded Software. It supports the download of code and data to Flash by
         the Composite Product Manufacturer before Operational Usage (e.g. during development). This function-
         ality can be made unavailable after usage. When the Flashloader OS module is available, the Shared OS
         Libraries, Symmetric Crypto Library and System Mode OS become mandatory.

All logical dependencies of the IC Dedicated Support Software are described in the definitions above.

1.4.3.3     Security functionality dependency on optional software
As some of the modules and libraries are optional, the security functionality mentioned in this ST also becomes
optional. If the Symmetric Crypto Library is not part of the TOE, the SFRs related to SS.SW_DES, SS.SW_AES,
SS.SW_RNG and SF.Object_Reuse are not available. If the System Mode OS is optional, SS.Loader will no
longer work (as System Mode OS functionally supports SS.Loader). SF.MEM_SUB will also not be available, as
the System Mode OS makes sure that the MMU gets properly configured for this functionality.

1.4.3.4     Documentation
The documents containing a functional description and guidelines for the use of the security functionality, as
needed to develop Security IC Embedded Software, are listed in Table 1.1. The whole documentation shall be
used by the developer to develop the Security IC Embedded Software.

1.4.4       Security during Development and Production
The Security IC product life-cycle is scheduled in phases as introduced in the PP [26]. IC Development as well as
IC Manufacturing and Testing, which are phases 2 and 3 of the life-cycle, are part of the evaluation. Phase 4 the
IC Packaging is also part of the evaluation. The Security IC is delivered at the end of phase 3 or phase 4 in the
life-cycle. The development and production environment of the TOE ranges from phase 2 to TOE Delivery.



 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                       Rev. 2.3 – 2019-06-04                                              15 of 95
 NXP Semiconductors                                                                               N7021 VA
                                                                                                  Security Target Lite
                                                                                                                             Public



With respect to Application Note 3 in [26] the TOE supports the authentic delivery using the FabKey feature. For
further details refer to the data sheet [25] and the guidance and operation manual [13].
During the design and the layout process only personnel involved in the specific development project for an IC
have access to sensitive data. Different teams are responsible for the design data and for customer related data.
The production of the wafers includes two different steps regarding the production flow. In the first step the wafers
are produced with the fixed masks independent of the NCN or CCN. After that step the wafers are completed with
the product type specific data, including ROM and Flash Code, and data (if applicable) as identified by NCN and
CCN. The test process of every die is performed by a test center of NXP. Delivery processes between the involved
sites provide accountability and traceabionfidential data
                             and (ii) must configure the memory management in a way that different applications




                                          All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                              Rev. 4.4 — 29 October 2018                                                                34 of 87
PUBLIC
NXP Semiconductors                                              P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                      Security Target Lite



                             are sufficiently separated. If the Security IC Embedded Software uses random
                             numbers provided by the security service SS.RNG these random numbers must be
                             tested as appropriate for the intended purpose. This addition ensures that the
                             assumption A.Key-Function is still covered by the objective OE.Plat-Appl although
                             additional functions are being supported according to P.Add-Components.
                           • Compared to [6] a clarification has been made for the security objective “Treatment of
                             User Data (OE.Resp-Appl)”: By definition cipher or plain text data and cryptographic
                             keys are User Data. So, the Security IC Embedded Software will protect such data if
                             required and use keys and functions appropriately in order to ensure the strength of
                             cryptographic operation. Quality and confidentiality must be maintained for keys that
                             are imported and/or derived from other keys. This implies that appropriate key
                             management has to be implemented in the environment. In addition, the treatment of
                             User Data comprises the implementation of a multi-application operating system that
                             does not disclose security relevant User Data of one application to another one. These
                             measures make sure that the assumption A.Key-Function is still covered by the
                             security objective OE.Resp-Appl although additional functions are being supported
                             according to P.Add-Components.
                       The justification related to the assumption "Check of initialisation data by the Security IC
                       Embedded Software (A.Check-Init)" is as follows:
                       Since OE.Check-Init requires the Security IC Embedded Software developer to implement
                       a function assumed in A.Check-Init, the assumption is covered by the objective.
                       The justification of the additional policy and the additional assumptions show that they do
                       not contradict to the rationale already given in the PP [6] for the assumptions, policy and
                       threats defined there.




                                         All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserior approval.




                                                                                                 the evaluation evidence described in the Common Criteria assurance family entitled “TOE design
                                                                                                 (ADV_TDS)”. The intent of this chapter is to characterise the degree of architectural separation of the
                                                                                                 major components and to show dependencies between the TOE and products using the TOE in a
                                                                                                 composition (e.g. dependencies between HW and SW).
                                                                                                 The TOE contains a Crypto Library, which provides a set of cryptographic functionalities that can be
                                                                                                 used by the Smartcard Embedded Software. The Crypto Library consists of several binary packages
                                                                                                 that are intended to be linked to the Smartcard Embedded Software. The Smartcard Embedded
                                                                                                 Software developer links the binary packages that he needs to his Smartcard Embedded Software and
                                                                                                 the whole is subsequently implemented in arbitrary memory. Please note that the crypto functions are
                                                                                                 supplied as a library rather than as a monolithic program, and hence a user of the library may include
                                                                                                 only those functions that are actually required. However, some dependencies exist; details are
                                                                                                 described in the User Guidance.
                                                                                                 The TOE is implemented as a set of subsystems. The division into subsystems is chosen according to
                                                                                                 the cryptographic algorithms provided. The whole TOE provides AES, DES, Triple-DES (3DES), RSA,
                                                                                                 RSA key generation, RSA public key computation, ECDSA (ECC over GF(p)) signature generation
                                                                                                 and verification, ECDSA (ECC over GF(p)) signature generation and verification, ECDSA (ECC over
                                                                                                 GF(p)) key generation, ECDH (ECC Diffie-Hellmann) key-exchange, full point addition (ECC over
                                                     Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bon                                             GF(p), SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 algorithms in addition to the functionality
                                                                                                 described in the Hardware Security Target [ST-HW] for the hardware platform. In addition, the TOE
                                                                                                 implements a software (pseudo) random number generator, which is initialised (seeded) by the
                                                                                                 hardware random number generator of the SmartMX2.
                                                                                                 Page: 10/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 Finally, the TOE provides a secure copy routine, a secure compare routine, a secure modular multiply
                                                                                                 routine, a secure modular add and subtract routine, and includes internal security measures for
                                                                                                 residual information protection.

                                                                                                 2.5      Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                 Type             Name                              Release     Date         Form of delivery


                                                                                                 Documents User Guidance Manual                    1.6 n
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                   2018-02-28   Electronic document
                                                                                                                                            4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification...................................................................................................     eripheral Configuration and Use, Data     1.4       PDF via NXP Doc-
                         Sheet addendum [20]                                                 Store
 Document                SmartMX3 N7021 MMU configuration & FW interface,          1.5       PDF via NXP Doc-
                         Data Sheet addendum [18]                                            Store
 Document                SmartMX3 N7021 Inter-Card Communication, Data Sheet       1.1       PDF via NXP Doc-
                         addendum [17]                                                       Store
 Document                SmartMX3 N7021 NVM Operate Function, Data Sheet           1.0       PDF via NXP Doc-
                         addendum [19]                                                       Store
 Document                NXP Secure Smart Card Controller N7021 Information on     1.4       PDF via NXP Doc-
                         Guidance and Operation, Guidance and Operation Man-                 Store
                         ual [13]
 Deliverables of the Flashloader OS
 IC Dedicated Support    Flashloader OS                                            20.0      On-chip software
 Software
 Document                SmartMX3 N7021 FlashLoader, Product Data Sheet ad-        1.3       PDF via NXP Doc-
                         dendum [15]                                                         Store
 Deliverables of the Shared OS Libraries
 IC Dedicated Support    Shared OS Libraries                                       20.0      On-chip software
 Software
 Library File            libComm                                                             SDK installer via NXP
                                                                                             DocStore
 Library File            libCrc                                                              SDK installer via NXP
                                                                                             DocStore
 Library File            libMem                                                              SDK installer via NXP
                                                                                             DocStore
 Library File            libFL                                                               SDK installer via NXP
                                                                                             DocStore
 Document                SmartMX3 N7021 Shared OS libraries, Data Sheet ad-        1.2       PDF via NXP Doc-
                         dendum [22]                                                         Store
 Deliverables of the System Mode OS
 IC Dedicated Support    System Mode OS                                            20.0      On-chip software
 Software




Final                                                                                          ©NXP N.V. 2019. All rights reserved.

Evaluation documentation                        Rev. 2.3 – 2019-06-04                                                 6 of 95
 NXP Semiconductors                                                                         N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



  Type                   Name                                                    Version     Form of Delivery
  Document               SmartMX3 N7021 NXP System Mode OS Interface, Data       1.6         PDF via NXP Doc-
                         Sheet addendum [23]                                                 Store
  Deliverables of the Symmetric Crypto Library
  IC Dedicated Support   Crypto Library Iron                                     2.0.6-01    On-chip software
  Software
  Library Files          Crypto Library Iron                                     2.0.6-01    SDK installer via NXP
                                                                                             DocStore
  Document               Crypto Library V1.0 on N7021 VA, Symmetric Cipher Li-   1.2         PDF via NXP Doc-
                         brary (SymCfg), User manual [28]                                    Store
  Document               N7021 Crypto Library, RNG Library, User manual [27]     1.3         PDF via NXP Doc-
                                                                                             Store
  Document               N7021 Crypto Library, Utils Library, User manual [29]   1.1         PDF via NXP Doc-
                                                                                             Store
  Document               Crypto Library Iron on N7021 VA, Information on Guid-   2.0         PDF via NXP Doc-
                         ance and Operation, Guidance and Operation Manual [7]               Store

                                            Tab. 1.1: Components of the TOE

The IC Hardware is delivered to the customer by secure transport in parcels sealed with special tape. The
customer can examine the tape sealing to make sure that the TOE has not been manipulated during transport.
The documentation can be downloaded by the customer from the NXP DocStore website after registration. Library
files (object files, header files and linker scripts) are also made available to the customer via NXP DocStore, as
part of a downloadable and installable SDK.
The logical dependencies of the TOE components are given in Section 1.4.3.2.
The IC Hardware is identified by a nameplate that is located in the layout of the chip (see [24] how to inspect the
nameplate). The IC Dedicated Software is identified by ’IC Dedicated Software version’, which can be read out by
the Security IC Embedded Software via a GetVersion command as described in [14].

1.4.2     Evaluated Configurations
The N7021 VA can be delivered with various configuration options as described in this section. The configu-
ration options are divided into two groups: major configuration options according to section 1.4.2.1 and minor
configuration options according to section 1.4.2.2.

1.4.2.1   Major configuration options
Three major configurations can be chosen by the customer during the ordering process:

     • Configuration based on 320 kBytes of Flash memory as code space

     • Configuration based on 240 kBytes of Flash memory as code space

     • Configuration based on 144 kBytes of ROM memory as code space



 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                               7 of 95
 NXP Semiconductors                                                                                             N7021 VA
                                                                                                                 Security Target Lite
                                                                                                                                            Public



Each major configuration is provided with several minor configuration options, which are introduced in Section
1.4.2.2. Each major configuration also provides customers with several options for reconfiguration (Post Delivery
Configuration), which are described in Section 1.4.2.3 in detail.

1.4.2.2       Minor configuration options
Minor configurations are chosen by the customer during the ordering process as detailed in Table 1.2.

   Product option            Choices                                    Description
   Customer Type             System Mode Customer, User                 Select the hierarchical interaction model of the Security IC
                             Mode Customer                              Embedded Software.
   Use Flash Loader          Yes, No                                    If selected, allow the download of an arbitrary card image into
                                                                        logical card B using the Flashloader.
   UID Option                7B UID, 4B FNUID, 10B UID                  Determines the UID setting.
   Enable Contactless        Enabled, Disabled                          If enabled, the contactless interface is activated in the product
   Interface                                                            configuration.
   Input Capacitance         17pF, 56pF, 70pF                           Nominal input capacitance for ISO/IEC 14443 contactless in-
                                                                        terface.
   Data Rate                 All, 106kbps, 106-848kbps, 106-            Set the available data rates.
                             848kbps and VHBR rates up to
                             3.2Mbps
   Enable Contact In-        Enabled, Disabled                          If enabled, the contact interface is activated in the product
   terface                                                              configuration.
   PUF option                Enabled, Disabled                          If enabled, the device supports the PUF security functionality.
   MIFARE       DESFire      Disabled, 2K, 4K, 8K, 32K                  Configure the available MIFARE DESFire image in logical
                 1
   EV2 Option                                                           card A of the system1 .
   MIFARE Plus EV1           Disabled, 2K, 4K                           Configure the available MIFARE PLUS2 image in logical card
          1
   Option                                                               A of the system1 .
   Enable Chip Health        Enabled, Disabled                          Enable the availability of Chip Health Mode (CHM).
   Mode

                                             Tab. 1.2: Evaluated minor configuration options

Regardless of the minor configuration options selected, the TOE will always remain in a certified configuration.

1.4.2.3       Post Delivery Configuration
Post Delivery Configuration (PDC) can be used by the customer after the TOE has been delivered by NXP. These
options can be used to tailor the TOE to specific customer requirements. The Post Delivery Configuration settings
can be changed multiple times but must be set permanently by the customer before the TOE is delivered to phase
7 of the life-cycle.


    1 MIFARE   emulations are not part of the TSF and are therefore not in scope of this certification.




 Final                                                                                                              ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                                   Rev. 2.3 – 2019-06-04                                                          8 of 95
 NXP Semiconductors                                                                                      N7021 VA
                                                                                                         Security Target Lite
                                                                                                                                    Public



Table 1.3 lists those configuration parameters that can be set by PDC in the NXP Secure Smart Card Controller
N7021 VA.

     PDC option                             Description
     Total requested Flash size             Define the total number of customer available Flash pages. PDC can only re-
                                            duce this value.
     Contact/contactless/dual operation     Define the operation mode which can be either "contact only", "contactless
     mode                                   only", or "dual". Interfaces can only be deactivated by PDC if they were se-
                                            lected during ordering.
     Disable cryptographic functions        Define the available cryptographic options. Each of the three functions (DES,
                                            AES, PKCC) can be independently disabled.
     Outside Anti-Wear partition size       Defines the outside anti-wear partition flash size available for logical card B.
     Card B
     Inside Anti-Wear partition size Card   Defines the inside anti-wear partition flash page size of logical card B and the
     B and Free Page Pool (FPP) size        number of additional Free Page Pool pages. Wear-levelling increases Flash
                                            endurance.
     Default logical card                   Define which logical card SM (A or B) should be launched after finishing the
                                            boot sequence.
     Default OS                             Define which operating system (either OS 1 or OS 2) should be launched after
                                            finishing the boot sequence of the selected logical card.
     Card A/Card B RAM partition split      Define how the RAM is split between Card A and Card B.
     Basic control setting and codebase     Set the codebase (memory offset) and options for OS1 in Card B.
     for OS1 in Card B
     Basic control setting and codebase     Set the codebase (memory offset) and options for OS2 in Card B.
     for OS2 in Card B

                                             Tab. 1.3: Post Delivery Configuration

As indicated in the description of the PDC options, they can only be used to downgrade some configurations,
it is not possible to enable functionality. The Post Delivery Configuration can be accessed using chip health
mode functionality in combination with the ISO/IEC 7816 contact interface. PDC configures the availability of
TSF. Deactivating TSF is identical to not utilizing the functionality and therefore the TOE will remain in a certified
configuration. For further details regarding PDC refer to [21].

1.4.2.4     Dependencies on minor configuration and PDC
Depending on the minor configuration options chosen during the ordering process, and on the changes made
using PDC, some of the security functionality mentioned in this ST is no longer available. Table 1.4 below lists
these dependencies.

   Option                   Feature              SFRs comment
   Use Flash Loader         SS.Loader            SFRs are still in place to ensure correct blocking of functionality.




 Final                                                                                                      ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                            Rev. 2.3 – 2019-06-04                                                         9 of 95
 NXP Semiconductors                                                                                    N7021 VA
                                                                                                        Security Target Lite
                                                                                                                                  Public



     Option                Feature                 SFRs comment
     Chip Health Mode      SS.RECONFIG             Feature CHM is not available, SS.RECONFIG itself is still available. PDC
                                                   also available via System Mode API.
     Disable DES           SS.HW_TDES,             Related SFRs are deactivated. (SF.Object_Reuse is still available)
                           SS.SW_DES
     Disable AES           SS.HW_AES,              Related SFRs are deactivated. AES functionality is mandatory for SF.PUF.
                           SS.SW_AES,              SS.RECONFIG needs AES for PDC configuration and CHM authentication.
                           SF.PUF,                 (SF.Object_Reuse is still available)
                           SS.RECONFIG
     PUF option            SF.PUF                  Related SFRs are deactivated.

                                       Tab. 1.4: Dependencies on minor configuration and PDC

1.4.2.5       Evaluated package types
The commercial types are named according to the format P7nxeeeypp(p)/mvrrff(o).
The characters in the above format are coded as described in Table 1.5 and Table 1.6. The commercial type name
is composed of fixed symbols, which are detailed in Table 1.5, and variable entries, which are filled in according
to the rules in Table 1.6.

 Variable       Description                                    Values                             Evaluated Options
 n              indicates ROM or Flash product                 numeric                            ’0’ for ROM, ’1’ for Flash
 x              Interface and Feature Configuration            alpha numeric                      ’D’ for Dual Interface
 eee            Indication of Flash or ROM Size, depending     alpha numeric
                on variable n
 y              MIFARE Emulation Option Configuration          alphanumeric                       ’P’ for no MIFARE emulation,
                                                                                                  ’D’ for DESFire EV2, ’M’ for
                                                                                                  MIFARE Plus EV1
 pp(p)          Package delivery type                          alpha numeric                      see table 1.6
 /              separator (mandatory)
 m              Manufacturer identifier                        alpha numeric                      ’9’ for TSMC
 v              Version of mask set                            alphabetic                         ’A’ for HW version VA
 rr             NCN number, which identifies the NXP con-      alpha numeric                      specific to a certain combi-
                tent at TOE delivery                                                              nation of major and minor
                                                                                                  options and IC Dedicated
                                                                                                  Software version and other
                                                                                                  NXP data elements
 ff             CCN number, which identifies the customer      alpha numeric                      specific to customer identity
                content at TOE delivery                                                           and content of code and data
                                                                                                  to be uploaded on behalf of
                                                                                                  the customer
 (o)            Option                                         alpha numeric, optional




 Final                                                                                                    ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                              Rev. 2.3 – 2019-06-04                                                   10 of 95
 NXP Semiconductors                                                                                 N7021 VA
                                                                                                    Security Target Lite
                                                                                                                               Public



 Variable     Description                                  Values                              Evaluated Options

                                 Tab. 1.5: Variable Definitions for Commercial Type Names



     Type     Description
     Unn      Wafer not thinner than 50µm. The numbers ”nn” in ”Unn” identify a specific wafer delivery type (thickness,
              manufacturing process and packing option)
     Xnn      Chip card module. The numbers ”nn” in ”Xnn” identify a specific chip module delivery type (module type,
              manufacturing process and packing option)
     An       Contactless chip card module or inlay type (assembly containing the TOE and a contactless antenna on
              a carrier material. The ”n” in ”An” identifies a specific contactless module or inlay delivery type (type of
              contactless module or inlay, manufacturing process and packing option)

                                            Tab. 1.6: Supported Package Types

Security during development and production is ensured for all package types listed above, for details refer to
section 1.4.4.
The commercial type name identifies major configuration and package type of the TOE as well as the Security
IC Embedded Software. However, the commercial type name does not itemize the minor configuration options of
the TOE, which are introduced in section 1.4.2.2. Instead, minor configuration options are identified during the
ordering process, which is coupled to the NCN and CCN of the commercial type name.

1.4.3       Logical Scope of TOE
1.4.3.1     Hardware Description
The TOE distinguishes five TOE modes:

   1. Super System Mode (SSM)

   2. Configuration Mode (CM)

   3. Test Mode (Test Mode)

   4. System Mode (SM)

   5. User Mode (UM)

The Super System Mode is not available to the Security IC Embedded Software. In Super System Mode the
TOE executes the Boot Software resp. the IC Dedicated Test Software. Notice that the Firmware Interface also
executes in Super System Mode and other parts are executed in System Mode and can be accessed via so-
called system calls either from User Mode or System Mode. The Security IC Embedded Software may execute in
System Mode or User Mode. Note also that the CPU itself only distinguishes between the User Mode, the System
Mode and the Super System Mode. From CPU’s perspective there is no difference between the Test Mode, the



 Final                                                                                                 ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                          Rev. 2.3 – 2019-06-04                                                    11 of 95
 NXP Semiconductors                                                                        N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



Configuration Mode and the Super System Mode. The difference from system perspective is only that the Test
Mode and Configuration Mode can extend their access rights to Special Function Registers compared to what
is visible in Super System Mode (it can grant access to test features). However, this is enforced by the Memory
Management Unit where the Test Mode and Configuration Mode are modelled as an own mode that has extended
access rights compared to Super System Mode.
The N7021 VA is able to control two different logical phases. After production of the Security IC every start-up or
reset completes with execution of the IC Dedicated Test Software. The test functionality is disabled at the end of
the production test. Afterwards, every start-up or reset ends up in System Mode or User Mode, depending on the
minor configuration ’Customer Type’ selected by the customer.
System Mode and User Mode are available to the developer of the Security IC Embedded Software. System
Mode has broader access to the hardware components available to the Security IC Embedded Software. User
Mode has restricted access to the CPU, specific Special Function Registers and the memories depending on
the access rights granted by software running in System Mode. The hardware components are controlled by the
Security IC Embedded Software via Special Function Registers. Both are interrelated to the activities of the CPU,
the Memory Management Unit, interrupt control, I/O configuration, NVM, timers and the coprocessors.
The N7021 VA provides interrupts. Interrupts force a jump to a specific fixed vector address in the ROM or Flash.
Any interrupt can therefore be controlled and guided by a specific part of the Security IC Embedded Software. In
addition, N7021 VA provides user calls and system calls. These calls have to be explicitly done by the Security
IC Embedded Software via dedicated CPU instructions. A user call starts the execution of related code dedicated
to one lower privileged mode (Super System Mode to System Mode or System Mode to User Mode). A system
call starts the execution of related code dedicated to one higher privileged mode (User Mode to System Mode or
System Mode to Super System Mode).
The Watchdog timer is intended to abort irregular program executions by a time-out mechanism and is enabled
and configured by the Security IC Embedded Software.
The N7021 VA incorporates 320 kBytes of Flash, 10 kBytes of RAM and up to 188 kBytes of program memory
available in ROM. Access control to all three memory types is enforced by a Memory Management Unit (MMU).
The System Mode OS provides a simplification of the resource management (e.g. MMU firewall settings, dynamic
segment setup, peripheral access control). The MMU partitions each memory into several parts, defined as
objects in the Hardware Access Control Policy (see section 6.1.6).
The Triple-DES coprocessor supports single DES and Triple-DES operations. Only Triple-DES in 3-key operation
(168-bit) is in the scope of this evaluation. The AES coprocessor supports AES operation with three different key
lengths of 128, 192 or 256 bit. The Public Key Crypto Coprocessor (PKCC) coprocessor supplies basic arithmetic
functions to support implementation of asymmetric cryptographic algorithms by the Security IC Embedded Soft-
ware. The random number generator provides true random numbers without pseudo random calculation. The
deterministic random number generator provides pseudo-random calculation seeded by the true random number
generator. The CRC coprocessor provides CRC generation polynomial CRC-8, CRC-16 and CRC-32.
The N7021 VA operates with a single external power supply of 1.8V, 3V or 5V nominal. Alternatively the TOE can
be supplied via the RF interface by means of inductive coupling. The maximum external clock frequency used




 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                      Rev. 2.3 – 2019-06-04                                               12 of 95
 NXP Semiconductors                                                                            N7021 VA
                                                                                               Security Target Lite
                                                                                                                         Public



for synchronization of the ISO/IEC 7816 communication is 10 MHz nominal, the CPU and all coprocessors are
supplied exclusively with an internally generated clock signal which frequency can be selected by the Security IC
Embedded Software. The N7021 VA provides power saving modes with reduced activity. These are named IDLE
Mode and SLEEP Mode, of which the latter one includes CLOCK STOP Mode.
The TOE protects secret data, which are stored to and operated by the TOE, against physical tampering. A
memory encryption is added to the memories RAM, ROM and Flash such that data stored to these memories is
encrypted. Chip shielding is added in form of active and passive shield over the whole chip surface. Sensors in
form of light, voltage, temperature and frequency sensors are distributed over the chip area. The security func-
tionality of the IC hardware platform is mainly provided by the TOE, and completed by the Security IC Embedded
Software. This causes dependencies between the security functionality of the TOE and the security functionality
provided by the Security IC Embedded Software.

1.4.3.2   Software Description
Figure 1.2 illustrates the different pieces of software available on the TOE.

                                Card A                                      Card B


                    E.g. MIFARE Plus/              NXP Libraries
                     MIFARE Desfire                    NXP                     Customer UM
                                                     libCRC
            UM




                           OS
                                                         NXP
                                                      libMem
                                                        NXP
                                                     libComm
                                                       NXP               NXP             NXP
            SM




                                                       libFL                                   Customer
                       NXP SM OS                                         SM               FL
                                                                                                  SM
                                                                         OS              OS
                                                        NXP
                                                   libSymCipher


                                               Super System Mode OS
            SSM




                              (incl. Test Software, Boot Software, Firmware Interface)


                                        Fig. 1.2: Software Components of the TOE


The N7021 VA supports two logical cards (Card A and Card B). Both logical cards are divided into a User Mode
and a System Mode. The logical location of the Security IC Embedded Software. depends on the usage of the
IC hardware platform. Card A is reserved for Security IC Embedded Software developed by NXP (for example,
a MIFARE Operating System). This code is stored in the UM-A_Code_Seg (which is the User Mode of Card
A). Card B is available for Security IC Embedded Software developed by the customer, which can be stored in



 Final                                                                                           ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                                13 of 95
 NXP Semiconductors                                                                          N7021 VA
                                                                                             Security Target Lite
                                                                                                                        Public



either UM-B_Code_Seg (User Mode of Card B) or stored in the SM-B_Code_Seg (System Mode of Card B) if the
customer is a System Mode customer. If a customer did not order any NXP developed Security IC Embedded
Software product (such as MIFARE), then User Mode Card A is not present. The physical location of the Security
IC Embedded Software can be either in ROM or in Flash and is not in the scope of this evaluation.
The separation between two logical cards (Card A and Card B) is provided by the so-called ”Vertical IP firewall”
which allows having two completely separated logical cards on the same hardware without any unintended impact
on each other. Because a logical card is also divided into a User Mode and a System Mode, it is possible to
implement a security feature called ”Secure User Mode Box”.
The ”Secure User Mode Box” makes sure that NXP code and data residing in the User Mode of Card A (for
example, a MIFARE Operating System) cannot have any security impact on the certified IC configuration. This
is achieved because the System Mode OS in logical Card A restricts access of code executed in User Mode on
logical Card A such that no influence to any other mode and card is possible. For the ”Secure User Mode Box”
fixed values are NXP defined during production.
Using shared memory segments it is possible to share data or code between the separated logical cards. The
owner of a memory block has to explicitly allow this kind of sharing. The libraries are shared between the logical
cards using this mechanism, reducing the footprint, as code only has to be present on the device once. An
Intercard communication mechanism allows the currently active card to send a message to the inactive card with
a request for card switching. This mechanism allows for the handover of execution between the logical cards.
The IC Dedicated Test Software is developed by NXP and embedded in the Test Software. The IC Dedicated
Test Software includes the test operating system, test routines for the various blocks of the circuitry, control
flags for the status of the Flash’s manufacturer area and shutdown functions to ensure that security relevant test
routines cannot be executed illegally after phase 3. This is stored in the SSM_Data_Seg. Moreover, the IC
Dedicated Test Software is used to download patch code related to System Mode (stored in SM-A_Code_Seg or
SM-B_Code_Seg) or User Mode (stored in UM-A_Code_Seg or UM-B_Code_Seg).
The IC Dedicated Support Software comprises the following parts:

   1. The Boot Software is executed after each reset of the TOE, i.e. every time when the TOE starts. It sets up the
         TOE and does some basic configuration of the hardware based on the settings stored in SSM_Data_Seg,
         respectively. The Boot Software is stored in the SSM_Code_Seg.

   2. The Firmware Interface is stored in the SSM_Code_Seg. It provides low-level flash management, the Post
         Delivery Configuration feature and basic system functionality like self-testing, error-counter handling and
         reset functionality. Notice, that Boot Software and IC Dedicated Test Software also access the Firmware
         Interface.

   3. The System Mode OS is an Operating System developed by NXP and stored in the SM-A_Code_Seg and/or
         in the SM-B_Code_Seg and is accessed by the Security IC Embedded Software via system calls. It offers
         ready-to-use resource and access management for arbitrary customer applications that do not want to be
         exposed to the more low-level features such as MMU configuration. The System Mode OS on Card A is




 Final                                                                                          ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 – 2019-06-04                                               14 of 95
 NXP Semiconductors                                                                        N7021 VA
                                                                                            Security Target Lite
                                                                                                                      Public



         mandatory when the Flashloader OS is part of the product, when library code is shared between the logical
         cards or when Card A is activated. The System Mode OS on Card B is mandatory for User Mode customers.
         For System Mode customers who do not need any NXP library and no Flashloader OS and no activated
         Card A, the System Mode OS is deactivated and cannot be executed.

   4. The Shared OS Libraries are an optional module and can be stored in any Card and mode. It provides
         simplified communication, CRC and memory functions to the Security IC Embedded Software. The Shared
         OS Libraries are required by the Flashloader OS.

   5. The Symmetric Crypto Library is an optional library which provides functions to access AES, DES, RNG and
         Secure Operations functionality to the Security IC Embedded Software. It is mandatory for the Flashloader
         OS. The physical location of the Symmetric Crypto Library depends on the configuration selected by the
         customer. For products that include the Flashloader OS, the Symmetric Crypto Library is located in ROM.
         For products without the Flashloader OS, the physical location depends on how the customer linked the
         Symmetric Crypto Library into their Security IC Embedded Software using the development tools.

   6. The Flashloader OS is an optional module and stored in the SM-B_Code_Seg and cannot be directly ac-
         cessed by the Security IC Embedded Software. It supports the download of code and data to Flash by
         the Composite Product Manufacturer before Operational Usage (e.g. during development). This function-
         ality can be made unavailable after usage. When the Flashloader OS module is available, the Shared OS
         Libraries, Symmetric Crypto Library and System Mode OS become mandatory.

All logical dependencies of the IC Dedicated Support Software are described in the definitions above.

1.4.3.3     Security functionality dependency on optional software
As some of the modules and libraries are optional, the security functionality mentioned in this ST also becomes
optional. If the Symmetric Crypto Library is not part of the TOE, the SFRs related to SS.SW_DES, SS.SW_AES,
SS.SW_RNG and SF.Object_Reuse are not available. If the System Mode OS is optional, SS.Loader will no
longer work (as System Mode OS functionally supports SS.Loader). SF.MEM_SUB will also not be available, as
the System Mode OS makes sure that the MMU gets properly configured for this functionality.

1.4.3.4     Documentation
The documents containing a functional description and guidelines for the use of the security functionality, as
needed to develop Security IC Embedded Software, are listed in Table 1.1. The whole documentation shall be
used by the developer to develop the Security IC Embedded Software.

1.4.4       Security during Development and Production
The Security IC product life-cycle is scheduled in phases as introduced in the PP [26]. IC Development as well as
IC Manufacturing and Testing, which are phases 2 and 3 of the life-cycle, are part of the evaluation. Phase 4 the
IC Packaging is also part of the evaluation. The Security IC is delivered at the end of phase 3 or phase 4 in the
life-cycle. The development and production environment of the TOE ranges from phase 2 to TOE Delivery.



 Final                                                                                        ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                       Rev. 2.3 – 2019-06-04                                              15 of 95
 NXP Semiconductors                                                                               N7021 VA
                                                                                                  Security Target Lite
                                                                                                                             Public



With respect to Application Note 3 in [26] the TOE supports the authentic delivery using the FabKey feature. For
further details refer to the data sheet [25] and the guidance and operation manual [13].
During the design and the layout process only personnel involved in the specific development project for an IC
have access to sensitive data. Different teams are responsible for the design data and for customer related data.
The production of the wafers includes two different steps regarding the production flow. In the first step the wafers
are produced with the fixed masks independent of the NCN or CCN. After that step the wafers are completed with
the product type specific data, including ROM and Flash Code, and data (if applicable) as identified by NCN and
CCN. The test process of every die is performed by a test center of NXP. Delivery processes between the involved
sites provide accountability and traceabionfidential data
                             and (ii) must configure the memory management in a way that different applications




                                          All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                              Rev. 4.4 — 29 October 2018                                                                34 of 87
PUBLIC
NXP Semiconductors                                              P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                      Security Target Lite



                             are sufficiently separated. If the Security IC Embedded Software uses random
                             numbers provided by the security service SS.RNG these random numbers must be
                             tested as appropriate for the intended purpose. This addition ensures that the
                             assumption A.Key-Function is still covered by the objective OE.Plat-Appl although
                             additional functions are being supported according to P.Add-Components.
                           • Compared to [6] a clarification has been made for the security objective “Treatment of
                             User Data (OE.Resp-Appl)”: By definition cipher or plain text data and cryptographic
                             keys are User Data. So, the Security IC Embedded Software will protect such data if
                             required and use keys and functions appropriately in order to ensure the strength of
                             cryptographic operation. Quality and confidentiality must be maintained for keys that
                             are imported and/or derived from other keys. This implies that appropriate key
                             management has to be implemented in the environment. In addition, the treatment of
                             User Data comprises the implementation of a multi-application operating system that
                             does not disclose security relevant User Data of one application to another one. These
                             measures make sure that the assumption A.Key-Function is still covered by the
                             security objective OE.Resp-Appl although additional functions are being supported
                             according to P.Add-Components.
                       The justification related to the assumption "Check of initialisation data by the Security IC
                       Embedded Software (A.Check-Init)" is as follows:
                       Since OE.Check-Init requires the Security IC Embedded Software developer to implement
                       a function assumed in A.Check-Init, the assumption is covered by the objective.
                       The justification of the additional policy and the additional assumptions show that they do
                       not contradict to the rationale already given in the PP [6] for the assumptions, policy and
                       threats defined there.




                                         All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                             Rev. 4.4 — 29 October 2018                                                                35 of 87
PUBLIC
NXP Semiconductors                                           P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                   Security Target Lite




5. Extended Components Definition
                       This Security Target does not define extended components.
                       Note that the PP “Security IC Protection Profile” [6] defines extended security functional
                       requirements in chapter 5, which are included in this Security Target.
                       The extended component definition used for Random Number Generator has been taken
                       from [8].




                               BSI-DSZ-CC-1025-V3-2020

                      for

IFX_CCI_000011h, 00001Bh, 00001Eh, 000025h,
design step G12 with optional libraries and with
        specific IC dedicated software

                     from

           Infineon Technologies AG
                     BSI - Bundesamt für Sicherheit in der Informationstechnik, Postfach 20 03 63, D-53133 Bonn
                      Phone +49 (0)228 99 9582-0, Fax +49 (0)228 9582-5477, Infoline +49 (0)228 99 9582-111




Certification Report V1.0                                                                                         CC-Zert-327 V5.3
      BSI-DSZ-CC-1025-V3-2020 (*)
      IFX_CCI_000011h, 00001Bh, 00001Eh, 000025h, design step G12 with
      optional libraries and with specific IC dedicated software

      from                       Infineon Technologies AG
      PP Conformance:            Security IC Platform Protection Profile with                                      SOGIS
                                                                                                             Recognition Agreement
                                 Augmentation Packages Version 1.0, 13 January
                                 2014, BSI-CC-PP-0084-2014
      Functionality:             PP conformant plus product specific extensions
                                 Common Criteria Part 2 extended
      Assurance:                 Common Criteria Part 3 conformant
                                 EAL 6 augmented by ALC_FLR.1


The IT Product identified in this certificate has been evaluated at an approved evaluation
facility using the Common Methodology for IT Security Evaluation (CEM), Version 3.1
extended by Scheme Interpretations, by advice of the Certification Body for components
beyond EAL 5 and CC Supporting Documents as listed in the Certification Report for
conformance to the Common Criteria for IT Security Evaluation (CC), Version 3.1. CC and
CEM are also published as ISO/IEC 15408 and ISO/IEC 18045.
(*) This certificate applies only to the specific version and release of the product in its
evaluated configuration and in conjunction with the complete Certification Report and
Notification. For details on the validity see Certification Report part A chapter 5.
The evaluation has been conducted in accordance with the provisions of the certification
scheme of the German Federal Office for Information Security (BSI) and the conclusions
of the evaluation facility in the evaluation technical report are consistent with the
                                                                                                             Common Criteria
evidence adduced.                                                                                        Recognition Arrangement
This certificate is not an endorsement of the IT Product by the Federal Office for                      recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
Information Security or any other organisation that recognises or gives effect to this                              only
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 24 July 2020
For the Federal Office for Information Security



Matthias Intemann                      L.S.
Head of Branch


                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-1025-V3-2020




                       This page is intentionally left blank.




                                                                                  4 / 35
BSI-DSZ-CC-1025-V3-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................13
   3. Security Policy............................................................................................................16
   4. Assumptions and Clarification of Scope.....................................................................17
   5. Architectural Information.............................................................................................18
   6. Documentation...........................................................................................................18
   7. IT Product Testing.......................................................................................................18
   8. Evaluated Configuration.............................................................................................19
   9. Results of the Evaluation............................................................................................20
   10. Obligations and Notes for the Usage of the TOE.....................................................27
   11. Security Target..........................................................................................................28
   12. Regulation specific aspects (eIDAS, QES)..............................................................28
   13. Definitions.................................................................................................................28
   14. Bibliography..............................................................................................................29
C. Excerpts from the Criteria..............................................................................................32

D. Annexes.........................................................................................................................33




                                                                                                                                 5 / 35
Certification Report                                                               BSI-DSZ-CC-1025-V3-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carried out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BMI Regulations on Ex-parte Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]



1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     BMI Regulations on Ex-parte Costs - Besondere Gebührenverordnung des BMI für individuell
     zurechenbare öffentliche Leistungen in dessen Zuständigkeitsbereich (BMIBGebV), Abschnitt 7 (BSI-
     Gesetz) - dated 2 September 2019, Bundesgesetzblatt I p. 1365



                                                                                                        6 / 35
BSI-DSZ-CC-1025-V3-2020                                                              Certification Report




●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.
●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 35
Certification Report                                                       BSI-DSZ-CC-1025-V3-2020




This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product IFX_CCI_000011h, 00001Bh, 00001Eh, 000025h, design step G12 with
optional libraries and with specific IC dedicated software has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-1025-V2-2019. Specific
results from the evaluation process BSI-DSZ-CC-1025-V2-2019 were re-used.
The evaluation of the product IFX_CCI_000011h, 00001Bh, 00001Eh, 000025h, design
step G12 with optional libraries and with specific IC dedicated software was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 10 July 2020. TÜV
Informationstechnik GmbH is an evaluation facility (ITSEF)5 recognised by the certification
body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and  NXP eDoc Suite v3.5 on JCOP4 P71 –
     cryptovision ePasslet Suite ––
Java Card applet configuration providing
 Secure Signature Creation Device with
           key import (SSCD)

                Security Target Lite
                      NSCIB-CC-00229287

                Common Criteria / ISO 15408 / EAL 5+




                       Document Version 1.2 • 2020-12-17


      cv cryptovision GmbH • Munscheidstr. 14 • 45886 Gelsenkirchen • Germany
          www.cryptovision.com • info@cryptovision.com • +49-209-167-2450
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


                                                                               Content

1       Introduction ............................................................................................................................................ 4
    1.1          ST/TOE Identification ..................................................................................................................................... 4
    1.2          ST overview ................................................................................................................................................... 4
    1.3          TOE overview ................................................................................................................................................. 5
    1.4          TOE description ............................................................................................................................................. 5

2       Conformance claims ............................................................................................................................. 15
    2.1          CC conformance .......................................................................................................................................... 15
    2.2          Statement of Compatibility concerning Composite Security Target ........................................................... 15

3       Security problem definition .................................................................................................................. 34
    3.1          Assets, users and threat agents ................................................................................................................... 34
    3.2          Threats ......................................................................................................................................................... 34
    3.3          Organisational Security Policies................................................................................................................... 35
    3.4          Assumptions ................................................................................................................................................ 36

4       Security Objectives ............................................................................................................................... 37
    4.1          Security Objectives for the TOE ................................................................................................................... 37
    4.2          Security Objectives for the Operational Environment ................................................................................ 38
    4.3          Security Objectives Rationale .....................................                                                                                                 TÜV Rheinland Nederland B.V.




                                                                                                                                                          Certification Report
Version 2020-3




                                                                                                                    NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet
                                                                                                                    Suite – Java Card applet configuration providing Machine
                                                                                                                      Readable Travel Document with „ICAO Application”,
                                                                                                                              Extended Access Control with PACE

                                                                                                                  Sponsor:                         NXP Semiconductors Germany GmbH
                                                                                                                                                   Troplowitzstrasse 20
                                                                                                                                                   22529 Hamburg
                                                                                                                                                   Germany
                                                                                                                  Developer:                       cv cryptovision GmbH
                                                                                                                                                   Munscheidstr. 14
                                                                                                                                                   45886 Gelsenkirchen
                                                                                                                                                   Germany
                                                                                                                  Evaluation facility:             Brightsight
                                                                                                                                                   Brassersplein 2
                                                                                                                                                   2612 CT Delft
                                                                                                                                                   The Netherlands


                                                                                                                  Report number:                   NSCIB-CC-0229285-CR

                                                                                                                  Report version:                  1
® ................................................................................. 39

5       Extended Component Definition .......................................................................................................... 45
    5.1          Definition of the Family FPT_EMS ............................................................................................................... 45
    5.2          Definition of the Family FCS_RND ............................................................................................................... 46

6       IT Security Requirements ...................................................................................................................... 47
    6.1          General ........................................................................................................................................................ 47
    6.2          TOE Security Functional Requirements ....................................................................................................... 47
    6.3          TOE Security Assurance Requirements ....................................................................................................... 59
    6.4          Security Requirements Rationale ................................................................................................................ 60

7       TOE summary specification .................................................................................................................. 66
    7.1          Security Functionality .................................................................................................................................. 66
    7.2          TOE summary specification rationale .......................................................................................................... 73

8       References ............................................................................................................................................ 76
    Common Criteria ........................................................................................................................................................ 76
    Protection Profiles ..................................................................................................................................................... 76
    TOE and Platform References .................................................................................................................................... 76
    EU regulation ............................................................................................................................................................. 77
    The DIRECTIVE ........................................................................................................................................................... 77
    Application and Cryptography standards .................................................................................................................. 77



                                                                                    2 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Glossary ......................................................................................................................................................... 79




Version Control
 Version          Date                  Author                          Changes to Previous Version
 1.0              2020-12-09            Thomas Zeggel                   ST-Lite based on ST version 1.0.
 1.1              2020-12-15            Thomas Zeggel                   ST-Lite based on ST version 1.1.
 1.2              2020-12-17            Thomas Zeggel                   ST-Lite based on ST version 1.2.




                                                                             3 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


1 Introduction

1.1 ST/TOE Identification
Title:                            NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite – Java Card
                                  applet configuration providing Secure Signature Creation De-vice with key
                                  import (SSCD) – Security Target Lite
Document Version:                 v1.2
Origin:                           cv cryptovision GmbH
Compliant to:                     Protection profiles for secure signature creation device – Part 3: Device with
                                  key import; English version EN 419211-3:2013, English translation of DIN EN
                                  419211-3:2014-03; PP Registration: BSI-CC-PP-0075-2012-MA-01; October
                                  2013 [PP0075]
Product identification:           NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite
TOE identification:               NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite – Java Card
                                  applet configuration providing Secure Signature Creation Device with key
                                  import (SSCD)
Javacard OS platform:             NXP JCOP4 P71, NSCIB-CC-180212 [Cert_OS]
Security controller:              NXP N7121, Certification ID BSI-DSZ-CC-1040, [Cert_IC]
TOE documentation:                Administration and user guide [Guidance]


1.2 ST overview
This document contains the security target for SSCD compliant configuration of the NXP eDoc Suite v3.5 on
JCOP4 P71 - cryptovision ePasslet Suite. NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite is a
set of Javacard applications intended to be used exclusively on the JCOP4 P71 Javacard OS platform, which
is certified according to CC EAL 6+ [Cert_OS]. NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite
as well as the JCOP4 operating system are provided on a smart card chip based on the NXP N7121 security
controller, which is itself certified according to CC EAL 6+ [Cert_IC].
This security target is strictly conformant to the Protection Profile Protection profiles for Secure Signature
Creation Device — Part 3: Device with key import (BSI-CC-PP-0075-2012-MA-01) [PP0075].
The main objectives of this ST are:
         to introduce TOE and the SSCD application,
         to define the scope of the TOE and its security features,
         to describe the security environment of the TOE, including the assets to be protected and the
          threats to be countered by the TOE and its environment during the product development, produc-
          tion and usage.
         to describe the security objectives of the TOE and its environment supporting in terms of integrity
          and confidentiality of application data and programs and of protection of the TOE.
         to specify the security requirements which includes the TOE security functional requirements, the
          TOE assurance requirements and TOE security functionalities.
The assurance level for the TOE is CC EAL5 augmented with AVA_VAN.5 and ALC_DVS.2.




                                                     4 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


1.3 TOE overview
The TOE is a Java Card with a set of applets (NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite)
configured to provide a secure signature creation device (SSCD) with key import. To allow secure access to
the signature functionality over the contactless interface, it provides an optional PACE mechanism to build
up a secure channel for the signature PIN.


1.4 TOE description

1.4.1 Overview of NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite
NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite contains a set of Java Card applets for e-ID
document applications built upon an underlying core library. The following Table 1 provides an overview of
the individual applications included in NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite:


 Product / Application                            Specification                     Configuration
 ICAO MRTD application with Basic Access Con-     ICAO Doc 9303                     ePasslet3.5/MRTD-BAC
 tro (BAC) and Supplemental Access Control
 (SAC)
 ISO File System application                      ISO 7816                          ePasslet3.5/ISO-FS
 ISO Driving License application with Basic Ac-   ISO 18013                         ePasslet3.5/IDL-Basic
 cess Protection (BAP) or Supplemental Access
 Control (SAC)
 ISO Driving License application with Extended    ISO 18013                         ePasslet3.5/IDL-Extended
 Access Protection (EAP) or Extended Access
 Control (EACv1)
 ICAO MRTD application with Extended Access       ICAO Doc 9303, TR03110v1.11       ePasslet3.5/MRTD-EAC
 Control (EACv1)
 Secure Signature Creation Device application     ISO 7816, PKCS#15                 ePasslet3.5/SSCD
 supporting PKI utilization – Device with key
 generation
 Secure Signature Creation Device application     ISO 7816, PKCS#15                 ePasslet3.5/SSCD-IMP
 supporting PKI utilization – Device with key
 import
 EU Electronic Vehicle Registration application   EU Council Directive 1999/37/EC   ePasslet3.5/eVR
 EU Electronic Health Insurance application       CWA 15974                         ePasslet3.5/eHIC
 German eID Document application                  ICAO Doc 9303, TR03110v2.11,      ePasslet3.5/GeID
                                                  TR03127 v1.15
 Customizable eID Document application            ICAO Doc 09303 and                ePasslet3.5/GenID
                                                  TR03110v2.11
 EU Electronic Residence Permit application       TR03127 v1.15                     ePasslet3.5/eRP


Table 1: Configurations of the NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite. Please note
that not all configurations are certified according to Common Criteria. The TOE of this ST is marked in yel-
low.




                                                      5 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


These configurations are based on one or more predefined applets; different configurations might use the
same underlying applet.
The whole applet code resides in the Flash memory; the applets providing these different configurations
are instantiated into Flash memory. Multiple configurations (and hence support for different applications)
can be present at the same time by instantiating multiple applets with their distinct configurations with
some restrictions detailed below. A common combination could be an ICAO MRTD applet and an SSCD ap-
plet providing a travel application with LDS data and EAC authentication together with a signature applica-
tion.
Via configuration the instanciated applets can be tied to the contactless and/or the contact interface, re-
spectively.

1.4.2 TOE definition
The TOE is a combination of hardware and software configured to securely create, use and manage signa-
ture-creation data (SCD). The TOE consists of
       the circuitry of the chip (the integrated circuit, IC) including the contact-based interface with hard-
        ware for the contactless interface including contacts for the antenna, providing basic cryptographic
        functionalities,
       the platform with the Java Card operation system JCOP4 together with the JCOP4 P71 documenta-
        tion according to [ST_OS],
       NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite – Java Card applet configuration
        providing a secure signature creation device (SSCD) with key import1
       the associated Administrator and User Guidance [Guidance] in PDF format and the platform docu-
        mentation.


                              TOE boundary




              Instantiated             Other instantiated ap-                      3rd party
             Applet of the              plet using ePasslet                         applet
             ePasslet Suite            Suite code (bytecode                       (bytecode
              according to             verified according to                      verified ac-
             User Guidance                User Guidance)                          cording to
                                                                                  User Guid-
                                                                                     ance)
             NXP eDoc Suite v3.5 on JCOP4 P71 - cryptovision
               ePasslet Suite code in non-volatile memory
                               (Flash image)

                                          Javacard OS: NXP JCOP4


                                           Hardware: NXP N7121



1Please note that there are two different options: a configuration for the contact-based interface, or a
configuration for the contactless interface with additional PACE mechanism.

                                                     6 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite



Figure 1: Schematic view on the Target of Evaluation (TOE) and its boundaries. The TOE is based on the
certified hardware and Javacard OS. Besides the NXP eDoc Suite v3.5 on JCOP4 - cryptovision ePasslet Suite
code in non-volatile memory and the applet instantiated from it which forms the TOE of this security target,
it may also contain additional applets which are not part of the TOE.


The TOE’s functionality claimed by this security target is realized by the NXP eDoc Suite v3.5 on JCOP4 P71
- cryptovision ePasslet Suite in SSCD with key import configuration. The SSCD configuration with key import
provides a PKCS#15 compliant file structure and a separate DF for the SSCD functionality (D.Sig). While D.Sig
provides the TOE’s functionality claimed by this security target, the PKCS#15 part is out of scope of the
certification.

1.4.3 TOE delivery and identification
The delivery comprises the following items:
 Type                                 Name                                     Form of delivery
 Hardware                             NXP Secure Smart Card Control- Micro Controller including on-
                                      ler N7121 with IC Dedicated Soft- chip software: Firmware and
                                      ware and Crypto Library           Crypto Lib. The TOE is delivered
                                                                        as wafer or module. The TOE can
                                                                        be collected at NXP site or is be-
                                                                        ing shipped to the customer. See
                                                                        [AGD_PRE] for details.
 JCOP4 P71 OS                         ROM Code (Platform ID)                   On-chip software: JCOP4 P71 OS
                                      FLASH content (FLASH ID)                 included in the Micro Controller
                                      Patch Code (Patch ID)
 NXP eDoc Suite v3.5 on JCOP4 Javacard Package                                 On-chip software: NXP eDoc
 P71 - cryptovision ePasslet Suite                                             Suite included in the Micro Con-
                                                                               troller
 Document                             JCOP4 P71 User Guidance and Electronic document via NXP
                                      Administration Manual (cf. DocStore
                                      [ST_OS])
 Document                             HW Objective Data Sheet Electronic document via NXP
                                      (Conﬁguration Banking & Secure DocStore
                                      ID), cf. [ST_OS]
 Document                             Guidance documentation of the Electronic documents via NXP
                                      certified eDoc Suite configura- DocStore
                                      tion [Guidance]; it consists of
                                      three documents:
                                      (1) NXP eDoc Suite v3.5 on JCOP4
                                      - cryptovision ePasslet Suite –
                                      Java Card Applet Suite providing
                                      Electronic ID Documents applica-
                                      tions. Guidance Manual.
                                      (2)   Preparation         Guidance
                                      (AGD_PRE).



                                                     7 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


                                      (3)  Operational          Guidance
                                      (AGD_OPE).
                                            Table 2: Delivery items

Identification of the platform is performed by the procedure according to [AGD_PRE].
Once the platform is identified correctly, the correct version of the Java card layer of the TOE (NXP eDoc
Suite v3.5 on JCOP4 P71 - cryptovision ePasslet Suite, version 3.5) can be verified as descibed in [Guidance].

1.4.4 TOE functions
The TOE comprises all IT security functionality necessary to ensure the secrecy of the SCD and the security
of the digital signature. The TOE provides the following functions:

       to import signature creation data (SCD) and, optionally, the correspondent signature verification
        data (SVD),
       to, optionally, receive and store certificate info,
       to switch the TOE from a non-operational state to an operational state, and
       if in an operational state, to create electronic signatures for data with the following steps:
        a) select an SCD if multiple are present in the SSCD,
        b) authenticate the signatory and determine its intent to sign,
        c) receive data to be signed or a unique representation thereof (DTBS/R)
        d) apply an appropriate cryptographic signature-creation function using the selected SCD to the
           DTBS/R.
The TOE may implement its function for digital signature creation to conform to the specifications in ETSI
TS 101 733 (CAdES) [CADES], ETSI TS 101 903 (XAdES) [XADES] and ETSI TS 101 903 (PADES) [PADES].
The TOE is prepared for the signatory's use by
       import at least one set of SCD, and
       personalising for the signatory by storing in the TOE:
        a) the signatory’s reference authentication data (RAD)
        b) optionally, certificate info for at least one SCD in the TOE.
After preparation the SCD shall be in a non-operational state. Upon receiving a TOE the signatory shall verify
its non-operational state and change the SCD state to operational.

After import the SCD is in a non-operational state. Upon receiving a TOE the signatory shall verify its non-
operational state and change the SCD state to operational.

After preparation the intended legitimate user should be informed of the signatory’s verification authenti-
cation data (VAD) required for use of the TOE in signing. If the VAD is a password or PIN, the means of
providing this information is expected to protect the confidentiality and the integrity of the corresponding
RAD.

If the use of an SCD is no longer required, then it should be destroyed (e.g. by erasing it from memory) as
well as the associated certificate info, if any exists.

1.4.5 Operation of the TOE
This paragraph presents a functional overview of the TOE in its distinct operational environments:


                                                     8 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


       The preparation environment, where the TOE interacts with a certification service provider (CSP)
        through a SCD/SVD generation application to import the signature creation data (SCD) and a certif-
        icate generation application (CGA) to obtain a certificate for the signature validation data (SVD)
        corresponding to the SCD the certification service provider has generated. The SCD/SVD generation
        application transmits the SVD to the CGA. The initialisation environment interacts further with the
        TOE to personalise it with the initial value of the reference authentication data (RAD).
       The signing environment where the TOE interacts with a signer through a signature creation appli-
        cation (SCA) to sign data after authenticating the signer as its signatory. The signature creation ap-
        plication provides the data to be signed (DTBS), or a unique representation thereof (DTBS/R) as
        input to the TOE signature creation function and obtains the resulting digital signature2.
       The management environments where the TOE interacts with the user or an SSCD-provisioning ser-
        vice provider to perform management operations, e.g. for the signatory to reset a blocked RAD. A
        single device, e.g. a smart card terminal, may provide the required secure environment for man-
        agement and signing.
The preparation environment, the signing environment and the management environment are secure and
protect data exchanged with the TOE. Figure 3 in prEN 14169-1:2011 illustrates the operational environ-
ment.
The TOE stores signature creation data (SCD) and reference authentication data (RAD). The TOE may store
multiple instances of SCD. In this case the TOE provides a function to identify each SCD and the SCA can
provide an interface to the signer to select an SCD for use in the signature creation function of the SSCD.
The TOE protects the confidentiality and integrity of the SCD and restricts its use in signature creation to its
signatory. The digital signature created by the TOE may be used to create an advanced electronic signature
as defined in Article 5.1 of the [Directive]3. Determining the state of the certificate as qualified is beyond
the scope of this standard.
The signature creation application is assumed to protect the integrity of the input it provides to the TOE
signature creation function as being consistent with the user data authorised for signing by the signatory.
Unless implicitly known to the TOE, the SCA indicates the kind of the signing input (as DTBS/R) it provides
and computes any hash value required. The TOE may augment the DTBS/R with signature parameters it
stores and then computes a hash value over the input as needed by the kind of input and the used crypto-
graphic algorithm.
The TOE stores signatory reference authentication data (RAD) to authenticate a user as its signatory. The
RAD is a password (e.g. PIN), a biometric template or a combination of these. The TOE protects the confi-
dentiality and integrity of the RAD. The TOE may provide a user interface to directly receive verification
authentication data (VAD) from the user, alternatively, the TOE receive the VAD from the signature creation
application (SCA). If the signature creation application handles, is requesting or obtaining a VAD from the
user, it is assumed to protect the confidentiality and integrity of this data.
A certification service provider and a SSCD-provisioning service provider interact with the TOE in the secure
preparation environment to perform any preparation function of the TOE required before control of the
TOE is given to the legitimate user. These functions may include:
       initialising the RAD,
       generating a key pair,

2 At a pure functional level the SSCD creates a digital signature; for an implementation of the SSCD, in that
meeting the requirements of this PP and with the key certificate created as specified in the Directive, Annex
I, the result of the signing process can be used as to create a qualified electronic signature.
3Please note that while this security target - following the according protection profile BSI-CC-PP-0075-
2012-MA-01 - references the [Directive], it also incorporates the requirements of the eIDAS regulation [Re-
gulation] and the according commission implementing regulation [Implementing].

                                                     9 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


         storing personal information of the legitimate user.
In the case at hand the TOE is a smart card or electronic ID document. In this case a smart-card terminal
may be deployed that provides the required secure environment to handle a request for signatory authori-
zation. A signature can be obtained on a document prepared by a signature-creation application component
running on personal computer connected to the card terminal. The signature creation application, after
presenting the document to the user and after obtaining the authorization PIN initiates the electronic sig-
nature creation function of the smart card through the terminal.
The RAD verification is typically performed by direct PIN verification (VERIFY PIN command); to further pro-
tect the RAD (password or PIN) – especially in a contactless application scenario – the Password Authenti-
cated Connection Establishmanet (PACE) protocol according to [TR03110] can be used.

1.4.6 Major security features of the TOE
The TOE provides the following TOE security functionalities:
         TSF_Access manages the access to objects (files, directories, data and secrets) stored in the applet’s
          file system. It also controls write access of initialization, pre-personalization and personalization
          data4.
         TSF_Admin manages the storage of manufacturing data, pre-personalization data and personaliza-
          tion data.
         TSF_Secret ensures secure management of secrets such as cryptographic keys. This covers secure
          key storage, access to keys as well as secure key deletion. These mechanisms are mainly provided
          by TSF_OS.
         TSF_Crypto performs high level cryptographic operations. The implementation is mainly based on
          the Security Functionalities provided by TSF_OS.
         TSF_SecureMessaging realizes a secure communication channel.
         TSF_Auth realizes two authentication mechanisms: PIN verification and alternatively authentication
          with the PACE protocol.
         TSF_Integrity protects the integrity of internal applet data like the Access control lists.
         TSF_OS contains all security functionalities provided by the certified platform (IC, Javacard opera-
          tion system). The cryptographic operations needed for this TOE are provided by the platform:
              o   Electronic signature-generation with RSA and key sizes of 2000 up to 4096 bit in steps of 1
                  bit, or ECDSA with key sizes of key sizes of 160 bit to 521 bit in steps of one bit.
              o   Secure messaging with AES (128, 192 or 256 bit key length).
              o   PACE authentication with key lengths of 160 bit to 521 bit in steps of one bit (ECC).

1.4.7 TOE life cycle
This paragraph is based on the protection profile [PP0075].

1.4.7.1    General



4 In the context of this security target the three categories are defined as follows: initialization comprises
the preparation of the TOE based on proprietary operations of the platform with the Java Card operation
system; pre-personalization comprises the configuration of the card manager and security domains as well
as the generation of applet instances using Global Platform commands. Personalization is carried out after-
wards using commands of the applet layer of the TOE.

                                                     10 of 82
 NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


The TOE life cycle distinguishes stages for development, production, preparation and operational use. The
development and production of the TOE (cf. CC part 1 [CC_1], para.139) together constitute the develop-
ment phase of the TOE.


   Hardware
   development
   and certifica-
                                                                                            NXP      eDoc
   tion
                                                 Javacard OS                                Suite v3.5 on
                           Guidance                                                         JCOP4 - cryp-
                                                 development
                           manuals,                                                         tovision
                                                 and certifica-
                           samples                                                          ePasslet
                                                 tion
                                                                          Guidance          Suite devel-
                                                                          manuals,          opment and
                                                                          samples           certification
                           Secure de-
                           livery     of
   Hardware                chips as cer-         Secure pro-
   production              tified in CC          duction     of
                           hardware              chips with Ja-           Secure de-
                           certification         vacard OS and            livery of ap-
                                                 NXP      eDoc            plet code as
                                                 Suite v3.5 on            certified in
                                                 JCOP4 - cryp-            CC applet
                                                 tovision                 certification
                                                 ePasslet Suite
                                                 in       Flash
                                                 memory


Figure 2: Overview of the development phase of the TOE, which contains development and production
of the TOE. After the secure production following the process certified for the Javacard OS, the chips are
delivered to the SSCD provisioning service using the delivery process already established for the OS. Gray
boxes indicate the steps which are subject to evaluation according to the assurance life cycle (ALC) class.



The development phase is subject of CC evaluation according to the assurance life cycle (ALC) class.


The development phase ends with the delivery of the TOE to an SSCD-provisioning service provider or a
card manufacturer. This is also the end of the scope of the certification according to Common Criteria.




                                                     11 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite




          CSP                                Development phase (see fig. 2)
      SCD/SVD GA
  SCD/SVD generation                                                    Delivery to SSCD provisioning service
  SCD export
  SVD export                      SSCD preparation
                                  Installation of SSCD             Personalisation for the
                                  SCD/SVD import                   signatory

                                  SVD import*                      RAD installation

                                  import of certificate info       VAD definition

          CSP
           CGA                                                         Delivery to Signatory
 Certificate generation
 Directory service                SSCD operational use

                                              Operational usage of SCD
                                              Signature creation

                                              Destruction of SCD
                                              destruction of SCD
                                              deletion of certificate info


                                                        Usage phase


Figure 3: Example of TOE lifecycle following figure 1 of [PP0075]. Note that import of certificate info during
TOE preparation and deletion of certificate info when SCD is destroyed are optional. The delivery to the
SSCD provisioning service after the development phase is also the end of the scope of the certification ac-
cording to Common Criteria.

The operational usage of the TOE comprises the preparation stage and the operational use stage. The TOE
operational use stage begins when the signatory has obtained both the VAD and the TOE. Enabling the TOE
for signing requires at least one set of SCD stored in its memory.
Figure 3 shows an example of the lifecycle where an SCD or SCD/SVD pair is imported from SSCD-
provisioning service before delivery to the signatory. The lifecycle may allow import of SCD or SCD/SVD key
pairs after delivery to the signatory as well.
The TOE life cycle ends when all keys stored in it have been rendered permanently unusable. Rendering a
key in the SSCD unusable may include deletion of any stored corresponding certificate info. The lifecycle
may allow generation of SCD or SCD/SVD key pairs after delivery to the signatory as well.

1.4.7.2   Preparation stage
The preparation phase of the TOE lifecycle is processing the TOE from the customer's acceptance of the
delivered TOE to a state ready for operation by the signatory. The customer receiving the TOE from the


                                                    12 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


manufacturer is the SSCD-provisioning service that prepares and provides the SSCD to subscribers. The
preparation includes
         Create and configure the signature application according to AGD_PRE; this step involves applet
          instanciation as well as creation of the file system (card profile).5
         The personalisation of the TOE for use by the signatory, i.e. the installation of the RAD in the TOE
          and handover of VAD to the signatory.
         The initialisation of the TOE, i.e. the CSP generates the SCD/SVD pair by means of a SCD/SVD gen-
          eration device, loads the SCD to the TOE, and sends the SVD to the CGA. The TOE may import and
          store the SCD/SVD pair.
         The generation of the (qualified) certificate containing among others (cf. [1], Annex II)
              a) the SVD which correspond to SCD under the control of the signatory;
              b) the name of the signatory or a pseudonym, which is to be identified as such,
              c) an indication of the beginning and end of the period of validity of the certificate.

         The preparation may include optional loading of the certificate info into the SSCD for signatory con-
          venience.
The CSP generates a SCD/SVD pair and imports SCD, and optionally also SVD, into the SSCD. The CSP ensures
          a) the correspondence between SCD and SVD,
          b) that algorithm and key size for the SVD are appropriate.

Please take note that verifying whether the claimed identity of the signer originates from that given SSCD
has to be done by the CSP operating the CGA.
If the TOE is used for creation of advanced electronic signatures, the certificate links the signature verifica-
tion data to the person (i.e. the signatory) and confirms the identity of that person (cf. [Directive], article 2,
Clause 9).
This security target requires the TOE to provide mechanisms for import of SCD, implementation of the SCD
and personalisation. The environment is assumed to protect all other processes for TOE preparation like
SCD transfer between the SCD/SVD generation device and the TOE, and SVD transfer between the SCD/SVD
generation device and the CGA. The CSP may export the SVD to the TOE for internal use by the TOE (e.g.,
self-test).
Before generating a (qualified) certificate, the CSP is expected to first store the SCD in a SSCD. A secure
channel with the TOE may be used to support this, by ensuring integrity of the SCD during transmission to
the TOE.

1.4.7.3    Operational use stage
In this lifecycle stage the signatory can use the TOE to create advanced electronic signatures.
The operational phase of the TOE starts when at least one SCD/SVD pair is generated by the CSP and the
SCD is imported into the SSCD and when the signatory takes control over the TOE and makes the SCD oper-
ational. The signatory uses the TOE with a trustworthy SCA in a secured environment only. The SCA is as-
sumed to protect the DTBS/R during the transmission to the TOE.




5 This preparation step has been added to the life cycle definition of the underlying Protection Profile and
is necessary to provide the basic functionality (i.e. application and file system) for the following steps. It
may be performed by the SSCD-provisioning service provider directly or by a separate entity (card manu-
facturer).

                                                    13 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


The signatory can also interact with the SSCD to perform management tasks, e.g. reset a RAD value or use
counter if the password/PIN in the reference data has been lost or blocked. Such management tasks require
a secure environment.
The signatory can render an SCD in the TOE permanently unusable. Rendering the last SCD in the TOE per-
manently unusable ends the life of the TOE as SSCD.
The TOE may support functions to generate additional signing keys. If the TOE supports these functions it
will support further functions to securely obtain certificates for the new keys. For an additional key the
signatory may be allowed to choose the kind of certificate (qualified, or not) to obtain for the SVD of the
new key. The signatory may also be allowed to choose some of the data in the certificate request for in-
stance to use a pseudonym instead of the legal name in the certificate5. If the conditions to obtain a quali-
fied certificate are met, the new key can also be used to create advanced electronic signatures. The optional
TOE functions for additional key generation and certification may require additional security functions in
the TOE and an interaction with the SSCD-provisioning service provider in an environment that is secure.
The TOE life cycle as SSCD ends when all SCD stored in the TOE are destructed. This may include deletion of
the corresponding certificates.




                                                    14 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


2 Conformance claims

2.1 CC conformance
This security target claims conformance6 to:
     Common Criteria for Information Technology Security Evaluation, Part 1: Introduction and General
        Model; Version 3.1, Revision 5, April 2017; CCMB-2017-04-001, [CC_1],
     Common Criteria for Information Technology Security Evaluation, Part 2: Security Functional Re-
        quirements; Version 3.1, Revision 5, April 2017; CCMB-2017-04-002, [CC_2],
     Common Criteria for Information Technology Security Evaluation, Part 3: Security Assurance Re-
        quirements; Version 3.1, Revision 5, April 2017; CCMB-2017-04-003, [CC_3],
as follows:
     Part 2 extended,
     Part 3 conformant,
     Package conformant to EAL5 augmented with AVA_VAN.5 and ALC_DVS.2 defined in CC part 3
        [CC_3].
The
          Common Methodology for Information Technology Security Evaluation, Evaluation Methodology;
           Version 3.1, Revision 5, April 2017; CCMB-2017-04-004, [CC_4]

has to be taken into account.


This security target is strictly conformant to the protection profile [PP0075]. To cover the additional PACE
functionality the following SFR have been added:
          FCS_COP.1/PACE
          FCS_RND.1


The evaluation of the TOE uses the result of the CC evaluation of the NXP N7871 chip claiming conformance
to the PP [PP0084]. The hardware part of the composite evaluation is covered by the certification report
[Cert_IC]. In addition, the evaluation of the TOE uses the result of the CC evaluation of the NXP JCOP4 P71
Javacard OS. The Javacard OS as part of the composite evaluation is covered by the certification report
[Cert_OS].


2.2 Statement of Compatibility concerning Composite Security Target

2.2.1 Assessment of the Platform TSFs
The following table lists all Security Functionalities of the underlying Platform ST and shows, which Security
Functionalities of the Platform ST are relevant for this Composite ST and which are irrelevant. The first col-
umn addresses specific Security Functionality of the underlying platform, which is assigned to Security Func-
tionalities of the Composite ST in the second column. The last column provides additional information on
the correspondence if necessary.

6   The referenced version of the Common Criteria has been updated to version 5.

                                                    15 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform TSF-group                   Correspondence in this ST          References/Remarks
SF.JCVM                              -                                  Java Card Virtual Machine
SF.CONFIG                            -                                  Configuration Management
SF.OPEN                              -                                  Card Content Management
SF.CRYPTO                            TSF_Crypto                         Cryptographic Functionality
SF.RNG                               TSF_Crypto                         Random Number Generator
                                                                        Part of TSF.Crypto
SF.DATA_STORAGE                      TSF_Secret                         Secure Data Storage
SF.PUF                               -                                  User Data Protection using PUF
                                                                        PUF functionality is not used in the
                                                                        TOE
SF.EXT_MEM                           -                                  External Memory
                                                                        Not used in the TOE.
SF.OM                                -                                  Java Object Management
SF.MM                                TSF_Secret                         Memory Management
SF.PIN                               TSF_Auth                           PIN Management
                                                                        This platform TSF focuses on PIN au-
                                                                        thentication.
SF.PERS_MEM                          -                                  Persistent Memory Management
SF.EDC                               TSF_Integrity                      Error Detection Code API
SF.HW_EXC                            TSF_Integrity                      Hardware Exception Handling
SF.RM                                -                                  Restricted Mode
SF.PID                               TSF_Admin                          Platform Identification
                                                                        SF.PID provides a platform identifier.
                                                                        This platform identifier is generated
                                                                        during the card image generation.
                                                                        The platform identifier contains IDs
                                                                        for:
                                                                        • NVM content (stored during romiz-
                                                                        ing)
                                                                        • Patch Level (stored during romiz-
                                                                        ing, can be changed during personal-
                                                                        ization if patch is loaded)
                                                                        • ROM code (stored during romizing)
                                                                        • ROM code checksum (stored dur-
                                                                        ing romizing or during first TOE
                                                                        boot).
                                                                        It identifies unambiguously the NVM
                                                                        and ROM part of the TOE.
SF.SMG_NSC                           TSF_Crypto, TSF_Secret             No Side-Channel




                                                     16 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


 SF.ACC_SBX                          -                                  Secure Box
                                                                        The functionality is not used for the
                                                                        TOE.
 SF.MOD_INVOC                        -                                  Module Invocation
 SF.RENS_RES                         -                                  Sensitive Result


                      Table 3: Relevant platform TSF-groups and their correspondence

2.2.2 Assessment of the Platform SFRs
The following table provides an assessment of all Platform SFRs. The Platform SFRs are listed in the order
used within the security target of the platform [ST_OS].


 Platform SFR                                 Correspondence in this References/Remarks
                                              ST
 COREG_LC Security Functional Requirements (chapter 7.2.1 in platform ST)
 Firewall Policy (chapter 7.2.1.1 in platform ST)
 FDP_ACC.2[FIREWALL]                          No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall). The resulting requirements for
                                                                           applets are reflected in the User
                                                                           Guidance of the TOE.
                                                                           No contradiction to this ST.
 FDP_ACF.1[FIREWALL]                          No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall). The resulting requirements for
                                                                           applets are reflected in the User
                                                                           Guidance of the TOE.
                                                                           No contradiction to this ST.
 FDP_IFC.1[JCVM]                              No correspondence            Out of scope (internal Java Virtual
                                                                           Machine).
                                                                           No contradiction to this ST.
 FDP_IFF.1[JCVM]                              No correspondence            Out of scope (internal Java Virtual
                                                                           Machine). No contradiction to this
                                                                           ST.
 FDP_RIP.1[OBJECTS]                           No correspondence.           Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
 FMT_MSA.1[JCRE]                              No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
 FMT_MSA.1[JCVM]                              No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
 FMT_MSA.2[FIREWALL-JCVM]                     No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall). The resulting requirements for


                                                    17 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
                                                                           applets are reflected in the User
                                                                           Guidance of the TOE.
                                                                           No contradiction to this ST.
FMT_MSA.3[FIREWALL]                           No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall). The resulting requirements for
                                                                           applets are reflected in the User
                                                                           Guidance of the TOE.
                                                                           No contradiction to this ST.
FMT_MSA.3[JCVM]                               No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
FMT_SMF.1                                     No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
FMT_SMR.1                                     No correspondence            Out of scope (internal Java Card Fire-
                                                                           wall).
                                                                           No contradiction to this ST.
Application Programming Interface (chapter 7.2.1.2 in platform ST)
FCS_CKM.1                                     No correspondence            Out of scope of the TOE. No contra-
(FCS_CKM.1.1, FCS_CKM.1.1[PUF])                                            diction to this ST.
FCS_CKM.2                                     No correspondence.           Out of scope. No contradiction to this
                                                                           ST.
FCS_CKM.3                                     No correspondence.           Out of scope. No contradiction to this
                                                                           ST.
FCS_CKM.4                                     FCS_CKM.4                    The Java Card platform fulfills the re-
(FCS_CKM.4.1, FCS_CKM.4.1[PUF])                                            quirement that all keys are physically
                                                                           overwritten in a randomized man-
                                                                           ner].
                                                                           No contradiction to this ST.
FCS_COP.1                                     FCS_COP.1/SIG                The requirement FCS_COP.1/SIG of
(FCS_COP.1.1[PUF_AES]                         FCS_COP.1/PACE               this ST targets electronic signature
                                                                           generation and is fulfilled by the plat-
FCS_COP.1.1[PUF_MAC]                                                       form SFR targeting signature genera-
FCS_COP.1.1[TripleDES]                                                     tion
FCS_COP.1.1[AES]                                                           FCS_COP.1.1[RSASignaturePKCS1]
                                                                           and FCS_COP.1.1[ECSignature].
FCS_COP.1.1[RSACipher]
                                                                           FCS_COP.1/PACE uses the platform
FCS_COP.1.1[ECDHPACEKeyAgreement]
                                                                           functionality    required     by
FCS_COP.1.1[PIV]                                                           FCS_COP.1.1[AES]             and
FCS_COP.1.1[ECDH_P1363]
FCS_COP.1.1[DESMAC]
FCS_COP.1.1[AESMAC]



                                                    18 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
FCS_COP.1.1[RSASignaturePKCS1]                                             FCS_COP.1.1[ECDHPACEKeyAgreeme
FCS_COP.1.1[ECSignature]                                                   nt]
FCS_COP.1.1[ECAdd]                                                         The according hash functions of
                                                                           FCS_COP.1/SIG of this ST are pro-
FCS_COP.1.1[SHA]                                                           vided by FCS_COP.1.1[SHA].
FCS_COP.1.1[AES_CMAC]                                                      No contradictions to this ST.
FCS_COP.1.1[DAP])
FDP_RIP.1[ABORT]                              No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[APDU]                               No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[GlobalArray_Refined]                No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[bArray]                             No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[KEYS]                               No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[TRANSIENT]                          No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ROL.1[FIREWALL]                           No correspondence.           Out of scope (internal Java Card Fire-
                                                                           wall). The resulting requirements for
                                                                           applets are reflected in the User
                                                                           Guidance of the TOE.
                                                                           No contradiction to this ST.
Card Security Management (chapter 7.2.1.3 in platform ST)
FAU_ARP.1                                     FPT_FLS.1, FPT_PHP.3         Not directly corresponding, but plat-
                                                                           form SFR is basis of fulfillment of
                                                                           FPT_FLS.1 and FPT_PHP.3. Internal
                                                                           counter for security violations com-
                                                                           plement Java Card OS mechanisms-
                                                                           No contradiction to this ST.
FDP_SDI.2[DATA]                               FPT_FLS.1, FPT_PHP.3         Not directly corresponding, but plat-
FDP_SDI.2[SENSITIVE_RESULT]                                                form SFR is basis of fulfillment of
                                                                           FPT_FLS.1 and FPT_PHP.3. No con-
                                                                           tradiction to this ST.
FPR_UNO.1                                     FPT_EMS.1                    Not directly corresponding, but rele-
                                                                           vant for the fullfillment of


                                                    19 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
                                                                           FPT_EMS.1. No contradiction to this
                                                                           ST.
FPT_FLS.1                                     FPT_FLS.1                    The fulfillment of the platform SFR is
                                                                           part of the basis of the fulfillment of
                                                                           the SFR of this ST. Internal counter-
                                                                           measures for detecting security vio-
                                                                           lations complement Java Card OS
                                                                           mechanisms. No contradiction to
                                                                           this ST.
FPT_TDC.1                                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
AID Management (chapter 7.2.1.4 in platform ST)
FIA_ATD.1[AID]                                No correspondence.           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UID.2[AID]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_USB.1[AID]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MTD.1[JCRE]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MTD.3[JCRE]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
INSTG Security Functional Requirements (chapter 7.2.2 in platform ST)
This group consists of the SFRs related to the installation of the applets, which addresses security aspects
outside the runtime.
FMT_SMR.1[INSTALLER]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_FLS.1[INSTALLER]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_RCV.3[INSTALLER]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.




                                                    20 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
ADELG Security Functional Requirements (chapter 7.2.3 in platform ST)
This group consists of the SFRs related to the deletion of applets and/or packages, enforcing the applet
deletion manager (ADEL) policy on security aspects outside the runtime.
FDP_ACC.2[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ACF.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_RIP.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMR.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_FLS.1[ADEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
RMIG Security Functional Requirements (chapter 7.2.4 in platform ST)
This group specifies the policies that control the access to the remote objects and the flow of information
that takes place when the RMI service is used. Optional, not used in the platform ST.
ODELG Security Functional Requirements (chapter 7.2.5 in platform ST)
The following requirements concern the object deletion mechanism. This mechanism is triggered by the
applet that owns the deleted objects by invoking a specific API method.
FDP_RIP.1[ODEL]                               No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_FLS.1[ODEL]                               FPT_FLS.1                    The fulfillment of the platform SFR is
                                                                           part of the basis of the fulfillment of
                                                                           the SFR of this ST. Internal counter-
                                                                           measures for detecting security vio-
                                                                           lations complement Java Card OS


                                                    21 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
                                                                           mechanisms. No contradiction to
                                                                           this ST.
CARG Security Functional Requirements (chapter 7.2.6 in platform ST)
This group includes requirements for preventing the installation of packages that has not been bytecode
verified, or that has been modified after bytecode verification.
FDP_UIT.1[CCM]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ROL.1[CCM]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ITC.2[CCM]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_FLS.1[CCM]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ACC.1[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ACF.1[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMR.1[SD]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FCO_NRO.2[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_IFC.2[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.


                                                    22 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
FDP_IFF.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UID.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UAU.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UAU.4[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FTP_ITC.1[SC]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
EMG Security Functional Requirements (chapter 7.2.7 in platform ST)
This group includes requirements for managing the external memory.
FDP_ACC.1[EXT-MEM]                            No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ACF.1[EXT-MEM]                            No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[EXT-MEM]                            No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[EXT-MEM]                            No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.




                                                    23 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
FMT_SMF.1[EXT-MEM]                            No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
ConfG Security Functional Requirements (chapter 7.2.8 in platform ST)
FDP_IFC.2[CFG]                                No correspondence            Complete information flow control
                                                                           (CFG). Out of scope (internal Java
                                                                           Card functionality).
                                                                           No contradiction to this ST.
FDP_IFF.1[CFG]                                No correspondence            Simple security attributes (CFG). Out
                                                                           of scope (internal Java Card function-
                                                                           ality).
                                                                           No contradiction to this ST.
FMT_MSA.3[CFG]                                No correspondence            Static attribute initialisation (CFG).
                                                                           Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[CFG]                                No correspondence            Management of security attributes
                                                                           (CFG). Out of scope (internal Java
                                                                           Card functionality).
                                                                           No contradiction to this ST.
FMT_SMR.1[CFG]                                No correspondence            Security roles (CFG). Out of scope (in-
                                                                           ternal Java Card functionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[CFG]                                No correspondence            Specification of management Func-
                                                                           tions (CFG). Out of scope (internal
                                                                           Java Card functionality).
                                                                           No contradiction to this ST.
FIA_UID.1[CFG]                                No correspondence            Timing of identification (CFG). Out of
                                                                           scope (internal Java Card functional-
                                                                           ity).
                                                                           No contradiction to this ST.
SecureBox Security Functional Requirements (chapter 7.2.9 in platform ST)
FDP_ACC.2[SecureBox]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_ACF.1[SecureBox]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[SecureBox]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.



                                                    24 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
FMT_MSA.3[SecureBox]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[SecureBox]                          No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
ModDesG Security Functional Requirements (chapter 7.2.10 in platform ST)
FDP_IFC.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FDP_IFF.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_ATD.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_USB.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMR.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FPT_FLS.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UID.1[MODULAR-DESIGN]                     No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
RMG Security Functional Requirements (chapter 7.2.11 in platform ST)
FDP_ACC.2[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).



                                                    25 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform SFR                                  Correspondence in this References/Remarks
                                              ST
                                                                           No contradiction to this ST.
FDP_ACF.1[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.3[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_MSA.1[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FMT_SMF.1[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UID.1[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FIA_UAU.1[RM]                                 No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
Further Security Functional Requirements (chapter 7.1.12 in platform ST)
FAU_SAS.1[SCP]                                No correspondence            Out of scope (internal Java Card func-
                                                                           tionality).
                                                                           No contradiction to this ST.
FCS_RNG.1                                     In this ST, random num- FCS_RND.1
                                              bers according to AIS20
                                              class PTG.3 are required.
                                              The platform generates
                                              random numbers with a
                                              defined quality metric
                                              that can be used di-
                                              rectly.
FCS_RNG.1[HDT]                                No correspondence            Hybrid deterministic random num-
                                                                           ber generator.
                                                                           No contradiction to this ST.
FIA_AFL.1[PIN]                                FIA_AFL.1                    Authentication Failure Handling
                                                                           (PIN). The fulfillment of the require-
                                                                           ment is based on the platform re-
                                                                           quirement.
                                                                           No contradiction to this ST.




                                                    26 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


 Platform SFR                                 Correspondence in this References/Remarks
                                              ST
 FPT_EMSEC.1                                  No correspondence            TOE emanation. No direct corre-
                                                                           spondence, but platform require-
                                                                           ment leads to protection of crypto-
                                                                           graphic keys, PINs and user data.
                                                                           No contradiction to this ST.
 FPT_PHP.3                                    FPT_PHP.3                    The fulfillment of the SFR in this ST is
                                              FPT_EMS.1                    based on the platform SFR (together
                                                                           with additional countermeasures).
                                  Table 4: Assessment of the platform SFRs.

2.2.3 Assessment of the Platform Objectives
The following table provides an assessment of all relevant Platform objectives.


 Platform Objective                Correspondence in this ST             References/Remarks
 OT.SID                            No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.SID_MODULE                     No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
 OT.FIREWALL                       No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.GLOBAL_ARRAYS_CONFID           OT.SCD_Secrecy                        No contradiction to this ST.
 OT.GLOBAL_ARRAYS_INTEG            OT.DTBS_Integrity_TOE                 No contradiction to this ST.
 OT.NATIVE                         No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.OPERATE                        No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.REALLOCATION                   No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.RESOURCES                      No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
 OT.SENSITIVE_RESULTS_INTEG No correspondence                            Indirectly relevant for the correct
                                                                         function of the TOE of this ST, but no
                                                                         corresponding objectives for the
                                                                         TOE of this ST.
                                                                         No contradiction to this ST.
 OT.ALARM                          OT.Tamper_ID                          Relevant for the protection against
                                   OT.Tamper_Resistance                  physical tampering. No contradic-
                                                                         tion to this ST.
 OT.CIPHER                         No correspondence                     Indirectly relevant for the correct
                                                                         function of the TOE of this ST, but no
                                                                         corresponding objectives for the
                                                                         TOE of this ST. No contradictions.


                                                    27 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


Platform Objective                 Correspondence in this ST             References/Remarks
OT.RNG                             O.RBGS                                The objective regarding random
                                                                         number generation is related.
                                                                         No contradiction to this ST.
OT.KEY-MNGT                        OT.SCD_Secrecy                        Secure key management of the plat-
                                                                         form leads to secrecy of SCD. No
                                                                         contradiction to this ST.
OT.PIN-MNGT                        No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
OT.TRANSACTION                     No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
OT.OBJ-DELETION                    No correspondence                     Out of scope. No contradiction to
                                                                         this ST.
OT.APPLI-AUTH                      No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.DOMAIN-RIGHTS                   No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.COMM_AUTH                       No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.COMM_INTEGRITY                  No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.COMM_CONFIDENTIALITY            No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.EXT-MEM                         No correspondence                     Out of scope.
                                                                         No contradiction to this ST.
OT.CARD-MANAGEMENT                 No correspondence                     Out of scope. No contradiction to
                                                                                                         Manufacturer up to delivery to the end consumer to maintain confi-
                                      dentiality and integrity of the TOE and of its manufacturing and test
                                      data (to prevent any possible copy, modification, retention, theft or
                                      unauthorised use). This means that the phases after TOE delivery are
                                      assumed to be protected appropriately.
                                      This is reflected by appropriate measures in the production and deliv-
                                      ery of the TOE of this ST.
 A.APPS-PROVIDER                      A.APPS-PROVIDER assumes that the application provider is a trusted
                                      actor that provides basic or secure applications, and that the ap-
                                      plicatrion provider is resposible for his security domain keys.
                                      This leads to appropriate directives in the user guidance [Guidance].
 A.VERIFICATION-AUTHORITY             A.VERIFICATION-AUTHORITY assumes that the verification authority is
                                      a trusted actor and able to guarantee and check the digital signature
                                      attached to a basic or secure application. This is reflected by appro-
                                      priate directives in the user guidance [Guidance].
                                  Table 7: Assumptions of the Platform ST.

2.2.6.2   Assessment of Platform Objectives for the Operational Environment
There are the following Platform Objectives for the Operational Environment that have to be considered.


 Platform Objective for the Environment                    Relevance for Composite ST
 OE.APPLET                                                 The platform objective for the environment states
                                                           that applets loaded post-issuance do not contain



                                                    31 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


                                                           native methods. This objective for the environ-
                                                           ment leads to appropriate directives in the user
                                                           guidance [Guidance].
OE.VERIFICATION                                            The platform objective for the environment tar-
                                                           gets the applet code verification. This is fulfilled by
                                                           the TOE of this ST; regarding third-party-code, this
                                                           objective for the environment leads to appropri-
                                                           ate directives in the user guidance [Guidance].
                                                           There it is stated that all applets loaded to the TOE
                                                           have to be verified.
OE.CODE-EVIDENCE                                           The platform objective for the environment focus-
                                                           ses on application code loaded pre-issuance or
                                                           post-issuance. It has to be ensured that the loaded
                                                           application has not been changed since the code
                                                           verification. This objective for the environment
                                                           leads to appropriate directives in the user guid-
                                                           ance [Guidance].
OE.APPS-PROVIDER                                           The application provider (AP) shall be a trusted ac-
                                                           tor that provides applications. The AP is responsi-
                                                           ble for its security domain keys. This objective for
                                                           the environment leads to appropriate directives in
                                                           the user guidance [Guidance].
OE.VERIFICATION-AUTHORITY                                  The platform objective for the environment tar-
                                                           gets the verification authority for post-issuance
                                                           loading. This entity should be a trusted actor who
                                                           is able to guarantee and check the digital signature
                                                           attached to an application. This objective for the
                                                           environment leads to appropriate directives in the
                                                           user guidance [Guidance].
OE.KEY-CHANGE                                              The platform objective for the environment focus-
                                                           ses on the change of the security domain initial
                                                           keys before any operation on it. This objective for
                                                           the environment leads to appropriate directives in
                                                           the user guidance [Guidance].
OE.SECURITY-DOMAINS                                        The platform objective for the environment states
                                                           that security domains can be dynamically created,
                                                           deleted and blocked during usage phase in post-
                                                           issuance mode. This objective for the environment
                                                           leads to appropriate directives in the user guid-
                                                           ance [Guidance].
OE.USE_DIAG                                                The platform objective for the environment covers
                                                           secure communication during packaging, finishing
                                                           and personalisation. This is reflected by appropri-
                                                           ate measures in the production and de-livery of
                                                           the TOE of this ST.
OE.USE_KEYS                                                This platform objective for the environment states
                                                           that the keys which are stored outside the TOE
                                                           and which are used for secure communication and
                                                           authentication between Smart Card and terminals

                                                    32 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


                                                           are protected for confidentiality and integrity in
                                                           their own storage environment.
                                                           This is reflected by appropriate measures in the
                                                           production and delivery of the TOE of this ST.
OE.PROCESS_SEC_IC                                          OE. PROCESS_SEC_IC states that security proce-
                                                           dures shall be used after TOE Delivery up to deliv-
                                                           ery to the end consumer to maintain confidential-
                         f the CA key Restriction of the ability to write the Modular invert
       of the CA key to the Personalization Agent.
     FMT_MTD.1/Initialize PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Change_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Unblock_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Resume_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/PI_PP_CPI Load Management of TSF data for Polymorphic
       eMRTD


SF.LCM.3 The implementation of this security function contributes to:
     FMT_SMF.1 Specification of Management Functions
     FMT_SMR.1/PACE Security roles (Personalization Agent)
     FMT_MTD.1/CVCA_UPD Management of TSF data – Country Verifier
       Certification Authority
     FMT_MTD.3 Secure TSF data
     FMT_MTD.1/DATE Current date
     FMT_MTD.1/Initialize PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Change_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Unblock_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Resume_PIN Management of TSF data for Polymorphic eMRTD
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 137/150
                       eMRTD Configuration)

SF.LCM.4 The platform implementation provides this security function and
  contributes to:
     FMT_LIM.1 Limited capabilities
     FMT_LIM.2 Limited availability
     FMT_LIM.1/POLY Limited capabilities for Polymorphic eMRTD
     FMT_LIM.2/POLY Limited availability for Polymorphic eMRTD

SF.LCM.5 The implementation of this security function contributes to:
     FMT_MTD.1/KEY_READ Management of TSF data – Key Read
     FMT_MTD.1/PACE_CAM_KEY_READ
     FPT_EMS.1 TOE Emanation
     FMT_MTD.1/Unblock_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/Resume_PIN Management of TSF data for Polymorphic eMRTD
     FMT_MTD.1/PI_PP_CPI Read Management of TSF data for Polymorphic
eMRTD


SF.LCM.6
     FAU_SAS.1 Audit storage
     The audit records are usually write-only-once data of the travel document
       (see FMT_MTD.1/INI_ENA, FMT_MTD.1/INI_DIS).
                           Security Target Lite
                                                                             Ref.:
                    IDeal Pass v2.3-n JC with Privacy
                                                                      2018_2000036361
                    Protection (SAC/EAC/Polymorphic
                                                                        Page: 138/150
                          eMRTD Configuration)

8 Annex

Glossary

Term                Definition
Accurate Terminal A Terminal Certificate is accurate, if the issuing Document Verifier is
Certificate       trusted by the travel document’s chip to produce Terminal
                  Certificates with the correct certificate effective date, see [TR-
                  03110-1].
Advanced            A specific order of authentication steps between a travel document
Inspection          and a terminal as required by [TR-03110-1], namely (i) PACE, (ii)
Procedure (with     Chip Authentication v.1, (iii) Passive Authentication with SOD and
PACE)               (iv) Terminal Authentication v.1. AIP can generally be used by EIS-
                    AIP-PACE.
Agreement           This term is used in the current ST in order to reflect an appropriate
                    relationship between the parties involved, but not as a legal notion.

Active              Security mechanism defined in [ICAO-9303]. Option by which means
Authentication      the MTRD’s chip proves and the inspection system verifies the
                    identity and authenticity of the MTRD’s chip as part of a genuine
                    MRTD issued by a known State of organization.

Application note    Optional informative part of the PP containing sensitive supporting
                    information that is considered relevant or useful for the construction,
                    evaluation, or use of the TOE (cf. CC part 1, section B.2.7).
Audit records       Write-only-once non-volatile memory area of the MRTDs chip to
                    store the Initialisation Data and Pre-personalization Data.
Authenticity        Ability to confirm the MRTD and its data elements on the MRTD’s
                    chip were created by the issuing State or Organization
Basic Access        Security mechanism defined in [ICAO-9303] by which means the
Control             MTRD’s chip proves and the inspection system protect their
                    communication by means of secure messaging with Basic Access
                    Keys (see there).
Basic Inspection    A technical system being used by an inspecting authority and
System (BIS)        operated by a governmental organisation (i.e. an Official Domestic
                    or Foreign Document Verifier) and verifying the travel document
                    presenter as the travel document holder (for ePassport: by
                    comparing the real biometric data (face) of the travel document
                    presenter with the stored biometric data (DG2) of the travel
                    document holder).
                    The Basic Inspection System with PACE is a PACE Terminal
                    additionally supporting/applying the Passive Authentication protocol
                    and is authorised by the travel document Issuer through the
                    Document Verifier of receiving state to read a subset of data stored
                    on the travel document.
Biographical data   The personalized details of the bearer of the document appearing as
(bio data).         text in the visual and machine readable zones on the biographical
                    data page of a passport book or on a travel card or visa.
                           Security Target Lite
                                                                              Ref.:
                    IDeal Pass v2.3-n JC with Privacy
                                                                       2018_2000036361
                    Protection (SAC/EAC/Polymorphic
                                                                         Page: 139/150
                          eMRTD Configuration)

Term                Definition
Biometric           Data stored for biometric authentication of the MRTD                                                                                            2018_2000036361
                            Protection (SAC/EAC/Polymorphic
                                                                                                           Page: 4/150
                                  eMRTD Configuration)

      4.1.3    Security Objectives related to Polymorphic eMRTD ..................................................53
    4.2    SECURITY OBJECTIVES FOR THE OPERATIONAL ENVIRONMENT ....................................................55
      4.2.1    Issuing State or Organisation .................................................................................55
      4.2.2    Travel document Issuer and CSCA: travel document PKI (issuing) branch ................56
      4.2.3    Terminal operator: Terminal receiving branch .........................................................57
      4.2.4    Travel document holder Obligations .......................................................................58
      4.2.5    Receiving State or Organisation .............................................................................58
      4.2.6    Oes related to Polymorphic eMRTD ........................................................................60
    4.3    SECURITY OBJECTIVES RATIONALE ......................................................................................63
      4.3.1    Threats ................................................................................................................63
      4.3.2    Organisational Security Policies ..............................................................................67
      4.3.3    Assumptions .........................................................................................................69
      4.3.4    SPD and Security Objectives ..................................................................................71
5           EXTENDED REQUIREMENTS ............................................................................... 76
    5.1     DEFINITION OF THE FAMILY FAU_SAS .................................................................................76
    5.2     DEFINITION OF THE FAMILY FCS_RND ................................................................................76
    5.3     DEFINITION OF THE FAMILY FIA_API ..................................................................................77
    5.4     DEFINITION OF THE FAMILY FMT_LIM .................................................................................78
    5.5     DEFINITION OF THE FAMILY FPT_EMS .................................................................................80
6           SECURITY REQUIREMENTS ................................................................................ 81
    6.1    SECURITY FUNCTIONAL REQUIREMENTS ................................................................................81
      6.1.1    Class Cryptographic Support (FCS) .........................................................................83
      6.1.2    Class FIA Identification and Authentication .............................................................87
      6.1.3    Class FDP User Data Protection ..............................................................................95
      6.1.4    Class FTP Trusted Path/Channels ......................................................................... 100
      6.1.5    Class FAU Security Audit ...................................................................................... 101
      6.1.6    Class FMT Security Management .......................................................................... 101
      6.1.7    Class FPT Protection of the Security Functions ...................................................... 107
      6.1.8    Class FPR ........................................................................................................... 109
    6.2    SECURITY ASSURANCE REQUIREMENTS................................................................................ 110
    6.3    SECURITY REQUIREMENTS RATIONALE ................................................................................ 110
      6.3.1    Security Objectives for the TOE ........................................................................... 110
      6.3.2    Rationale tables of Security Objectives and SFRs................................................... 115
      6.3.3    Dependencies ..................................................................................................... 119
      6.3.4    Rationale for the Security Assurance Requirements ............................................... 122
      6.3.5    AVA_VAN.5 Advanced methodical vulnerability analysis ......................................... 123
      6.3.6    ALC_DVS.2 Sufficiency of security measures ......................................................... 123
7           TOE SUMMARY SPECIFICATION ....................................................................... 124
    7.1    TOE SUMMARY SPECIFICATION ......................................................................................... 124
      7.1.1    SF.IA Identification and Authentication ................................................................. 124
      7.1.2    SF.CF Cryptographic functions support ................................................................. 125
      7.1.3    SF.ILTB Protection against interference, logical tampering and bypass ................... 125
      7.1.4    SF.AC Access control / Storage and protection of logical travel document data ....... 126
      7.1.5    SF.SM Secure Messaging ..................................................................................... 126
      7.1.6    SF.LCM Security and life cycle management ......................................................... 126
    7.2    SFRS AND TSS............................................................................................................. 129
      7.2.1    SFRs and TSS - Rationale .................................................................................... 129
8           ANNEX .............................................................................................................. 138

GLOSSARY .................................................................................................................... 138
                               Security Target Lite
                                                                                                      Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                                2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                                   Page: 5/150
                              eMRTD Configuration)

ABBREVIATIONS .......................................................................................................... 149

REFERENCES ................................................................................................................ 149
                                Security Target Lite
                                                                                                Ref.:
                         IDeal Pass v2.3-n KC with Privacy
                                                                                          2018_2000036361
                         Protection (SAC/EAC/Polymorphic
                                                                                             Page: 6/150
                               eMRTD Configuration)

Table of figures
Figure 1: TOE ......................................................................................................12
Figure 2: TOE life-cycle .........................................................................................18
                                Security Target Lite
                                                                                                Ref.:
                         IDeal Pass v2.3-n JC with Privacy
                                                                                          2018_2000036361
                         Protection (SAC/EAC/Polymorphic
                                                                                             Page: 7/150
                               eMRTD Configuration)


Table of tables
Table 1 Threats and Security Objectives - Coverage .................................................71
Table 2 Security Objectives and Threats - Coverage .................................................72
Table 3 OSPs and Security Objectives - Coverage ....................................................73
Table 4 Security Objectives and OSPs - Coverage ....................................................74
Table 5 Assumptions and Security Objectives for the Operational Environment -
    Coverage .......................................................................................................75
Table 6 Security Objectives for the Operational Environment and Assumptions -
    Coverage .......................................................................................................75
Table 7 Security Objectives and SFRs - Coverage .................................................. 118
Table 8 SFRs Dependencies ................................................................................ 121
Table 9 SARs Dependencies ................................................................................ 122
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                 Page: 8/150
                       eMRTD Configuration)

1 ST Introduction
The aim of this document is to describe the Security Target for IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration), the
Machine Readable Travel Document (MRTD) with the ICAO application, Password
Authenticated Connection Establishment (covering PACE-GM, PACE-IM and PACE-
CAM), Extended Access Control and Polymorphic eMRTD on NXP JCOP 3 P60.

1.1 ST Identification
                Security Target Lite IDeal Pass v2.3-n JC with Privacy
Title
                Protection (SAC/EAC/Polymorphic eMRTD Configuration)
Reference       2018_2000036361
Version         1.1
Certification
                NSCIB
Body
Author          IDEMIA
CC Version      3.1 Revision 5
Assurance
                EAL5 augmented with ALC_DVS.2 and AVA_VAN.5
Level
                Protection Profile Machine Readable Travel Document with ICAO
                Application, Extended Access Control with PACE (EAC PP) BSI-
                CC-PP-0056-V2-2012, Version 1.3.2, 5th December 2012 [EAC-
Protection      PP-V2]
Profiles
                Protection Profile Machine Readable Travel Document using
                Standard Inspection Procedure with PACE, BSI-CC-PP-0068-V2-
                MA-01, Version 1.0.1, 22 July 2014, BSI [PACE-PP].
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 9/150
                        eMRTD Configuration)

1.2 TOE Reference
                 IDeal Pass v2.3-n JC with Privacy Protection
TOE name
                 (SAC/EAC/Polymorphic eMRTD Configuration)
TOE              7126-9301-0311 for applet loaded in EEPROM
identification   7126-9301-0319 for applet loaded in ROM
TOE version      v2.3.0.14
Name of          NXP JCOP 3 P60 certified by the Dutch NSCIB certification body
Platform         (CC-18-98209/2) on 29-11-2018
                 Platform ID: “JxHyyy0019790400” (SVN 6521; “OSB RC9”)
Platform
                 Patch ID: 00 00 00 00 00 00 00 00 (no patch)
identification
                           04 00 00 00 00 00 00 00 (PL4)
                 NXP Secure Smart Card Controller P6022y VB including IC
IC reference     Dedicated Software certified by the German BSI certification
                 body (BSI-DSZ-CC-1059-2018) on 18-05-2018
Crypto Lib       Crypto Library V3.1.x on P6022y VB certified by the Dutch
reference        NSCIB certification body (CC-18-67206) on 31-05-2018



1.3 TOE Overview
The Security Target (ST) defines the security objectives and requirements for a
contact or contactless based chip of machine readable travel documents (MRTD)
based on the requirements and recommendations of the International Civil
Aviation Organization (ICAO), EU requirements for biometric European passport
(Council Regulation (EC) No 2252/2004 and Commission Implementing Decision
6181) and Biometric European Resident Permit (REGULATION (EU) 2017/1954
and Commission Implementing Decision 6178). This product is intended to
enable verification of the authenticity of the travel document and to identify its
holder during a border control, using an inspection system. The verification
process is based on Extended Access Control with Password Authenticated
Connection Establishment (PACE) and optionally Active Authentication (AA).

The main features and their origin are the following:
 Password Authenticated Connection Establishment (PACE)
   according to ICAO Technical Report “Supplemental Access Control” [ICAO-
   9303] part 11 and strictly conform to BSI-CC-PP-0068-V2 [PACE-PP] for
   protection of the communication between terminal and chip. The following
   PACE mapping modes are supported and covered by the TOE:
      o    Generic Mapping (PACE-GM)
      o    Integrated Mapping (PACE-IM)
      o    Chip Authentication Mapping (PACE-CAM), which combines PACE-GM
           with Chip Authentication into a single protocol.
                         Security Target Lite
                                                                       Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 10/150
                        eMRTD Configuration)

   Chip Authentication v1
    according to BSI TR-03110 parts 1 and 3 [TR-03110-1], [TR-03110-3] and
    strictly conform to BSI-CC-PP-0056-V2-2012 [EAC-PP-V2], authenticates the
    travel document’s chip to the inspection system.
   Terminal Authentication v1
    according to BSI TR-03110 parts 1 and 3 [TR-03110-1], [TR-03110-3] and
    strictly conform to BSI-CC-PP-0056-V2-2012 [EAC-PP-V2], authenticates the
    inspection system to travel document’s chip and protects the confidentiality
    and integrity of the sensitive biometric reference data during their
    transmission from the TOE to the inspection system.

As a feature that can be optionally configured the TOE supports:
   Active Authentication
    which according to [ICAO-9303] prevents copying the SOD and proves that it
    has been read from the authentic chip. It proves that the chip has not been
    substituted.


   Polymorphic Authentication
    which according to [PCA-eMRTD] provides additional privacy by randomisation
    of returned Polymorphic Identities, Polymorphic Pseudonyms and
    Complementary Polymorphic ID attributes in combination with standard ICAO
    and EAC1 eMRTD protocols specified in ICAO Doc 9303 [ICAO-9303] and BSI
    TR-03110 parts 1 and 3 [TR-03110-1] and [TR 03110-3].

The TOE may also be used as an ISO driving license, compliant to ISO/IEC 18013
or ISO/IEC TR 19446 supporting PACE, AA and CA, as both applications (MRTD
and IDL) share the same protocols and data structure organization. Therefore, in
the rest of the document, the word “MRTD” MAY be understood either as a MRTD
in the sense of ICAO, or a driving license compliant to ISO/IEC 18013 or ISO/IEC
TR 19446 depending on the targeted usage envisioned by the issuer.

Application note
This TOE claims an assurance level EAL5 augmented with AVA_VAN.5 and
ALC_DVS.2. AVA_VAN.5 implies that the TOE is resistant to attacks performed by
an attacker possessing "High attack potential".
Not all key sizes specified in this security target have sufficient cryptographic
strength for satisfying the AVA_VAN.5 “high attack potential”. In order to be
protected against attackers with a "high attack potential", sufficiently large
cryptographic key sizes SHALL be configured for this TOE. References can be
found in national and international document standards. Further details have
been specified in the TOE’s guidance documentation [AGD_PRE].
                         Security Target Lite
                                                                   Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                               Page: 11/150
                        eMRTD Configuration)

1.4 TOE Description

1.4.1 TOE Definition
The Target of Evaluation (TOE) addressed by the current security target is an
electronic travel document representing a contactless / contact based smart card
or passport programmed according to Logical data structure (LDS) and protocols
specified in ICAO Doc 9303 [ICAO-9303] and additionally providing the Extended
Access Control according to BSI TR-03110 part 1 [TR-03110-1] and part 3 [TR-
03110-3] and Active Authentication according to [ICAO-9303]. The
communication between terminal and chip shall be protected by Password
Authenticated Connection Establishment (PACE), optionally with Chip
Authentication Mapping (PACE CAM) according to Electronic Passport using
Standard Inspection Procedure with PACE (PACE PP), BSI-CC-PP-0068-V2 [PACE-
PP]. Polymorphic eMRTD extensions are present on the TOE that enable secure
authentication with enhanced privacy protection features. It provides the holder
the possibility to authenticate towards a service provider in a non-traceable and
non-linkable manner thanks to usage of Polymorphic Pseudonyms and other
Polymorphic ID attributes.

The TOE (IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
eMRTD Configuration)) is composed of
    the NXP JCOP 3 P60, composed of
      o the circuitry of the MRTD’s chip (NXP Secure Smart Card Controller
         P6022y VB including IC Dedicated Software) with hardware for the
         contact and contactless interface;
       o   the Crypto Library V3.1.x on P6022y VB;
       o   the IC Embedded Software (operating system): NXP JCOP 3;
      The MRTD application IDeal Pass v2.3-n JC with Privacy Protection
       (SAC/EAC/Polymorphic eMRTD Configuration) loaded in ROM or in
       EEPROM;
      the associated guidance documentation in [AGD_PRE] and [AGD_OPE];
      the Personalisation Agent Key set.


The TOE utilizes the evaluation of NXP JCOP 3 P60 which has been certified by
the Dutch NSCIB certification body (CC-18-98209/2).

A schematic overview of the TOE is shown in Figure 1:
 The MRTD’s chip circuitry and the IC dedicated software forming the Smart
   Card Platform (Hardware Platform and Hardware Abstraction Layer);
 The IC embedded software running on the Smart Card Platform consisting of
      o Java Card virtual machine, ensuring language-level security;
      o Java Card runtime environment, providing additional security features
         for Java card technology enabled devices;
      o Java card API, providing access to card’s resources for the Applet;
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 12/150
                        eMRTD Configuration)

        o  Global Platform Card Manager, responsible for management of Applets
           on the card.
        o Mifare implementation can be enabled or disabled for this TOE.
        o Crypto Library.
    The Applet Layer is IDeal Pass v2.3-n JC with Privacy Protection
     (SAC/EAC/Polymorphic eMRTD Configuration) applet.




                                        Figure 1: TOE



1.4.2 TOE usage and security features for operational use
Depending on its configuration during pre-personalisation and personalisation,
the TOE can be used as:
    ICAO/EAC eMRTD,
    Polymorphic eMRTD and
    EU/ISO Driving Licence.

The ICAO/EAC eMRTD, Polymorphic eMRTD and Driver Licence are installed as a
separate application instances of the applet having their own dedicated
application identifiers and personalisation. The following TOE configurations are
covered within the scope of this Security Target:

    Configuration ICAO/EAC            Polymorphic        Driver licence
                  eMRTD               eMRTD
    1             present             -                  -
    2             present             present            -
    3             -                   -                  present
    4             -                   present            present
    5             -                   Present            -

The authentication protocols PACEv2, Chip authentication (CAv1), Active
Authentication and Terminal Authentication (TAv1) specified in [ICAO-9303] and
                         Security Target Lite
                                                                             Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                       2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                         Page: 13/150
                        eMRTD Configuration)

[TR-03110] have also been refered to in ISO18013 for EU driving licences. The
BAP-1 protocol defined in ISO18013 is equal to Basic Access Protocol (BAC)
defined in [ICAO-9303]. As to the logical data structure, the ISO18013 uses the
same concept of Passive Authentication defined in [ICAO-9303], but specifies
different ISO7816-4 elementary file identifiers for storing the ICAO defined
content of DG3, DG4 and DG15.

When an Issuing state is using the product as an ISO compliant Driving licence,
the following name mapping of roles, definitions, data groups and protocol is
applicable within the scope of this security target:

                        MRTD                           ISO Driving License
                        MRTD                                   IDL
                         ICAO                                ISO/IEC
                      ICAO 9303                    ISO/IEC 18013 or ISO/IEC TR
                                                              19446
                           BAC                                BAP-1
                           DG3                                DG7*
                           DG4                                DG8*
                          DG15                                DG13
                           MRZ                      MRZ or SAI (Scanning area
                                                            identifier)
                         Traveler                             Holder
          *Access rights to the biometric data in DG3 and DG4 are also mapped to
           DG7 and DG8, respectively.

The following two sub sections explain the TOE security features for operational
use of TOE configured as respectively ICAO/EAC eMRTD/Driving licence and
Polymorphic eMRTD.


1.4.2.1 ICAO/EAC eMRTD and ISO Driving licence
This sub section explains the TOE security features for operational use of TOE
configured as ICAO/EAC eMRTD or as Driving Licence.

A State or Organisation issues travel documents to be used by the holder for
international travel. The traveller presents a travel document to the inspection
system to prove his or her identity. The travel document in context of this
Security Target contains:
  I.  visual (eye readable) biographical data and portrait of the holder,
 II.  a separate data summary (MRZ data) for visual and machine reading using
       OCR methods in the Machine readable zone (MRZ) and
III.  data elements on the travel document’s chip according to LDS in case of
       contactless machine reading.

The authentication of the traveller is based on:
  I.  the possession of a valid travel document personalized for a holder with
      the claimed identity as given on the biographical data page and
 II.  biometrics using the reference data stored in the travel document.
                               Security Target Lite
                                                                                           Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                     2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                       Page: 14/150
                              eMRTD Configuration)


The issuing State or Organization ensures the authenticity of the data of genuine
travel documents. The receiving State trusts a genuine travel document of an
issuing State or Organization.

For this Security Target the travel document is viewed as unit of:
(i) the physical part of the travel document in form of paper and/or plastic
    and chip. It presents visual readable data including (but not limited to)
    personal data of the travel document holder
    (a) the biographical data on the biographical data page of the travel
         document surface,
    (b) the printed data in the Machine Readable Zone (MRZ) and
    (c) the printed portrait.

(ii) the logical travel document as data of the travel document holder stored
     according to the Logical Data Structure as defined in [ICAO-9303] as specified
     by ICAO on the contact based or contactless integrated circuit. It presents
     contact based / contactless readable data including(but not limited to)
     personal data of the travel document holder
     (a) the digital Machine Readable Zone Data (digital MRZ data, EF.DG1),
     (b) the digitized portraits (EF.DG2),
     (c) the biometric reference data of finger(s) (EF.DG3) or iris image(s)
          (EF.DG4) or both1,
     (d) the other data according to LDS (EF.DG5 to EF.DG16) and
     (e) the Document Security Object (SOD).


The issuing State or Organisation implements security features of the travel
document to maintain the authenticity and integrity of the travel document and
their data. The physical part of the travel document and the travel document’s
chip are identified by the Document Number.

The physical part of the travel document is protected by physical security
measures (e.g. watermark, security printing), logical (e.g. authentication keys of
the travel document’s chip) and organisational security measures (e.g. control of
materials, personalisation procedures) [ICAO-9303].These security measures can
include the binding of the travel document’s chip to the travel document.

The logical travel document is protected in authenticity and integrity by a digital
signature created by the document signer acting for the issuing State or
Organisation and the security features of the travel document’s chip.

The ICAO Doc 9303 [ICAO-9303] defines the baseline security methods Passive
Authentication, advanced security access methods Basic Access Control (BAC)
and Password Authenticated Connection Establishment to the logical travel



These biometric reference data are optional according to [ICAO-9303]. This ST assumes that the issuing State or
1

Organisation uses this option and protects these data by means of extended access control.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 15/150
                       eMRTD Configuration)

document, Active Authentication of the travel document’s chip, Extended Access
Control and the Data Encryption of sensitive biometrics as optional security
measure. The Passive Authentication Mechanism is performed completely and
independently of the TOE by the TOE environment.

The BSI TR-03110 parts 1 and 3 [TR-03110-1] and [TR 03110-3] specify the
Extended Access Control protocols Chip Authentication version 1 (CAv1) and
Terminal Authentication (TAv1), which are required to get secured access to the
biometric data stored in data groups DG3 and DG4 in combination with PACE or
BAC.

This Security Target addresses the protection of the logical travel document:
   (i) in integrity by write-only-once access control and by physical means, and
   (ii) in confidentiality by the Extended Access Control Mechanism.

This Security Target addresses the Chip Authentication Version 1 described in
[TR-03110-1] and PACE-CAM described in [ICAO-9303] part 11 as an alternative
to the Active Authentication stated in [ICAO-9303].

For Basic Access Control (BAC) supported by the product, a separate evaluation
and certification is performed with ST [ST-BAC].

The confidentiality by Password Authenticated Connection Establishment (PACE)
is a mandatory security feature of the TOE. The travel document shall strictly
conform to the ‘Common Criteria Protection Profile Machine Readable Travel
Document using Standard Inspection Procedure with PACE [PACE-PP]. Note that
[PACE-PP] considers high attack potential.

For the PACE protocol according to [ICAO-9303] part 11, the following steps shall
be performed:
 (i) the travel document's chip encrypts a nonce with the shared password,
       derived from the MRZ resp. CAN data and transmits the encrypted nonce
       together with the domain parameters to the terminal.
 (ii) The terminal recovers the nonce using the shared password, by
       (physically) reading the MRZ or CAN data. This nonce shall be converted to
       a group generator using one of the following mapping algorithms, which
       maps a static generator to an ephemeral generator:
           a. Generic mapping (PACE-GM) or
           b. Integrated mapping PACE-IM)
 (iii) The travel document's chip and terminal computer perform a Diffie-
       Hellmann key agreement together with the ephemeral domain parameters
       to create a shared secret. Both parties derive the session keys KMAC and
       KENC from the shared secret.
 (iv) Each party generates an authentication token, sends it to the other party
       and verifies the received token.

In case of PACE with Chip Authenticated Mapping (PACE-CAM), in addition to the
steps above executed for the PACE-GM variant, the MRTD chip computes Chip
Authentication Data CAIC, encrypts them AIC = E(KSEnc, CAIC) and sends them
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 16/150
                        eMRTD Configuration)

to the terminal. The terminal decrypts AIC and verifies the authenticity of the
chip using the recovered Chip Authentication Data CAIC.

After successful key negotiation, the terminal and the travel document's chip
provide private communication (secure messaging) [TR-03110-1], [ICAO-9303].

This Security Target requires the TOE to implement the Extended Access Control
as defined in [TR-03110-1]. The Extended Access Control consists of two parts:
  (i) the Chip Authentication Protocol Version 1 and
  (ii) the Terminal Authentication Protocol Version 1 (v.1).

The Chip Authentication Protocol v.1
  (i) authenticates the travel document’s chip to the inspection system and
  (ii) establishes secure messaging which is used by Terminal Authentication v.1
       to protect the confidentiality and integrity of the sensitive biometric
       reference data during their transmission from the TOE to the inspection
       system. Therefore Terminal Authentication v.1 can only be performed if
       Chip Authentication v.1has been successfully executed.

The Terminal Authentication Protocolv.1 consists of
  (i) the authentication of the inspection system as entity authorized by the
       receiving State or Organisation through the issuing State, and
  (ii) an access control by the TOE to allow reading the sensitive biometric
       reference data only to successfully authenticated authorized inspection
       systems.

The Active Authentication protocol may be optionally configured during
personalisation.

The issuing State or Organisation authorizes the receiving State by means of
certification the authentication public keys of Document Verifiers who create
Inspection System Certificates.


1.4.2.2 Polymorphic eMRTD

In addition to an ICAO/EAC eMRTD functionality, the TOE supports Polymorphic
eMRTD extensions that can be configured using the same applet during
personalisation. The TOE’s Polymorphic eMRTD extensions enable secure
authentication with enhanced privacy protection features. The Polymorphic
extensions provide the holder the possibility to authenticate towards a service
provider using an authentication service in a non-traceable and non-linkable
manner thanks to usage of Polymorphic ID attributes.

The Polymorphic extensions are used to configure a Polymorphic eMRTD as stand
alone application instance or next to an ICAO/EAC eMRTD/Driving application
licence instance having its own application identifier during personalisation.
                         Security Target Lite
                                                                       Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 17/150
                        eMRTD Configuration)

The Polymorphic eMRTD uses the same ICAO and EAC1 protocols like PACEv2,
Chip Authentication v1 (CAv1) and Terminal Authentication (v1) as defined in
[ICAO-9303], [TR-03110-1] and [TR-03110-3]. The TOE’s Polymorphic eMRTD
extensions provide the following features:

      Secure storage of the Polymorphic ID attributes during personalisation or
       the TOE.
      Polymorphic Authentication Protocol (PMA) for authenticated access with
       user consent, randomization and secure readout of the Polymorphic ID
       attributes, in combination with PACEv2 and EAC1 eMRTD protocols.
      PACEv2 protocol extended with PIN and PUK passwords, to enforce user
       authentication (document holder verification) in compliance with [TR-
       03101-3].

For Polymorphic eMRTD, the PACE protocol is configured with PIN, PUK and CAN
passwords in compliance with [TR-03110-3] during personalisation. Only PACE-
GM and PACE-IM are configurable for a Polymorphic eMRTD.

The Active Authentication protocol shall not be configured for a polymorphic
eMRTD.

The logical data structure consists only of EF.CVCA, DG14 and EF.SOD. In order
to assure a sufficient level of privacy during authentication the CAv1 private key
and EF.SOD are shared amoung a sufficient high number of personalised
Polymorphic eMRTDs, i.e. the logical data structure does not contain any unique
identifiable data.



1.4.3 TOE life cycle
The TOE life cycle is described in terms of its four life cycle phases. (With respect
to the [SIC-PP], the TOE life-cycle is additionally subdivided into 7 steps in the
ST. These steps are denoted too in the following although the sequence of the
steps differs for the TOE life cycle).
                                  Security Target Lite
                                                                                                          Ref.:
                           IDeal Pass v2.3-n JC with Privacy
                                                                                                    2018_2000036361
                           Protection (SAC/EAC/Polymorphic
                                                                                                      Page: 18/150
                                 eMRTD Configuration)


               Phase 2 - Manufacturing                                                  Phase 1 - Development

                    IC Manufacturer                                                              IC Developer

                                                                   (1)
                                                                                               NXP P6022y VB


                            ROM


                                                                                             Software Developer

                       EEPROM                                      (1)                        NXP JCOP 3 SECID
                                                                                                P60 CS (OSB)

                                                                  (2a)                         IDeal Pass v2.3-n
                                                                                                JC With Privacy
                                                           Applet (ROM or EEPROM)                 Protection
                                                                                                   (Applet)
(3) Transport key                       (4) Chip modules
    + Authentication key
                                                                                             IDeal Pass v2.3-n JC
                  MRTD Manufacturer                                                          with Privacy Protection
                                                                                                    Guidance
                                                                  (2b)                           Documentation
                    Sample Authentication
                                                                   Applet (EEPROM)
                                                                   + AGD_PRE
                                                                   + AGD_OPE
                     Inlay Manufacturing




                           Initialization                                               Phase 3 - Personalization

                       Transport and                                                        Personalization Agent
                     Authentication Keys



                     Pre-Personalisation
                           Keys                                     (5)
                                                              Personalisation key set           Personalization
                                                              + eMRTD
                                                              + AGD_OPE
                     Pre-Personalisation                      + AGD_PRE

                    Personalisation Keys
                                                                                                         (6)
                                                                                                Personalised eMRTD
                                                                                                (ePassport) + AGD_OPE


                                                                                        Phase 4 - Operational use
                eMRTD Form Factors :
                - ID3 passport booklets,
                                                                                                MRTD Holder
                - ID1 cards or ID3 holder
                pages,
                - Antenna inlays,
                - Chip in modules on a                                                        (7) Operational use
                reel.




                                              Figure 2: TOE life-cycle
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 19/150
                        eMRTD Configuration)


Actors :
  IC Developer, IC Manufacturer          NXP
  Software Developer                     Platform: NXP
                                         ePassport applet: IDEMIA R&D sites
                                         (Osny, Meyreuil and Noida)
  Travel document manufacturer           IDEMIA plants (Haarlem and Noida)


1.4.3.1 Phase 1 “Development”
(Step1) The TOE is developed in phase 1. The IC developer develops the
integrated circuit, the IC Dedicated Software and the guidance documentation
associated with these TOE components.
The IC developer also acts as the developer of the embedded software (operating
system), which is the NXP JCOP 3 P60.

(Step2) The software developer uses the guidance documentation for the
integrated circuit and the guidance documentation for relevant parts of the NXP
JCOP 3 P60 and develops the ePassport application and the guidance
documentation associated with this TOE component.

The ePassport application (i.e. the IDeal Pass v2.3-n JC with Privacy Protection
(SAC/EAC/Polymorphic eMRTD Configuration) applet run time code) may be
integrated either in ROM or in EEPROM of the chip. Depending on the intention:
      (a) the ePassport application is securely delivered directly from the
          software developer (IDEMIA development dept.) to the IC manufacturer
          (NXP). The applet code will be integrated into the ROM mask code or
          inEEPROM by the IC manufacturer, or
      (b) the ePassport application is securely delivered directly from the
          software developer (IDEMIA development dept.) to the travel document
          manufacturer (IDEMIA production dept.) .) for loading in EEPROM.

Notice that the guidance documentation of the ePassport application is always
securely delivered directly from the software developer (IDEMIA development
dept.) to the travel document manufacturer (IDEMIA production dept.).


1.4.3.2 Phase 2 “Manufacturing”
(Step3) In a first step the TOE integrated circuit is produced containing the travel
document’s chip Dedicated Software, the parts of the travel document’s chip
Embedded Software and in case of alternative a) the ePassport application in
ROM or in EEPROM.

The IC manufacturer writes the IC Identification Data onto the chip to control the
IC as travel document material during the IC manufacturing and the delivery
process to the travel document manufacturer. The IC is securely delivered from
the IC manufacturer to the travel document manufacturer.
                            Security Target Lite
                                                                       Ref.:
                     IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                     Protection (SAC/EAC/Polymorphic
                                                        A.1[SFR]        Management of Security Attributes (Special Function Registers)

Hierarchical-To       No other components.

Dependencies          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                      FMT_SMR.1 Security roles FMT_SMF.1 Specification of Management Functions

FMT_MSA.1.1[SFR]      The TSF shall enforce the Hardware Access Control Policy to restrict the ability to modify the
                      security attributes defined in the Special Function Registers to code executed in a TOE mode
                      which has write access to the respective Special Function Registers.

FMT_MSA.1[SUB]        Management of Security Attributes (Secure User Mode Box)

Hierarchical-To       No other components.

Dependencies          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                      FMT_SMR.1 Security roles FMT_SMF.1 Specification of Management Functions

FMT_MSA.1.1[SUB]      The TSF shall enforce the NXP Secure User Mode Box Policy to restrict the ability to modify
                      the security attributes defined as the objects SFR_DYN_SEG, SFR_FRAM, and SFR_CRAM to
                      SSM_Code, SSM-CM_Code, SSM-TM_Code, and SM-A_NXP-Code.

FMT_SMF.1[HW]         Specification of Management Functions (Hardware)

Hierarchical-To       No other components.




 Final                                                                                               ©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                       Rev. 2.3 – 2019-06-04                                                     65 of 95
 NXP Semiconductors                                                                                    N7021 VA
                                                                                                       Security Target Lite
                                                                                                                                 Public



Dependencies              No dependencies.

FMT_SMF.1.1[HW]           The TSF shall be capable of performing the following management functions:

                SMF11.HW:USR Change of TOE mode to lower privileged mode by calling one of the following instructions:
                                  USR or EUSR and SYSACK.
                SMF11.HW:SYS Change of TOE mode to higher privileged mode by calling one of the following instructions:
                                  SYS or ESYS and SYSACK.
                 SMF11.HW:INT Change of TOE mode by invoking an interrupt.

               SMF11.HW:RETI Change of TOE mode by finishing an interrupt (with instruction RETI).

               SMF11.HW:TPDC Temporary disabling and enabling of security functionality using PDC (see Table 1.3).

               SMF11.HW:PPDC Permanently disabling and enabling of security functionality using PDC (see Table 1.3).

Application Note:         The iteration of FMT_MSA.1 with the dependency to FMT_SMF.1 may imply a separation of the
                          Specification of Management Functions. However, iteration of FMT_SMF.1 is not needed for
                          hardware access control (FMT_MSA.1[MEM] and FMT_MSA.1[SFR]) because all management
                          functions rely on the same features implemented in the hardware.


6.2      Security Assurance Requirements
Table 6.46 lists all security assurance requirements that are valid for this Security Target. These security assur-
ance requirements are defined in the PP ”Security IC Platform Protection Profile” [26] and/or in CC part [5] for
EAL6, except for requirements ASE_TSS.2 and ALC_FLR.1, which are augmentations of this Security Target to
EAL6, see section 2.2.
ASE_TSS.2 is an augmentation in this Security Target to give architectural information on the security function-
ality of the TOE. ALC_FLR.1 is an augmentation in this Security Target to cover policies and procedures of the
developer applied to track and correct flaws and support surveillance of the TOE.
In compliance with Application Note 22 in the PP [26] the third column in Table 6.46 shows, which security
assurafacturer to the Personalisation Agent.
The travel document manufacturer also provides the relevant parts of the
guidance documentation [AGD_PRE] and [AGD_OPE] and the Personalisation
Agent Key set to the Personalisation Agent. The following table describes the
physical delivery of the TOE components:

TOE component               Identification               Version     Package                    Delivery
                                                                                                method
IDeal Pass v2.3-n JC with   -     7126-9301-0311 for     v2.3.0.14   The package can be         Trusted courier
Privacy Protection                applet loaded in                   either of the following:
(SAC/EAC/Polymorphic              EEPROM                              -    Chip embedded in
eMRTD Configuration)        -     7126-9301-0319 for                       ID3 passport
                                  applet loaded in ROM                     booklets,
                                                                      -    Chip embedded in
                                                                           ID1 cards or ID3
                                                                           holder pages,
                                                                      -    Chip embedded in
                                                                           antenna inlays,
                                                                      -    Chip in modules
                                                                           on a reel.
[AGD_OPE]*                  2017_2000032685              2.1         Electronic document        PGP-encrypted
                                                                                                email
[AGD_PRE]*                  2017_2000032686              2.7         Electronic document        PGP-encrypted
                                                                                                email
Personalisation Agent       n.a                          n.a         Electronic file            PGP encrypted
Key set                                                                                         parts on USB or
                                                                                                CD media, off-
                                                                                                line registered
                                                                                                distribution by
                                                                                                trusted courier.
* : Distribution of guidance documents [AGD_PRE] and [AGD_OPE] is only managed by
the IDEMIA Haarlem manufacturing site.
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 22/150
                        eMRTD Configuration)

1.4.3.3 Phase 3 “Personalisation of the travel document”
(Step 6) The personalisation of the travel document includes
  i.  the survey of the MRTD holder’s biographical data,
 ii.   the enrolment of the MRTD holder biometric reference data (i.e. the
       digitized portraits and the optional biometric reference data),
iii.   the printing of the visual readable data onto the physical MRTD,
iv.    the writing of the TOE User Data and TSF Data into the logical MRTD and
 v.    configuration of the TSF if necessary.

The step (iv) is performed by the Personalisation Agent and includes but is not
limited to the creation of:
  i.   the digital MRZ data (EF.DG1),
 ii.   the digitized portrait (EF.DG2), and
iii.   the Document security object.

The signing of the Document security object by the Document signer [ICAO-
9303] finalizes the personalisation of the genuine travel document for the travel
document holder. The personalised travel document (together with appropriate
guidance (AGD_OPE) for TOE usage if necessary) is handed over to the travel
document holder for operational use.

The personalisation of Polymorphic eMRTD application instance includes:

 i.    establishing the identity of the polymorphic eMRTD document holder,
 ii.   Requesting the required Polymorphic eMRTD ID attributes from the central
       Key Management authority,
iii.   writing Polymorphic ID attributes, Polymorphic LDS data as defined in
       [PCA-eMRTD],
iv.    writing the TSF data (PIN, PUK, CAv1 private key) as defined in [PCA-
       eMRTD],
 v.    signing the Document Security Object defined in
       [ICAO-9303] (in the role of DS).


The signing of the Document security object by the Document signer [ICAO-
9303] finalizes the personalisation of the genuine Polymorphic eMRTD document
for the travel document holder. The personalised Polymorphic eMRTD document
(together with appropriate guidance (AGD_OPE) for TOE usage if necessary) is
handed over to the Polymorphic eMRTD document holder for operational use.


EAC PP Application note 2: The TSF data (data created by and for the TOE,
that might affect the operation of the TOE; cf. [CC-1] §92) comprise (but are not
                               Security Target Lite
                                                                                            Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                      2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                        Page: 23/150
                              eMRTD Configuration)

limited to) the Personalisation Agent Authentication Key(s), the Terminal
Authentication trust anchor, the effective date and the Chip Authentication
Private Key.

EAC PP Application note 3: This ST distinguishes between the Personalisation
Agent as entity known to the TOE and the Document Signer as entity in the TOE
IT environment signing the Document security object as described in [ICAO-
9303]. This approach allows but does not enforce the separation of these roles.


1.4.3.4 Phase 4 “Operational Use”
(Step 7) The TOE is used as a travel document's chip by the traveller and the
inspection systems in the “Operational Use” phase. The user data can be read
according to the security policy of the issuing State or Organisation and can be
used according to the security policy of the issuing State but they can never be
modified.

EAC PP Application note 42: The intention of the ST is to consider at least the
phases 1 and parts of phase 2 (i.e. Step1 to Step3) as part of the evaluation and
therefore to define the TOE delivery according to CC after this phase. Since
specific production steps of phase 2 are of minor security relevance (e.g. booklet
manufacturing and antenna integration) these are not part of the CC evaluation
under ALC. Nevertheless the decision about this has to be taken by the
certification body resp. the national body of the issuing State or Organisation. In
this case the national body of the issuing State or Organisation is responsible for
these specific production steps.
Note that the personalisation process and its environment may depend on
specific security needs of an issuing State or Organisation. All production,
generation and installation procedures after TOE delivery up to the “Operational
Use” (phase 4) have to be considered in the product evaluation process under
AGD assurance class. Therefore, the Security Target outlines the split up of
P.Manufact, P.Personalisation and the related security objectives into aspects
relevant before vs. after TOE delivery.


1.4.3.5 Non-TOE hardware/software/firmware required by the TOE
There is no explicit non-TOE hardware, software or firmware required by the TOE
to perform its claimed security features. The TOE is defined to comprise the chip
and the complete operating system and application. Note, the inlay holding the
chip as well as the antenna and the booklet (holding the printed MRZ) are
needed to represent a complete travel document. Nevertheless, these parts are
not inevitable for the secure operation of the TOE.




2
 For this ST all steps of both phase 1 and phase 2 are part of the evaluation and therefore define the TOE
delivery according to the CC evaluation after this phase.
                        Security Target Lite
                                                                        Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                  2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                    Page: 24/150
                       eMRTD Configuration)


2 Conformance Claims


2.1 CC Conformance Claim
This security target claims to be conformant to the Common Criteria version
3.1,which comprises

   Common Criteria for Information Technology Security Evaluation, Part
    1:Introduction and General Model; CCMB-2012-09-001, Version 3.1, Revision
    5, April 2017
    [CC-1]
   Common Criteria for Information Technology Security Evaluation, Part
    2:Security Functional Requirements; CCMB-2012-09-002, Version 3.1,
    Revision 5, April 2017 [CC-2]
   Common Criteria for Information Technology Security Evaluation, Part
    3:Security Assurance Requirements; CCMB-2012-09-003, Version 3.1,
    Revision 5, April 2017 [CC-3]

    as follows:
     Part 2 extended
          o FAU_SAS       Audit data storage
          o FCS_RND       Generation of random numbers
          o FIA_API       Authentication proof of identity
          o FMT_LIM       Limited capabilities and availability
          o FPT_EMS       TOE emanation
     Part 3 conformant

The Common Methodology for Information Technology Security Evaluation
(CEM), Evaluation Methodology; CCMB-2012-09-004, Version 3.1, Revision 5,
April 2017 [CEM] has been taken into account.


2.2 PP Claim
This security target (ST) claims strict conformance to:
    Common Criteria Protection Profile Machine Readable Travel Document
       with "ICAO Application", Extended Access Control with PACE (EAC PP) BSI-
       CC-PP-0056-V2-2012, Version 1.3.2, 5th December 2012 [EAC-PP-V2].
    Protection Profile Machine Readable Travel Document using Standard
       Inspection Procedure with PACE, BSI-CC-PP-0068-V2-2011-MA-01,
       Version 1.0.1, 22 July 2014, BSI [PACE-PP].

The [EAC-PP-V2] claims strict conformance to the PACE Protection Profile
Machine Readable Travel Document using Standard Inspection Procedure with
PACE, BSI-CC-PP-0068-V2-2011, Version 1.0, 2nd November 2011, BSI.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 25/150
                        eMRTD Configuration)

2.3 Package Claim
This ST is conforming to assurance package EAL5 augmented with ALC_DVS.2
and AVA_VAN.5 defined in CC part 3 [CC-3].


2.4 PP Conformance Rationale
This ST claims strict conformance to [EAC-PP-V2]. According to hints in [EAC-PP-
V2] parts of the [PACE-PP] have been included into this ST. A detailed
justification is given in the following.


2.4.1 Main aspects
-   The TOE description (chapter 1.3) is based on the TOE definition and TOE
    usage of [EAC-PP, 1.1]. It was enhanced by product specific details.

-   All definitions of the security problem definition in [EAC-PP, 3] have been
    taken exactly from the protection profile in the same wording.

-   All security objectives have been taken exactly from [EAC-PP, 4] in the same
    wording, except for OT.Chip_Auth_Proof which is enhanced to support
    Active Authentication.

-   The part of extended components definition has been taken originally from
    [EAC-PP, 5].

-   All SFRs for the TOE have been taken originally from the [EAC-PP, 6.1] added
    by according iterations, selections and assignments.

-   The security assurance requirements (SARs) have been taken originally from
    the EAC-PP. The requirements are shifted to those of EAL 5+.


2.4.2 Overview of differences between the PP and the ST

The Active Authentication has been added to the TOE. For that:
- One assumption has been added to cover Active Authentication during
   personalization: A.Pers_Agent_AA
- Two security objectives for the environment have been added:
   OE.Auth_Key_MRTD and OE.AA_MRTD. These additions to the original
   objectives of the PP do not contradict with any other objective nor mitigate a
   threat (or part of a threat) meant to be addressed by security objectives for
   the TOE in the PP.
- Three security functional requirements have been added:
              FCS_COP.1/SIG_GEN
                FIA_API.1/AA
                FMT_MTD.1/AAPK
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 26/150
                        eMRTD Configuration)

The additional functionality of Password Authenticated Connection Establishment
with Chip Authentication Mapping (PACE-CAM) has been added to the TOE. It
possesses the same security requirements as the PACE functionality, which
means that the same security problem definition is applicable for PACE-CAM.


The following additional SFRs have been defined for PACE-CAM:
              FIA_UID.1/PACE_CAM
                FIA_UAU.1/PACE_CAM
                FIA_UAU.4/PACE_CAM
                FIA_UAU.5/PACE_CAM
                FIA_UAU.6/PACE_CAM
                FMT_MTD.1/PACE_CAM_KEY_READ
                FMT_MTD.1/PACE_CAM_KEY_WRITE




The additional functionality of the Polymorphic eMRTD extensions has been
added to the TOE with: (i) additional security problem definition; (ii) additional
security objectives; (iii) additional SFRs. Notice that many SFRs are included
from the [EACv2-PP].
                        Security Target Lite
                           eneral support for cryptographic operations needed.

OT.Data_Authenticity The security objective OT.Data_Authenticity aims
  ensuring authenticity of the User- and TSF data (after the PACE
  Authentication) by enabling its verification at the terminal-side and by an
  active verification by the TOE itself. This objective is mainly achieved by
  FTP_ITC.1/PACE using FCS_COP.1/PACE_MAC. A prerequisite for establishing
  this trusted channel is a successful PACE or Chip and Terminal Authentication
  v.1       FIA_UID.1/PACE,       FIA_UAU.1/PACE        (FIA_UID.1/PACE_CAM,
  FIA_UAU.1/PACE_CAM for PACE CAM) using FCS_CKM.1/DH_PACE resp.
  FCS_CKM.1/CA and possessing the special properties FIA_UAU.5/PACE,
  FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM, FIA_UAU.6/PACE_CAM for PACE
  CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1 requires erasing the values of session
  keys (here: for KMAC). FIA_UAU.4/PACE, FIA_UAU.5/PACE and FCS_CKM.4
  (FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM and FCS_CKM.4 for PACE
  CAM) represent some required specific properties of the protocols used. The
  SFR FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the
  Chip Authentication Private Key and the Active Authentication Private Key. The
  SFR FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE
  passwords and the modular invert of the CA key. FMT_MTD.1/PA requires that
  SOD containing signature over the User Data stored on the TOE and used for
  the Passive Authentication is allowed to be written by the Personalisation
  Agent only and, hence, is to be considered as trustworthy. The SFR
  FCS_RND.1 represents a general support for cryptographic operations needed.
  The SFRs FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles
  related.

OT.Data_Confidentiality The security objective OT.Data_Confidentiality aims
  that the TOE always ensures confidentiality of the User- and TSF-data stored
  and, after the PACE Authentication resp. Chip Authentication, of these data
  exchanged. This objective for the data stored is mainly achieved by
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 112/150
                       eMRTD Configuration)

  (FDP_ACC.1/TRM, FDP_ACF.1/TRM). FIA_UAU.4/PACE, FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM,        FIA_UAU.5/PACE_CAM      for   PACE    CAM)    and
  FCS_CKM.4 represent some required specific properties of the protocols used.
  This objective for the data exchanged is mainly achieved by FDP_UCT.1/TRM,
  FDP_UIT.1/TRM and FTP_ITC.1/PACE using FCS_COP.1/PACE_ENC resp.
  FCS_COP.1/CA_ENC. A prerequisite for establishing this trusted channel is a
  successful PACE or Chip and Terminal Authentication v.1 FIA_UID.1/PACE,
  FIA_UAU.1/PACE (FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM for PACE
  CAM) using FCS_CKM.1/DH_PACE resp. FCS_CKM.1/CA and possessing the
  special properties FIA_UAU.5/PACE, FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM,
  FIA_UAU.6/PACE_CAM for PACE CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1
  requires erasing the values of session keys (here: for Kenc). The SFR
  FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the Chip
  Authentication Private Key and the Active Authentication Private Key. The SFR
  FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE passwords
  and the modular invert of the CA key. FMT_MTD.1/PA requires that SOD
  containing signature over the User Data stored on the TOE and used for the
  Passive Authentication is allowed to be written by the Personalisation Agent
  only and, hence, is to be considered trustworthy. The SFR FCS_RND.1
  represents the general support for cryptographic operations needed. The SFRs
  FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles related.

OT.Tracing The security objective OT.Tracing aims that the TOE prevents
  gathering TOE tracing data by means of unambiguous identifying the travel
  document remotely through establishing or listening to a communication via
  the contactless/contact-based interface of the TOE without a priori knowledge
  of the correct values of shared passwords (CAN, MRZ, PIN, PUK). This
  objective is achieved as follows:
            1. While establishing PACE communication with CAN, MRZ or PUK
                (non-blocking      authentication /   authorization  data)   by
                FIA_AFL.1/PACE,
            2. while establishing PACE communication using the PIN (blocking
                authentication data) by FIA_AFL.1/Block_PIN,
            3. for listening to PACE communication and for establishing CAv1
                communication by FTP_ITC.1/PACE,
            4. and      for     listening     to  CAv1     communication     by
                FTP_ITC.1/Polymorphic. The trusted channel shall be established
                by performing the PACE, CAv1 and TAv1 protocols according to
                [TR03110TR-03110] and the Polymorphic Authentication protocol
                (PMA).

OT.Prot_Abuse-Func The security objective OT.Prot_Abuse-Func “Protection
  against Abuse of Functionality” is ensured by the SFRs FMT_LIM.1, FMT_LIM.2,
  FMT_LIM.1/POLY and FMT_LIM.2/POLY which prevent misuse of test
  functionality of the TOE or other features which may not be used after TOE
  Delivery.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 113/150
                        eMRTD Configuration)

OT.Prot_Inf_Leak The security objective OT.Prot_Inf_Leak “Protection against
  Information Leakage” requires the TOE to protect confidential TSF data stored
  and/or processed in the travel document’s chip against disclosure
      by measurement and analysis of the shape and amplitude of signals or the
        time between events found by measuring signals on the electromagnetic
        field, power consumption, clock, or I/O lines which is addressed by the
        SFR FPT_EMS.1,
      by forcing a malfunction of the TOE which is addressed by the SFR
        FPT_FLS.1 and FPT_TST.1, and/or
      by a physical manipulation of the TOE which is addressed by the SFR
        FPT_PHP.3.

OT.Prot_Phys-Tamper The security objective OT.Prot_Phys-Tamper “Protection
  against Physical Tampering” is covered by the SFR FPT_PHP.3.

OT.Prot_Malfunction The security objective OT.Prot_Malfunction “Protection
  against Malfunctions” is covered by (i) the SFR FPT_TST.1 which requires self-
  tests to demonstrate the correct operation and tests of authorized users to
  verify the integrity of TSF data and TSF code, and (ii) the SFRFPT_FLS.1 which
  requires a secure state in case of detected failure or operating conditions
  possibly causing a malfunction.

OT.Identification The security objective OT.Identification “Identification of the
  TOE” addresses the storage of Initialisation and Pre-Personalisation Data in its
  non-volatile memory, whereby they also include the IC Identification Data
  uniquely identifying the TOE’s chip. This will be ensured by TSF according to
  SFR FAU_SAS.1. The SFR FMT_MTD.1/INI_ENA allows only the Manufacturer
  to write Initialisation and Pre-personalisation Data (including the
  Personalisation Agent key set). The SFR FMT_MTD.1/INI_DIS requires the
  Personalisation Agent to disable access to Initialisation and Pre-personalisation
  Data in the life cycle phase ‘operational use’. The SFRs FMT_SMF.1 and
  FMT_SMR.1/PACE support the functions and roles related.

OT.AC_Pers The       security   objective  OT.AC_Pers      “Access   Control   for
  Personalisation of logical travel document” addresses the access control of the
  writing the logical travel document. The justification for the SFRs FAU_SAS.1,
  FMT_MTD.1/INI_ENA and FMT_MTD.1/INI_DIS arises from the justification for
  OT.Identification above with respect to the Pre-personalisation Data. The write
  access to the logical travel document data are defined by the SFR
  FIA_UID.1/PACE (FIA_UID.1/PACE_CAM for PACE CAM), FIA_UAU.1/PACE
  (FIA_UAU.1/PACE_CAM for PACE CAM), FDP_ACC.1/TRM and FDP_ACF.1/TRM
  in the same way: only the successfully authenticated Personalisation Agent is
  allowed to write the data of the groups EF.DG1 to EF.DG16 of the logical travel
  document only once. FMT_MTD.1/PA covers the related property of
  OT.AC_Pers (writing SOD and, in generally, personalization data). The SFR
  FMT_SMR.1/PACE lists the roles (including Personalisation Agent) and the SFR
  FMT_SMF.1 lists the TSF management functions (including Personalisation).
                        Security Target Lite
                                                                     Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 114/150
                       eMRTD Configuration)

  The SFRs FMT_MTD.1/KEY_READ (FMT_MTD.1/PACE_CAM_KEY_READ for
  PACE CAM protocol) and FPT_EMS.1 restrict the access to the Personalisation
  Agent Keys, the Chip Authentication Private Key and the Active Authentication
  Private key. The authentication of the terminal as Personalisation Agent shall
  be performed by TSF according to SFRs FIA_UAU.4/PACE and FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM and FIA_UAU.5/PACE_CAM for PACE CAM). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Terminal Authentication Protocol v.1 (after Chip Authentication v.1) with
  the Personalisation Agent Keys, the TOE will use TSF according to the
  FCS_RND.1 (for the generation of the challenge), FCS_CKM.1/CA (for the
  derivation of the new session keys after Chip Authentication v.1), and
  FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the ENC_MAC_Mode secure
  messaging), FCS_COP.1/SIG_VER (as part of the Terminal Authentication
  Protocol v.1) and FIA_UAU.6/EAC (for the re-authentication). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Authentication Mechanism with the Personalisation Agent Key, the TOE will
  use TSF according to the FCS_RND.1 (for the generation of the challenge) and
  FCS_COP.1/CA_ENC (to verify the authentication attempt). The session keys
  are destroyed according to FCS_CKM.4 after use.

OT.Sens_Data_Conf The            security     objective      OT.Sense_Data_Conf“
  Confidentiality of sensitive biometric reference data” is enforced by the Access
  Control SFP defined in FDP_ACC.1/TRM and FDP_ACF.1/TRM allowing the data
  of EF.DG3 and EF.DG4 only to be read by successfully authenticated Extended
  Inspection System being authorized by a valid certificate according
  FCS_COP.1/SIG_VER. The SFRs FIA_UID.1/PACE and FIA_UAU.1/PACE
  (FIA_UID.1/PACE_CAM and FIA_UAU.1/PACE_CAM for PACE CAM) require the
  identification and authentication of the inspection systems. The SFR
  FIA_UAU.5/PACE requires the successful Chip Authentication (CA) v.1 before
  any     authentication    attempt   as    Extended     Inspection  System    (or
  FIA_UAU.5/PACE_CAM for PACE CAM). During the protected communication
  following the CA v.1 the reuse of authentication data is prevented by
  FIA_UAU.4/PACE (FIA_UAU.4/PACE_CAM for PACE CAM). The SFR
  FIA_UAU.6/EAC and FDP_UCT.1/TRM requires the confidentiality protection of
  the transmitted data after Chip Authentication v.1 by means of secure
  messaging implemented by the cryptographic functions according to
  FCS_RND.1 (for the generation of the terminal authentication challenge),
  FCS_CKM.1/CA (for the generation of shared secret and for the derivation of
  the new session keys), and FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC for
  the ENC_MAC_Mode secure messaging. The session keys are destroyed
  according to FCS_CKM.4 after use. The SFR FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ requires that the Chip Authentication Key cannot be
  written unauthorized or read afterwards. The SFR FMT_MTD.1/AAPK and
  FMT_MTD.1/KEY_READ requires that the Active Authentication Key cannot be
  written       unauthorized       or      read      afterwards.      The     SFR
  FMT_MTD.1/PACE_CAM_KEY_WRITE and FMT_MTD.1/PACE_CAM_KEY_READ
  requires that the modular invert of the CA key cannot be written unauthorized
  or read afterwards. To allow a verification of the certificate chain as in
  FMT_MTD.3 the CVCA’s public key and certificate as well as the current date
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 115/150
                       eMRTD Configuration)

  are  written or   update  by   authorized identified role  as                 of
  FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD and FMT_MTD.1/DATE.

OT.Chip_Auth_Proof The security objective OT.Chip_Auth_Proof “Proof of
  travel document’s chip authenticity” is ensured by the Chip Authentication
  Protocolv.1 provided by FIA_API.1/CA and by Active Authentication provided
  by FIA_API.1/AA proving the identity of the TOE. The Chip Authentication
  Protocolv.1 defined by FCS_CKM.1/CA is performed using a TOE internally
  stored confidential private key as required by FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ. The Chip Authentication Protocolv.1 [TR-03110-1]
  requires additional TSF according to FCS_CKM.1/CA (for the derivation of the
  session keys), FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the
  ENC_MAC_Mode        secure    messaging).    The   SFRs     FMT_SMF.1     and
  FMT_SMR.1/PACE support the functions and roles related. The Active
  Authentication defined by FCS_COP.1/SIG_GEN for the generation of the RSA
  Signature is performed using a TOE internally stored confidential private key
  as required by FMT_MTD.1/AAPK and FMT_MTD.1/KEY_READ. According to
  FDP_ACF.1, only the successfully authenticated Inspection Systems are
  allowed to request active authentication (FDP_ACF.1.2, rule 2).

OT.Polymorphic_Data_Confidentiality: SFRs that contribute to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Integrity: SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.Polymorphic_Data_Authenticity:        SFRs   that contribute   to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Privacy:        SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.AC_Pers_Polymorphic:       SFRs that contribute to meet this objective are
  mentioned in table 7.

OT.DoS: SFRs that contribute to meet this objective are mentioned in table 7.

6.3.2 Rationale tables of Security Objectives and SFRs
                                 Security Target Lite
                                                                             Ref.:
                          IDeal Pass v2.3-n JC with Privacy
                                                                      2018_2000036361
                          Protection (SAC/EAC/Polymorphic
                                                                        Page: 116/150
                                eMRTD Configuration)

Security Objectives                Security Functional Requirements                 Rationale
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FPT_PHP.3, FCS_CKM.1/CA,
                                   FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Integrity                  FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FMT_MTD.1/AAPK,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_WRITE,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FTP_ITC.1/PACE,
                                   FMT_SMF.1, FMT_MTD.1/PA, FCS_CKM.1/CA,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Authenticity               FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                    6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FMT_SMR.1/PACE,
                                   FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_ENC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FCS_CKM.1/CA, FCS_COP.1/CA_ENC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,                  Section
OT.Data_Confidentiality
                                   FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_AFL.1/PACE, FTP_ITC.1/PACE,                  Section
OT.Tracing
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Block_PUK         6.3.1
                                   FMT_LIM.1, FMT_LIM.2, FMT_LIM.1/POLY,            Section
OT.Prot_Abuse-Func
                                   FMT_LIM.2/POLY                                   6.3.1
                                                                                    Section
OT.Prot_Inf_Leak                   FPT_FLS.1, FPT_TST.1, FPT_PHP.3, FPT_EMS.1
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Phys-Tamper                FPT_PHP.3
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Malfunction                FPT_FLS.1, FPT_TST.1
                                                                                    6.3.1
                                   FMT_SMF.1, FMT_MTD.1/INI_ENA, FAU_SAS.1,         Section
OT.Identification
                                   FMT_SMR.1/PACE, FMT_MTD.1/INI_DIS                6.3.1
                              Security Target Lite
                                                                               Ref.:
                       IDeal Pass v2.3-n JC with Privacy
                                                                        2018_2000036361
                       Protection (SAC/EAC/Polymorphic
                                                                          Page: 117/150
                             eMRTD Configuration)

                                      FMT_SMF.1, FMT_MTD.1/INI_ENA, FMT_MTD.1/PA,
                                      FAU_SAS.1, FCS_CKM.1/CA, FCS_CKM.4,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_COP.1/SIG_VER, FCS_RND.1, FIA_UID.1/PACE,
                                      FIA_UAU.1/PACE, FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                        Section
OT.AC_Pers                            FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                        6.3.1
                                      FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                      FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                      FPT_EMS.1, FMT_MTD.1/INI_DIS,
                                      FMT_MTD.1/PACE_CAM_KEY_READ
                                      FCS_CKM.1/CA, FCS_CKM.4, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_COP.1/SIG_VER,
                                      FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                      FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                      FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                      FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                      FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                                                                        Section
OT.Sens_Data_Conf                     FDP_UCT.1/TRM, FMT_MTD.1/CVCA_INI,
                                      FMT_MTD.1/CVCA_UPD, FMT_MTD.1/DATE,               6.3.1
                                      FMT_MTD.1/CAPK, FMT_MTD.1/KEY_READ,
                                      FMT_MTD.1/PACE_CAM_KEY_READ,
                                      FMT_MTD.1/PACE_CAM_KEY_WRITE FMT_MTD.3,
                                      FMT_MTD.1/AAPK,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                      FCS_CKM.1/CA, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FMT_SMF.1, FMT_SMR.1/PACE,
                                                                                        Section
OT.Chip_Auth_Proof                    FMT_MTD.1/CAPK, FMT_MTD.1/KEY_READ,
                                                                                        6.3.1
                                      FIA_API.1/CA, FMT_MTD.1/AAPK, FIA_API.1/AA,
                                      FCS_COP.1/SIG_GEN
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/SIG_VER,
                                      FCS_COP.1/PACE_ENC, FCS_COP.1/PACE_MAC,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                      FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                      FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                      FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                      FDP_RIP.1/POLY, FDP_RIP.1, FDP_ACC.1/POLY,
                                      FDP_ACF.1/POLY, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FDP_UCT.1/TRM, FDP_UIT.1/TRM, FTP_ITC.1/PACE,     Section
OT.Polymorphic_Data_Confidentiality
                                      FMT_SMF.1, FMT_SMR.1/POLY,                        6.3.1
                                      FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD,
                                      FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                      FMT_MTD.1/KEY_READ, FMT_MTD.1/PI_PP_CPI_Read,
                                      FMT_MTD.1/PI_PP_CPI_Load,
                                      FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                      FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                      FCS_CKM.1/CA, FIA_UAU.6/POLY, FMT_MTD.3,
                                      FCS_CKM.4, FIA_UAU.5/POLY, FCS_CKM.1/POLY,
                                      FCS_COP.1/POLY
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_RND.1,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,       Section
OT.Polymorphic_Data_Integrity
                                      FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,   6.3.1
                                      FIA_UAU.6/EAC, FDP_RIP.1/POLY, FDP_RIP.1,
                                      FDP_ACC.1/POLY, FDP_ACF.1/POLY, FDP_ACC.1/TRM,
                                      FDP_ACF.1/TRM, FDP_UCT.1/TRM, FDP_UIT.1/TRM,
                             Security Target Lite
                                                                            Ref.:
                      IDeal Pass v2.3-n JC with Privacy
                                                                     2018_2000036361
                      Protection (SAC/EAC/Polymorphic
                                                                       Page: 118/150
                            eMRTD Configuration)

                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,
                                   FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FPT_PHP.3,
                                   FMT_MTD.1/PI_PP_CPI_Read,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/PACE_MAC,
                                   FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                   FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                   FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                   FIA_AFL.1/PACE, FDP_RIP.1/POLY, FDP_RIP.1,        Section
OT.Polymorphic_Data_Authenticity
                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,        6.3.1
                                   FMT_MTD.1/PA, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/POLY,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                                                                     Section
OT.Polymorphic_Data_Privacy        FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                                                                     6.3.1
                                   FMT_MTD.1/PI_PP_CPI_Read, FPR_ANO.1,
                                   FPR_UNL.1, FCS_CKM.4, FCS_CKM.1/POLY
                                   FCS_COP.1/SIG_VER, FCS_COP.1/CA_ENC,
                                   FCS_COP.1/CA_MAC, FCS_RND.1,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,
                                   FIA_UAU.6/EAC, FDP_ACC.1/POLY, FDP_ACF.1/POLY,
                                   FDP_ACC.1/TRM, FDP_ACF.1/TRM, FAU_SAS.1,          Section
OT.AC_Pers_Polymorphic             FMT_SMF.1, FMT_SMR.1/POLY, FMT_MTD.1/PA,          6.3.1
                                   FMT_MTD.1/KEY_READ, FPT_EMS.1,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FMT_MTD.1/INI_DIS,
                                   FMT_MTD.1/INI_ENA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY
                                   FIA_AFL.1/Suspend_PIN,                            Section
OT.DoS
                                   FIA_AFL.1/Suspend_PUK                             6.3.1

                    Table 7 Security Objectives and SFRs - Coverage
                        Security Target Lite
                                                                       Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                  Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACEsections 7.2 and 7.3 of the PP [9]
 Due to these optional additional security functionalities the security objectives
    O.Cap_Avail_Loader, capability and availability of the Loader,
    O.Ctrl_Auth_Loader, access control and authenticity for the Loader and
    OE.Loader_Usage. secure communication and usage of the Loader
    O.Prot_TSF_Confidentiality, protection of the confidentiality of the TSF
    OE.Lim_Block_Loader, limitation of capability and blocking the Loader
have been introduced.




CC Document                                             40                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Conformance Claims (ASE_CCL)


3.1.4         CIPURSE Cryptographic Library (CCL)

The TOE provides “Additional Specific Security Functionality (O.Add-Functions)” including the CIPURSE™
Cryptography. This cryptographic functionality implements additional cryptographic services by implementation
of a protocol providing a secure mutual authentication of two entities, namely the terminal (denoted as PCD =
Proximity Coupling Device (CIPURSE™-compliant terminal)) and a smart card or a token in other form factors
which is called PICC. PICC stands for Proximity Integrated Circuit Card (CIPURSE™-compliant card).
Beside the mutual authentication, the protocol implements measures to maintain the integrity of the transferred
data and preserves in parallel the confidentiality of the transferred data.
Due to these additional security functionalities the security objectives
     O.Ctrl_Auth_CCL
     O.Prot_Integrity
     O.Prot_Confidentiality
have been introduced.




CC Document                                           41                                                    1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Conformance Claims (ASE_CCL)


3.1.5          Summary

All of the above add-ons have no impact on the conformance statements regarding CC [10] and PP [9], with
following rational:
The security target fulfils the strict conformance claim of the PP [9] due to the application notes 9 applying here.
By this note the addition of further security functions and security services are covered, even without deriving
particular security functionality from a threat or a policy.
Due to the above rational, the security objectives of this security target are consistent with the statement of the
security objectives in the PP [9], as the security target claims package augmentation to the PP [9].
All security functional requirements defined in the PP [9] are included and completely defined in this ST.
A listing of all security functional requirements and where those are taken from is given in chapter 7.1.

The following security functional requirement is included and completely defined in this ST, section 6.

                         FPT_TST.2               Subset TOE security testing1

All assignments and selections of the security functional requirements are done in the PP [9] and in this Security
Target.


3.2            Application Notes
The functional requirements
     FCS_RNG.1/HPRG,
     FCS_RNG.1/TRNG,
     FCS_RNG.1/DRNG and
     FCS_RNG.1/KSG
are iterations of the FCS_RNG.1 as defined in the Protection Profile [9] according to “Anwendungshinweise und
Interpretationen zum Schema (AIS)” respectively “Functionality classes and evaluation methodology for physical
random number generators”, AIS31 [13].




                                             1
                                                 Requirement from the PP [9]


CC Document                                                 42                                                    1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Problem Definition (ASE_SPD)




4              Security Problem Definition (ASE_SPD)
The content of the PP [9] applies to this chapter completely.


4.1            Threats
The threats are directed against the assets and/or the security functions of the TOE. For example, certain attacks
are only one step towards a disclosure of assets while others may directly lead to a compromise of the
application security. The more detailed description of specific attacks is given later on in the process of
evaluation and certification.
The threats to security are defined and described in PP [9] section 3.2, respectively for T.Masquerade_TOE in
chapter 7.2.1.

                                      Table 6      Threats according PP [9]
                             Threat                                Name
                     T.Phys-Manipulation        Physical Manipulation
                     T.Phys-Probing             Physical Probing
                     T.Malfunction              Malfunction due to Environmental Stress
                     T.Leak-Inherent            Inherent Information Leakage
                     T.Leak-Forced              Forced Information Leakage
                     T.Abuse-Func               Abuse of Functionality
                     T.RND                      Deficiency of Random Numbers
                     T.Masquerade_TOE           Masquerade of the TOE



4.1.1          Additional Threat due to TOE specific Functionality
Threat Memory Access Violation
The additional functionality of introducing sophisticated privilege levels and access control allows the secure
separation between the operation system(s) and applications, the secure downloading of applications after
personalization and enables multitasking by separating memory areas and performing access controls between
different applications. Due to this additional functionality “area based memory access control” a new threat is
introduced.
The Smartcard Embedded Software is responsible for its User data of the Composite TOE according to the
assumption “Treatment of User data of the Composite TOE (A.Resp-Appl)”. However, the Smartcard Embedded
Software may comprise different parts, for instance an operating system and one or more applications. In this
case, such parts may accidentally or deliberately access data (including code) of other parts, which may result in
a security violation.




CC Document                                             43                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Problem Definition (ASE_SPD)


The TOE shall avert the threat “Memory Access Violation (T.Mem-Access)” as specified below:

 T.Mem-            Memory Access Violation
 Access
                   Parts of the Smartcard Embedded Software may cause security violations by accidentally or
                   deliberately accessing restricted data (which may include code) or privilege levels. Any
                   restrictions are defined by the security policy of the specific application context and must be
                   implemented by the Smartcard Embedded Software.

Threat Diffusion of Open Samples
The additional functionality of a Loader as defined in the PP [9], section 7.3 requires to address the following
threat, as defined in the document “PP0084: Interpretation” [9.1].
The TOE shall avert the threat “Diffusion of open Samples (T.Open_Samples_Diffusion)” as specified below:

 T.Open_Samples_Diffusion         Diffusion of Open Samples
                                  An attacker may get access to open samples of the TOE and use them to gain
                                  information about the TSF (loader, memory management unit, ROM code …).
                                  He may also use the open samples to characterize the behavior of the IC and its
                                  security functionalities (for example: characteriy objective OT.Active_Auth above counters the threat T.Counterfeit
(threat defined in [PP_EAC].




CC Document                                              12
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 6            Extended Components Definition (ASE_ECD)
[PP_EAC], [PP_SAC] and [PP_BAC] respective sections 5 “Extended Components Definition” are applicable for
this TOE.




CC Document                                          13
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  7             Security Requirements (ASE_REQ)

  7.1           TOE Security Functional Requirements
 The security functional requirements (SFR) for this TOE are defined in this chapter.
This ST covers the three PPs [PP_SAC], [PP_EAC] and [PP_BAC] each two of which have a non empty
intersection of SFRs. In the rest of this section we provide a classification of the SFRs of these PPs depending on
where these SFRs are declared and if they need a refinement here in this ST.
 Table 1 lists all SFRs appearing both in [PP_SAC] and [PP_BAC].
 Table 2 lists all SFRs declared in [PP_SAC].
Table 3 lists all SFRs specific to [PP_BAC]. Note that some of the SFRs appear in both [PP_SAC] and [PP_BAC]
with same name but different content. In such cases the SFR is iterated with either the extension …/BAC or
…/PACE.
Table 4 lists all SFRs specific to [PP_EAC]. Note that [PP_EAC] is an extension of [PP_SAC], therefore all SFRs of
[PP_SAC] are SFRs in [PP_EAC], i.e. the SFRs listed in Table 3 and Table 4 are also SFRs of [PP_EAC].
Table 5 lists the SFRs introduced in this ST which are related to the Active Authentication mechanism
supported by the TOE.

Table 1       TOE SFRs equivalent from both [PP_SAC] and [PP_BAC]
  FCS_CKM.4
  FCS_RND.1
  FMT_MTD.1/INI_ENA
  FPT_TST.1
  FPT_PHP.3



Table 2       TOE SFRs specifically from [PP_SAC]
  FCS_CKM.1/DH_PACE
  FCS_COP.1/PACE_ENC
  FCS_COP.1/PACE_MAC
  FIA_AFL.1/PACE
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/PACE
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FDP_RIP.1

CC Document                                             14
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FDP_UCT.1/TRM
  FDP_UIT.1/TRM
  FTP_ITC.1/PACE
  FAU_SAS.1
  FMT_SMF.1
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/INI_DIS
  FMT_MTD.1/KEY_READ
  FMT_MTD.1/PA
  FPT_EMS.1
  FPT_FLS.1

Table 3

Table 4       TOE SFRs specifically from [PP_BAC]
  FCS_CKM.1
  FCS_COP.1/SHA
  FCS_COP.1/ENC
  FCS_COP.1/AUTH
  FCS_COP.1/MAC
  FIA_UID.1
  FIA_UAU.1
  FIA_UAU.4
  FIA_UAU.5
  FIA_UAU.6
  FIA_AFL.1
  FDP_ACC.1
  FDP_ACF.1
  FDP_UCT.1
  FDP_UIT.1
  FAU_SAS.1/BAC
  FMT_SMF.1/BAC
  FMT_SMR.1
  FMT_LIM.1/BAC
  FMT_LIM.2/BAC
  FMT_MTD.1/INI_DIS/BAC

CC Document                                          15
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FMT_MTD.1/KEY_WRITE
  FMT_MTD.1/KEY_READ/BAC
  FPT_EMSEC.1
  FPT_FLS.1/BAC




Table 5       TOE SFRs specifically from [PP_EAC]
  FCS_CKM.1/CA
  FCS_COP.1/CA_ENC
  FCS_COP.1/CA_MAC
  FCS_COP.1/SIG_VER
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/EAC
  FIA_API.1
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/CVCA_INI
  FMT_MTD.1/DATE
  FMT_MTD.1/CAPK
  FMT_MTD.1/CVCA_UPD
  FMT_MTD.1/KEY_READ
  FMT_MTD.3
  FPT_EMS.1




CC Document                                          16
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



Table 6       TOE SFRs introduced in this ST
 FIA_API.1/AA
 FMT_MTD.1/AA
 FCS_COP.1/SIG_GEN




7.1.1                About the Application Notes in this ST
Note that if an SFR has application notes as per the PPs [PP_SAC], [PP_EAC] and [PP_BAC] then these
application notes apply and can be found in the respective PPs.
Some SFRs contain additional application notes to ease the understanding of the specificities of this TOE.
These application notes do not come from the PPs and are prefixed with [IFX specific].



7.1.2                Common SFRs from [PP_BAC] and [PP_SAC]

7.1.2.1              Class FCS: Cryptographic Support




  FCS_CKM.4                Cryptographic key destruction – Session keys

  Hierarchical to:         No other components.

  Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                           user data with security attributes, or FCS_CKM.1 Cryptographic key generation]:
                           fulfilled by FCS_CKM.1 in case of BAC;
                           fulfilled by FCS_CKM.1/DH_PACE in case of PACE

  FCS_CKM.4.1              The TSF shall destroy cryptographic keys in accordance with a specified
                           cryptographic key destruction method overwriting the key values with random
                           values that meets the following: none

                           Application note 19 of [PP_BAC] and application note 28 of [PP_SAC] are both
 [IFX specific]            applicable for this SFR. There is no contradiction between the two application
 Application Note:         notes. While the application note from [PP_BAC] simply requests the encryption
                           and message authentication keys to be destroyed, the application note from
                           [PP_SAC] provides more detailed requests, when the session keys have to be
                           destroyed. Therefore FCS_CKM.4 from [PP_SAC] and [PP_BAC] can be combined.




CC Document                                            17
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_RND.1                Quality metric for random numbers

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FCS_RND.1.1              The TSF shall provide a mechanism to generate random numbers that meet
                          Random numbers generation Class PTG.3 according to [AIS31]

 [IFX specific]           There is no contradiction between application note 24 of [PP_BAC] and application
 Application Note:        note 31 of [PP_SAC]. Both application notes shall apply and therefore FCS_RND.1
                          from [PP_BAC] and [PP_SAC] can be combined, i.e. the random numbers shall be
                          used for the PACE, BAC and the authentication mechanism based on Triple-DES (as
                          defined in FIA_UAU.4/PACE and FIA_UAU.4).




7.1.2.2             Class FMT Security Management

 FMT_MTD.1/INI_ENA        Management of TSF data – Writing Initialisation and Pre-personalisation Data

 Hierarchical to:         No other components.

 Dependencies:            FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1 for
                          PACE; fulfilled by FMT_SMF.1/BAC for BAC
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE for PACE; fulfilled by
                          FMT_SMR.1 for BAC

 FMT_MTD.1.1/INI_ENA      The TSF shall restrict the ability to write the Initialisation Data and Pre-
                          personalisation Data to the Manufacturer.

 [IFX specific]           The application note 42 of [PP_BAC] applies. This application note provides a
 Application Note:        definition, what is meant by “Pre-Personalisation Data”. This definition is also
                          applicable to FMT_MTD.1/INI_ENA from [PP_SAC]. Therefore FMT_MTD.1/INI_ENA
                          from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            18
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.2.3             Class FPT Protection of the Security Functions


 FPT_TST.1                TSF testing

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_TST.1.1              The TSF shall run a suite of self tests during initial start-up, to demonstrate the
                          correct operation of the TSF.

 FPT_TST.1.2              The TSF shall provide authorised users with the capability to verify the integrity of
                          the TSF data.

 FPT_TST.1.3              The TSF shall provide authorised users with the capability to verify the integrity of
                          stored TSF executable code.



 [IFX specific]           There is no contradiction between application note 46 of [PP_BAC] and application
                          note 52 of [PP_SAC]. In fact, although the wording is slightly different, the meaning
 Application Note:
                          of these application notes is identical. Therefore either of these application notes
                          applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be combined.




 FPT_PHP.3                Resistance to physical attack

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_PHP.3.1              The TSF shall resist physical manipulation and physical probing to the TSF by
                          responding automatically such that the SFRs are always enforced.

 [IFX specific]           Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application
                          note 48 of [PP_BAC] is only informative to the reader in the sense, that it provides a
 Application Note:
                          context to an older CC standard, but not relevant for the interpretation of
                          FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or application note 53
                          of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            19
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.3                SFRs specifically from [PP_SAC]

7.1.3.1              Class FCS: Cryptographic Support


  FCS_CKM.1/DH_PACE        Cryptographic key generation – Diffie-Hellman for PACE session keys

  Hierarchical to:         No other components.

  Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                           operation]: fulfilled by FCS_CKM.4
                           Justification: A ECDH agreement is used in order to have no key distribution,
                           therefore FCS_CKM.2 makes no sense in this case while FCS_CKM.4 Cryptographic
                           key destruction makes sense.

  FCS_CKM.1.1/DH_PACE      The TSF shall generate cryptographic keys in accordance with a specified
                           cryptographic key generation algorithm ECDH compliant to [TR_ECC] and
                           specified cryptographic key size Table 7 column key size that meet the following:
                           [ICAO_SAC].




Table 7       FCS_CKM/DH_PACE Key Sizes
  Algorithm                                                               Key size
  ECDH key agreement algorithm                                            224, 256, 320, 384, 512
  AES session keys                                                        128, 192, 256
  TDES session keys                                                       112




  FCS_COP.1/PACE_ENC        Cryptographic operation – Encryption / Decryption AES / 3DES

  Hierarchical to:          No other components.

  Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import
                            of user data with security attributes, or FCS_CKM.1 Cryptographic key
                            generation]: fulfilled by FCS_CKM.1/DH_PACE
                            FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.

  FCS_COP.1.1/PACE_ENC      The TSF shall perform secure messaging – encryption and decryption in
                            accordance with a specified cryptographic algorithm AES and 3DES in CBC mode

CC Document                                           20
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                           and cryptographic key sizes 128, 192 and 256 bits for AES and 112 bits for 3DES
                           that meet the following: compliant to [ICAO_SAC].

 [IFX specific]            3DES in CBC mode is used with key size of 112 bit. AES in CBC mode is used with
 Application Note:         key size of 128, 192 or 256 bit. The TOE implements the cryptographic primitives
                           (i.e. Triple-DES and AES) for secure messaging with encryption of the transmitted
                           data and encrypting the nonce in the first step of PACE. The keys aruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or FCS_CKM.1


CC Document                                          43
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                                        Cryptographic key generation]FCS_CKM.4 Cryptographic key
                                        destruction

 FCS_COP.1.1/CA_MAC                     The TSF shall perform secure messaging – message authentication
                                        code in accordance with a specified cryptographic algorithm AES CMAC
                                        and 3DES-CBC and cryptographic key sizes 128, 192, 256 bits for AES
                                        CMAC and 112 for 3DES-CBC that meet the following: compliant to
                                        [ICAO_SAC] .


                                        Personalisation of the TOE is done using the secure channel protocol
 [IFX specific]
                                        03 as specified in [GPv2_3_1] with AES 256 bits key length with CMAC
 Application note                       compliant with NIST 800-38A.




7.1.5.3             Class FIA Identification and Authentication


The following table provides an overview of the authentication mechanisms used.

 Name                                                               SFR for the TOE

 Authentication Mechanism for Personalisation Agents                FIA_UAU.4/PACE
 Chip authentication v.1                                            FIA_API.1,
                                                                    FIA_UAU.5/PACE,
                                                                    FIA_UAU.6/EAC

 Chip Active Authentication                                         FIA_API.1/AA
 Terminal Authentication Protocol v.1                               FIA_UAU.5/PACE
 PACE protocol (listed only for information purposes, so will not   FIA_UAU.1/PACE
 be described further in this section)                              FIA_UAU.5/PACE
                                                                    FIA_AFL.1/PACE

 Passive authentication                                             FIA_UAU.5/PACE




 FIA_API.1/AA              Authentication Proof of Identity (Active Authentication)

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.


CC Document                                            44
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          The TSF shall provide the Active Authentication Mechanisms according to
 FIA_API.1.1/AA
                          [ICAO_9303_1] to prove the identity of the TOE.


 [IFX specific]           The SFR FIA_API.1/AA has been included in this security target in addition to the
 Application Note:        SFRs defined by the Protection Profiles claimed in section 3.2. This extension does
                          not conflict with the strict conformance to the claimed Protection Profiles.




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110_1]
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-03110_1]
                          (see next item 6)
                           6. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is identified.


 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel


CC Document                                            45
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key
                          5. to carry out the Chip Authentication Protocol Version 1 according to [TR-
                          03110_1]
                          6. to carry out the Terminal Authentication Protocol Version 1 according to [TR-
                          03110_1] (see next item 7)
                           7. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is authenticated.



 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




                          Single-use authentication mechanisms - Single-use authentication of the
 FIA_UAU.4/PACE
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according [ICAO_SAC],
                          2. Authentication Mechanism based on Triple- DES or AES .
                          3. Terminal Authentication Protocol v.1 according to [TR-03110_1].




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide

CC Document                                            46
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. PACE Protocol according to [ICAO_SAC],
                          2. Passive Authentication according to [ICAO_9303_01],
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC],
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                              length
                          5. Terminal Authentication Protocol v.1 according to [TR-03110_1],
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                          commands with correct message authentication code sent by means of secure
                          messaging with the key agreed with the terminal by means of the PACE protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by secure
                          channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key length.
                          3. After run of the Chip Authentication Protocol Version 1 the TOE accepts only
                          received commands with correct message authentication code sent by means of
                          secure messaging with key agreed with the terminal by means of the Chip
                          Authentication Mechanism v1.
                          4. The TOE accepts the authentication attempt by means of the Terminal
                          Authentication Protocol v.1 only if the terminal uses the public key presented
                          during the Chip Authentication Protocol v.1 and the secure messaging established
                          by the Chip Authentication Mechanism v.1 19.
                          5. None

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6/EAC            Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.




CC Document                                          47
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE after successful run of the Chip Authentication Protocol Version 1 shall
                          be verified as being sent by the Inspection System.




 FIA_API.1                 Authentication Proof of Identity

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.

 FIA_API.1.1              The TSF shall provide a Chip Authentication Protocol Version 1 according to [TR-
                          03110_1] to prove the identity of the TOE.




7.1.5.4             Class User Data Protection


 FDP_ACC.1/TRM             Subset access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1/TRM          The TSF shall enforce the Access Control SFP on terminals gaining access to the
                          User Data and data stored in EF.SOD of the logical travel document



The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below
(Common Criteria Part 2).



 FDP_ACF.1/TRM             Security attribute based access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACC.1 Subset access controlFMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1/TRM           The TSF shall enforce the Access Control SFP to objects based on the following:

CC Document                                          48
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. Subjects:
                            a.Terminal,
                            b.BIS-PACE
                            c.Extended Inspection System
                          2. Objects:
                             a.data in EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                          logical travel document ,
                            b.data in EF.DG3 of the logical travel document ,
                            c.data in EF.DG4 of the logical travel document ,
                            d.all TOE intrinsic secret cryptographic keys stored in the travel document
                          3. Security attributes:
                            a.PACE Authentication
                            b.Terminal Authentication v.1
                            c.Authorisation of the Terminal.

 FDP_ACF.1.2/TRM          The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed: A BIS-PACE is allowed to
                          read data objects from FDP_ACF.1.1/TRM according to [4] after a successful PACE
                          authentication as required by FIA_UAU.1/PACE.

 FDP_ACF.1.3/TRM          The TSF shall explicitly authorize access of subjects to objects based on the
                          following additional rules: none.

 FDP_ACF.1.4/TRM          The TSF shall explicitly deny access of subjects to objects based on the following
                          additional rules:
                          1.Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                          allowed to read, to write, to modify, to use any User Data stored on the travel
                          document.
                          2.Terminals not using secure messaging are not allowed to read, to write, to
                          modify, to use any data stored on the travel document.
                          3.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 3 (Fingerprint) granted by the relative
                          certificate holder authorization encoding is not allowed to read the data objects
                          2b) of FDP_ACF.1.1/TRM.
                          4.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 4 (Iris) granted by the relative certificate holder
                          authorization encoding is not allowed to read the data objects 2c) of
                          FDP_ACF.1.1/TRM.
                          5.Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.

CC Document                                           49
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          6.Terminals authenticated as CVCA or as DV are not allowed to read data in the
                          EF.DG3 and EF.DG4 .




7.1.5.5             Class FMT Security Management


 FMT_SMR.1/PACE            Security roles

 Hierarchical to:          No other components.

 Dependencies:             FIA_UID.1 Timing of identification.

 FMT_SMR.1.1/PACE          The TSF shall maintain the roles
                           1.Manufacturer ,
                           2.Personalisation Agent,
                           3.Terminal,
                           4.PACE authenticated BIS-PACE,
                           5.Country Verifying Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            D.1/CAPK, FMT_MTD.1/KEY_READ,
                                                                                        6.3.1
                                      FIA_API.1/CA, FMT_MTD.1/AAPK, FIA_API.1/AA,
                                      FCS_COP.1/SIG_GEN
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/SIG_VER,
                                      FCS_COP.1/PACE_ENC, FCS_COP.1/PACE_MAC,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                      FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                      FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                      FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                      FDP_RIP.1/POLY, FDP_RIP.1, FDP_ACC.1/POLY,
                                      FDP_ACF.1/POLY, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FDP_UCT.1/TRM, FDP_UIT.1/TRM, FTP_ITC.1/PACE,     Section
OT.Polymorphic_Data_Confidentiality
                                      FMT_SMF.1, FMT_SMR.1/POLY,                        6.3.1
                                      FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD,
                                      FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                      FMT_MTD.1/KEY_READ, FMT_MTD.1/PI_PP_CPI_Read,
                                      FMT_MTD.1/PI_PP_CPI_Load,
                                      FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                      FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                      FCS_CKM.1/CA, FIA_UAU.6/POLY, FMT_MTD.3,
                                      FCS_CKM.4, FIA_UAU.5/POLY, FCS_CKM.1/POLY,
                                      FCS_COP.1/POLY
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_RND.1,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,       Section
OT.Polymorphic_Data_Integrity
                                      FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,   6.3.1
                                      FIA_UAU.6/EAC, FDP_RIP.1/POLY, FDP_RIP.1,
                                      FDP_ACC.1/POLY, FDP_ACF.1/POLY, FDP_ACC.1/TRM,
                                      FDP_ACF.1/TRM, FDP_UCT.1/TRM, FDP_UIT.1/TRM,
                             Security Target Lite
                                                                            Ref.:
                      IDeal Pass v2.3-n JC with Privacy
                                                                     2018_2000036361
                      Protection (SAC/EAC/Polymorphic
                                                                       Page: 118/150
                            eMRTD Configuration)

                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,
                                   FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FPT_PHP.3,
                                   FMT_MTD.1/PI_PP_CPI_Read,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/PACE_MAC,
                                   FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                   FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                   FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                   FIA_AFL.1/PACE, FDP_RIP.1/POLY, FDP_RIP.1,        Section
OT.Polymorphic_Data_Authenticity
                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,        6.3.1
                                   FMT_MTD.1/PA, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/POLY,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                                                                     Section
OT.Polymorphic_Data_Privacy        FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                                                                     6.3.1
                                   FMT_MTD.1/PI_PP_CPI_Read, FPR_ANO.1,
                                   FPR_UNL.1, FCS_CKM.4, FCS_CKM.1/POLY
                                   FCS_COP.1/SIG_VER, FCS_COP.1/CA_ENC,
                                   FCS_COP.1/CA_MAC, FCS_RND.1,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,
                                   FIA_UAU.6/EAC, FDP_ACC.1/POLY, FDP_ACF.1/POLY,
                                   FDP_ACC.1/TRM, FDP_ACF.1/TRM, FAU_SAS.1,          Section
OT.AC_Pers_Polymorphic             FMT_SMF.1, FMT_SMR.1/POLY, FMT_MTD.1/PA,          6.3.1
                                   FMT_MTD.1/KEY_READ, FPT_EMS.1,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FMT_MTD.1/INI_DIS,
                                   FMT_MTD.1/INI_ENA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY
                                   FIA_AFL.1/Suspend_PIN,                            Section
OT.DoS
                                   FIA_AFL.1/Suspend_PUK                             6.3.1

                    Table 7 Security Objectives and SFRs - Coverage
                        Security Target Lite
                                                                       Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                  Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACE_CAM             No Dependencies
FIA_UID.1/POLY                 No Dependencies
FIA_UAU.1/POLY                 (FIA_UID.1)                FIA_UID.1/POLY
FIA_UAU.4/POLY                 No Dependencies
FIA_UAU.5/POLY                 No Dependencies
FIA_UAU.6/POLY                 No Dependencies
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_READ
                               (FMT_SMR.1)                FMT_SMR.1/PACE
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_WRITE
                               (FMT_SMR.1)                FMT_SMR.1/PACE
FIA_API.1/CA                   No Dependencies
FIA_API.1/AA                   No Dependencies
FDP_ACC.1/TRM                  (FDP_ACF.1)                FDP_ACF.1/TRM
                               (FDP_ACC.1) and
FDP_ACF.1/TRM                                             FDP_ACC.1/TRM
                               (FMT_MSA.3)
FDP_RIP.1                      No Dependencies
FDP_ACC.1/POLY                 (FDP_ACF.1)                FDP_ACF.1/POLY
                               (FDP_ACC.1) and
FDP_ACF.1/POLY                                            FDP_ACC.1/POLY
                               (FMT_MSA.3)
FDP_RIP.1/POLY                 No Dependencies
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UCT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UIT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
FTP_ITC.1/PACE                 No Dependencies
FAU_SAS.1                      No Dependencies
FMT_SMF.1                      No Dependencies
                                                          FIA_UID.1/PACE,
FMT_SMR.1/PACE                 (FIA_UID.1)
                                                          FIA_UID.1/PACE_CAM
                          Security Target Lite
                                                                    Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                               Page: 120/150
                         eMRTD Configuration)

FMT_LIM.1                     (FMT_LIM.2)               FMT_LIM.2
FMT_LIM.2                     (FMT_LIM.1)               FMT_LIM.1
FMT_SMR.1/POLY                (FIA_UID.1)               FIA_UID.1/POLY
FMT_LIM.1/POLY                (FMT_LIM.2)               FMT_LIM.2/POLY
FMT_LIM.2/POLY                (FMT_LIM.1)               FMT_LIM.1/POLY
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_ENA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_DIS
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/PA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_INI
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_UPD
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/DATE
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/AAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
F                             MT_MTD.1/KEY_READ
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                                                        FMT_MTD.1/CVCA_INI,
FMT_MTD.3                     (FMT_MTD.1)
                                                        FMT_MTD.1/CVCA_UPD
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/Initialize_PIN
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Change_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Unblock_PIN         (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Resume_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Load      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Read      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FPT_EMS.1                     No Dependencies
FPT_FLS.1                     No Dependencies
FPT_TST.1                     No Dependencies
FPT_PHP.3                     No Dependencies
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/DH_PACE             FCS_COP.1) and            FCS_COP.1/PACE_ENC,
                              (FCS_CKM.4)               FCS_COP.1/PACE_MAC
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/CA                  FCS_COP.1) and            FCS_COP.1/CA_ENC,
                              (FCS_CKM.4)               FCS_COP.1/CA_MAC
                              (FCS_CKM.2 or
                                                        FCS_CKM.4,
FCS_CKM.1/POLY                FCS_COP.1) and
                              (FCS_CKM.4)               FCS_COP.1/POLY
                              (FCS_CKM.1 or FDP_ITC.1
FCS_CKM.4                                               FCS_CKM.1/DH_PACE
                              or FDP_ITC.2)
FCS_COP.1/PACE_ENC            (FCS_CKM.1 or FDP_ITC.1   FCS_CKM.1/DH_PACE,
                          Security Target Lite
                                                                      Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                 Page: 121/150
                         eMRTD Configuration)

                                or FDP_ITC.2) and         FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/DH_PACE,
FCS_COP.1/PACE_MAC              or FDP_ITC.2) and
                                                          FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_ENC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_VER               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_GEN               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_MAC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
FCS_COP.1/POLY                  (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/POLY,
                                or FDP_ITC.2) and
                                (FCS_CKM.4)               FCS_CKM.4
FCS_RND.1                       No Dependencies
FPR_ANO.1                       No Dependencies
FPR_UNL.1                       No Dependencies

                          Table 8 SFRs Dependencies


6.3.3.1.1 Rationale for the exclusion of Dependencies


The dependency FMT_MSA.3 of FDP_ACF.1/TRM is discarded. The access
  control TSF according to FDP_ACF.1/TRM uses security attributes which are
  defined during the personalisation and are fixed over the whole life time of the
  TOE. No management of these security attribute (i.e. SFR FMT_MSA.1 and
  FMT_MSA.3) is necessary here.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 122/150
                        eMRTD Configuration)

6.3.3.2 SARs Dependencies
Requirements     CC Dependencies                          Satisfied Dependencies
ADV_ARC.1       (ADV_FSP.1) and (ADV_TDS.1)               ADV_FSP.5, ADV_TDS.4
ADV_FSP.5       (ADV_IMP.1) and (ADV_TDS.1)               ADV_IMP.1, ADV_TDS.4
ADV_IMP.1       (ADV_TDS.3) and (ALC_TAT.1)               ADV_TDS.4, ALC_TAT.2
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
ADV_INT.2
                (ALC_TAT.1)                               ALC_TAT.2
ADV_TDS.4       (ADV_FSP.5)                               ADV_FSP.5
AGD_OPE.1       (ADV_FSP.1)                               ADV_FSP.5
AGD_PRE.1       No Dependencies
                (ALC_CMS.1) and (ALC_DVS.1) and           ALC_CMS.5, ALC_DVS.2,
ALC_CMC.4
                (ALC_LCD.1)                               ALC_LCD.1
ALC_CMS.5       No Dependencies
ALC_DEL.1       No Dependencies
ALC_DVS.2       No Dependencies
ALC_LCD.1       No Dependencies
ALC_TAT.2       (ADV_IMP.1)                               ADV_IMP.1
                (ASE_ECD.1) and (ASE_INT.1) and           ASE_ECD.1, ASE_INT.1,
ASE_CCL.1
                (ASE_REQ.1)                               ASE_REQ.2
ASE_ECD.1       No Dependencies
ASE_INT.1       No Dependencies
ASE_OBJ.2       (ASE_SPD.1)                               ASE_SPD.1
ASE_REQ.2       (ASE_ECD.1) and (ASE_OBJ.2)               ASE_ECD.1, ASE_OBJ.2
ASE_SPD.1       No Dependencies
                (ADV_FSP.1) and (ASE_INT.1) and           ADV_FSP.5, ASE_INT.1,
ASE_TSS.1
                (ASE_REQ.1)                               ASE_REQ.2
ATE_COV.2       (ADV_FSP.2) and (ATE_FUN.1)               ADV_FSP.5, ATE_FUN.1
                (ADV_ARC.1) and (ADV_TDS.4) and           ADV_ARC.1, ADV_TDS.4,
ATE_DPT.3
                (ATE_FUN.1)                               ATE_FUN.1
ATE_FUN.1       (ATE_COV.1)                               ATE_COV.2
                (ADV_FSP.2) and (AGD_OPE.1) and           ADV_FSP.5, AGD_OPE.1,
ATE_IND.2       (AGD_PRE.1) and (ATE_COV.1) and           AGD_PRE.1, ATE_COV.2,
                (ATE_FUN.1)                               ATE_FUN.1
                (ADV_ARC.1) and (ADV_FSP.4) and           ADV_ARC.1, ADV_FSP.5,
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
AVA_VAN.5
                (AGD_OPE.1) and (AGD_PRE.1) and           AGD_OPE.1, AGD_PRE.1,
                (ATE_DPT.1)                               ATE_DPT.3

                           Table 9 SARs Dependencies


6.3.4 Rationale for the Security Assurance Requirements
The EAL5 was chosen to permits a developer to gain maximum assurance from
positive security engineering based upon rigorous commercial development
practices supported by moderate application of specialist security engineering
techniques. Such a TOE will probably be designed and developed with the intent
of achieving EAL5 assurance. It is likely that the additional costs attributable to
the EAL5 requirements, relative to rigorous development without the application
of specialised techniques, will not be large.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 123/150
                       eMRTD Configuration)

6.3.5 AVA_VAN.5 Advanced methodical vulnerability analysis
The selection of the component AVA_VAN.5 provides the assurance that the TOE
is shown to be highly resistant to penetration attacks to meet the security
objectives OT.Prot_Inf_Leak, OT.Prot_Phys-Tamper and OT.Prot_Malfunction.

6.3.6 ALC_DVS.2 Sufficiency of security measures
The selection of the component ALC_DVS.2 provides a higher assurance of the
secu-rity of the MRTD's development and manufacturing especially for the secure
handling of the MRTD's material.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 124/150
                       eMRTD Configuration)


7 TOE Summary Specification

7.1 TOE Summary Specification
This section provides a description of the security functions and assurance
measures of the TOE that meet the TOE security requirements.

The TOE provides security features (SF) which can be associated to following
groups:
  Identification and Authentication mechanisms
  Cryptographic functions support
  Access control /Storage and protection of logical travel document data
  Secure messaging
  Security and Life-cycle management
Moreover, the TOE will protect itself against interference, logical tampering and
bypass. The security functionality of the TOE respectively the IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration) applet
will be externally available to the user by APDU commands according to the
access conditions specified by the according policies considering the life cycle
state, user role and security state.

7.1.1 SF.IA Identification and Authentication
The different authentication mechanisms are supported by APDU commands and
parameters using the cryptographic functions provided by the platform. The
authentication mechanisms are enforced by protocols and APDU methods as
specified in the functional specification.

Note that Symmetric Basic Access Control (BAC) Authentication Mechanism is
supported by the TOE but not covered by this Security Target.

The TOE supports the following authentication mechanisms:
        SF.IA.1: Password Authenticated Connection Establishment (PACE)
        SF.IA.2: EAC Chip Authentication v. 1
        SF.IA.3: EAC Terminal Authentication Protocol v.1
        SF.IA.4: Authentication of the Personalization Agent with a
         personalisation key set based on a symmetric authentication
         mechanism
        SF.IA.5: ICAO Active Authentication
        SF.IA.6: Optionally PACE with additional Chip Authentication Mapping
         (PACE CAM)
        SF.IA.7: Polymorphic Authentication (PMA)
        SF.IA.8: Polymorphic eMRTD Document Holder Verification
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 125/150
                       eMRTD Configuration)

7.1.2 SF.CF Cryptographic functions support
Cryptographic function support is provided by the underlying NXP JCOP 3 P60,
i.e. the TOE relies on the underlying platform for performing its required
cryptographic operations.

SF.CF Cryptographic functions include:
        SF.CF.1: 3DES and AES cipher operations for secure messaging
        SF.CF.2: Digest calculations (SHA-1, SHA-224, SHA-256, SHA-384 and
         SHA-512)
        SF.CF.3: Signature generation (ECDSA, RSA)
        SF.CF.4: Signature verification (ECDSA, RSA)
        SF.CF.5: Diffie-Hellman Key Agreement (ECDH and DH)
        SF.CF.6: Key Generation (PACE ECDH/DH ephemeral keys and secure
         messaging MAC and ENC session keys)
        SF.CF.7: Key and secret authentication data Destruction
        SF.CF.8: True Random Number generation
        SF.CF.9: Randomization of PI/PP/CPI data as part of the Polymorphic
         Authentication protocol (PMA)




7.1.3 SF.ILTB Protection against interference, logical tampering
and bypass

SF.ILTB.1
  Protection against interference, logical tampering and bypass
  Security domains are supported by the Java Card platform used by the TOE
  underlying NXP JCOP 3 P60. The NXP JCOP 3 P60 provides protection against
  physical attack and performs self-tests as described in [PLTF-ST].
  The platform protects the TOE against malfunctions that are caused by
  exposure to operating conditions that may cause a malfunction. This includes
  hardware resets and operation outside the specified norms.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet uses transient memory where a hardware reset
  always reverts the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet into an unauthenticated
  state.
                         Security Target Lite
                                                                        Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 126/150
                        eMRTD Configuration)

7.1.4 SF.AC Access control / Storage and protection of logical
travel document data

SF.AC.1
  Access control / Storage and protection of logical travel document
  data
  The TOE provided access control, storage and protection of logical travel
  document data including access control to MRTD data. The TOE implements
  the subjects, objects, security attributes and rules according to the security
  attribute based access control. Access control is enforced by the APDU
  methods as specified in the interface defined in the functional specification.

7.1.5 SF.SM Secure Messaging

SF.SM.1
  Secure Messaging
  Secure messaging MAC and ENC operations are performed by the TOE’s
  platform.
  Secure messaging in ENC_MAC mode is established during PACE or re-
  established during Chip Authentication v1 and is based on SF.CF.1, 5, 6 and 8.

SF.SM.2
  Secure Messaging – Re-authentication
  The Retail MAC for 3DES and CMAC for AES are part of every APDU
  command/response when secure messaging is active after a successful PACE
  or Chip Authentication has been accomplished. Re-authentication after reset of
  the SM protocol is assured by accepting only valid (mandatory) MAC or CMAC
  cryptograms.

7.1.6 SF.LCM Security and life cycle management

SF.LCM.1
  Management of phases and roles
  For the TOE the following life-cycle phases have been identified:
      1. Manufacturing phase
      2. Personalisation phase
      3. Operational phase
      4. Termination phase
  Each life-cycle phase (or state) has its typical user acting as role holder.
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 127/150
                       eMRTD Configuration)

Life-cycle phase           Role
Manufacturing phase        IC Manufacturer
                           MRTD Manufacturer Platform initialisation)
                           MRTD Manufacturer (Pre-personalisation)
Personalisation phase      Personalisation Agent
                           Basic or Extended Inspection system
Operational phase          Polymorphic Authentication System
                           Polymorphic eMRTD document holder
Terminated phase           None

  All role holders in Manufacturing, Pre-Personalisation and Personalisation
  phases are identified by cryptographic authentication keys. In Operational
  phase the PACE password is required to authenticate the Basic or Extended
  Inspection System in order to get access to the non-sensitive ICAO LDS
  datagroups.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet maintains the internal life-cycle state the
  moment that the applet is installed. This state, together with the access
  control mechanisms force the Terminal into a specific role, for the pre-
  personalisation and subsequent, personalisation and operational phases. The
  phases (and corresponding life-cycle states) are controlled by APDU
  commands.



SF.LCM.2
  Life Cycle states of the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet
  The TOE supports the following life-cycle states:
      1. Not instantiated (applet resides in ROM or in EEPROM)
      2. PRE-PERSONALISATION state
      3. PERSONALISATION state
      4. OPERATIONAL state
      5. TERMINATED state (irreversibly)
  Each Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACE_CAM             No Dependencies
FIA_UID.1/POLY                 No Dependencies
FIA_UAU.1/POLY                 (FIA_UID.1)                FIA_UID.1/POLY
FIA_UAU.4/POLY                 No Dependencies
FIA_UAU.5/POLY                 No Dependencies
FIA_UAU.6/POLY                 No Dependencies
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_READ
                               (FMT_SMR.1)                FMT_SMR.1/PACE
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_WRITE
                               (FMT_SMR.1)                FMT_SMR.1/PACE
FIA_API.1/CA                   No Dependencies
FIA_API.1/AA                   No Dependencies
FDP_ACC.1/TRM                  (FDP_ACF.1)                FDP_ACF.1/TRM
                               (FDP_ACC.1) and
FDP_ACF.1/TRM                                             FDP_ACC.1/TRM
                               (FMT_MSA.3)
FDP_RIP.1                      No Dependencies
FDP_ACC.1/POLY                 (FDP_ACF.1)                FDP_ACF.1/POLY
                               (FDP_ACC.1) and
FDP_ACF.1/POLY                                            FDP_ACC.1/POLY
                               (FMT_MSA.3)
FDP_RIP.1/POLY                 No Dependencies
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UCT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UIT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
FTP_ITC.1/PACE                 No Dependencies
FAU_SAS.1                      No Dependencies
FMT_SMF.1                      No Dependencies
                                                          FIA_UID.1/PACE,
FMT_SMR.1/PACE                 (FIA_UID.1)
                                                          FIA_UID.1/PACE_CAM
                          Security Target Lite
                                                                    Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                               Page: 120/150
                         eMRTD Configuration)

FMT_LIM.1                     (FMT_LIM.2)               FMT_LIM.2
FMT_LIM.2                     (FMT_LIM.1)               FMT_LIM.1
FMT_SMR.1/POLY                (FIA_UID.1)               FIA_UID.1/POLY
FMT_LIM.1/POLY                (FMT_LIM.2)               FMT_LIM.2/POLY
FMT_LIM.2/POLY                (FMT_LIM.1)               FMT_LIM.1/POLY
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_ENA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_DIS
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/PA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_INI
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_UPD
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/DATE
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/AAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
F                          MT_MTD.1/KEY_READ
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                                                        FMT_MTD.1/CVCA_INI,
FMT_MTD.3                     (FMT_MTD.1)
                                                        FMT_MTD.1/CVCA_UPD
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/Initialize_PIN
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Change_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Unblock_PIN         (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Resume_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Load      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Read      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FPT_EMS.1                     No Dependencies
FPT_FLS.1                     No Dependencies
FPT_TST.1                     No Dependencies
FPT_PHP.3                     No Dependencies
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/DH_PACE             FCS_COP.1) and            FCS_COP.1/PACE_ENC,
                              (FCS_CKM.4)               FCS_COP.1/PACE_MAC
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/CA                  FCS_COP.1) and            FCS_COP.1/CA_ENC,
                              (FCS_CKM.4)               FCS_COP.1/CA_MAC
                              (FCS_CKM.2 or
                                                        FCS_CKM.4,
FCS_CKM.1/POLY                FCS_COP.1) and
                              (FCS_CKM.4)               FCS_COP.1/POLY
                              (FCS_CKM.1 or FDP_ITC.1
FCS_CKM.4                                               FCS_CKM.1/DH_PACE
                              or FDP_ITC.2)
FCS_COP.1/PACE_ENC            (FCS_CKM.1 or FDP_ITC.1   FCS_CKM.1/DH_PACE,
                          Security Target Lite
                                                                      Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                 Page: 121/150
                         eMRTD Configuration)

                                or FDP_ITC.2) and         FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/DH_PACE,
FCS_COP.1/PACE_MAC              or FDP_ITC.2) and
                                                          FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_ENC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_VER               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_GEN               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_MAC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
FCS_COP.1/POLY                  (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/POLY,
                                or FDP_ITC.2) and
                                (FCS_CKM.4)               FCS_CKM.4
FCS_RND.1                       No Dependencies
FPR_ANO.1                       No Dependencies
FPR_UNL.1                       No Dependencies

                          Table 8 SFRs Dependencies


6.3.3.1.1 Rationale for the exclusion of Dependencies


The dependency FMT_MSA.3 of FDP_ACF.1/TRM is discarded. The access
  control TSF according to FDP_ACF.1/TRM uses security attributes which are
  defined during the personalisation and are fixed over the whole life time of the
  TOE. No management of these security attribute (i.e. SFR FMT_MSA.1 and
  FMT_MSA.3) is necessary here.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 122/150
                        eMRTD Configuration)

6.3.3.2 SARs Dependencies
Requirements     CC Dependencies                          Satisfied Dependencies
ADV_ARC.1       (ADV_FSP.1) and (ADV_TDS.1)               ADV_FSP.5, ADV_TDS.4
ADV_FSP.5       (ADV_IMP.1) and (ADV_TDS.1)               ADV_IMP.1, ADV_TDS.4
ADV_IMP.1       (ADV_TDS.3) and (ALC_TAT.1)               ADV_TDS.4, ALC_TAT.2
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
ADV_INT.2
                (ALC_TAT.1)                               ALC_TAT.2
ADV_TDS.4       (ADV_FSP.5)                               ADV_FSP.5
AGD_OPE.1       (ADV_FSP.1)                               ADV_FSP.5
AGD_PRE.1       No Dependencies
                (ALC_CMS.1) and (ALC_DVS.1) and           ALC_CMS.5, ALC_DVS.2,
ALC_CMC.4
                (ALC_LCD.1)                               ALC_LCD.1
ALC_CMS.5       No Dependencies
ALC_DEL.1       No Dependencies
ALC_DVS.2       No Dependencies
ALC_LCD.1       No Dependencies
ALC_TAT.2       (ADV_IMP.1)                               ADV_IMP.1
                (ASE_ECD.1) and (ASE_INT.1) and           ASE_ECD.1, ASE_INT.1,
ASE_CCL.1
                (ASE_REQ.1)                               ASE_REQ.2
ASE_ECD.1       No Dependencies
ASE_INT.1       No Dependencies
ASE_OBJ.2       (ASE_SPD.1)                               ASE_SPD.1
ASE_REQ.2       (ASE_ECD.1) and (ASE_OBJ.2)               ASE_ECD.1, ASE_OBJ.2
ASE_SPD.1       No Dependencies
                (ADV_FSP.1) and (ASE_INT.1) and           ADV_FSP.5, ASE_INT.1,
ASE_TSS.1
                (ASE_REQ.1)                               ASE_REQ.2
ATE_COV.2       (ADV_FSP.2) and (ATE_FUN.1)               ADV_FSP.5, ATE_FUN.1
                (ADV_ARC.1) and (ADV_TDS.4) and           ADV_ARC.1, ADV_TDS.4,
ATE_DPT.3
                (ATE_FUN.1)                               ATE_FUN.1
ATE_FUN.1       (ATE_COV.1)                               ATE_COV.2
                (ADV_FSP.2) and (AGD_OPE.1) and           ADV_FSP.5, AGD_OPE.1,
ATE_IND.2       (AGD_PRE.1) and (ATE_COV.1) and           AGD_PRE.1, ATE_COV.2,
                (ATE_FUN.1)                               ATE_FUN.1
                (ADV_ARC.1) and (ADV_FSP.4) and           ADV_ARC.1, ADV_FSP.5,
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
AVA_VAN.5
                (AGD_OPE.1) and (AGD_PRE.1) and           AGD_OPE.1, AGD_PRE.1,
                (ATE_DPT.1)                               ATE_DPT.3

                           Table 9 SARs Dependencies


6.3.4 Rationale for the Security Assurance Requirements
The EAL5 was chosen to permits a developer to gain maximum assurance from
positive security engineering based upon rigorous commercial development
practices supported by moderate application of specialist security engineering
techniques. Such a TOE will probably be designed and developed with the intent
of achieving EAL5 assurance. It is likely that the additional costs attributable to
the EAL5 requirements, relative to rigorous development without the application
of specialised techniques, will not be large.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 123/150
                       eMRTD Configuration)

6.3.5 AVA_VAN.5 Advanced methodical vulnerability analysis
The selection of the component AVA_VAN.5 provides the assurance that the TOE
is shown to be highly resistant to penetration attacks to meet the security
objectives OT.Prot_Inf_Leak, OT.Prot_Phys-Tamper and OT.Prot_Malfunction.

6.3.6 ALC_DVS.2 Sufficiency of security measures
The selection of the component ALC_DVS.2 provides a higher assurance of the
secu-rity of the MRTD's development and manufacturing especially for the secure
handling of the MRTD's material.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 124/150
                       eMRTD Configuration)


7 TOE Summary Specification

7.1 TOE Summary Specification
This section provides a description of the security functions and assurance
measures of the TOE that meet the TOE security requirements.

The TOE provides security features (SF) which can be associated to following
groups:
  Identification and Authentication mechanisms
  Cryptographic functions support
  Access control /Storage and protection of logical travel document data
  Secure messaging
  Security and Life-cycle management
Moreover, the TOE will protect itself against interference, logical tampering and
bypass. The security functionality of the TOE respectively the IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration) applet
will be externally available to the user by APDU commands according to the
access conditions specified by the according policies considering the life cycle
state, user role and security state.

7.1.1 SF.IA Identification and Authentication
The different authentication mechanisms are supported by APDU commands and
parameters using the cryptographic functions provided by the platform. The
authentication mechanisms are enforced by protocols and APDU methods as
specified in the functional specification.

Note that Symmetric Basic Access Control (BAC) Authentication Mechanism is
supported by the TOE but not covered by this Security Target.

The TOE supports the following authentication mechanisms:
        SF.IA.1: Password Authenticated Connection Establishment (PACE)
        SF.IA.2: EAC Chip Authentication v. 1
        SF.IA.3: EAC Terminal Authentication Protocol v.1
        SF.IA.4: Authentication of the Personalization Agent with a
         personalisation key set based on a symmetric authentication
         mechanism
        SF.IA.5: ICAO Active Authentication
        SF.IA.6: Optionally PACE with additional Chip Authentication Mapping
         (PACE CAM)
        SF.IA.7: Polymorphic Authentication (PMA)
        SF.IA.8: Polymorphic eMRTD Document Holder Verification
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 125/150
                       eMRTD Configuration)

7.1.2 SF.CF Cryptographic functions support
Cryptographic function support is provided by the underlying NXP JCOP 3 P60,
i.e. the TOE relies on the underlying platform for performing its required
cryptographic operations.

SF.CF Cryptographic functions include:
        SF.CF.1: 3DES and AES cipher operations for secure messaging
        SF.CF.2: Digest calculations (SHA-1, SHA-224, SHA-256, SHA-384 and
         SHA-512)
        SF.CF.3: Signature generation (ECDSA, RSA)
        SF.CF.4: Signature verification (ECDSA, RSA)
        SF.CF.5: Diffie-Hellman Key Agreement (ECDH and DH)
        SF.CF.6: Key Generation (PACE ECDH/DH ephemeral keys and secure
         messaging MAC and ENC session keys)
        SF.CF.7: Key and secret authentication data Destruction
        SF.CF.8: True Random Number generation
        SF.CF.9: Randomization of PI/PP/CPI data as part of the Polymorphic
         Authentication protocol (PMA)




7.1.3 SF.ILTB Protection against interference, logical tampering
and bypass

SF.ILTB.1
  Protection against interference, logical tampering and bypass
  Security domains are supported by the Java Card platform used by the TOE
  underlying NXP JCOP 3 P60. The NXP JCOP 3 P60 provides protection against
  physical attack and performs self-tests as described in [PLTF-ST].
  The platform protects the TOE against malfunctions that are caused by
  exposure to operating conditions that may cause a malfunction. This includes
  hardware resets and operation outside the specified norms.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet uses transient memory where a hardware reset
  always reverts the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet into an unauthenticated
  state.
                         Security Target Lite
                                                                        Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 126/150
                        eMRTD Configuration)

7.1.4 SF.AC Access control / Storage and protection of logical
travel document data

SF.AC.1
  Access control / Storage and protection of logical travel document
  data
  The TOE provided access control, storage and protection of logical travel
  document data including access control to MRTD data. The TOE implements
  the subjects, objects, security attributes and rules according to the security
  attribute based access control. Access control is enforced by the APDU
  methods as specified in the interface defined in the functional specification.

7.1.5 SF.SM Secure Messaging

SF.SM.1
  Secure Messaging
  Secure messaging MAC and ENC operations are performed by the TOE’s
  platform.
  Secure messaging in ENC_MAC mode is established during PACE or re-
  established during Chip Authentication v1 and is based on SF.CF.1, 5, 6 and 8.

SF.SM.2
  Secure Messaging – Re-authentication
  The Retail MAC for 3DES and CMAC for AES are part of every APDU
  command/response when secure messaging is active after a successful PACE
  or Chip Authentication has been accomplished. Re-authentication after reset of
  the SM protocol is assured by accepting only valid (mandatory) MAC or CMAC
  cryptograms.

7.1.6 SF.LCM Security and life cycle management

SF.LCM.1
  Management of phases and roles
  For the TOE the following life-cycle phases have been identified:
      1. Manufacturing phase
      2. Personalisation phase
      3. Operational phase
      4. Termination phase
  Each life-cycle phase (or state) has its typical user acting as role holder.
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 127/150
                       eMRTD Configuration)

Life-cycle phase           Role
Manufacturing phase        IC Manufacturer
                           MRTD Manufacturer Platform initialisation)
                           MRTD Manufacturer (Pre-personalisation)
Personalisation phase      Personalisation Agent
                           Basic or Extended Inspection system
Operational phase          Polymorphic Authentication System
                           Polymorphic eMRTD document holder
Terminated phase           None

  All role holders in Manufacturing, Pre-Personalisation and Personalisation
  phases are identified by cryptographic authentication keys. In Operational
  phase the PACE password is required to authenticate the Basic or Extended
  Inspection System in order to get access to the non-sensitive ICAO LDS
  datagroups.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet maintains the internal life-cycle state the
  moment that the applet is installed. This state, together with the access
  control mechanisms force the Terminal into a specific role, for the pre-
  personalisation and subsequent, personalisation and operational phases. The
  phases (and corresponding life-cycle states) are controlled by APDU
  commands.



SF.LCM.2
  Life Cycle states of the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet
  The TOE supports the following life-cycle states:
      1. Not instantiated (applet resides in ROM or in EEPROM)
      2. PRE-PERSONALISATION state
      3. PERSONALISATION state
      4. OPERATIONAL state
      5. TERMINATED state (irreversibly)
  Each life-cycle phase (or state) has its typical user acting as role holder.
                          Security Target Lite
                                                                     Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                Page: 128/150
                         eMRTD Configuration)

                     Life-cycle state (maintained
Life-cycle phase                                    Role
                     by applet)
Manufacturing        - (Applet not instantiated)    IC Manufacturer
phase                                               MRTD Manufacturer Platform
                     - (Applet not instantiated)
                                                    initialisation)
                                                    MRTD Manufacturer (Pre-
                     PRE-PERSONALISATION
                                                    personalisation)
Personalisation
                     PERSONALISATION                Personalisation Agent
phase
                                                    Basic or Extended
                                                    Inspection system
                                                    Polymorphic Authentication
Operational phase    OPERATIONAL
                                                    System
                                                    Polymorphic eMRTD
                                                    document holder
Terminated phase     TERMINATED                     None




SF.LCM.3
  Management of TSF-Data
  The TOE allows only in its PERSONALISATION life-cycle state TSF data to be
  written onto the TOE.
  In OPERATIONAL life-cycle state the management of TSF-Data can only be
  performed:
    After successful Terminal Authentication. Updating the Country Verifier
      Certification Authority Public Key and Certificate is restricted to the
      Country Verifier Certification Authority. Modifying the Current Date is
      restricted to the Country Verifier Certification Authority, the Document
      Verifier and the domestic Extended Inspection System.
    After verification of the user PIN or PUK by issuing a dedicated PIN change
      command (RRC).



SF.LCM.4
  Protection of test features
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet does not have any dedicated test features
  implemented.
  The test features of the NXP JCOP 3 P60 are protected by ways described in
  [PLTF-ST] and guidance documentation.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 129/150
                       eMRTD Configuration)

SF.LCM.5
  Protection of keys and PACE passwords
  In PRE-PERSONALISATION life-cycle state personalisation Agent Key Set is
  installed on the TOE’s platform and protected by the platform.
  In all TOE life-cycle states the Personalization Agent Key set (MAC, ENC, KEK),
  the PACE passwords (derived from MRZ, CAN, PIN or PUK), the Chip
  Authentication Private Key, the Active Authentication Private Key are protected
  from disclosure. The IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet only stores keys in Java
  Card specified Key structures, which are protected by NXP JCOP 3 P60.

SF.LCM.6
  IC Identification data
  During initialisation the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet is installed and initiated
  with the Pre-Personalisation Agent key and the IC Identification data. The
  INSTALL for INSTALL method of the NXP JCOP 3 P60 will be used to store the
  IC Identification data.

7.2 SFRs and TSS

7.2.1 SFRs and TSS - Rationale

7.2.1.1 TOE Summary Specification

7.2.1.1.1 SF.IA Identification and Authentication


SF.IA.1 The implementation of PACE contributes to:
     FIA_AFL.1/PACE, Authentication failure handling PACE authentication using
        non-blocking authorisation data. The TOE increases the reaction time of
        the TOE after an unsuccessful authentication attempt with a wrong
        PACE passwords.
     FIA_UID.1/PACE, Timing of identification. The TOE allows to carry out the
        PACE Protocol after successful user identification
     FIA_UAU.1/PACE, Timing of authentication. The TOE prevents reuse of
        authentication data related to the PACE protocol, i.e. according
        authentication mechanisms.
     FIA_UAU.4/PACE, Single-use authentication mechanisms - Single-use
        authentication of the Terminal by the T
                                    the hardware platform.
                                    The NXP N7021 provides the computing platform and cryptographic support by means of
                                    co-processors for the Crypto Library Cobalt on N7021 VA.
                                    The Crypto Library Cobalt on N7021 VA provides the security functionality described
                                    below in addition to the functionality described in the Hardware Security Target [13] for
                                    the hardware platform:
                                    The Crypto Library provides RSA, RSA key generation, RSA public key computation,
                                    ECDSA (ECC over GF(p)) signature generation and verification, ECDSA (ECC over
                                    GF(p)) key generation, ECDH (ECC Diffie-Hellmann) key-exchange, standard security
                                    level SHA-1, SHA-224, SHA-256, SHA-384 and SHA-512.




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                         3 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                              Security Target Lite



                           1.3.2 Life-Cycle
                                    The life cycle of the hardware platform as part of the TOE is described in section 1.4.4
                                    "Security During Development and Production" of the Hardware Security Target [13]. The
                                    delivery process or the hardware platform is independent from the Crypto Library Cobalt
                                    on N7021 VA.
                                    The Crypto Library Cobalt on N7021 VA is delivered in Phase 1 (for a definition of the
                                    Phases refer to Section 1.2.3 'TOE life cycle’ of the Protection Profile [5]) as a software
                                    package (a set of binary files) to the developers of Security IC Embedded Software. The
                                    Security IC Embedded Software may comprise in this case an operating system and/or
                                    other smart card software (applications). The Software developer can incorporate the
                                    Crypto Library into their product.
                                    The subsequent use of the Crypto Library Cobalt on N7021 VA by Security IC Embedded
                                    Software Developers is out of the control of the developer NXP Semiconductors; the
                                    integration of the Crypto Library Cobalt on N7021 VA into Security IC Embedded
                                    Software is not part of this evaluation.
                                    Security during Development and Production
                                    The development process of the Crypto Library Cobalt on N7021 VA is part of the
                                    evaluation. The access to the implementation documentation, test bench and the source
                                    code is restricted to the development team of the Crypto Library Cobalt on N7021 VA.
                                    The security measures installed within NXP, including a secure delivery process, ensure
                                    the integrity and quality of the delivered Crypto Library Cobalt on N7021 VA binary files.

                           1.3.3 Specific Issues of Hardware and the Common Criteria
                                    Regarding the Application Note 2 of the Protection Profile [5] the TOE provides additional
                                    functionality which is not covered in the Protection profile [5] and the Hardware Security
                                    Target [13]. This additional functionality is added using the policy “P.Add-CryptoLib-
                                    Func” (see Section 3.3 of this Security Target).

                              1.4 TOE Description
                                    The Target of Evaluation (TOE) consists of a hardware part and a software part:
                                    • The hardware part consists of the N7021 with IC Dedicated Software. The hardware
                                      part of the TOE includes dedicated guidance documentation.
                                    • The software part consists of the IC Dedicated Support Software “Crypto Library Cobalt
                                      on N7021 VA” which consists of a software library and associated documentation. The
                                      Crypto Library Cobalt on N7021 VA is an additional part that provides cryptographic
                                      functions that can be operated on the hardware platform as described in this Security
                                      Target.
                                    The hardware part of the TOE is not described in detail in this document. Details are
                                    included in the Hardware Security Target [13] and therefore this latter document will be
                                    cited wherever appropriate.
                                    The TOE components consist of all the TOE components listed in Table 1 of the
                                    Hardware Security Target [13] plus all TOE components listed in the table below:

Table 1. Components of the TOE that are additional to the Hardware Security Target
Type                                  Name                                                                                       Release   Form of Delivery
Package RSA Encryption / Decryption

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.                  © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                                      4 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                              Security Target Lite



Type                                  Name                                                                                       Release   Form of Delivery
Library                               RSA Library                                                                                2.0.8     SDK add-on installer via
                                                                                                                                           NXP DocStore
Document                              N7021 Crypto Library: User Manual - RSA [9]                                                1.4       PDF via NXP DocStore
Package RSA Key Generation
Library                               RSA Key Generation Library                                                                 2.0.8     SDK add-on installer via
                                                                                                                                           NXP DocStore
Document                              N7021 Crypto Library: User Manual - RSA Key                                                1.0       PDF via NXP DocStore
                                      Generation [10]
Package ECC over GF(p)
Library                               ECC Library                                                                                2.0.8     SDK add-on installer via
                                                                                                                                           NXP DocStore
Document                              N7021 Crypto Library: User Manual - ECC over GF(p) 1.2                                               PDF via NXP DocStore
                                      [11]
Package SHA
Library                               SHA Library                                                                                2.0.8     SDK add-on installer via
                                                                                                                                           NXP DocStore
Document                              N7021 Crypto Library: User Manual - SHA [8]                                                1.0       PDF via NXP DocStore
Document                              N7021 Crypto Library: User Manual - Hash Library [7] 1.0                                             PDF via NXP DocStore
Required for all packages
Library                               Asymmetric Utilities Library                                                               2.0.8     SDK add-on installer via
                                                                                                                                           NXP DocStore
Document                              N7021 Crypto Library: User Manual - UtilsAsym [12]                                         1.0       PDF via NXP DocStore
Document                              N7021 Crypto Library: User Guidance Manual -                                               1.8       PDF via NXP DocStore
                                      Crypto Library Cobalt on N7021 VA [6]

                                    The documentation can be downloaded by the customer from the NXP DocStore website
                                    after registration. Librߙs (object files, header files and linker scripts) are also made
                                    available to the customer via NXP DocStore, as part of a downloadable and installable
                                    SDK add-on.

                           1.4.1 Hardware Description
                                    The NXP N7021 hardware is described in section 1.4.3.1 “Hardware Description” of the
                                    Hardware Security Target [13]. The IC Dedicated Software delivered with the hardware
                                    platform is described in section 1.4.3.2 “Software Description” of the Hardware Security
                                    Target [13].
                                    As described in the Hardware Security Target [13], the N7021 hardware provides the
                                    customer with a configuration option to disable the PKCC coprocessor. When the PKCC
                                    is disabled using this option, it is no longer possible to make use of the packages 'RSA
                                    Encryption / Decryption', 'RSA Key Generation' and 'ECC over GF(p)' provided by this
                                    Crypto Library.

                           1.4.2 Software Description
                                    A Security IC Embedded Software developer may create Security IC Embedded
                                    Software to execute on the NXP N7021 hardware. This software is stored in arbitrary
Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.                   © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                                       5 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                    memory of the hardware and is not part of the TOE, with one exception: the Security
                                    IC Embedded Software may contain the “Crypto Library Cobalt on N7021 VA“ (or parts
                                           1
                                    thereof ) and this Crypto Library is part"of the TOE.
                                    RSA
                                    • The RSA algorithm can be used for encryption and decryption as well as for signature
                                      generation, signature verification, message encoding and signature encoding.
                                    • The RSA key generation can be used to generate RSA key pairs.
                                    • The RSA public key computation can be used to compute the public key that belongs to
                                      a given private CRT key.
                                    The TOE supports various key sizes for RSA up to a limit of 4096 bits.
                                    RSA functionality is not available in case the customer disabled the PKCC coprocessor
                                    as part of the hardware configuration. See the Hardware Security Target [13] for more
                                    information.
                                    ECDSA (ECC over GF(p))
                                    • The ECDSA (ECC over GF(p)) algorithm can be used for signature generation and
                                      signature verification.
                                    • The ECDSA (ECC over GF(p)) key generation algorithm can be used to generate ECC
                                      over GF(p) key pairs for ECDSA.
                                    • The ECDH (ECC Diffie-Hellman) key exchange algorithm can be used to establish
                                      cryptographic keys. It can be also used as secure point multiplication.
                                    The TOE supports various key sizes for ECC over GF(p) up to a limit of 640 bits for
                                    signature generation, key pair generation and key exchange. For signature verification
                                    the TOE supports key sizes up to a limit of 640 bits.
                                    Supported curves are any Weierstrass curves from size 128 bits to size 640 bits with co-
                                    factor equal 1.
                                    ECC functionality is not available in case the customer disabled the PKCC coprocessor
                                    as part of the hardware configuration. See the Hardware Security Target [13] for more
                                    information.
                                    SHA
                                    • The SHA-1, SHA-224, SHA-256, SHA-384 and SHA-512 algorithms can be used for
                                      different purposes such as computing hash values in the course of digital signature
                                      creation or key derivation.
                                    Resistance of cryptographic algorithms against attacks
                                    The cryptographic algorithms are designed taking into account the attacks described in
                                    JIL-ATT-SC: Attack Methods for Smartcards and Similar Devices [19].
                                    Further security functionality
                                    • The TOE includes internal security measures for residual information protection.
                                    Note that the TOE does not restrict access to the functions provided by the hardware:
                                    these functions are still directly accessible to the Security IC Embedded Software.


                                      1 These crypto functions are supplied as a library rather than as a monolithic program, and hence a user of
                                          the library may include only those functions that are actually required – it is not necessary to include all
                                          cryptographic functions of the library in every Security IC Embedded Software. For example, it is possible
                                          to omit the RSA or the ECC components. However, some dependencies exist; details are described in
                                          the User Guidance [6].
Crypto Library Cobalt on N7021 VA                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                            Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                            6 / 35
NXP Semiconductors                                                                                            Cr?ypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                           1.4.3 Documentation
                                    The documentation for the NXP N7021 hardware is listed in section 1.4.3.3
                                    “Documentation” of the Hardware Security Target [13].
                                    The Crypto Library has associated user manuals and one user guidance documentation
                                    (see [6]). The user manuals contain:
                                    • the specification of the functions provided by the Crypto Library,
                                    • details of the parameters and options required to call the Crypto Library by the Security
                                      IC Embedded Software
                                    and the user guidance document contains:
                                    • Guidelines on the secure usage of the Crypto Library, including the requirements on
                                      the environment (the Security IC Embedded Software calling the Crypto Library is
                                      considered to be part of the environment).

                           1.4.4 Interface of the TOE
                                    The interface to the NXP N7021 hardware is described in section 1.4.5 “Interface of the
                                    TOE” of the Hardware Security Target [13]. The use of this interface is not restricted by
                                    the use of the Crypto Library Cobalt on N7021 VA.
                                    The interface to the TOE additionally consists of software function calls, as detailed in
                                    the “User Manual” documents of the Crypto Library Cobalt on N7021 VA. The developer
                                    of the Security IC Embedded Software will link the required functionality of the Crypto
                                    Library Cobalt on N7021 VA into the Security IC Embedded Software as required for his
                                    Application.

                           1.4.5 Life Cycle and Delivery of the TOE
                                    The life cycle and delivery for the NXP N7021 hardware is described in section 1.4.4
                                    “Security during development and production” of the Hardware Security Target [13].
                                    The Crypto Library Cobalt on N7021 VA is delivered as part of Phase 1 (for a definition
                                    of the Phases refer to section ‘1.2.3 TOE life cycle’ of the Protection Profile [5]) to the
                                    Security IC Embedded Software developer. The Crypto Library Cobalt on N7021 VA
                                    may be delivered by e-mail or by Document Control (DocuControl or DocStore) or by
                                    delivering physical media such as compact disks by mail or courier. To protect the Crypto
                                    Library Cobalt on N7021 VA during the delivery process, the Crypto Library Cobalt
                                    on N7021 VA is encrypted and digitally signed. The Security IC Embedded Software
                                    developer then integrates the Crypto Library Cobalt on N7021 VA in the Security IC
                                    Embedded Software.

                           1.4.6 TOE Intended Usage
                                    Regarding to Phase 7 (for a definition of the Phases refer to section ‘1.2.3 TOE life
                                    cycle’ of the Protection Profile [5]), the combination of the hardware and the Security
                                    IC Embedded Software is used by the end-user. The method of use of the product in
                                    this phase depends on the application. The TOE is intended to be used in an unsecured
                                    environment, that is, the TOE does not rely on the Phase 7 environment to counter any
                                    threat.
                                    For details on the usage of the hardware platform refer to section 1.4.5 “TOE Intended
                                    Usage” in the Hardware Security Target [13].

Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        7 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                    The Crypto Library Cobalt on N7021 VA is intended to support the development of
                                    the Security IC Embedded Software since the cryptographic functions provided by
                                    the Crypto Library Cobalt on N7021 VA include countermeasures against the threats
                                    described in this Security Target. The used modules of the Crypto Library Cobalt on
                                    N7021 VA are linked to the other parts of the Security IC Embedded Software and they
                                    are implemented as an extention of the Security IC Dedicated Software in arbitrary
                                    memory of the hardware platform.

                           1.4.7 TOE User Environment
                                    The user environment for the Crypto Library Cobalt on N7021 VA is the Security IC
                                    Embedded Software, developed by customers of NXP, to run on the NXP N7021
                                    hardware.

                           1.4.8 General IT features of the TOE
                                    The general features of the NXP N7021 hardware are described in section 1.3 “TOE
                                    overview” of the Hardware Security Target [13]. These are supplemented for the TOE by
                                    the functions listed in Section 1.3.1 of this Security Target.




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        8 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



2         CC Conformance and Evaluation Assurance Level
                (                    The evaluation is based upon:
                                    • "Common Criteria for Information Technology Security Evaluation, Part 1: Introduction
                                      and general model, Version 3.1, Revision 5, April 2017, CCMB-2017-04-001" [1]
                                    • "Common Criteria for Information Technology Security Evaluation, Part 2: Security
                                      functional components, Version 3.1, Revision 5, April 2017, CCMB-2017-04-002" [2]
                                    • "Common Criteria for Information Technology Security Evaluation, Part 3: Security
                                      assurance components, Version 3.1, Revision 5, April 2017, CCMB-2017-04-003" [3]
                                    For the evaluation the following methodology will be used:
                                    • "Common Methodology for Information Technology Security Evaluation, Evaluation
                                      Methodology, Version 3.1, Revision 5, April 2017, CCMB-2017-04-004" [4]
                                    The chosen level of assurance is EAL6 + augmented.
                                    The augmentations to EAL6 are ASE_TSS.2 and ALC_FLR.1.
                                    This Security Target claims the following CC conformances:
                                    • CC 3.1 Part 2 extended, Part 3 conformant, EAL6 augmented
                                    • Strict Conformance to the Protection Profile [5]
                                    The assurance level for evaluation and the functionality of the TOE are chosen in order to
                                    allow the confirmation that the TOE is suitable for use within devices compliant with the
                                    German Digital Signature Law.
                                    Note 1. The hardware platform is evaluated according to the assurance level EAL 6
                                    augmented. The evaluation of the hardware platform is appropriate for the composite
                                    evaluation since both the EAL level and the augmentations claimed in this Security
                                    Target are identical to those claimed for the hardware platform (refer to the Hardware
                                    Security Target [13]).

                              2.1 Conformance claim rationale
                                    According to chapter 2 this Security Target claims strict conformance to the Protection
                                    Profile [5]. As shown in 1.3 the composed TOE consists of hardware (Secure Controller
                                    IC) and software (IC Dedicated Software). This is identical to the TOE as defined in [5]
                                    and therefore the TOE type is consistent.




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        9 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



3         Security Problem Definition

                              3.1 Description of Assets
                                    Since this Security Target claims strict conformance to a PP [5], the assets defined in
                                    section 3.1 of the Protection Profile apply to this Security Target. User Data and TSF
                                    data are defined as part of assets in [13]. Since the data computed by the Crypto Library
                                    contains keys, plain text and cipher text that are considered as User Data and e.g.
                                    blinding vectors that are considered as TSF data the assets are considered as complete
                                    for this Security Target.

                              3.2 Threats
                                    Since this Security Target claims strict conformance to the PP [5], the threats defined in
                                    section 3.2 of the Protection Profile, and which are described in section 3.2 “Threats” of
                                    the Hardware Security Target [13] are valid for this Security Target. No additional threats
                                    are defined for this Security Target.

                              3.3 Organizational Security Policies
                                    In addition to the security functionality provided by the hardware and defined in the
                                    hardware security target [13], the following additional security functionality is provided by
                                    the Crypto Library for use by the Security IC Embedded Software:
                                    P.Add-CryptoLib-Func: Additional Specific Security Functionality
                                    The TOE provides the following additional security functionality to the Security IC
                                    Embedded Software:
                                    • RSA encryption, decryption, signature generation, signature verification, message
                                      encoding and signature encoding.
                                    • RSA public key computation
                                    • RSA key generation,
                                    • ECDSA (ECC over GF(p)) signature generation and verification,
                                    • ECC over GF(p) key generation,
                                    • ECDH (ECC Diffie-Hellman) key exchange,
                                    • SHA-1, SHA-224, SHA-256, SHA-384 and SHA-512 Hash Algorithms.
                                    In addition, the TOE shall provide resistance against attacks as described in Note 4 and
                                    in Security architectural information.
                                    Regarding the Application Note 5 of the Protection Profile [5] there are no other additional
                                    policies defined in this Security Target.

                              3.4 Assumptions
                                    The assumptions are described in the Hardware Security Target [13]. No additional
                                    assumptions are defined for this Security Target.




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       10 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



4         Security Objectives
                                    This chapter contains the following sections: “Security Objectives for the TOE”, “Security
                                    Objectives for the Security IC Embedded Software”, “Security Objectives for the
                                    Operational Environment”, and “Security Objectives Rationale”.

                              4.1 Security Objectives for the TOE
                                    The security objectives for the TOE defined in the Protection Profile [5] and the Hardware
                                    Security Target [13] are entirely applied to this Security Target.
                                    The following additional security objectives for the Crypto Library are defined by this ST,
                                    and are provided by the software part of the TOE:
                                    O.RSA                                            The TOE includes functionality to provide encryption,
                                                                                     decryption, signature creation, signature verification,
                                                                                     message encoding and signature encoding using the
                                                                                     RSA algorithm, see Note 4.
                                    O.RSA_PubExp                                     The TOE includes functionality to compute an RSA
                                                                                     public key from an RSA private key, see Note 4.
                                    O.RSA_KeyGen                                     The TOE includes functionality to generate RSA key
                                                                                     pairs, see Note 4.
                                    O.ECDSA                                          The TOE includes functionality to provide signature
                                                                                     creation and signature verification using the ECC over
                                                                                     GF(p) algorithm, see Note 4.
                                    O.ECC_DHKE                                       The TOE includes functionality to provide Diffie-Hellman
                                                                                     key exchange based on ECC over GF(p), see Note 4.
                                    O.ECC_KeyGen                                     The TOE includes functionality to generate ECC over
                                                                                     GF(p) key pairs, see Note 4.
                                    O.SHA                                            The TOE includes functionality to provide electronic
                                                                                     hashing facilities using the SHA-1, SHA-224, SHA-256,
                                                                                     SHA-384 and SHA-512 algorithms.
                                    Note 4. All introduced security objectives claiming cryptographic functionality are
                                    protected against attacks as described in JIL-ATT-SC: Attack Methods for Smartcards
                                    and Similar Devices [19], which include Side Channel Attacks, Perturbation attacks,
                                    Differential Fault Analysis (DFA) and timing attacks. The following exceptions apply:
                                    1. RSA Public Key computation and RSA Key generation do not contain protective
                                       measures against DPA
                                    2. ECDSA (ECC over GF(p)) Key Generation does not contain protective measures
                                       against DPA
                                    3. SHA-1, SHA-224, SHA-256, SHA-384 and SHA-512 do not contain protective
                                       measures against DPA, DFA and timing attacks. It provides countermeasures against
                                       template attacks targeting the input message and the output digest.
                                    This does not mean that the algorithm is insecure; rather at the time of this security
                                    target no promising attacks were found. More details about conditions and restrictions for
                                    resistance against attacks are given in the user documentation of the Crypto Library.




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       11 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                              4.2 Security Objectives for the IC Embedded Software
                                    The security objectives for the Security IC Embedded Software defined in section 4.2 of
                                    the Protection Profile [5] and additional refinements in the Hardware Security Target [13]
                                    entirely apply to this Security Target.
                                    The TOE assumes that the Security IC Embedded Software abides by the provisions
                                    detailed in “Clarification of Treatment of user data of the Composite TOE (OE.Resp-
                                    Appl)” contained within section 4.2 “Security Objectives for the Security IC Embedded
                                    Software” of the Hardware Security Target [13].

                              4.3 Security Objectives for the Operational Environment
                                    The security objective for the “Security Objectives for the Operational environment”
                                    defined in the PP [5], and given in the Hardware Security Target [13] are entirely valid for
                                    this Security Target.

                              4.4 Security Objectives Rationale
                                    Section 4.4 of the Protection Profile [5] and Section 4.4 of the Hardware Security Target
                                    [13] provide a rationale how the threats, organisational security policies and assumptions
                                    are addressed by the objectives that are subject of the PP. They entirely apply to this
                                    Security Target. The justification for the additional security objectives for the Crypto
                                    Library on N7021 are listed in the table below:

Table 2. Additional Security Objectives versus threats, assumptions or policies for Crypto Library on Crypto
Library Cobalt on N7021 VA
Threat, Assumption/Policy                                                                 Security Objective
P.Add-CryptoLib-Func                                                                      O.RSA
                                                                                          O.RSA_PubExp
                                                                                          O.RSA_KeyGen
                                                                                          O.ECDSA
                              (                                                           O.ECC_DHKE
                                                                                          O.ECC_KeyGen
                                                                                          O.SHA

                                    They are in line with the security objectives of the Protection Profile and supplement
                                    these according to the additional assumptions and organisational security policy.
                                    The rationale for all item defined in the Security Target is given below.
                                    Since the objectives O.RSA, O.RSA_PubExp, O.RSA_KeyGen, O.ECDSA,
                                    O.ECC_DHKE, O.ECC_KeyGen and O.SHA require the TOE to implement exactly
                                    the same specific security functionality as required by P.Add-CryptoLib-Func, the
                                    organizational security policy P.Add-CryptoLib-Func is covered by the security objectives.
                                    Additionally, the security objectives O.Leak-Inherent, O.Phys-Probing, O.Malfunction,
                                    O.Phys-Manipulation and O.Leak-Forced define how to implement the specific security
                                    functionality required by P.Add-CryptoLib-Func and therefore support P.Add-CryptoLib-
                                    Func. These security objectives are also valid for the additional specific security
                                    functionality since they must also avert the related threats for the components added to
                                    the organisational security policy.
                                    The justification of the additional policy and the additional assumptions show that they
                                    do not contradict with the rationale already given in the Protection Profile [5] for the
                                    assumptions, policy and threats defined there.
Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       12 / 35
NXP Semiconductors                                                                                           Crypto Library Cobalt on N7021 VA
                                                                                                                               Security Target Lite



5         Extended Components Definition
                                    This Security Target does not define extended components.




Crypto Library Cobalt on N7021 VA                 All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                       Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                     13 / 35
NXP Semiconductors                                                                                              Crypto Library Cobalt on N7021 VA
                                                                                                                                                 Security Target Lite



6         Security Requirements

                              6.1 Security Functional Requirements
                                    To support a better understanding of the combination Protection Profile and Security
                                    Target of the hardware platform (N7021) vs. this Security Target (Crypto Library Cobalt
                                    on N7021 VA), the TOE SFRs are presented in the following sections.

                           6.1.1 SFRs from the Protection Profile and the Security Target of the platform
                                    The Security Functional Requirements (SFRs) for this TOE (Crypto Library Cobalt on
                                    N7021 VA) are specified based on the Smart Card IC Platform Protection Profile [5], and
                                    are defined in the Common Criteria [2] or in the Protection Profile [5]. They entirely apply
                                    to this Security Target.
                                    Note 5. These requirements have already been stated in the Hardware Security Target
                                    [13] and are fulfilled by the chip hardware, if not indicated otherwise in this Section.
                                    The additional SFRs shown in this Section are defined in the Common Criteria, described
             d FCS_CKM.4 ensures that the TOE provides procedural
                                       measures to prevent disclosure of memory contents that was used by the TOE. The
                                       Crypto Library supports FDP_RIP.1[SW] and FCS_CKM.4 by making all memory
                                       contents used by the library no longer available. Note that the requirement for
                                       residual information protection applies to all functionality of the Crypto Library.

                           6.3.2 Extended requirements
                                    This Security Target does not define extended requirements.

                           6.3.3 Dependencies of security requirements
                                    SFRs [FDP_ITC.1, or FDP_ITC.2 or FCS_CKM.1] are not included in this Security Target
                                    for FCS_COP.1/SHA since the TOE only provides a pure engine for these algorithms
                                    without additional features like the handling of keys or importing data from outside the
                                    TOE. Therefore the Security IC Embedded Software must fulfil these requirements
                                    related to the needs of the realized application.

                           6.3.4 Rationale for the Assurance Requirements
                                    The selection of assurance components and augmentations of Crypto Library on N7021
                                    is generally based on EAL6, the underlying Protection Profile [5], and the Security Taret
                                    of the hardware [13] of the N7021.
                                    EAL6 was chosen to provide an even stronger baseline of assurance than the EAL4 in
                                    the Protection Profile. The augmentations ALC_FLR.1 and ASE_TSS.2 were chosen to
                                    extend the level of assurance even further.




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      23 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



7         TOE Summary Specification
                                    This chapter describes the “IT Security Functionality”.

                              7.1 IT Security Functionality
                                    The evaluation of this cryptographic library is performed as a composite evaluation,
                                    where the TOE comprises both the underlying hardware and the embedded software
                                    (Crypto Library). The TOE of this composite evaluation therefore extends the security
                                    functionality already available in the chip platform (see section 7.1 “Portions of the TOE
                                    Security Functionality” of the Hardware Security [13]).
                                    The security functionality of N7021
                                    The security functionality of the hardware platform for the N7021 is described in the
                                    Hardware Security Target [13]. They entirely apply to this Security Target.
                                    Note 8. The security functionality SF.LOG is extended by the Crypto Library as described
                                    in Security Features of the TOE.


                                    The additional security functionality provided by the TOE is described in the following
                                    sub-sections.
                                    The IT security functionalities directly correspond to the TOE security functional
                                    requirements defined in Section 6.1. The definitions of the IT security functionalities refer
                                    to the corresponding security functional requirements.

                           7.1.1 Security Services of the TOE

                         7.1.1.1    SS.RSA

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for data encryption, decryption, signature and verification. All algorithms are
                                    defined in PKCS #1, v2.2 (RSAEP, RSADP, RSAP1, RSAVP1)
                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    The TOE contains modular exponentiation functions, which, together with other functions
                                    in the TOE, perform the operations required for RSA encryption or decryption. Two
                                    different RSA algorithms are supported by the TOE, namely the "Simple Straight Forward
                                    Method" (called RSA "straight forward", the key consists of the pair n and d) and RSA
                                    using the "Chinese Remainder Theorem" (RSA CRT, the key consists of the quintuple p,
                                    q, dp, dq, qInv).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA

                         7.1.1.2    SS.RSA_Pad

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for message and signature encoding. This IT security functionality supports the
                                    EME-OAEP and EMSA-PSS signature scheme. All algorithms are defined in PKCS #1,
                                    v2.2 (EME-OAEP, EMSA-PSS)

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       24 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PAD

                         7.1.1.3    SS.RSA_PublicExp

                                    The TOE provides functions that implement computation of an RSA public key from a
                                    private CRT key. All algorithms are defined in PKCS #1, v2.2.
                                    This routine supports various key lengths from 512 bits to 4096 bits (CRT).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PubExp

                         7.1.1.4 SS.ECDSA

                                    The TOE provides functions to perform ECDSA Signature Generation and Signature
                                    Verification according to ISO/IEC 14888-3:2015 [18], ANSI X9.62 [21], FIPS PUB 186-4
                                    [17] and IEEE Std 1363™-2000 [20]
                                    Note that hashing of the message must be done beforehand and is not provided by this
                                    security functionality, but could be provided by SS.SHA.
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECDSA supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                  e
                                                                                     non-volatile memory as service provided by the IC
                                                                                     Manufacturer or IC Packaging Manufacturer).
                                    Composite Product                                The Composite Product Manufacturer has the following
                                    Manufacturer                                     roles (i) the Security IC Embedded Software Developer
                                                                                     (Phase 1), (ii) the Composite Product Integrator (Phase
                                                                                     5) and (iii) the Personalizer (Phase 6). If the TOE is
                                                                                     delivered after Phase 3 in form of wafers or sawn
                                                                                     wafers (dice) he has the role of the IC Packaging
                                                                                     Manufacturer (Phase 4) in addition. The customer of the
                                                                                     TOE Manufacturer who receives the TOE during TOE
                                                                                     Delivery. The Composite Product Manufacturer includes
                                                                                     the Security IC Embedded Software developer and all
                                                                                     roles after TOE Delivery up to Phase 6 (refer to Figure 2
                                                                                     on page 10 and Section 7.1.1).
                                    End-consumer                                     User of the Composite Product in Phase 7.
                                    IC Dedicated Software                            IC proprietary software embedded in a Security IC
                                                                                     (also known as IC firmware) and developed by the IC
                                                                                     Developer. Such softwary of EF.CVCA, DG14 and EF.SOD. In order
to assure a sufficient level of privacy during authentication the CAv1 private key
and EF.SOD are shared amoung a sufficient high number of personalised
Polymorphic eMRTDs, i.e. the logical data structure does not contain any unique
identifiable data.



1.4.3 TOE life cycle
The TOE life cycle is described in terms of its four life cycle phases. (With respect
to the [SIC-PP], the TOE life-cycle is additionally subdivided into 7 steps in the
ST. These steps are denoted too in the following although the sequence of the
steps differs for the TOE life cycle).
                                  Security Target Lite
                                                                                                          Ref.:
                           IDeal Pass v2.3-n JC with Privacy
                                                                                                    2018_2000036361
                           Protection (SAC/EAC/Polymorphic
                                                                                                      Page: 18/150
                                 eMRTD Configuration)


               Phase 2 - Manufacturing                                                  Phase 1 - Development

                    IC Manufacturer                                                              IC Developer

                                                                   (1)
                                                                                               NXP P6022y VB


                            ROM


                                                                                             Software Developer

                       EEPROM                                      (1)                        NXP JCOP 3 SECID
                                                                                                P60 CS (OSB)

                                                                  (2a)                         IDeal Pass v2.3-n
                                                                                                JC With Privacy
                                                           Applet (ROM or EEPROM)                 Protection
                                                                                                   (Applet)
(3) Transport key                       (4) Chip modules
    + Authentication key
                                                                                             IDeal Pass v2.3-n JC
                  MRTD Manufacturer                                                          with Privacy Protection
                                                                                                    Guidance
                                                                  (2b)                           Documentation
                    Sample Authentication
                                                                   Applet (EEPROM)
                                                                   + AGD_PRE
                                                                   + AGD_OPE
                     Inlay Manufacturing




                           Initialization                                               Phase 3 - Personalization

                       Transport and                                                        Personalization Agent
                     Authentication Keys



                     Pre-Personalisation
                           Keys                                     (5)
                                                              Personalisation key set           Personalization
                                                              + eMRTD
                                                              + AGD_OPE
                     Pre-Personalisation                      + AGD_PRE

                    Personalisation Keys
                                                                                                         (6)
                                                                                                Personalised eMRTD
                                                                                                (ePassport) + AGD_OPE


                                                                                        Phase 4 - Operational use
                eMRTD Form Factors :
                - ID3 passport booklets,
                                                                                                MRTD Holder
                - ID1 cards or ID3 holder
                pages,
                - Antenna inlays,
                - Chip in modules on a                                                        (7) Operational use
                reel.




                                              Figure 2: TOE life-cycle
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 19/150
                        eMRTD Configuration)


Actors :
  IC Developer, IC Manufacturer          NXP
  Software Developer                     Platform: NXP
                                         ePassport applet: IDEMIA R&D sites
                                         (Osny, Meyreuil and Noida)
  Travel document manufacturer           IDEMIA plants (Haarlem and Noida)


1.4.3.1 Phase 1 “Development”
(Step1) The TOE is developed in phase 1. The IC developer develops the
integrated circuit, the IC Dedicated Software and the guidance documentation
associated with these TOE components.
The IC developer also acts as the developer of the embedded software (operating
system), which is the NXP JCOP 3 P60.

(Step2) The software developer uses the guidance documentation for the
integrated circuit and the guidance documentation for relevant parts of the NXP
JCOP 3 P60 and develops the ePassport application and the guidance
documentation associated with this TOE component.

The ePassport application (i.e. the IDeal Pass v2.3-n JC with Privacy Protection
(SAC/EAC/Polymorphic eMRTD Configuration) applet run time code) may be
integrated either in ROM or in EEPROM of the chip. Depending on the intention:
      (a) the ePassport application is securely delivered directly from the
          software developer (IDEMIA development dept.) to the IC manufacturer
          (NXP). The applet code will be integrated into the ROM mask code or
          inEEPROM by the IC manufacturer, or
      (b) the ePassport application is securely delivered directly from the
          software developer (IDEMIA development dept.) to the travel document
          manufacturer (IDEMIA production dept.) .) for loading in EEPROM.

Notice that the guidance documentation of the ePassport application is always
securely delivered directly from the software developer (IDEMIA development
dept.) to the travel document manufacturer (IDEMIA production dept.).


1.4.3.2 Phase 2 “Manufacturing”
(Step3) In a first step the TOE integrated circuit is produced containing the travel
document’s chip Dedicated Software, the parts of the travel document’s chip
Embedded Software and in case of alternative a) the ePassport application in
ROM or in EEPROM.

The IC manufacturer writes the IC Identification Data onto the chip to control the
IC as travel document material during the IC manufacturing and the delivery
process to the travel document manufacturer. The IC is securely delivered from
the IC manufacturer to the travel document manufacturer.
                            Security Target Lite
                                                                       Ref.:
                     IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                     Protection (SAC/EAC/Polymorphic
                                                                   Page: 20/150
                           eMRTD Configuration)

If necessary the IC manufacturer adds the parts of the IC Embedded Software in
the non-volatile programmable memories (for instance EEPROM).

(Step4 optional) The travel document manufacturer combines the IC with
hardware for the contact based / contactless interface in the travel document
unless the travel document consist of the chip only.

(Step5) The travel document manufacturer
  i.  adds the IC Embedded Software or part of it in the non-volatile
      programmable memories (for instance EEPROM) if necessary and in case
      of alternative (b), loads the ePassport application into the non-volatile
      programmable memories (for instance EEPROM),
 ii.      creates the ePassport application and
iii.      equips travel document’s chips with pre-personalization Data.

EAC PP Application Note 1: Creation of the application for this TOE implies
Applet instantiation.

For this Security Target the following name mappings to the protection profile
[EAC-PP-V2] apply:
    IC Dedicated SW = Low level IC libraries
    travel document’s chip Embedded Software = NXP JCOP 3 P60 operating
       system.
    ePassport application = IDeal Pass v2.3-n JC with Privacy Protection
       (SAC/EAC/Polymorphic eMRTD Configuration) Applet run time code or an
       instantiation of it.
    Pre-personalization Data = Personalization Agent Key Set, Card Production
       Life Cycle (CPLC) data and buffer settings.

Both the underlying platform and IDeal Pass v2.3-n JC with Privacy Protection
(SAC/EAC/Polymorphic eMRTD Configuration) Applet provide configuration and
life-cycle management functions required for TOE preparation. TOE preparation
steps are performed in manufacturing phase and consist of the following 2
activities:
    1. Platform initialisation
       2. Pre-personalisation

Platform initialisation
Platform initialisation consists of the configuration of the NXP JCOP 3 P60 in
accordance with requirements specified in the platform administrator guidance
[PLTF-PRE] by using the dedicated platform commands. Furthermore the Pre-
Personalisation Agent key set is installed and (a part of) the CPLC data is
updated. To prevent unattended tracing of the MRTD document, the NXP JCOP 3
P60 is configured such that unauthenticated access to any platform unique
idenfiable data is not possible.
                               Security Target Lite
                                                                                             Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                       2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                         Page: 21/150
                              eMRTD Configuration)

Pre-personalisation
The pre-personalisation consists of the following steps:
   a. IC (chip) Authentication and getting chip access with the pre-
      personalisation key set.
   b. [optional] In case the IDeal Pass v2.3-n JC with Privacy Protection
      (SAC/EAC/Polymorphic eMRTD Configuration) applet runtime code does
      not reside in ROM, it is loaded into EEPROM.
   c. Install the applet application instances depending on the desired TOE
      configuration specified in section 1.4.2, using IDeal Pass v2.3-n JC with
      Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration) applet.
   d. Set the ePassport (and if present) the Polymorphic eMRTD applet
      irreversibly in its PERSONALISATION life-cycle state by installation of the
      Personalisation Agent specific personalisation key set(s).

During step (c) the CPLC data with the IC Identifier as well as the other pre-
personalisation data is configured in the TOE. The last step (d) finalizes the TOE.
This is the moment the TOE starts to exist and is ready for delivery to the
Personalisation Agent. The guidance documentation for the Personalisation Agent
is [AGD_PRE].

The pre-personalised travel document together with the IC Identifier is securely
delivered from the travel document manufacturer to the Personalisation Agent.
The travel document manufacturer also provides the relevant parts of the
guidance documentation [AGD_PRE] and [AGD_OPE] and the Personalisation
Agent Key set to the Personalisation Agent. The following table describes the
physical delivery of the TOE components:

TOE component               Identification               Version     Package                    Delivery
                                                                                                method
IDeal Pass v2.3-n JC with   -     7126-9301-0311 for     v2.3.0.14   The package can be         Trusted courier
Privacy Protection                applet loaded in                   either of the following:
(SAC/EAC/Polymorphic              EEPROM                              -    Chip embedded in
eMRTD Configuration)        -     7126-9301-0319 for                       ID3 passport
                                  applet loaded in ROM                     booklets,
                                                                      -    Chip embedded in
                                                                           ID1 cards or ID3
                                                                           holder pages,
                                                                      -    Chip embedded in
                                                                           antenna inlays,
                                                                      -    Chip in modules
                                                                           on a reel.
[AGD_OPE]*                  2017_2000032685              2.1         Electronic document        PGP-encrypted
                                                                                                email
[AGD_PRE]*                  2017_2000032686              2.7         Electronic document        PGP-encrypted
                                                                                                email
Personalisation Agent       n.a                          n.a         Electronic file            PGP encrypted
Key set                                                                                         parts on USB or
                                                                                                CD media, off-
                                                                                                line registered
                                                                                                distribution by
                                                                                                trusted courier.
* : Distribution of guidance documents [AGD_PRE] and [AGD_OPE] is only managed by
the IDEMIA Haarlem manufacturing site.
                         Security Target Lite
                                                                     Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 22/150
                        eMRTD Configuration)

1.4.3.3 Phase 3 “Personalisation of the travel document”
(Step 6) The personalisation of the travel document includes
  i.  the survey of the MRTD holder’s biographical data,
 ii.   the enrolment of the MRTD holder biometric reference data (i.e. the
       digitized portraits and the optional biometric reference data),
iii.   the printing of the visual readable data onto the physical MRTD,
iv.    the writing of the TOE User Data and TSF Data into the logical MRTD and
 v.    configuration of the TSF if necessary.

The step (iv) is performed by the Personalisation Agent and includes but is not
limited to the creation of:
  i.   the digital MRZ data (EF.DG1),
 ii.   the digitized portrait (EF.DG2), and
iii.   the Document security object.

The signing of the Document security object by the Document signer [ICAO-
9303] finalizes the personalisation of the genuine travel document for the travel
document holder. The personalised travel document (together with appropriate
guidance (AGD_OPE) for TOE usage if necessary) is handed over to the travel
document holder for operational use.

The personalisation of Polymorphic eMRTD application instance includes:

 i.    establishing the identity of the polymorphic eMRTD document holder,
 ii.   Requesting the required Polymorphic eMRTD ID attributes from the central
       Key Management authority,
iii.   writing Polymorphic ID attributes, Polymorphic LDS data as defined in
       [PCA-eMRTD],
iv.    writing the TSF data (PIN, PUK, CAv1 private key) as defined in [PCA-
       eMRTD],
 v.    signing the Document Security Object defined in
       [ICAO-9303] (in the role of DS).


The signing of the Document security object by the Document signer [ICAO-
9303] finalizes the personalisation of the genuine Polymorphic eMRTD document
for the travel document holder. The personalised Polymorphic eMRTD document
(together with appropriate guidance (AGD_OPE) for TOE usage if necessary) is
handed over to the Polymorphic eMRTD document holder for operational use.


EAC PP Application note 2: The TSF data (data created by and for the TOE,
that might affect the operation of the TOE; cf. [CC-1] §92) comprise (but are not
                               Security Target Lite
                                                                                            Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                      2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                        Page: 23/150
                              eMRTD Configuration)

limited to) the Personalisation Agent Authentication Key(s), the Terminal
Authentication trust anchor, the effective date and the Chip Authentication
Private Key.

EAC PP Application note 3: This ST distinguishes between the Personalisation
Agent as entity known to the TOE and the Document Signer as entity in the TOE
IT environment signing the Document security object as described in [ICAO-
9303]. This approach allows but does not enforce the separation of these roles.


1.4.3.4 Phase 4 “Operational Use”
(Step 7) The TOE is used as a travel document's chip by the traveller and the
inspection systems in the “Operational Use” phase. The user data can be read
according to the security policy of the issuing State or Organisation and can be
used according to the security policy of the issuing State but they can never be
modified.

EAC PP Application note 42: The intention of the ST is to consider at least the
phases 1 and parts of phase 2 (i.e. Step1 to Step3) as part of the evaluation and
therefore to define the TOE delivery according to CC after this phase. Since
specific production steps of phase 2 are of minor security relevance (e.g. booklet
manufacturing and antenna integration) these are not part of the CC evaluation
under ALC. Nevertheless the decision about this has to be taken by the
certification body resp. the national body of the issuing State or Organisation. In
this case the national body of the issuing State or Organisation is responsible for
these specific production steps.
Note that the personalisation process and its environment may depend on
specific security needs of an issuing State or Organisation. All production,
generation and installation procedures after TOE delivery up to the “Operational
Use” (phase 4) have to be considered in the product evaluation process under
AGD assurance class. Therefore, the Security Target outlines the split up of
P.Manufact, P.Personalisation and the related security objectives into aspects
relevant before vs. after TOE delivery.


1.4.3.5 Non-TOE hardware/software/firmware required by the TOE
There is no explicit non-TOE hardware, software or firmware required by the TOE
to perform its claimed security features. The TOE is defined to comprise the chip
and the complete operating system and application. Note, the inlay holding the
chip as well as the antenna and the booklet (holding the printed MRZ) are
needed to represent a complete travel document. Nevertheless, these parts are
not inevitable for the secure operation of the TOE.




2
 For this ST all steps of both phase 1 and phase 2 are part of the evaluation and therefore define the TOE
delivery according to the CC evaluation after this phase.
                        Security Target Lite
                                                                        Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                  2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                    Page: 24/150
                       eMRTD Configuration)


2 Conformance Claims


2.1 CC Conformance Claim
This security target claims to be conformant to the Common Criteria version
3.1,which comprises

   Common Criteria for Information Technology Security Evaluation, Part
    1:Introduction and General Model; CCMB-2012-09-001, Version 3.1, Revision
    5, April 2017
    [CC-1]
   Common Criteria for Information Technology Security Evaluation, Part
    2:Security Functional Requirements; CCMB-2012-09-002, Version 3.1,
    Revision 5, April 2017 [CC-2]
   Common Criteria for Information Technology Security Evaluation, Part
    3:Security Assurance Requirements; CCMB-2012-09-003, Version 3.1,
    Revision 5, April 2017 [CC-3]

    as follows:
     Part 2 extended
          o FAU_SAS       Audit data storage
          o FCS_RND       Generation of random numbers
          o FIA_API       Authentication proof of identity
          o FMT_LIM       Limited capabilities and availability
          o FPT_EMS       TOE emanation
     Part 3 conformant

The Common Methodology for Information Technology Security Evaluation
(CEM), Evaluation Methodology; CCMB-2012-09-004, Version 3.1, Revision 5,
April 2017 [CEM] has been taken into account.


2.2 PP Claim
This security target (ST) claims strict conformance to:
    Common Criteria Protection Profile Machine Readable Travel Document
       with "ICAO Application", Extended Access Control with PACE (EAC PP) BSI-
       CC-PP-0056-V2-2012, Version 1.3.2, 5th December 2012 [EAC-PP-V2].
    Protection Profile Machine Readable Travel Document using Standard
       Inspection Procedure with PACE, BSI-CC-PP-0068-V2-2011-MA-01,
       Version 1.0.1, 22 July 2014, BSI [PACE-PP].

The [EAC-PP-V2] claims strict conformance to the PACE Protection Profile
Machine Readable Travel Document using Standard Inspection Procedure with
PACE, BSI-CC-PP-0068-V2-2011, Version 1.0, 2nd November 2011, BSI.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 25/150
                        eMRTD Configuration)

2.3 Package Claim
This ST is conforming to assurance package EAL5 augmented with ALC_DVS.2
and AVA_VAN.5 defined in CC part 3 [CC-3].


2.4 PP Conformance Rationale
This ST claims strict conformance to [EAC-PP-V2]. According to hints in [EAC-PP-
V2] parts of the [PACE-PP] have been included into this ST. A detailed
justification is given in the following.


2.4.1 Main aspects
-   The TOE description (chapter 1.3) is based on the TOE definition and TOE
    usage of [EAC-PP, 1.1]. It was enhanced by product specific details.

-   All definitions of the security problem definition in [EAC-PP, 3] have been
    taken exactly from the protection profile in the same wording.

-   All security objectives have been taken exactly from [EAC-PP, 4] in the same
    wording, except for OT.Chip_Auth_Proof which is enhanced to support
    Active Authentication.

-   The part of extended components definition has been taken originally from
    [EAC-PP, 5].

-   All SFRs for the TOE have been taken originally from the [EAC-PP, 6.1] added
    by according iterations, selections and assignments.

-   The security assurance requirements (SARs) have been taken originally from
    the EAC-PP. The requirements are shifted to those of EAL 5+.


2.4.2 Overview of differences between the PP and the ST

The Active Authentication has been added to the TOE. For that:
- One assumption has been added to cover Active Authentication during
   personalization: A.Pers_Agent_AA
- Two security objectives for the environment have been added:
   OE.Auth_Key_MRTD and OE.AA_MRTD. These additions to the original
   objectives of the PP do not contradict with any other objective nor mitigate a
   threat (or part of a threat) meant to be addressed by security objectives for
   the TOE in the PP.
- Three security functional requirements have been added:
              FCS_COP.1/SIG_GEN
                FIA_API.1/AA
                FMT_MTD.1/AAPK
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 26/150
                        eMRTD Configuration)

The additional functionality of Password Authenticated Connection Establishment
with Chip Authentication Mapping (PACE-CAM) has been added to the TOE. It
possesses the same security requirements as the PACE functionality, which
means that the same security problem definition is applicable for PACE-CAM.


The following additional SFRs have been defined for PACE-CAM:
              FIA_UID.1/PACE_CAM
                FIA_UAU.1/PACE_CAM
                FIA_UAU.4/PACE_CAM
                FIA_UAU.5/PACE_CAM
                FIA_UAU.6/PACE_CAM
                FMT_MTD.1/PACE_CAM_KEY_READ
                FMT_MTD.1/PACE_CAM_KEY_WRITE




The additional functionality of the Polymorphic eMRTD extensions has been
added to the TOE with: (i) additional security problem definition; (ii) additional
security objectives; (iii) additional SFRs. Notice that many SFRs are included
from the [EACv2-PP].
                        Security Target Lite
                           eneral support for cryptographic operations needed.

OT.Data_Authenticity The security objective OT.Data_Authenticity aims
  ensuring authenticity of the User- and TSF data (after the PACE
  Authentication) by enabling its verification at the terminal-side and by an
  active verification by the TOE itself. This objective is mainly achieved by
  FTP_ITC.1/PACE using FCS_COP.1/PACE_MAC. A prerequisite for establishing
  this trusted channel is a successful PACE or Chip and Terminal Authentication
  v.1       FIA_UID.1/PACE,       FIA_UAU.1/PACE        (FIA_UID.1/PACE_CAM,
  FIA_UAU.1/PACE_CAM for PACE CAM) using FCS_CKM.1/DH_PACE resp.
  FCS_CKM.1/CA and possessing the special properties FIA_UAU.5/PACE,
  FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM, FIA_UAU.6/PACE_CAM for PACE
  CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1 requires erasing the values of session
  keys (here: for KMAC). FIA_UAU.4/PACE, FIA_UAU.5/PACE and FCS_CKM.4
  (FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM and FCS_CKM.4 for PACE
  CAM) represent some required specific properties of the protocols used. The
  SFR FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the
  Chip Authentication Private Key and the Active Authentication Private Key. The
  SFR FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE
  passwords and the modular invert of the CA key. FMT_MTD.1/PA requires that
  SOD containing signature over the User Data stored on the TOE and used for
  the Passive Authentication is allowed to be written by the Personalisation
  Agent only and, hence, is to be considered as trustworthy. The SFR
  FCS_RND.1 represents a general support for cryptographic operations needed.
  The SFRs FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles
  related.

OT.Data_Confhe Polymorphic eMRTD document holder for operational use.


EAC PP Application note 2: The TSF data (data created by and for the TOE,
that might affect the operation of the TOE; cf. [CC-1] §92) comprise (but are not
                               Security Target Lite
                                                                                            Ref.:
                        IDeal Pass v2.3-n JC with Privacy
                                                                                      2018_2000036361
                        Protection (SAC/EAC/Polymorphic
                                                                                        Page: 23/150
                              eMRTD Configuration)

limited to) the Personalisation Agent Authentication Key(s), the Terminal
Authentication trust anchor, the effective date and the Chip Authentication
Private Key.

EAC PP Application note 3: This ST distinguishes between the Personalisation
Agent as entity known to the TOE and the Document Signer as entity in the TOE
IT environment signing the Document security object as described in [ICAO-
9303]. This approach allows but does not enforce the separation of these roles.


1.4.3.4 Phase 4 “Operational Use”
(Step 7) The TOE is used as a travel document's chip by the traveller and the
inspection systems in the “Operational Use” phase. The user data can be read
according to the security policy of the issuing State or Organisation and can be
used according to the security policy of the issuing State but they can never be
modified.

EAC PP Application note 42: The intention of the ST is to consider at least the
phases 1 and parts of phase 2 (i.e. Step1 to Step3) as part of the evaluation and
therefore to define the TOE delivery according to CC after this phase. Since
specific production steps of phase 2 are of minor security relevance (e.g. booklet
manufacturing and antenna integration) these are not part of the CC evaluation
under ALC. Nevertheless the decision about this has to be taken by the
certification body resp. the national body of the issuing State or Organisation. In
this case the national body of the issuing State or Organisation is responsible for
these specific production steps.
Note that the personalisation process and its environment may depend on
specific security needs of an issuing State or Organisation. All production,
generation and installation procedures after TOE delivery up to the “Operational
Use” (phase 4) have to be considered in the product evaluation process under
AGD assurance class. Therefore, the Security Target outlines the split up of
P.Manufact, P.Personalisation and the related security objectives into aspects
relevant before vs. after TOE delivery.


1.4.3.5 Non-TOE hardware/software/firmware required by the TOE
There is no explicit non-TOE hardware, software or firmware required by the TOE
to perform its claimed security features. The TOE is defined to comprise the chip
and the complete operating system and application. Note, the inlay holding the
chip as well as the antenna and the booklet (holding the printed MRZ) are
needed to represent a complete travel document. Nevertheless, these parts are
not inevitable for the secure operation of the TOE.




2
 For this ST all steps of both phase 1 and phase 2 are part of the evaluation and therefore define the TOE
delivery according to the CC evaluation after this phase.
                        Security Target Lite
                                                                        Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                  2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                    Page: 24/150
                       eMRTD Configuration)


2 Conformance Claims


2.1 CC Conformance Claim
This security target claims to be conformant to the Common Criteria version
3.1,which comprises

   Common Criteria for Information Technology Security Evaluation, Part
    1:Introduction and General Model; CCMB-2012-09-001, Version 3.1, Revision
    5, April 2017
    [CC-1]
   Common Criteria for Information Technology Security Evaluation, Part
    2:Security Functional Requirements; CCMB-2012-09-002, Version 3.1,
    Revision 5, April 2017 [CC-2]
   Common Criteria for Information Technology Security Evaluation, Part
    3:Security Assurance Requirements; CCMB-2012-09-003, Version 3.1,
    Revision 5, April 2017 [CC-3]

    as follows:
     Part 2 extended
          o FAU_SAS       Audit data storage
          o FCS_RND       Generation of random numbers
          o FIA_API       Authentication proof of identity
          o FMT_LIM       Limited capabilities and availability
          o FPT_EMS       TOE emanation
     Part 3 conformant

The Common Methodology for Information Technology Security Evaluation
(CEM), Evaluation Methodology; CCMB-2012-09-004, Version 3.1, Revision 5,
April 2017 [CEM] has been taken into account.


2.2 PP Claim
This security target (ST) claims strict conformance to:
    Common Criteria Protection Profile Machine Readable Travel Document
       with "ICAO Application", Extended Access Control with PACE (EAC PP) BSI-
       CC-PP-0056-V2-2012, Version 1.3.2, 5th December 2012 [EAC-PP-V2].
    Protection Profile Machine Readable Travel Document using Standard
       Inspection Procedure with PACE, BSI-CC-PP-0068-V2-2011-MA-01,
       Version 1.0.1, 22 July 2014, BSI [PACE-PP].

The [EAC-PP-V2] claims strict conformance to the PACE Protection Profile
Machine Readable Travel Document using Standard Inspection Procedure with
PACE, BSI-CC-PP-0068-V2-2011, Version 1.0, 2nd November 2011, BSI.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 25/150
                        eMRTD Configuration)

2.3 Package Claim
This ST is conforming to assurance package EAL5 augmented with ALC_DVS.2
and AVA_VAN.5 defined in CC part 3 [CC-3].


2.4 PP Conformance Rationale
This ST claims strict conformance to [EAC-PP-V2]. According to hints in [EAC-PP-
V2] parts of the [PACE-PP] have been included into this ST. A detailed
justification is given in the following.


2.4.1 Main aspects
-   The TOE description (chapter 1.3) is based on the TOE definition and TOE
    usage of [EAC-PP, 1.1]. It was enhanced by product specific details.

-   All definitions of the security problem definition in [EAC-PP, 3] have been
    taken exactly from the protection profile in the same wording.

-   All security objectives have been taken exactly from [EAC-PP, 4] in the same
    wording, except for OT.Chip_Auth_Proof which is enhanced to support
    Active Authentication.

-   The part of extended components definition has been taken originally from
    [EAC-PP, 5].

-   All SFRs for the TOE have been taken originally from the [EAC-PP, 6.1] added
    by according iterations, selections and assignments.

-   The security assurance requirements (SARs) have been taken originally from
    the EAC-PP. The requirements are shifted to those of EAL 5+.


2.4.2 Overview of differences between the PP and the ST

The Active Authentication has been added to the TOE. For that:
- One assumption has been added to cover Active Authentication during
   personalization: A.Pers_Agent_AA
- Two security objectives for the environment have been added:
   OE.Auth_Key_MRTD and OE.AA_MRTD. These additions to the original
   objectives of the PP do not contradict with any other objective nor mitigate a
   threat (or part of a threat) meant to be addressed by security objectives for
   the TOE in the PP.
- Three security functional requirements have been added:
              FCS_COP.1/SIG_GEN
                FIA_API.1/AA
                FMT_MTD.1/AAPK
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                  Page: 26/150
                        eMRTD Configuration)

The additional functionality of Password Authenticated Connection Establishment
with Chip Authentication Mapping (PACE-CAM) has been added to the TOE. It
possesses the same security requirements as the PACE functionality, which
means that the same security problem definition is applicable for PACE-CAM.


The following additional SFRs have been defined for PACE-CAM:
              FIA_UID.1/PACE_CAM
                FIA_UAU.1/PACE_CAM
                FIA_UAU.4/PACE_CAM
                FIA_UAU.5/PACE_CAM
                FIA_UAU.6/PACE_CAM
                FMT_MTD.1/PACE_CAM_KEY_READ
                FMT_MTD.1/PACE_CAM_KEY_WRITE




The additional functionality of the Polymorphic eMRTD extensions has been
added to the TOE with: (i) additional security problem definition; (ii) additional
security objectives; (iii) additional SFRs. Notice that many SFRs are included
from the [EACv2-PP].
                        Security Target Lite
                           eneral support for cryptographic operations needed.

OT.Data_Authenticity The security objective OT.Data_Authenticity aims
  ensuring authenticity of the User- and TSF data (after the PACE
  Authentication) by enabling its verification at the terminal-side and by an
  active verification by the TOE itself. This objective is mainly achieved by
  FTP_ITC.1/PACE using FCS_COP.1/PACE_MAC. A prerequisite for establishing
  this trusted channel is a successful PACE or Chip and Terminal Authentication
  v.1       FIA_UID.1/PACE,       FIA_UAU.1/PACE        (FIA_UID.1/PACE_CAM,
  FIA_UAU.1/PACE_CAM for PACE CAM) using FCS_CKM.1/DH_PACE resp.
  FCS_CKM.1/CA and possessing the special properties FIA_UAU.5/PACE,
  FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM, FIA_UAU.6/PACE_CAM for PACE
  CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1 requires erasing the values of session
  keys (here: for KMAC). FIA_UAU.4/PACE, FIA_UAU.5/PACE and FCS_CKM.4
  (FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM and FCS_CKM.4 for PACE
  CAM) represent some required specific properties of the protocols used. The
  SFR FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the
  Chip Authentication Private Key and the Active Authentication Private Key. The
  SFR FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE
  passwords and the modular invert of the CA key. FMT_MTD.1/PA requires that
  SOD containing signature over the User Data stored on the TOE and used for
  the Passive Authentication is allowed to be written by the Personalisation
  Agent only and, hence, is to be considered as trustworthy. The SFR
  FCS_RND.1 represents a general support for cryptographic operations needed.
  The SFRs FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles
  related.

OT.Data_Confidentiality The security objective OT.Data_Confidentiality aims
  that the TOE always ensures confidentiality of the User- and TSF-data stored
  and, after the PACE Authentication resp. Chip Authentication, of these data
  exchanged. This objective for the data stored is mainly achieved by
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 112/150
                       eMRTD Configuration)

  (FDP_ACC.1/TRM, FDP_ACF.1/TRM). FIA_UAU.4/PACE, FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM,        FIA_UAU.5/PACE_CAM      for   PACE    CAM)    and
  FCS_CKM.4 represent some required specific properties of the protocols used.
  This objective for the data exchanged is mainly achieved by FDP_UCT.1/TRM,
  FDP_UIT.1/TRM and FTP_ITC.1/PACE using FCS_COP.1/PACE_ENC resp.
  FCS_COP.1/CA_ENC. A prerequisite for establishing this trusted channel is a
  successful PACE or Chip and Terminal Authentication v.1 FIA_UID.1/PACE,
  FIA_UAU.1/PACE (FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM for PACE
  CAM) using FCS_CKM.1/DH_PACE resp. FCS_CKM.1/CA and possessing the
  special properties FIA_UAU.5/PACE, FIA_UAU.6/PACE (FIA_UAU.5/PACE_CAM,
  FIA_UAU.6/PACE_CAM for PACE CAM) resp. FIA_UAU.6/EAC. FDP_RIP.1
  requires erasing the values of session keys (here: for Kenc). The SFR
  FMT_MTD.1/KEY_READ restricts the access to the PACE passwords, the Chip
  Authentication Private Key and the Active Authentication Private Key. The SFR
  FMT_MTD.1/PACE_CAM_KEY_READ restricts the access to the PACE passwords
  and the modular invert of the CA key. FMT_MTD.1/PA requires that SOD
  containing signature over the User Data stored on the TOE and used for the
  Passive Authentication is allowed to be written by the Personalisation Agent
  only and, hence, is to be considered trustworthy. The SFR FCS_RND.1
  represents the general support for cryptographic operations needed. The SFRs
  FMT_SMF.1 and FMT_SMR.1/PACE support the functions and roles related.

OT.Tracing The security objective OT.Tracing aims that the TOE prevents
  gathering TOE tracing data by means of unambiguous identifying the travel
  document remotely through establishing or listening to a communication via
  the contactless/contact-based interface of the TOE without a priori knowledge
  of the correct values of shared passwords (CAN, MRZ, PIN, PUK). This
  objective is achieved as follows:
            1. While establishing PACE communication with CAN, MRZ or PUK
                (non-blocking      authentication /   authorization  data)   by
                FIA_AFL.1/PACE,
            2. while establishing PACE communication using the PIN (blocking
                authentication data) by FIA_AFL.1/Block_PIN,
            3. for listening to PACE communication and for establishing CAv1
                communication by FTP_ITC.1/PACE,
            4. and      for     listening     to  CAv1     communication     by
                FTP_ITC.1/Polymorphic. The trusted channel shall be established
                by performing the PACE, CAv1 and TAv1 protocols according to
                [TR03110TR-03110] and the Polymorphic Authentication protocol
                (PMA).

OT.Prot_Abuse-Func The security objective OT.Prot_Abuse-Func “Protection
  against Abuse of Functionality” is ensured by the SFRs FMT_LIM.1, FMT_LIM.2,
  FMT_LIM.1/POLY and FMT_LIM.2/POLY which prevent misuse of test
  functionality of the TOE or other features which may not be used after TOE
  Delivery.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 113/150
                        eMRTD Configuration)

OT.Prot_Inf_Leak The security objective OT.Prot_Inf_Leak “Protection against
  Information Leakage” requires the TOE to protect confidential TSF data stored
  and/or processed in the travel document’s chip against disclosure
      by measurement and analysis of the shape and amplitude of signals or the
        time between events found by measuring signals on the electromagnetic
        field, power consumption, clock, or I/O lines which is addressed by the
        SFR FPT_EMS.1,
      by forcing a malfunction"of the TOE which is addressed by the SFR
        FPT_FLS.1 and FPT_TST.1, and/or
      by a physical manipulation of the TOE which is addressed by the SFR
        FPT_PHP.3.

OT.Prot_Phys-Tamper The security objective OT.Prot_Phys-Tamper “Protection
  against Physical Tampering” is covered by the SFR FPT_PHP.3.

OT.Prot_Malfunction The security objective OT.Prot_Malfunction “Protection
  against Malfunctions” is covered by (i) the SFR FPT_TST.1 which requires self-
  tests to demonstrate the correct operation and tests of authorized users to
  verify the integrity of TSF data and TSF code, and (ii) the SFRFPT_FLS.1 which
  requires a secure state in case of detected failure or operating conditions
  possibly causing a malfunction.

OT.Identification The security objective OT.Identification “Identification of the
  TOE” addresses the storage of Initialisation and Pre-Personalisation Data in its
  non-volatile memory, whereby they also include the IC Identification Data
  uniquely identifying the TOE’s chip. This will be ensured by TSF according to
  SFR FAU_SAS.1. The SFR FMT_MTD.1/INI_ENA allows only the Manufacturer
  to write Initialisation and Pre-personalisation Data (including the
  Personalisation Agent key set). The SFR FMT_MTD.1/INI_DIS requires the
  Personalisation Agent to disable access to Initialisation and Pre-personalisation
  Data in the life cycle phase ‘operational use’. The SFRs FMT_SMF.1 and
  FMT_SMR.1/PACE support the functions and roles related.

OT.AC_Pers The       security   objective  OT.AC_Pers      “Access   Control   for
  Personalisation of logical travel document” addresses the access control of the
  writing the logical travel document. The justification for the SFRs FAU_SAS.1,
  FMT_MTD.1/INI_ENA and FMT_MTD.1/INI_DIS arises from the justification for
  OT.Identification above with respect to the Pre-personalisation Data. The write
  access to the logical travel document data are defined by the SFR
  FIA_UID.1/PACE (FIA_UID.1/PACE_CAM for PACE CAM), FIA_UAU.1/PACE
  (FIA_UAU.1/PACE_CAM for PACE CAM), FDP_ACC.1/TRM and FDP_ACF.1/TRM
  in the same way: only the successfully authenticated Personalisation Agent is
  allowed to write the data of the groups EF.DG1 to EF.DG16 of the logical travel
  document only once. FMT_MTD.1/PA covers the related property of
  OT.AC_Pers (writing SOD and, in generally, personalization data). The SFR
  FMT_SMR.1/PACE lists the roles (including Personalisation Agent) and the SFR
  FMT_SMF.1 lists the TSF management functions (including Personalisation).
                        Security Target Lite
                                                                     Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 114/150
                       eMRTD Configuration)

  The SFRs FMT_MTD.1/KEY_READ (FMT_MTD.1/PACE_CAM_KEY_READ for
  PACE CAM protocol) and FPT_EMS.1 restrict the access to the Personalisation
  Agent Keys, the Chip Authentication Private Key and the Active Authentication
  Private key. The authentication of the terminal as Personalisation Agent shall
  be performed by TSF according to SFRs FIA_UAU.4/PACE and FIA_UAU.5/PACE
  (FIA_UAU.4/PACE_CAM and FIA_UAU.5/PACE_CAM for PACE CAM). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Terminal Authentication Protocol v.1 (after Chip Authentication v.1) with
  the Personalisation Agent Keys, the TOE will use TSF according to the
  FCS_RND.1 (for the generation of the challenge), FCS_CKM.1/CA (for the
  derivation of the new session keys after Chip Authentication v.1), and
  FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the ENC_MAC_Mode secure
  messaging), FCS_COP.1/SIG_VER (as part of the Terminal Authentication
  Protocol v.1) and FIA_UAU.6/EAC (for the re-authentication). If the
  Personalisation Terminal wants to authenticate itself to the TOE by means of
  the Authentication Mechanism with the Personalisation Agent Key, the TOE will
  use TSF according to the FCS_RND.1 (for the generation of the challenge) and
  FCS_COP.1/CA_ENC (to verify the authentication attempt). The session keys
  are destroyed according to FCS_CKM.4 after use.

OT.Sens_Data_Conf The            security     objective      OT.Sense_Data_Conf“
  Confidentiality of sensitive biometric reference data” is enforced by the Access
  Control SFP defined in FDP_ACC.1/TRM and FDP_ACF.1/TRM allowing the data
  of EF.DG3 and EF.DG4 only to be read by successfully authenticated Extended
  Inspection System being authorized by a valid certificate according
  FCS_COP.1/SIG_VER. The SFRs FIA_UID.1/PACE and FIA_UAU.1/PACE
  (FIA_UID.1/PACE_CAM and FIA_UAU.1/PACE_CAM for PACE CAM) require the
  identification and authentication of the inspection systems. The SFR
  FIA_UAU.5/PACE requires the successful Chip Authentication (CA) v.1 before
  any     authentication    attempt   as    Extended     Inspection  System    (or
  FIA_UAU.5/PACE_CAM for PACE CAM). During the protected communication
  following the CA v.1 the reuse of authentication data is prevented by
  FIA_UAU.4/PACE (FIA_UAU.4/PACE_CAM for PACE CAM). The SFR
  FIA_UAU.6/EAC and FDP_UCT.1/TRM requires the confidentiality protection of
  the transmitted data after Chip Authentication v.1 by means of secure
  messaging implemented by the cryptographic functions according to
  FCS_RND.1 (for the generation of the terminal authentication challenge),
  FCS_CKM.1/CA (for the generation of shared secret and for the derivation of
  the new session keys), and FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC for
  the ENC_MAC_Mode secure messaging. The session keys are destroyed
  according to FCS_CKM.4 after use. The SFR FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ requires that the Chip Authentication Key cannot be
  written unauthorized or read afterwards. The SFR FMT_MTD.1/AAPK and
  FMT_MTD.1/KEY_READ requires that the Active Authentication Key cannot be
  written       unauthorized       or      read      afterwards.      The     SFR
  FMT_MTD.1/PACE_CAM_KEY_WRITE and FMT_MTD.1/PACE_CAM_KEY_READ
  requires that the modular invert of the CA key cannot be written unauthorized
  or read afterwards. To allow a verification of the certificate chain as in
  FMT_MTD.3 the CVCA’s public key and certificate as well as the current date
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 115/150
                       eMRTD Configuration)

  are  written or   update  by   authorized identified role  as                 of
  FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD and FMT_MTD.1/DATE.

OT.Chip_Auth_Proof The security objective OT.Chip_Auth_Proof “Proof of
  travel document’s chip authenticity” is ensured by the Chip Authentication
  Protocolv.1 provided by FIA_API.1/CA and by Active Authentication provided
  by FIA_API.1/AA proving the identity of the TOE. The Chip Authentication
  Protocolv.1 defined by FCS_CKM.1/CA is performed using a TOE internally
  stored confidential private key as required by FMT_MTD.1/CAPK and
  FMT_MTD.1/KEY_READ. The Chip Authentication Protocolv.1 [TR-03110-1]
  requires additional TSF according to FCS_CKM.1/CA (for the derivation of the
  session keys), FCS_COP.1/CA_ENC and FCS_COP.1/CA_MAC (for the
  ENC_MAC_Mode        secure    messaging).    The   SFRs     FMT_SMF.1     and
  FMT_SMR.1/PACE support the functions and roles related. The Active
  Authentication defined by FCS_COP.1/SIG_GEN for the generation of the RSA
  Signature is performed using a TOE internally stored confidential private key
  as required by FMT_MTD.1/AAPK and FMT_MTD.1/KEY_READ. According to
  FDP_ACF.1, only the successfully authenticated Inspection Systems are
  allowed to request active authentication (FDP_ACF.1.2, rule 2).

OT.Polymorphic_Data_Confidentiality: SFRs that contribute to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Integrity: SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.Polymorphic_Data_Authenticity:        SFRs   that contribute   to meet this
  objective are mentioned in table 7.

OT.Polymorphic_Data_Privacy:        SFRs that contribute to meet this objective
  are mentioned in table 7.

OT.AC_Pers_Polymorphic:       SFRs that contribute to meet this objective are
  mentioned in table 7.

OT.DoS: SFRs that contribute to meet this objective are mentioned in table 7.

6.3.2 Rationale tables of Security Objectives and SFRs
                                 Security Target Lite
                                                                             Ref.:
                          IDeal Pass v2.3-n JC with Privacy
                                                                      2018_2000036361
                          Protection (SAC/EAC/Polymorphic
                                                                        Page: 116/150
                                eMRTD Configuration)

Security Objectives                Security Functional Requirements                 Rationale
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FPT_PHP.3, FCS_CKM.1/CA,
                                   FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Integrity                  FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FMT_MTD.1/AAPK,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_WRITE,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_MAC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FTP_ITC.1/PACE,
                                   FMT_SMF.1, FMT_MTD.1/PA, FCS_CKM.1/CA,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                    Section
OT.Data_Authenticity               FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                    6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FMT_SMR.1/PACE,
                                   FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK
                                   FCS_CKM.1/DH_PACE, FCS_CKM.4,
                                   FCS_COP.1/PACE_ENC, FIA_UAU.6/PACE,
                                   FIA_UAU.6/PACE_CAM, FDP_RIP.1, FDP_UCT.1/TRM,
                                   FDP_UIT.1/TRM, FTP_ITC.1/PACE, FMT_SMF.1,
                                   FMT_MTD.1/PA, FCS_CKM.1/CA, FCS_COP.1/CA_ENC,
                                   FCS_RND.1, FIA_UID.1/PACE, FIA_UAU.1/PACE,
                                   FIA_UAU.4/PACE, FIA_UAU.5/PACE,                  Section
OT.Data_Confidentiality
                                   FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,          6.3.1
                                   FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                   FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                   FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/PACE_CAM_KEY_READ,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_AFL.1/PACE, FTP_ITC.1/PACE,                  Section
OT.Tracing
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Block_PUK         6.3.1
                                   FMT_LIM.1, FMT_LIM.2, FMT_LIM.1/POLY,            Section
OT.Prot_Abuse-Func
                                   FMT_LIM.2/POLY                                   6.3.1
                                                                                    Section
OT.Prot_Inf_Leak                   FPT_FLS.1, FPT_TST.1, FPT_PHP.3, FPT_EMS.1
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Phys-Tamper                FPT_PHP.3
                                                                                    6.3.1
                                                                                    Section
OT.Prot_Malfunction                FPT_FLS.1, FPT_TST.1
                                                                                    6.3.1
                                   FMT_SMF.1, FMT_MTD.1/INI_ENA, FAU_SAS.1,         Section
OT.Identification
                                   FMT_SMR.1/PACE, FMT_MTD.1/INI_DIS                6.3.1
                              Security Target Lite
                                                                               Ref.:
                       IDeal Pass v2.3-n JC with Privacy
                                                                        2018_2000036361
                       Protection (SAC/EAC/Polymorphic
                                                                          Page: 117/150
                             eMRTD Configuration)

                                      FMT_SMF.1, FMT_MTD.1/INI_ENA, FMT_MTD.1/PA,
                                      FAU_SAS.1, FCS_CKM.1/CA, FCS_CKM.4,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_COP.1/SIG_VER, FCS_RND.1, FIA_UID.1/PACE,
                                      FIA_UAU.1/PACE, FIA_UAU.4/PACE, FIA_UAU.5/PACE,
                                                                                        Section
OT.AC_Pers                            FIA_UID.1/PACE_CAM, FIA_UAU.1/PACE_CAM,
                                                                                        6.3.1
                                      FIA_UAU.4/PACE_CAM, FIA_UAU.5/PACE_CAM,
                                      FIA_UAU.6/EAC, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FMT_SMR.1/PACE, FMT_MTD.1/KEY_READ,
                                      FPT_EMSutual authentication requires first to authenticate the TOE to the external user. This requires
also knowledge by the user about the sequence of the protocol, interpretation of the transferred data and how to
start the authentication of the TOE. This authentication mean counters the threat T.Masquerade_TOE as only
the genuine TOE is able to identify itself correctly to the enabled user, which covers O.Authentication.
The second step of the mutual authentications mean implements the authentication of the user to the TOE. Only
the user enabled to present the correct authentication data and knowing about the sequence, data
interpretation and signaling of the authentication to the TOE is able to proceed further on.
This enforces OE.TOE_Auth, requiring the support of the verification mechanism and known authentication
reference data by the operational environment.

It is normal business that products enabled for software download by the user are either on their way to the user
or are already stored at user premises. At both situations it cannot be excluded that an attacker could manage to
steal such products enabled for software downloads. The ability to download software on a chip without
operating system and/or application is defined as open sample.
This situation generates the threat T.Open_Samples_Diffusion which is defined as follows:
The download of analysis software could enable an attacker to characterize the product and to construct an
attack path out of the gained information.
This threat is countered by the Flash Loader by following rational:
As long as the Flash Loader is active, controlled usage to the Flash Loader functionality (P.Ctrl_Loader) is
enforced which protects the TOE from achieving the status of being an open sample. And more, even the
attacker could observe, meaning in the sense of measurements during, or induce faults during an authorized
download, the Flash Loader protects the user data of the download by confidentiality and integrity protection
means. The Flash Loader functionalities of mutual authentication, establishing a dedicated trusted
communication channel, the encryption and integrity protection means cover the objectives
O.Prot_TSF_Confidentiality, O.Leak-Inherent and O.Leak-Forced.
The policy P.Ctrl_Loader covers also the environmental objective OE.Process-Sec-IC at user                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].            • functionality to calculate the Advanced Encryption Standard (AES) with different key
                        lengths,
                      • support for large integer arithmetic operations like multiplication, addition and logical
                        operations, which are suitable for public key cryptography (e.g. RSA or ECC),
                      • a True Random Number Generator,
                      • memory management control,
                      • cyclic redundancy check (CRC) calculation,
                      • ISO/IEC 7816 contact interface with UART, and
                      • ISO/IEC 14443 A contactless interface supporting.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           