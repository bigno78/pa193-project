Public




   Common Criteria Public Security Target
   EAL6 augmented / EAL6+
   IFX_CCI_000003h
   IFX_CCI_000005h
   IFX_CCI_000008h
   IFX_CCI_00000Ch
   IFX_CCI_000013h
   IFX_CCI_000014h
   IFX_CCI_000015h
   IFX_CCI_00001Ch
   IFX_CCI_00001Dh
   IFX_CCI_000021h
   IFX_CCI_000022h

   H13

   Resistance to attackers with HIGH attack potential
                                    Including optional Software Libraries
                            Flash Loader – 3x ACL – 4x HSL – 2x SCL – NRG – CCL




 Author: Infineon Technologies
 Revision: 1.8




CC Document            Please read the Important Notice and Warnings at the end of this document          1.8
www.infineon.com                                                                                   2020-04-22
Public




Table of Contents
2.2.1         Hardware of the TOE ...................................................................................................................26
2.2.2         Firmware and software of the TOE .............................................................................................. 27
2.2.3         Interfaces of the TOE................................................................................................................... 32
2.2.4         Guidance documentation ............................................................................................................ 33
2.2.5         Forms of delivery ......................................................................................................................... 35
2.2.6         Production sites ........................................................................................................................... 37
3.1.1         Adding Objectives ....................................................................................................................... 39
3.1.2         AES and TDES .............................................................................................................................40
3.1.3         Loader .........................................................................................................................................40
3.1.4         CIPURSE Cryptographic Library (CCL) ......................................................................................... 41
3.1.5         Summary .....................................................................................................................................42
4.1.1         Additional Threat due to TOE specific Functionality .................................................................... 43
4.1.2         Assets regarding the Threats .......................................................................................................44
4.2.1         Augmented Organizational Security Policy .................................................................................46
4.3.1         Augmented Assumptions ............................................................................................................ 47
4.3.2         Note regarding CIPURSE™ CL .....................................................................................................48
5.3.1         Clarification of “Treatment of User Data (OE.Resp-Appl)” .......................................................... 54
5.3.2         Clarification of “Protection during Composite product Manufacturing (OE.Process-Sec-IC)” ...... 54
6.1.1         Definition of FPT_TST.2 ..............................................................................................................60
6.1.2         TSF self-test (FPT_TST) ............................................................................................................... 61
7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1 ................................................................... 65
7.1.2         Subset of TOE testing.................................................................................................................. 70
7.1.3         Memory access control ................................................................................................................ 71
7.1.4         Support of Cipher Schemes ......................................................................................................... 74
7.1.5         Data Integrity FDP_SDI.2 and FDP_SDC.1 ................................................................................. 103
7.1.6         Application Note to FPT_FLS.1 Failure with preservation of secure state .................................. 104
7.3.1         Refinements .............................................................................................................................. 109
7.4.1         Rationale for the Security Functional Requirements .................................................................. 113
7.4.2         Rationale of the Assurance Requirements ................................................................................. 124
8.1.1         Listing of SFRs implemented by SF_DPM Device Phase Management ...................................... 126
8.2.1         Listing of SFRs implemented by SF_PS Protection against Snooping........................................ 129
8.3.1         Listing of SFRs implemented by SF_PMA Protection against Modifying Attacks ...................... 131
8.4.1         Listing of SFRs implemented by SF_PLA Protection against Logical Attacks ............................ 132
8.5.1         Implementation of AES and TDES by the Symmetric Cryptographic Coprocessor SCP ............. 133
8.5.2         Implementation of TDES, AES and CMAC by the Symmetric Cryptographic Library SCL .......... 135
8.5.3         RSA Cryptographic Library for all versions................................................................................. 137
8.5.4         Elliptic Curves Cryptographic Library for all versions ................................................................. 139
8.5.5         Toolbox Library for all versions .................................................................................................. 140
8.5.6         CIPURSE™ Cryptographic Library ............................................................................................. 141
8.5.7         Hybrid PTRNG ........................................................................................................................... 141
8.5.8         Listing of SFRs implemented by SF_CS “Cryptographic Support” ............................................. 142




CC Document                 Please read the Important Notice and Warnings at the end of this document                                                   1.8
www.infineon.com                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



1              Security Target Introduction (ASE_INT)

1.1            Security Target and Target of Evaluation Reference
The title of this document is Confidential Security Target as given on the front page and it covers and describes
one hardware platform respectively one IC representing the Target of Evaluation (TOE) with following Common
Criteria Identifiers:
     IFX_CCI_000003h
         IFX_CCI_000005h
         IFX_CCI_000008h
         IFX_CCI_00000Ch
         IFX_CCI_000013h
         IFX_CCI_000014h
         IFX_CCI_000015h
         IFX_CCI_00001Ch
         IFX_CCI_00001Dh
         IFX_CCI_000021h
      IFX_CCI_000022h
in the design step H13 and including optional software libraries and dedicated firmware in several versions as
stated and assigned in the table below.

In order to ease the readability of this document the bunch of Common Criteria Identifiers as listed above is
shortened and simply expressed with TOE (Target of Evaluation) or IFX_CCI_000003h with options.

This document is formed according to Common Criteria CCv3.1 EAL6 augmented (EAL6+) and comprises the
Infineon Technologies AG Security Controller (Integrated Circuit IC) with the above listed Common Criteria
Identifiers and with specific IC dedicated firmware and optional software.

The target of evaluation (TOE) is described in the following.
This Public Security Target has the revision 1.8 and is dated 2020-04-22.




CC Document                                              3                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The Target of Evaluation (TOE) is the Infineon Security Controller with following optional available software
packages:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
            o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
            o All ACL libraries provide elliptic curve cryptography EC3
    the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
    the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
    the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH™ NVM to the user
    the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method
    the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
       user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
    the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).
and with further specific IC dedicated firmware in several alternative versions.

Please note that always the highest version number points to the most recent status of a library coming usually
with improvements and/or additional functionality.

Note that each of the versions of the ACL, SCL, HSL, CCL and the NRG are optional and alternatively. This means
that the TOE comes either with one of the alternative library types– depending on the user choice - or with none.
The library types can freely be combined but not two versions of the equal type. For examples ACL with SCL with
HSL with NRG is welcome but a combination of HSL in version 03.11.8339 and at the same time with HSL in
version 01.22.4346 would not work. The library types are entirely independent from each other.
The security relevant differences in the versions - if any - are detailed in chapter 8. The claims of this Security
Target take the corresponding versions into account and thus the wording in the following refers to the library
type which is cited or else the claim includes always all named versions.

The design step of this TOE is H13.

The Security Target is based on the Protection Profile PP-0084 Security IC Platform Protection Profile with
Augmentation Packages [9] as publicly available for download at https://www.bsi.bund.de and certified under
BSI-CC-PP-0084-2014.
The Security Target is built in compliance with Common Criteria v3.1 Revision 5.

The Security Target takes into account all relevant current final interpretations.

1
 Rivest-Shamir-Adleman asymmetric cryptographic algorithm
2
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
3 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                           4                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



This TOE concept is based on the architecture, family concept and principles of the Integrity Guard implemented
in the controllers by Infineon Technologies AG deemed for high security requiring applications.

The certification body of this process is the German BSI, whereas the abbreviation stands for Federal Office for
Information Security, in German language Bundesamt für Sicherheit in der Informationstechnik.




CC Document                                             5                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                                          Table 1     Identification
                         Version           Date                            Registration
Security Target             1.8          2020-04-22                       This document
Target of Evaluation                                      The hardware controller with following identifiers:
                                                 [20]      MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf
       and NT4H2x21Tf
       Security Target Lite
       Rev. 1.0 – 2018-12-31                                  Evaluation documentation
       Final                                                                      PUBLIC
       <Certid>




Document Information

Info                     Content

Keywords                 Common Criteria, Security Target Lite, MF2DL(H)x0, MF2ID(H)10,
                         NT4H2x21Gf, NT4H2x21Tf

Abstract                 Evaluation of the MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and
                         NT4H2x21Tf product, developed and provided by NXP Semicon-
                         ductors, Business Unit Security & Connectivity, according to the
                         Common Criteria for Information Technology Evaluation Version 3.1
                         at EAL4
NXP Semiconductors                   MF2DL, MF2ID, NTAG42x(Tf)
                                                                                      Security Target Lite
                                                                                                              PUBLIC




Rev     Date               Description
1.0     31-December-2018   Initial version of this Security Target Lite based on Security Target Revision 1.9




Final                                                                                    ©NXP B.V. 2018. All rights reserved.

Evaluation documentation           Rev. 1.0 – 2018-12-31                                                        1 of 62
 NXP Semiconductors                                MF2DL, MF2ID, NTAG42x(Tf)
                                                                                             Security Target Lite
                                                                                                                     PUBLIC




1        ST Introduction
1.1        ST Reference
MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and NT4H2x21Tf Security Target Lite, Revision 1.0, NXP Semiconduc-
tors, Date 2018-12-31.


1.2        TOE Reference
MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and NT4H2x21Tf, Version 01.1


1.3        TOE Overview
1.3.1       Introduction
NXP has developed the TOE to be used with Proximity Coupling Devices (PCDs, also called "terminals")
according to ISO14443 Type A [10][12][13][11]. The communication protocol complies to ISO 14443 part 3 [13]
and 4 [11]. The TOE is primarily designed for secure contactless transport applications, loyalty programs, access
management, closed loop payment, account based services and secure NFC applications. It fully complies with
the requirements for fast and highly secure data transmission and interoperability with existing infrastructure.


The TOE provides resistance against attack of an attacker with an enhanced-basic attack potential. This is
achieved by a combination of different security features that provide a base-line protection against information
leakage via side-channels, fault injections and physical attacks. Furthermore, the TOE protects the different
operating modes of the Security IC to avoid ab-use by an attacker. Protected by these security features the TOE
implements the following main security services:

     • secure mutual authentication to support authentication of authorized users and the TOE
     • secure channel establishment and secure messaging to support confidential and integrity protected data
         transfer
     • secure dynamic messaging to allow secure export of user data in unauthenticated state on MIFARE IDentity
         and NTAG42x DNA (Tf) variants of the TOE
     • supporting non-traceability of the TOE by providing the option to use random IDs during contactless protocol
         establishment
     • enhanced secure transaction management provided by the MIFARE DESFire Light and MIFARE IDentity
         variants of the TOE
     • additional functionality to check the status of a tamper evident tag provided by the NTAG42x DNA Tf variant
         of the TOE




 Final                                                                                          ©NXP B.V. 2018. All rights reserved.

 Evaluation documentation                      Rev. 1.0 – 2018-12-31                                                   2 of 62
 NXP Semiconductors                                      MF2DL, MF2ID, NTAG42x(Tf)
                                                                                             Security Target Lite
                                                                                                                     PUBLIC



These security functionalities aim at enabling card issuers to use the product for various use-cases as outlined in
the following.


The TOE is a Security IC comprising a hardware platform and a fixed software                           IFX_CCI_000003h
                                                                          IFX_CCI_000005h
                                                                          IFX_CCI_000008h
                                                                          IFX_CCI_00000Ch
                                                                          IFX_CCI_000013h
                                                                          IFX_CCI_000014h
                                                                          IFX_CCI_000015h
                                                                          IFX_CCI_00001Ch
                                                                          IFX_CCI_00001Dh
                                                                          IFX_CCI_000021h
                                                                          IFX_CCI_000022h
                                                      In the Design Step      H13
                                                           With following alternative FW-Identifiers
                                                                             v80.100.17.3
                                                                             v80.100.17.2
                                                                             v80.100.17.1
                                                                             v80.100.17.0
                                                      And following optional SW – libraries:
                                                      ACL-1 to -3 RSA2048 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 RSA4096 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 EC          v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to 3 Toolbox      v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      HSL-1                   03.12.8812
                                                      HSL-2                   03.11.8339
                                                      HSL-3                   02.01.6634
                                                      HSL-4                   01.22.4346
                                                      SCL-1                   v2.04.002
                                                      SCL-2                   v2.02.010
                                                      NRG                     v02.04.3957
                                                      CIPURSE™ CL             v02.00.0004
                                                      Each of the above named libraries comes with a specific
                                                      user guidance document
                                                      Security IC Platform Protection Profile with
Protection Profile          1.0          2014-01-13
                                                      Augmentation Packages BSI-CC-PP-0084-2014



CC Document                                           6                                                     1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                             Version         Date                              Registration
                                                         Common Criteria for
                                                         Information Technology Security Evaluation
                                                         Part 1: Introduction and general model
                                3.1
                                                         CCMB-2017-04-001
Common Criteria                             2017-04
                                                         Part 2: Security functional requirements
                             Revision 5                  CCMB-2017-04-002
                                                         Part 3: Security Assurance Components
                                                         CCMB-2017-04-003
User Guidance Documentation Set
Chapter describes briefly the contents of the individual documents of the User Guidance Documentation,
while the individual documents are versioned and entitled in chapter 9 literature and references. The in this
chapter listed set of user guidance documents belongs to the TOE.

This TOE is represented by a number of various products which are all based on the equal design sources. The
TOE hardware remains entirely equal throughout all derivatives, but the usage for example in form of available
memory sizes, availability of the various interfaces, or other functions varies by means of blocking and chip
configuration. The firmware identifier on board depends on the order.
All TOE derivatives are derived from the equal hardware design results.

The TOE can be identified with the Generic Chip Identification Mode (GCIM). The IFX_CCI_000003h with options
hardware platform is identified by defined bytes of the GCIM as detailed in the HRM [1].
The unique hexadecimal values as stated in the title are:
                         IFX_CCI_000003h
                             IFX_CCI_000005h
                             IFX_CCI_000008h
                             IFX_CCI_00000Ch
                             IFX_CCI_000013h
                             IFX_CCI_000014h
                             IFX_CCI_000015h
                             IFX_CCI_00001Ch
                             IFX_CCI_00001Dh
                             IFX_CCI_000021h
                          IFX_CCI_000022h
The user can easily identify from which production line a certain IC is coming. The corresponding identifier is
given in chapter 2.2.6

These bytes clearly identify the hardware platform, or, in other words, the therein possible values for
IFX_CCI_000003h with options (without prefix IFX_CCI_) represent the equal hardware platform of this TOE. This
means that the hardware entirely equals throughout all derivatives and that the differences are achieved by
configuration and blocking means only. These values are unique for this hardware platform. This means that
these values will not be used in any other platform or product.
The interpretation of the output GCIM data is clearly explained in the user guidance, Hardware Reference Manual
HRM [1].
Although the TOE is represented by a number of various products, all based on the equal design sources, the
hardware is constituted out of few slightly different mask sets enabling to adapt to various external contactless
and contact based devices not being part of this TOE. Except this external adapt capability the TOE hardware
CC Document                                              7                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


and firmware – depending on the order option – remains entirely equal throughout all derivatives, but the usage
for example in form of available memory sizes, availability of the various interfaces, or other functions varies by
means of blocking and chip configuration. This blocking is applied by Infineon settings during the production
only. Again, all TOE derivatives are derived from the equal hardware design results, the IFX_CCI_000003h with
options.
The differences between the derivatives are achieved by blocking only and have no impact on the TOEs security
policies and related functions. Details are explained in the user guidance hardware reference manual HRM [1].
All product derivatives are identically from module design, layout and footprint, but are made different in their
possibilities to connect to different types of external antennas or to a contact based interface only. Therefore,
the TOE is represented and made out of different mask sets with following TOE internal and security irrelevant
differences:
The differences between the mask sets implement different input capacitances in the analogue part of the radio
frequency interface (RFI). This differentiation in the input capacitances enable for the connection of a wider
range of various antenna types. Note that external antennas or interfaces are not part of the TOE.
To each of the mask sets, an individual value is assigned, which is part of the data output of the Generic Chip
Identification Mode (GCIM). This number is located in the GCIM part individual length byte to clearly
differentiate between the mask sets related to the different input capacitances. Details are explained in the user
guidance hardware reference manual (HRM) and in the errata sheet.
There are no other differences between the mask sets the TOE is produced with.
The IFX_CCI_000003h with options products enable for a maximum of configuration possibilities defined by the
customer order following the market needs. For example, a TOE product can come in one project with the fully
available SOLID FLASH™ NVM1 or in another project with any other SOLID FLASH™ NVM –size below the
physical implementation size, or with a different RAM size. And more, the user has the free choice, whether he
needs the symmetric co-processor SCP, or the asymmetric co-processor Crypto2304T, or both, or none of them.
In addition, the user decides, whether the TOE comes with a free combination of software libraries or without
any. And, to be even more flexible, various interface options can be chosen as well.

To sum up the major selections, the user defines by his order:
      the firmware identifier in several alternatives
      the available memory sizes of the SOLID FLASH™ NVM and RAM
      the availability of the cryptographic coprocessors SCP and Crypto@2304T
      the availability and free combinations of the cryptographic libraries
         ACL-1, ACL-2, ACL-3, SCL-1 and SCL-2
      the availability of the CIPURSE™ Cryptographic Library
      the availability of the Flash Loader
      the availability of the alternative libraries HSL-1 or HSL-2 or HSL-3 or HSL-4
      the availability of the library NRG
      the availability of various interface options
      the possibility to tailor the product by blocking on his own premises (BPU)
      the possibility to apply the PIN letter in combination with the Flash Loader
The degree of freedom of the chip configuration is predefined by Infineon Technologies AG and made available
via the order tool.

Beside fix TOE configurations, which can be ordered as usual, this TOE implements optionally the so called
Billing-Per-Use (BPU) ability. This solution enables our customer to tailor the product on his own to the required


   1
       SOLID FLASH™ is an Infineon Trade Mark and stands for the Infineon Flash NVM. The abbreviation NVM is short for Non Volatile
                                Memory. The information remains stored even the power has been removed.


CC Document                                                        8                                                              1.8
                                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


configuration – project by project. By that BPU allows for significant reduction of logistic cost at all participating
parties and serves for acceleration of delivery of tailored product to the end-user.
BPU enables our customers to block the chip on demand into the final configuration at his own premises, without
further delivery or involving support by Infineon Technology.
The realization of it requires the presence of the Flash Loader software, enhanced with the BPU blocking
software part. The presence of the BPU ability defines the customer with his order.
The user then receives this TOE in a predefined starting configuration, for example entirely unblocked. Again,
the delivered starting configuration depends on the user order. After delivery, the user can put the TOE in
volume on his stock and can block it down to the required sizes and features, whenever a certain configuration is
required by a certain project.
Depending on the number of TOE products delivered, and their individual final blocked configuration, the
customer receives a balancing payment. By that our customers are charged only for the true configurations
required in their projects.
As written above, the software realizing the user allowed blocking, is implemented and delivered in the TOE –
depending on the order - and is part of the evaluation and certificate. This software is an additional part of the
Flash Loader software but also the other firmware – in all alternative versions - has seen a small enhancement to
enable for BPU.
If BPU is available, the blocking is done by the user at user premises, usually by taking an enhancement of the
user own personalization flow and applying the according APDUs. These APDUs are predefined by Infineon
Technologies and can also depend on the customer order. Only these APDUs can block the chip according to the
user demands.
Infineon Technologies AG provides special software, running in parallel when doing the blocking. This software
summarizes all devices and final configurations allowing for the later commercial balancing. The balancing
depends on the number of chips and their individual final blockings the user has made over a defined time span.
This special software can be used only for the commercial balancing, is not present on the TOE, not security
relevant and therefore not part of this certificate.
All blockings are done by setting the according value in the chip configuration page, where certain parts are left
available to the blocking software. Strong means of authentication are in place. The blocking software
respectively BPU software is an additional part of the Flash Loader software and the only piece of software, able
to manage the blocking APDUs. Therefore, the presence of the Flash Loader software is essential for the BPU
ability.
The user can only apply a predefined and checksum protected set of allowed APDU configuration commands
provided by Infineon Technologies AG. For this, the Flash Loader BPU software part, together with the firmware
– regardless of the version used -, executes one of those APDUs. After the final blocking is done and the user
additionally may have downloaded his software, the entire Flash Loader including the BPU software part is
permanently deactivated. This is called locking of the Flash Loader.
Of course, exclusively all security relevant settings are contained in the IFX-only part. The Flash Loader BPU
software does not access and has no access to the IFX-only part.
Once the user blocking by applying the APDU has been finalized, the configuration page is no more accessible
for changes. After the locking of the Flash Loader, the product is permanently fixed regarding its configurations
and software. A reactivation of the Flash Loader is not possible. At the next start-up, the Boot-Up-Software
(BOS) applies the made settings, and, if called, a Resource Management System (RMS)-function can output the
finally made chip configuration for verification and information purposes.
The entire configuration storage area is protected against manipulation, perturbation and false access. Note that
the IFX-only part of the configuration page is already access protected prior delivery to the user and the TOE
leaves the Infineon Technology premises only locked into User Mode.
The BPU software part is only active on the products which have been ordered with the BPU option. In all other
cases this software is disabled on the product. If a product is ordered without Flash Loader, also the Flash Loader
software is disabled and the BPU configuration changes are blocked in the IFX-configuration, which renders BPU
functionality unusable. Therefore, the BPU feature is only possible if the Flash Loader is active.


CC Document                                               9                                    package. The software is stored in
ROM and provides an operating system which implements a set of functions used to manage various kinds of data
files stored in the non-volatile EEPROM memory. The operating system provides access control if required by
the configura                    1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


If the user decides to use the Flash Loader, regardless whether it is ordered with or without BPU, an additional
process option can be ordered which results in an additional status of the Flash Loader. This process is called PIN-
Letter and enables for simplified logistics and thereby for faster delivery of the ordered TOE products to the user.
The PIN-Letter feature enabling for the PIN-Letter process is an implemented part of the Flash Loader. The
resulting logistical acceleration is possible since the PIN-Letter enables for delivery of not user-specific
configured, not flashed and not personalized TOE products to the user warehouse.
Extra authentication means applied in the PIN-Letter status of the Flash Loader preserve that only the intended
user with the intended PIN-Letter can configure with user specific information and enable the normal Flash
Loader functions in a second step. By that the user orders the products and receives - in a protected way - the
belonging PIN-Letter. PIN-Letter and delivered chips must match.
By delivery the user warehouse gets filled and depending on market demands the user can immediate apply the
authentication means of the PIN-letter. If passing, the TOE products become user specific configured and the
Flash Loader can be used for this specific user in a second step.
The following table outlines the different ways how the user can input his software on this TOE – a TOE without
user available ROM. User software comprises usually the operating system and applications, which are for
Infineon Technologies simply a user data package which is handled as a fixed data package during production.
This provides high process flexibility for the user of which an overview is given in the following table:


    tion. The operating system is designed as platform, which supports command sets for four different
applications forming four different product variants, in detail:

     • MIFARE DESFire Light: th                     Table 2        Options to implement user software on the chip
 Case                          Option                                          Flash Loader Status
         The user or/and a subcontractor downe MF2DL(H)x0 variant of the TOE (short: MF2DL) is intendeloadd for ls the
     i  m           assured identification of its end points and protection of the channel data from
                        modification or disclosure.
FTP_ITC.1.2/PACE        The TSF shall permit another trusted IT product to initiate communication via the
                        trusted channel.
FTP_ITC.1.3/PACE        The TSF shall initiate enforce communication via the trusted channel for any data
                        exchange between the TOE and the Terminal.


PP0068v2 application note 43: The trusted IT product is the terminal. In FTP_ITC.1.3/PACE, the word “initi-
ate” is changed to ‘enforce”, as the TOE is a passive device that can not initiate the communication. All the
communication are initiated by the Terminal, and the TOE enforce the trusted channel.
PP0068v2 application note 44: The trusted channel is established after successful performing the PACE
protocol (FIA_UAU.1/PACE). If the PACE was successfully performed, secure messaging is immediately
started using the derived session keys (PACE-KMAC, PACE-KEnc): this secure messaging enforces preventing
tracing while Passive Authentication and the required properties of operational trusted channel; the cryp-
tographic primitives being used for the secure messaging are as required by FCS_COP.1/PACE_ENC and
FCS_COP.1/PACE_MAC. The establishing phase of the PACE trusted channel does not enable tracing due to
the requirements FIA_AFL.1/PACE.
PP0068v2 application note 45: Please note that the control on the user data stored in the TOE is addressed
by FDP_ACF.1/TRM.

6.2.5 Class FAU Security Audit
FAU_SAS.1 Audit storage
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FAU_SAS.1.1             The TSF shall provide the Manufacturer with the capability to store the Initialisa-
                        tion and Pre-Personalisation Data in the audit records.


PP0068v2 application note 46: The Manufacturer role is the default user identity assumed by the TOE in
the life cycle phase ‘manufacturing’. The IC manufacturer and the travel document manufacturer in the
Manufacturer role write the Initialisation and/or Pre-personalisation Data as TSF-data into the TOE. The
audit records are usually write-only-once data of the travel document (see FMT_MTD.1/INI_ENA,
FMT_MTD.1/INI_DIS). Please note that there could also be such audit records which cannot be read out,
but directly used by the TOE.


                                                   65 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite




6.2.6 Class FMT Security Management
FMT_SMF.1 Specification of Management Functions
Hierarchical to:        No other components.
Dependencies:           No Dependencies
FMT_SMF.1.1             The TSF shall be capable of performing the following management functions:
                        1. Initialization,
                        2. Pre-personalization,
                        3. Personalization,
                        4. Configuration.

PP application note 36:The SFR FMT_SMR.1/PACE provides basic requirements to the management of the
TSF data.


FMT_SMR.1/PACE Security roles
Hierarchical to:        No other components.
Dependencies:           FIA_UID.1 Timing of identification.
FMT_SMR.1.1/PACE                 The TSF shall maintain the roles
                        1. Manufacturer,
                        2. Personalization Agent,
                        3. Terminal,
                        4. PACE authenticated BIS-PACE,
                        5. Country Verifying Certification Authority,
                        6. Document Verifier,
                        7. Domestic Extended Inspection System,
                        8. Foreign Extended Inspection System.
FMT_SMR.1.2/PACE        The TSF shall be able to associate users with roles.


PP application note 37: The SFR FMT_SMR.1.1/PACE in this ST covers the definition in PACE PP [PP0068v2]
and extends it by 5) to 8). This extension does not conflict with the strict conformance to PACE PP.
PP application note 38: The SFR FMT_LIM.1 and FMT_LIM.2 address the management of the TSF and TSF
data to prevent misuse of test features of the TOE over the life-cycle phases.
PP0068v2 application note 47: For explanation on the role Manufacturer and Personalisation Agent please
refer to the glossary of [PP0068v2]. The role Terminal is the default role for any terminal being recognised
by the TOE as not PACE authenticated BIS-PACE (‘Terminal’ is used by the travel document presenter).
The TOE recognises the travel document holder or an authorised other person or device (BIS-PACE) by using
PACE authenticated BIS-PACE (FIA_UAU.1/PACE).


FMT_LIM.1 Limited capabilities
Hierarchical to:        No other components.
Dependencies:           FMT_LIM.2 Limited availability.



                                                   66 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


FMT_LIM.1.1             The TSF shall be designed in a manner that limits their capabilities so that in con-
                        junction with “Limited availability (FMT_LIM.2)” the following policy is enforced:
                        Deploying Test Features after TOE Delivery does not allow,
                        1. User Data to be manipulated,
                        2. TSF data to be disclosed or manipulated,
                        3. software to be reconstructed,
                        4. substantial information about construction of TSF to be gathered which may
                           enable other attacks,
                        5. sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.

FMT_LIM.2 Limited availability
Hierarchical to:        No other components.
Dependencies:           FMT_LIM.1 Limited capabilities.
FMT_LIM.2.1             The TSF shall be designed in a manner that limits their availability so that in con-
                        junction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced:
                        Deploying Test Features after TOE Delivery does not allow
                        1. User Data to be manipulated,
                        2. TSF data to be disclosed or manipulated,
                        3. software to be reconstructed,
                        4. substantial information about construction of TSF to be gathered which may
                           enable other attacks,
                        5. sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.

PP application note 39: The formulation of “Deploying Test Features …” in FMT_LIM.2.1 might be a little bit
misleading since the addressed features are no longer available (e.g. by disabling or removing the respective
functionality). Nevertheless the combination of FMT_LIM.1 and FMT_LIM.2 is introduced to provide an op-
tional approach to enforce the same policy.
PP0068v2 application note 48: Note that the term “software” in item 4 of FMT_LIM.1.1 and FMT_LIM.2.1
refers to both IC Dedicated and IC Embedded Software.
PP application note 40: The following SFR are iterations of the component Management of TSF data
(FMT_MTD.1). The TSF data include but are not limited to those identified below.


FMT_MTD.1/CVCA_INI Management of TSF data – Initialisation of CVCA Certificate and Current Date
Hierarchical to:        No other components.
Dependencies:           FMT_SMF.1 Specification of management functions: fulfilled byFMT_SMF.1
                        FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
CVCA_INI
                        The TSF shall restrict the ability to write the
                        1. initial Country Verifying Certification Authority Public Key,
                        2. initial Country Verifying Certification Authority Certificate,
                        3. initial Current Date




                                                   67 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                          4. None57
                          To the Personalization Agent58.


PP application note 41:<applied>. The initial Country Verifying Certification Authority Public Keys (and their
updates later on) are used to verify the Country Verifying Certification Authority Link-Certificates. The initial
Country Verifying Certification Authority Certificate and the initial Current Date is needed for verification of
the certificates and the calculation of the Terminal Authorization.


FMT_MTD.1/CVCA_UPD Management of TSF data – Country Verifying Certification Authority
Hierarchical to:          No other components.
Dependencies:             FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
CVCA_UPD
                          The TSF shall restrict the ability to update the
                          1. Country Verifying Certification Authority Public Key,
                          2. Country Verifying Certification Authority Certificate,
                          to Country Verifying Certification Authority.


PP application note 42: The Country Verifying Certification Authority updates its asymmetric key pair and
distributes the public key be means of the Country Verifying CA Link-Certificates (cf. [TR-03110]). The TOE
updates its internal trust-point if a valid Country Verifying CA Link-Certificates (cf. FMT_MTD.3) is provided
by the terminal (cf. [TR-03110]).


FMT_MTD.1/DATE Management of TSF data – Current date
Hierarchical to:          No other components.
Dependencies:             FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/DATE          The TSF shall restrict the ability to modify the Current date to
                          1. Country Verifying Certification Authority,
                          2. Document Verifier,
                          3. Domestic Extended Inspection System.

PP application note 43: The authorized roles are identified in their certificate (cf. [TR-03110]) and author-
ized by validation of the certificate chain (cf. FMT_MTD.3). The authorized role of the terminal is part of the
Certificate Holder Authorization in the card verifiable certificate provided by the terminal for the identifica-
tion and the Terminal Authentication v.1 (cf. to [TR-03110]).


FMT_MTD.1/CAPK Management of TSF data – Chip Authentication Private Key
Hierarchical to:          No other components.


 [assignment: list of TSF data]
57

58   [assignment: the authorised identified roles]

                                                     68 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/CAPK           The TSF shall restrict the ability to load59 the Chip Authentication Private Key to the
                           Personalization Agent60.


PP application note 44: <applied> The verb “load” means here that the Chip Authentication Private Key is
generated securely outside the TOE and written into the TOE memory. Thus according to PP application
note 44 no additional key generation SFR is necessary.


FMT_MTD.1/INI_ENA Management of TSF data – Writing of Initialization Data and Prepersonalization
Data
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
INI_ENA
                           The TSF shall restrict the ability to write the Initialization Data and Prepersonaliza-
                           tion Data to the Manufacturer.


FMT_MTD.1/INI_DIS Management of TSF data – Disabling of Read Access to Initialization Data and Pre-
personalization Data
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
INI_DIS
                           The TSF shall restrict the ability to disable read access for users to the Initialization
                           Data to the Personalization Agent.


PP0068v2 application note 49: The TOE may restrict the ability to write the Initialisation Data and the Pre-
personalisation Data by (i) allowing writing these data only once and (ii) blocking the role Manufacturer at
the end of the manufacturing phase. The Manufacturer may write the Initialisation Data (as required by
FAU_SAS.1) including, but being not limited to a unique identification of the IC being used to trace the IC in
the life cycle phases ‘manufacturing’ and ‘issuing’, but being not needed and may be misused in the ‘oper-
ational use’. Therefore, read and use access to the Initialisation Data shall be blocked in the ‘operational
use’ by the Personalisation Agent, when he switches the TOE from the life cycle phase ‘issuing’ to the life
cycle phase ‘operational use’.


FMT_MTD.1/KEY_READ Management of TSF data – Key Read
Hierarchical to:           No other components.



59   [selection: create, load]
60   [assignment: the authorised identified roles]

                                                      69 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
KEY_READ                   The TSF shall restrict the ability to read the
                           1. PACE passwords,
                           2. Chip Authentication Private Key,
                           3. Personalization Agent Keys,
                           to none.
PP application note 45:The SFR FMT_MTD.1/KEY_READ in [PP0056v2] covers the definition in PACE PP
[PP0068v2] and extends it by additional TSF data. This extension does not conflict with the strict conform-
ance to PACE PP.


FMT_MTD.1/PAManagement of TSF data – Personalisation Agent
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/PA             The TSF shall restrict the ability to write the Document Security Object (SOD) to the
                           Personalisation Agent.


PP0068v2 application note 50: By writing SOD into the TOE, the Personalisation Agent confirms (on behalf
of DS) the correctness and genuineness of all the personalisation data related. This consists of user- and
TSF- data.


FMT_MTD.1/AAManagement of TSF data – Active Authentication Private Key
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled byget not covered by the TOE
itself need to be fulfilled by the operational environment of the TOE.
The customer or user of the product shall consider the results of the certification within his
system risk management process. In order for the evolution of attack methods and
techniques to be covered, he should define the period of time until a re-assessment of the
TOE is required and thus requested from the sponsor of the certificate.
The limited validity for the usage of cryptographic algorithms as outlined in chapter 9 has
to be considered by the user and his system risk management process, too.


                                                                                                     22 / 32
BSI-DSZ-CC-0977-V2-2019                                                    Certification Report




Some security measures are partly implemented in this certified TOE, but require
additional configuration or control or measures to be implemented by a product layer on
top, e.g. the IC Dedicated Support Software and/or Embedded Software] using the TOE.
For this reason the TOE includes guidance documentation (see table 2) which contains
obligations and guidelines for the developer of the product layer on top on how to securely
use this certified TOE and which measures have to be implemented in order to fulfil the
security requirements of the Security Target of the TOE. In the course of the evaluation of
the composite product or system it must be examined if the required measures have been
correctly and effectively implemented by the product layer on top. Additionally, the
evaluation of the composite product or system must also consider the evaluation results as
outlined in the document "ETR for composite evaluation" [10].
At the point in time when evaluation and certification results are reused there might be an
update of the document "ETR for composite evaluation" available. Therefore, the certified
products list on the BSI website has to be checked for latest information on
reassessments, recertifications or maintenance result available for the product.

11.     Security Target
For the purpose of publishing, the Security Target [9] of the Target of Evaluation (TOE) is
provided within a separate document as Annex A of this report. It is a sanitised version of
the complete Security Target [6] used for the evaluation performed. Sanitisation was
performed according to the rules as outlined in the relevant CCRA policy (see AIS 35 [4]).

12. Regulation specific aspects (eIDAS, QES)
None

13. Definitions
13.1. Acronyms
AIS           Application Notes and Interpretations of the Scheme
BSI           Bundesamt für Sicherheit in der Informationstechnik / Federal Office for
              Information Security, Bonn, Germany
BSIG          BSI-Gesetz / Act on the Federal Office for Information Security
CCRA          Common Criteria Recognition Arrangement
CC           Common Criteria for IT Security Evaluation
CEM           Common Methodology for Information Technology Security Evaluation
cPP           Collaborative Protection Profile
EAL           Evaluation Assurance Level
ETR           Evaluation Technical Report
IT            Information Technology
ITSEF         Information Technology Security Evaluation Facility
PP            Protection Profile
SAR           Security Assurance Requirement



                                                                                        23 / 32
Certification Report                                                  BSI-DSZ-CC-0977-V2-2019




SFP             Security Function Policy
SFR             Security Functional Requirement
ST              Security Target
TOE             Target of Evaluation
TSF             TOE Security Functionality

13.2. Glossary
Augmentation - The addition of one or more requirement(s) to a package.
Collaborative Protection Profile - A Protection Profile collaboratively developed by an
International Technical Community endorsed by the Management Committee.
Extension - The addition to an ST or PP of functional requirements not contained in CC
part 2 and/or assurance requirements not contained in CC part 3.
Formal - Expressed in a restricted syntax language with defined semantics based on well-
established mathematical concepts.
Informal - Expressed in natural language.
Object - A passive entity in the TOE, that contains or receives information, and upon which
subjects perform operations.
Package - named set of either security functional or security assurance requirements
Protection Profile - A formal document defined in CC, expressing an implementation
independent set of security requirements for a category of IT Products that meet specific
consumer needs.
Security Target - An implementation-dependent statement of security needs for a specific
identified TOE.
Semiformal - Expressed in a restricted syntax language with defined semantics.
Subject - An active entity in the TOE that performs operations on objects.
Target of Evaluation - An IT Product and its associated administrator and user guidance
documentation that is the subject of an Evaluation.
TOE Security Functionality - Combined functionality of all hardware, software, and
firmware of a TOE that must be relied upon for the correct enforcement of the SFRs.

14. Bibliography
[1]     Common Criteria for Information Technology Security Evaluation, Version 3.1,
        Part 1: Introduction and general model, Revision 5, April 2017
        Part 2: Security functional components, Revision 5, April 2017
        Part 3: Security assurance components, Revision 5, April 2017
        https://www.commoncriteriaportal.org
[2]     Common Methodology for Information Technology Security Evaluation (CEM),
        Evaluation Methodology, Version 3.1, Rev. 5, April 2017,
        https://www.commoncriteriaportal.org




                                                                                       24 / 32
BSI-DSZ-CC-0977-V2-2019                                                                     Certification Report




[3]        BSI certification: Scheme documentation describing the certification process (CC-
           Produkte) and Scheme documentation on requirements for the Evaluation Facility,
           approval and licencing (CC-Stellen), https://www.bsi.bund.de/zertifizierung
[4]        Application Notes and Interpretations of the Scheme (AIS) as relevant for the TOE 7
           https://www.bsi.bund.de/AIS
[5]        German IT Security Certificates (BSI 7148), periodically updated list published also
           on the BSI Website, https://www.bsi.bund.de/zertifizierungsreporte
[6]        NXP Secure Smart Card Controller N7021 VA Security Target, BSI-DSZ-CC-0977-
           V2-2019, Version 2.3, 2019-06-04, NXP Semiconductors (confidential document)
[7]        Evaluation Technical Report N7021 VA, BSI-DSZ-CC-0977-V2, Version 4, 2019-07-
           17, TÜV Informationstechnik GmbH (confidential document)
[8]        Security IC Platform Protection Profile with Augmentation Packages Version 1.0, 13
           January 2014, BSI-CC-PP-0084-2014
[9]        NXP Secure Smart Card Controller N7021 VA Security Target Lite, BSI-DSZ-CC-
           0977-V2-2019, Version 2.3, 2019-06-04, NXP Semiconductors (sanitised public
           document)
[10]       Evaluation Technical for Composite Evaluation for the N7021 VA, BSI-DSZ-CC-
           0977-V2 version 4, 2019-07-17, TÜV Informationstechnik GmbH (confidential
           document)

7
    specifically
       •    AIS1, Durchführung der Ortsbesichtigung in der Entwicklungsumgebung des Herstellers, Version 13,
            14.08.2008,
       •    AIS14, Anforderungen an Aufbau und Inhalt der ETR-Teile (Evaluation Technical Report) für
            Evaluationen nach CC (Common Criteria), Version 7, 03.08.2010,
       •    AIS19, Anforderungen an Aufbau und Inhalt der Zusammenfassung des ETR (Evaluation Technical
            Report) für Evaluationen nach CC (Common Criteria) und ITSEC, Version 9, 03.11.2014,
       •    AIS 20, Version 3, Funktionalitätsklassen und Evaluationsmethodologie für deterministische
            Zufallszahlengeneratoren
       •    AIS 25, Version 8, Anwendung der CC auf Integrierte Schaltungen including JIL Document and CC
            Supporting Document
       •    AIS 26, Version 9, Evaluationsmethodologie für in Hardware integrierte Schaltungen including JIL
            Document and CC Supporting Document
       •    AIS 31, Version 3, Funktionalitätsklassen und Evaluationsmethodologie für physikalische
            Zufallszahlengeneratoren
       •    AIS 32, Version 7, CC-Interpretationen im deutschen Zertifizierungsschema
       •    AIS 34, Version 3, Evaluation Methodology for CC Assurance Classes for EAL 5+ (CCv2.3 &
            CCv3.1) and EAL 6 (CCv3.1)
       •    AIS 35, Version 2, Öffentliche Fassung des Security Targets (ST-Lite) including JIL Document and
            CC Supporting Document and CCRA policies
       •    AIS 36, Version 4, Kompositionsevaluierung including JIL Document and CC Supporting Document
       •    AIS 38, Version 2, Reuse of evaluation results
       •    AIS39, Formal Method, Version 3.0, 24.10.2008
       •    AIS46, Informationen zur Evaluierung von kryptographischen Algorithmen und ergänzende Hinweise
            für die Evaluierung von Zufallszahlengeneratoren, Version 3, 04.12.2013.



                                                                                                         25 / 32
Certification Report                                                BSI-DSZ-CC-0977-V2-2019




[11]    SmartMX3 family P71D320 Overview, pinning and electrical characteristics, Product
        data sheet, Version 3.1, 2019-06-04, NXP Semiconductors (confidential document)
[12]    SmartMX3 N7021 Instruction Set Manual, Objective data sheet addendum, Version
        1.4, 2016-09-29, NXP Semiconductors (confidential document)
[13]    SmartMX3 family N7021 Wafer and delivery specification, Objective wafer
        specification, Version 1.3, 2018-05-15, NXP Semiconductors (confidential
        document)
[14]    SmartMX3 N7021 Post Delivery Configuration Post Delivery Configuration,
        Objective data sheet addendum, Version 1.1, 2017-03-22, NXP Semiconductors
        (confidential document)
[15]    SmartMX3 N7021 Chip Health Mode Chip Health Mode, Objective data sheet
        addendum, Version 1.0, 2016-12-06, NXP Semiconductors (confidential document)
[16]    SmartMX3 N7021 Peripheral Configuration and Use Peripheral Configuration and
        Use on the N7021, Objective data sheet addendum, Version 1.4, 2017-11-03, NXP
        Semiconductors (confidential document)
[17]    SmartMX3 N7021 MMU configuration & FW interface Access / resource
        management and security configuration, Data Sheet addendum, Version 1.5, 2017-
        11-03, NXP Semiconductors (confidential document)
[18]    SmartMX3 N7021, Inter-Card Communication Functionality and additional APIs,
        Objective data sheet addendum, Version 1.1, 2017-03-09, NXP Semiconductors
        (confidential document)
[19]    SmartMX3 N7021 NVM Operate Function, Data Sheet addendum, Version 1.0,
        2017-01-13, NXP Semiconductors (confidential document)
[20]    NXP Secure Smart Card Controller N7021 Information on Guidance and Operation,
        Guidance and Operation Manual, Version 1.4, 2019-06-04, NXP Semiconductors
        (confidential document)
[21]    SmartMX3 N7021 FlashLoader, Product Data Sheet addendum, Version 1.3, 2018-
        08-24, NXP Semiconductors (confidential document)
[22]    SmartMX3 N7021 Shared OS Libraries Memory, communication and CRC, including
        guidance and operation, Objective data sheet addendum, Version 1.2, 2017-11-03,
        NXP Semiconductors (confidential document)
[23]    SmartMX3 N7021 NXP System Mode OS Interface UM configuration and
        applications, Objective data sheet addendum, Version 1.6, 2017-11-03, NXP
        Semiconductors (confidential document)
[24]    Crypto Library V1.0 on N7021 VA Symmetric Cipher Library (SymCfg), User manual,
        Version 1.2, 2017-02-13, NXP Semiconductors (confidential document)
[25]    N7021 Crypto Library RNG Library, Product user manual, Version 1.3, 2017-03-27,
        NXP Semiconductors (confidential document)
[26]    N7021 Crypto Library Utils Library, User manual, Version 1.1, 2016-11-28, NXP
        Semiconductors (confidential document)
[27]    Crypto Library Iron on N7021 VA Information on Guidance and Operation, User
        manual, Version 2.0, 2018-11-15, NXP Semiconductors (confidential document)
[28]    Order Entry Form, Version 1.9, 2017-03-27, NXP Semiconductors



                                                                                     26 / 32
BSI-DSZ-CC-0977-V2-2019                                                   Certification Report




[29]   Crypto Library Iron / Cobalt V1.0 on N7021 VA, Life Cycle, Version 1.3, 2017-03-07,
       NXP Semiconductors (confidential document)
[30]   P71D320 Crypto Library, Configuration Item List, Evaluation documentation, Version
       1.0, 2017-03-07, NXP Semiconductors (confidential document)
[31]   NXP Secure Smart Card Controller 7021 VA Evaluation Reference List, Version 2.2,
       2019-07-17, NXP Semiconductors (confidential document)
[32]   NXP Secure Smart Card Controller N7021, Common Criteria CIL, Version 0.5,
       2017-04-06, NXP Semiconductors (confidential document)




                                                                                       27 / 32
Certification Report                                                   BSI-DSZ-CC-0977-V2-2019




C.       Excerpts from the Criteria
For the meaning of the assurance components and levels the following references to the
Common Criteria can be followed:
     •   On conformance claim definitions and descriptions refer to CC part 1 chapter 10.5
     •   On the concept of assurance classes, families and components refer to CC Part 3
         chapter 7.1
     •   On the concept and definition of pre-defined assurance packages (EAL) refer to CC
         Part 3 chapters 7.2 and 8
     •   On the assurance class ASE for Security Target evaluation refer to CC Part 3
         chapter 12
     •   On the detailled definitions of the assurance components for the TOE evaluation
         refer to CC Part 3 chapters 13 to 17
     •   The table in CC part 3 , Annex E summarizes the relationship between the
         evaluation assurance levels (EAL) and the assurance classes, families and
         components.
The CC are published at https://www.commoncriteriaportal.org/cc/




                                                                                        28 / 32
BSI-DSZ-CC-0977-V2-2019                                              Certification Report




D.     Annexes
List of annexes of this certification report
Annex A:      Security Target provided within a separate document.
Annex B:      Evaluation results regarding development
              and production environment




                                                                                  29 / 32
Certification Report                                                           BSI-DSZ-CC-0977-V2-2019




Annex B of Certification Report BSI-DSZ-CC-0977-V2-2019

Evaluation results regarding
development and production
environment


The IT product NXP Secure Smart Card Controller N7021 VA including IC Dedicated
Software (Target of Evaluation, TOE) has been evaluated at an approved evaluation facility
using the Common Methodology for IT Security Evaluation (CEM), Version 3.1 extended
by Scheme Interpretations, by advice of the Certification Body for components beyond
EAL 5 and CC Supporting Documents for conformance to the Common Criteria for IT
Security Evaluation (CC), Version 3.1.
As a result of the TOE certification, dated 31 July 2019, the following results regarding the
development and production environment apply. The Common Criteria assurance
requirements ALC – Life cycle support (i.e. ALC_CMC.5, ALC_CMS.5, ALC_DEL.1,
ALC_DVS.2, ALC_FLR.1, ALC_LCD.1, ALC_TAT.3)
are fulfilled for the development and production sites of the TOE listed below:
   Name of site /
                                     Address                                 Function
  Company name

                       NXP Semiconductors Germany GmbH       SW/HW Development, Delivery, central
                       Troplowitzstr. 20                     design database, ROM/Flash code
NXP Hamburg
                       22529 Hamburg                         handling, configuration of the Fabkey, and
                       Germany                               customer support, CM and Tooling
                       NXP Semiconductors Aust ensure any users are unable to use the following interface travel
                           document’s contactless/contact interface and circuit contacts to gain access to
                           1. PACE session keys (PACE-KMAC, PACE-KEnc),
                           2. the ephemeral private key ephem-SKPICC-PACE
                           3. none



 FPT_FLS.1                 Failure with preservation of secure state

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.

 FPT_FLS.1.1               The TSF shall preserve a secure state when the following types of failures occur:
                           1. Exposure to operating conditions causing a TOE malfunction,
                           2. Failure detected by TSF according to FPT_TST.1,
                           3. none




7.1.4               SFRs specifically from [PP_BAC]
For the dependencies of the SFRs specifically from [PP_BAC] please refer to [PP_BAC] section 6.3.2
“Dependency Rationale”

7.1.4.1             Class FCS: Cryptographic Support


 FCS_CKM.1                 Cryptographic key generation – Generation of Document Basic Access Keys by
                           the TOE

 Hierarchical to:          No other components.

 Dependencies:              [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                           operation]
                           FCS_CKM.4 Cryptographic key destruction

 FCS_CKM.1.1               The TSF shall generate cryptographic keys in accordance with a specified
                           cryptographic key generation algorithm Document Basic Access Key Derivation
                           Algorithm and specified cryptographic key sizes 112 bit that meet the following:
                           [ICAO_9303_01], normative appendix 5



CC Document                                           31
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_COP.1/SHA            Cryptographic operation – Hash for Key Derivation

 Hierarchical to:         No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SHA          The TSF shall perform hashing in accordance with a specified cryptographic
                          algorithm SHA-1 and cryptographic key sizes none that meet the following:
                          [NIST_Hash]




 FCS_COP.1/ENC            Cryptographic operation – Encryption / Decryption Triple DES

 Hierarchical to:         No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ENC          The TSF shall perform secure messaging (BAC) – encryption and decryption in
                          accordance with a specified cryptographic algorithm Triple-DES in CBC mode and
                          cryptographic key sizes 112 bit that meet the following: [NIST_DES] and
                          [ICAO_9303_01]; normative appendix 5, A 5.3




 FCS_COP.1/AUTH            Cryptographic operation – Authentication

 Hierarchical to:          No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                           FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/AUTH         The TSF shall perform symmetric authentication – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and cryptographic key
                          sizes 256 bits that meet the following: [FIPS_197].




CC Document                                          32
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_COP.1/MAC            Cryptographic operation – Retail MAC

 Hierarchical to:         No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Importof
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/MAC          The TSF shall perform secure messaging – message authentication code in
                          accordance with a specified cryptographic algorithm Retail MAC and
                          cryptographic key sizes 112 bit that meet the following: ISO 9797 (MAC algorithm
                          3, block cipher DES, Sequence Message Counter, padding mode 2)




7.1.4.2             Class FIA Identification and Authentication


 FIA_UID.1                Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.


 FIA_UID.1.1              The TSF shall allow
                          1.   to read the Initialization Data in Phase 2 “Manufacturing”,
                          2.   to read the random identifier in Phase 3 “Personalisation of the MRTD”,
                          3.   to read the random identifier in Phase 4 “Operational Use”
                          5.   on behalf of the user to be performed before the user is identified.

 FIA_UID.1.2              The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1                Timing of authentication

CC Document                                           33
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1              The TSF shall allow
                          1. to read the Initialization Data in Phase 2 “Manufacturing”,
                          2. to read the random identifier in Phase 3 “Personalisation of the MRTD”,
                          3. to read the random identifier in Phase 4 “Operational Use”
                          on behalf of the user to be performed before the user is authenticated.

 FIA_UAU.1.2              The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




 FIA_UAU.4                Single-use authentication mechanisms - Single-use authentication of the
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1              The TSF shall prevent reuse of authentication data related to
                          1. Basic Access Control Authentication Mechanism,
                          2. Authentication Mechanism based on Triple-DES and AES.



 FIA_UAU.5                Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1              The TSF shall provide
                          1. Basic Access Control Authentication Mechanism
                          2. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                             length
                          to support user authentication.

 FIA_UAU.5.2              The TSF shall authenticate any user’s claimed identity according to the following
                          rules:




CC Document                                          34
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. the TOE accepts the authentication attempt as Personalisation Agent by one of
                             the following mechanism(s): the Symmetric Authentication Mechanism based
                             on scp03 AES 256 bits key length with the Personalisation Agent Key.
                          2. the TOE accepts the authentication attempt as Basic Inspection System only by
                             means of the Basic Access Control Authentication Mechanism with the
                             Document Basic Access Keys.

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6                Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.6.1              The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE during a BAC mechanism based communication after successful
                          authentication of the terminal with Basic Access Control Authentication
                          Mechanism.




 FIA_AFL.1                Authentication failure handling

 Hierarchical to:         No other components.

 Dependencies:            FIA_UAU.1 Timing of authentication

 FIA_AFL.1.1              The TSF shall detect when a configurable number (see application note below) of
                          unsuccessful authentication attempts occur related to authentication attempts
                          using the BAC password as shared password.

 FIA_AFL.1.2              When the defined number of unsuccessful authentication attempts has been met
                          the TSF shall increasingly slow down the performance up to a maximum not
                          higher than 7 seconds verifying the authentication token.

 [IFX specific]           The number of failed authentication attempts is configurable. This configurable
                          number can be in the range [1..7f].
 Application note




CC Document                                          35
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.3             Class FDP User Data Protection


 FDP_ACC.1                Subset access control – Basic Access control

 Hierarchical to:         No other components

 Dependencies:            FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1              The TSF shall enforce the Basic Access Control SFP on terminals gaining write,
                          read and modification access to data in the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of
                          the logical MRTD.




 FDP_ACF.1                Basic Security attribute based access control – Basic Access Control

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACC.1 Subset access control, FMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1              The TSF shall enforce the Basic Access Control SFP to objects based on the
                          following:
                          1. Subjects:
                                                     a) Personalisation Agent,
                                                     b) Basic Inspection System,
                                                     c) Terminal,
                          2. Objects
                                                     a) data EF.DG1 to EF.DG16 of the logical MRTD,
                                                     b) data in EF.COM,
                                                     c) data in EF.SOD,
                          3. Security attributes
                                                     a) authentication status of terminals

 FDP_ACF.1.2              The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed:
                          1. the successfully authenticated Personalisation Agent is allowed to write and to
                             read the data of the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of the logical MRTD,
                          2. the successfully authenticated Basic Inspection System is allowed to read the
                             data in EF.COM, EF.SOD, EF.DG1, EF.DG2 and EF.DG5 to EF.DG16 of the logical
                             MRTD.

 FDP_ACF.1.3              The TSF shall explicitly authorise access of subjects to objects based on the
                          following additional rules: none.


CC Document                                           36
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_ACF.1.4              The TSF shall explicitly deny access of subjects to objects based on the rule:
                          1. Any terminal is not allowed to modify any of the EF.DG1 to EF.DG16 of the
                             logical MRTD.
                          2. Any terminal is not allowed to read any of the EF.DG1 to EF.DG16 of the logical
                             MRTD.
                          The Basic Inspection System is not allowed to read the data in EF.DG3 and EF.DG4.

 Refinement:              This SFR was refined (deletion of 3. from the list of Objects) as the optional EF.DG3
                          and EF.DG4 are not created and therefore do not exist.




 FDP_UCT.1                Basic data exchange confidentiality - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]

 FDP_UCT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from unauthorized disclosure.




 FDP_UIT.1                Data exchange integrity - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                          [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]

 FDP_UIT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from modification, deletion, insertion and
                          replay errors.

 FDP_UIT.1.2              The TSF shall be able to determine on receipt of user data, whether modification,
                          deletion, insertion and replay has occurred.




CC Document                                           37
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.4             Class FAU Security Audit


 FAU_SAS.1/BAC            Audit storage

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FAU_SAS.1.1/BAC          The TSF shall provide the Manufacturer with the capability to store the IC
                          Identification Data in the audit records.




7.1.4.5             Class FMT Security Management


 FMT_SMF.1/BAC            Specification of Management Functions

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies

 FMT_SMF.1.1/BAC          The TSF shall be capable of performing the following management functions:
                          1. Initialization,
                          2. Pre-Personalisation,
                          3. Personalisation.



 FMT_SMR.1                Security roles

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE

 FMT_SMR.1.1              The TSF shall maintain the roles
                          1. Manufacturer,
                          2. Personalisation Agent,
                          3. Basic Inspection System


CC Document                                          38
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_SMR.1.2              The TSF shall be able to associate users with roles.




 FMT_LIM.1/BAC            Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability: fulfilled by FMT_LIM.2

 FMT_LIM.1.1 /BAC         The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with ‘Limited availability (FMT_LIM.2) the following policy is enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks




 FMT_LIM.2/BAC            Limited availability

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.1 Limited capabilities: fulfilled by FMT_LIM.

 FMT_LIM.2.1/BAC          The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with ‘Limited capabilities (FMT_LIM.1)’ the following policy is
                          enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks



 FMT_MTD.1/INI_DIS/BAC         Management of TSF data – Reading and Using Initialisation and Pre-
                               Personalisation Data

 Hierarchical to:              No other components.


CC Document                                           39
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:               FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                             FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/INI_DIS/BAC     The TSF shall restrict the ability to disable read access for users to the
                             Initialisation Data to the Personalisation Agent.




 FMT_MTD.1/KEY_WRITE        Management of TSF data – Key Write

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_WRITE      The TSF shall restrict the ability to write the Document Basic Access Keys to the
                            Personalisation Agent.




 FMT_MTD.1/KEY_READ/BAC         Management of TSF data – Key Read

 Hierarchical to:               No other components.

 Dependencies:                  FMT_SMF.1 Specification of management functions fulfilled by FMT_SMF.1
                                FMT_SMR.1 Security roles fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/KEY_READ/BAC       The TSF shall restrict the ability to read the Document Basic Access Keys and
                                Personalisation Agent Keys to none.




7.1.4.6             Class FPT Protection of the Security Functions


 FPT_EMSEC.1              TOE Emanation

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies.

CC Document                                           40
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMSEC.1.1            The TOE shall not emit electromagnetic and current emissions in excess of none
                          useful information enabling access to Personalisation Agent Key(s) and Document
                          Basic Access Keys

 FPT_EMSEC.1.2            The TSF shall ensure any unauthorized users are unable to use the following
                          interface smart card circuit contacts to gain access to Personalisation Agent Key(s)
                          and Document Basic Access Keys.




 FPT_FLS.1/BAC            Failure with preservation of secure state

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_FLS.1.1              The TSF shall preserve a secure state when the following types of failures occur:
                          1. Exposure to out-of-range operating conditions where therefore a malfunction
                             could occur,
                          2. Failure detected by TSF according to FPT_TST.1,




7.1.5               SFRs specifically from [PP_EAC]

7.1.5.1             Cryptographic support


 FCS_CKM.1/CA             Cryptographic key generation – Diffie-Hellman for Chip Authentication
                          session keys

 Hierarchical to:          No other components.

 Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                          operation]




CC Document                                          41
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_CKM.1.1/CA           The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm ECDH cryptographic key generation
                          algorithm and specified cryptographic key sizes:
                          id-CA-ECDH-3DES-CBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or FCS_CKM.1


CC Document                                          43
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                                        Cryptographic key generation]FCS_CKM.4 Cryptographic key
                                        destruction

 FCS_COP.1.1/CA_MAC                     The TSF shall perform secure messaging – message authentication
                                        code in accordance with a specified cryptographic algorithm AES CMAC
                                        and 3DES-CBC and cryptographic key sizes 128, 192, 256 bits for AES
                                        CMAC and 112 for 3DES-CBC that meet the following: compliant to
                                        [ICAO_SAC] .


                                        Personalisation of the TOE is done using the secure channel protocol
 [IFX specific]
                                        03 as specified in [GPv2_3_1] with AES 256 bits key length with CMAC
 Application note                       compliant with NIST 800-38A.




7.1.5.3             Class FIA Identification and Authentication


The following table provides an overview of the authentication mechanisms used.

 Name                                                               SFR for the TOE

 Authentication Mechanism for Personalisation Agents                FIA_UAU.4/PACE
 Chip authentication v.1                                            FIA_API.1,
                                                                    FIA_UAU.5/PACE,
                                                                    FIA_UAU.6/EAC

 Chip Active Authentication                                         FIA_API.1/AA
 Terminal Authentication Protocol v.1                               FIA_UAU.5/PACE
 PACE protocol (listed only for information purposes, so will not   FIA_UAU.1/PACE
 be described further in this section)                              FIA_UAU.5/PACE
                                                                    FIA_AFL.1/PACE

 Passive authentication                                             FIA_UAU.5/PACE




 FIA_API.1/AA              Authentication Proof of Identity (Active Authentication)

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.


CC Document                                            44
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          The TSF shall provide the Active Authentication Mechanisms according to
 FIA_API.1.1/AA
                          [ICAO_9303_1] to prove the identity of the TOE.


 [IFX specific]           The SFR FIA_API.1/AA has been included in this security target in addition to the
 Application Note:        SFRs defined by the Protection Profiles claimed in section 3.2. This extension does
                          not conflict with the strict conformance to the claimed Protection Profiles.




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110_1]
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-03110_1]
                          (see next item 6)
                           6. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is identified.


 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel


CC Document                                            45
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key
                          5. to carry out the Chip Authentication Protocol Version 1 according to [TR-
                          03110_1]
                          6. to carry out the Terminal Authentication Protocol Version 1 according to [TR-
                          03110_1] (see next item 7)
                           7. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is authenticated.



 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




                          Single-use authentication mechanisms - Single-use authentication of the
 FIA_UAU.4/PACE
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according [ICAO_SAC],
                          2. Authentication Mechanism based on Triple- DES or AES .
                          3. Terminal Authentication Protocol v.1 according to [TR-03110_1].




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide

CC Document                                            46
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. PACE Protocol according to [ICAO_SAC],
                          2. Passive Authentication according to [ICAO_9303_01],
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC],
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                              length
                          5. Terminal Authentication Protocol v.1 according to [TR-03110_1],
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                          commands with correct message authentication code sent by means of secure
                          messaging with the key agreed with the terminal by means of the PACE protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by secure
                          channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key length.
                          3. After run of the Chip Authentication Protocol Version 1 the TOE accepts only
                          received commands with correct message authentication code sent by means of
                          secure messaging with key agreed with the terminal by means of the Chip
                          Authentication Mechanism v1.
                          4. The TOE accepts the authentication attempt by means of the Terminal
                          Authentication Protocol v.1 only if the terminal uses the public key presented
                          during the Chip Authentication Protc key destruction

 FCS_COP.1.1/MAC          The TSF shall perform secure messaging – message authentication code in
                          accordance with a specified cryptographic algorithm Retail MAC and
                          cryptographic key sizes 112 bit that meet the following: ISO 9797 (MAC algorithm
                          3, block cipher DES, Sequence Message Counter, padding mode 2)




7.1.4.2             Class FIA Identification and Authentication


 FIA_UID.1                Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.


 FIA_UID.1.1              The TSF shall allow
                          1.   to read the Initialization Data in Phase 2 “Manufacturing”,
                          2.   to read the random identifier in Phase 3 “Personalisation of the MRTD”,
                          3.   to read the random identifier in Phase 4 “Operational Use”
                          5.   on behalf of the user to be performed before the user is identified.

 FIA_UID.1.2              The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1                Timing of authentication

CC Document                                           33
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1              The TSF shall allow
                          1. to read the Initialization Data in Phase 2 “Manufacturing”,
                          2. to read the random identifier in Phase 3 “Personalisation of the MRTD”,
                          3. to read the random identifier in Phase 4 “Operational Use”
                          on behalf of the user to be performed before the user is authenticated.

 FIA_UAU.1.2              The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




 FIA_UAU.4                Single-use authentication mechanisms - Single-use authentication of the
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1              The TSF shall prevent reuse of authentication data related to
                          1. Basic Access Control Authentication Mechanism,
                          2. Authentication Mechanism based on Triple-DES and AES.



 FIA_UAU.5                Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1              The TSF shall provide
                          1. Basic Access Control Authentication Mechanism
                          2. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                             length
                          to support user authentication.

 FIA_UAU.5.2              The TSF shall authenticate any user’s claimed identity according to the following
                          rules:




CC Document                                          34
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. the TOE accepts the authentication attempt as Personalisation Agent by one of
                             the following mechanism(s): the Symmetric Authentication Mechanism based
                             on scp03 AES 256 bits key length with the Personalisation Agent Key.
                          2. the TOE accepts the authentication attempt as Basic Inspection System only by
                             means of the Basic Access Control Authentication Mechanism with the
                             Document Basic Access Keys.

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6                Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.6.1              The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE during a BAC mechanism based communication after successful
                          authentication of the terminal with Basic Access Control Authentication
                          Mechanism.




 FIA_AFL.1                Authentication failure handling

 Hierarchical to:         No other components.

 Dependencies:            FIA_UAU.1 Timing of authentication

 FIA_AFL.1.1              The TSF shall detect when a configurable number (see application note below) of
                          unsuccessful authentication attempts occur related to authentication attempts
                          using the BAC password as shared password.

 FIA_AFL.1.2              When the defined number of unsuccessful authentication attempts has been met
                          the TSF shall increasingly slow down the performance up to a maximum not
                          higher than 7 seconds verifying the authentication token.

 [IFX specific]           The number of failed authentication attempts is configurable. This configurable
                          number can be in the range [1..7f].
 Application note




CC Document                                          35
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.3             Class FDP User Data Protection


 FDP_ACC.1                Subset access control – Basic Access control

 Hierarchical to:         No other components

 Dependencies:            FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1              The TSF shall enforce the Basic Access Control SFP on terminals gaining write,
                          read and modification access to data in the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of
                          the logical MRTD.




 FDP_ACF.1                Basic Security attribute based access control – Basic Access Control

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACC.1 Subset access control, FMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1              The TSF shall enforce the Basic Access Control SFP to objects based on the
                          following:
                          1. Subjects:
                                                     a) Personalisation Agent,
                                                     b) Basic Inspection System,
                                                     c) Terminal,
                          2. Objects
                                                     a) data EF.DG1 to EF.DG16 of the logical MRTD,
                                                     b) data in EF.COM,
                                                     c) data in EF.SOD,
                          3. Security attributes
                                                     a) authentication status of terminals

 FDP_ACF.1.2              The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed:
                          1. the successfully authenticated Personalisation Agent is allowed to write and to
                             read the data of the EF.COM, EF.SOD, EF.DG1 to EF.DG16 of the logical MRTD,
                          2. the successfully authenticated Basic Inspection System is allowed to read the
                             data in EF.COM, EF.SOD, EF.DG1, EF.DG2 and EF.DG5 to EF.DG16 of the logical
                             MRTD.

 FDP_ACF.1.3              The TSF shall explicitly authorise access of subjects to objects based on the
                          following additional rules: none.


CC Document                                           36
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_ACF.1.4              The TSF shall explicitly deny access of subjects to objects based on the rule:
                          1. Any terminal is not allowed to modify any of the EF.DG1 to EF.DG16 of the
                             logical MRTD.
                          2. Any terminal is not allowed to read any of the EF.DG1 to EF.DG16 of the logical
                             MRTD.
                          The Basic Inspection System is not allowed to read the data in EF.DG3 and EF.DG4.

 Refinement:              This SFR was refined (deletion of 3. from the list of Objects) as the optional EF.DG3
                          and EF.DG4 are not created and therefore do not exist.




 FDP_UCT.1                Basic data exchange confidentiality - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                          [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]

 FDP_UCT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from unauthorized disclosure.




 FDP_UIT.1                Data exchange integrity - MRTD

 Hierarchical to:         No other components.

 Dependencies:            [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
                          [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]

 FDP_UIT.1.1              The TSF shall enforce the Basic Access Control SFP to be able to transmit and
                          receive user data in a manner protected from modification, deletion, insertion and
                          replay errors.

 FDP_UIT.1.2              The TSF shall be able to determine on receipt of user data, whether modification,
                          deletion, insertion and replay has occurred.




CC Document                                           37
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.4.4             Class FAU Security Audit


 FAU_SAS.1/BAC            Audit storage

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FAU_SAS.1.1/BAC          The TSF shall provide the Manufacturer with the capability to store the IC
                          Identification Data in the audit records.




7.1.4.5             Class FMT Security Management


 FMT_SMF.1/BAC            Specification of Management Functions

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies

 FMT_SMF.1.1/BAC          The TSF shall be capable of performing the following management functions:
                          1. Initialization,
                          2. Pre-Personalisation,
                          3. Personalisation.



 FMT_SMR.1                Security roles

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE

 FMT_SMR.1.1              The TSF shall maintain the roles
                          1. Manufacturer,
                          2. Personalisation Agent,
                          3. Basic Inspection System


CC Document                                          38
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_SMR.1.2              The TSF shall be able to associate users with roles.




 FMT_LIM.1/BAC            Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability: fulfilled by FMT_LIM.2

 FMT_LIM.1.1 /BAC         The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with ‘Limited availability (FMT_LIM.2) the following policy is enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks




 FMT_LIM.2/BAC            Limited availability

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.1 Limited capabilities: fulfilled by FMT_LIM.

 FMT_LIM.2.1/BAC          The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with ‘Limited capabilities (FMT_LIM.1)’ the following policy is
                          enforced:
                          Deploying test features after TOE delivery do not allow
                          1.   User Data to be disclosed or manipulated,
                          2.   TSF data to be disclosed or manipulated,
                          3.   software to be reconstructed and
                          4.   substantial information about construction of TSF to be gathered which may
                               enable other attacks



 FMT_MTD.1/INI_DIS/BAC         Management of TSF data – Reading and Using Initialisation and Pre-
                               Personalisation Data

 Hierarchical to:              No other components.


CC Document                                           39
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:               FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                             FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/INI_DIS/BAC     The TSF shall restrict the ability to disable read access for users to the
                             Initialisation Data to the Personalisation Agent.




 FMT_MTD.1/KEY_WRITE        Management of TSF data – Key Write

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_WRITE      The TSF shall restrict the ability to write the Document Basic Access Keys to the
                            Personalisation Agent.




 FMT_MTD.1/KEY_READ/BAC         Management of TSF data – Key Read

 Hierarchical to:               No other components.

 Dependencies:                  FMT_SMF.1 Specification of management functions fulfilled by FMT_SMF.1
                                FMT_SMR.1 Security roles fulfilled by FMT_SMR.1/PACE

 FMT_MTD.1.1/KEY_READ/BAC       The TSF shall restrict the ability to read the Document Basic Access Keys and
                                Personalisation Agent Keys to none.




7.1.4.6             Class FPT Protection of the Security Functions


 FPT_EMSEC.1              TOE Emanation

 Hierarchical to:         No other components.

 Dependencies:            No Dependencies.

CC Document                                           40
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMSEC.1.1            The TOE shall not emit electromagnetic and current emissions in excess of none
                          useful information enabling access to Personalisation Agent Key(s) and Document
                          Basic Access Keys

 FPT_EMSEC.1.2            The TSF shall ensure any unauthorized users are unable to use the following
                          interface smart card circuit contacts to gain access to Personalisation Agent Key(s)
                          and Document Basic Access Keys.




 FPT_FLS.1/BAC            Failure with preservation of secure state

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_FLS.1.1              The TSF shall preserve a secure state when the following types of failures occur:
                          1. Exposure to out-of-range operating conditions where therefore a malfunction
                             could occur,
                          2. Failure detected by TSF according to FPT_TST.1,




7.1.5               SFRs specifically from [PP_EAC]

7.1.5.1             Cryptographic support


 FCS_CKM.1/CA             Cryptographic key generation – Diffie-Hellman for Chip Authentication
                          session keys

 Hierarchical to:          No other components.

 Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                          operation]




CC Document                                          41
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_CKM.1.1/CA           The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm ECDH cryptographic key generation
                          algorithm and specified cryptographic key sizes:
                          id-CA-ECDH-3DES-CBC-CBC 112 bits,
                          id-CA-ECDH-AES-CBC-CMAC-128 128 bits,
                          id-CA-ECDH-AES-CBC-CMAC-192 192 bits,
                          id-CA-ECDH-AES-CBC-CMAC-256 256 bits
                          that meet the following: ECDH protocol compliant to [TR_ECC].




7.1.5.2             Cryptographic operations


 FCS_COP.1/CA_ENC          Cryptographic operation – Symmetric Encryption / Decryption

 Hierarchical to:          No other components.

 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ CA_ENC      The TSF shall perform secure messaging – encryption and decryption in
                          accordance with a specified cryptographic algorithm AES and 3DES in CBC mode
                          and cryptographic key sizes 112, 128, 192 and 256 bit that meet the following:
                          compliant to [TR-03110_1].

 [IFX specific]           Personalisation of the TOE is done using the secure channel protocol scp 03 as
 Application note         specified in [GPv2_3_1] with AES 256 bits key length with command encryption
                          compliant with NIST 800-38A.




 FCS_COP.1/SIG_VER         Cryptographic operation – Signature verification by travel document

 Hierarchical to:          No other components.




CC Document                                          42
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                          user data with security attributes, or FCS_CKM.1 Cryptographic key
                          generation]FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SIG_VER      The TSF shall perform digital signature verification in accordance with a specified
                           cryptographic algorithm ECDSA and cryptographic key sizes :
                          id-TA-ECDSA-SHA1 192 bits,
                          id-TA-ECDSA-SHA224 224, 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA256 256, 320, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA384, 384, 512 and 521 bits,
                          id-TA-ECDSA-SHA512, 512 and 521 bits
                          that meet the following: [TR-03110_1].



 FCS_COP.1/SIG_GEN        Cryptographic operation – Signature generation by MRTD (AA)

 Hierarchical to:         No other components.

                          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
 Dependencies:
                          user data with security attributes, or FCS_CKM.1 Cryptographic key generation]
                          FCS_CKM.4 Cryptographic key destruction
                          The TSF shall perform digital signature generation in accordance with a specified
 FCS_COP.1.1/SIG_GEN
                          cryptographic algorithm:
                          RSA based Digital Signature scheme 1 with SHA1,SHA224,SHA256,SHA384 or
                          SHA512 with RSA CRT 1024 to 2048 key length bits
                          or
                          ECDSA with SHA1,SHA224,SHA256,SHA384 or SHA512 and cryptographic key
                          sizes of 192, 224, 256, 320, 384, 512 or 521 bits;
                          that meet the following:
                          [ISO9796-2] for RSA signatures and [TR-03110_1] for ECDSA.

 [IFXspecific]            The TOE performs digital signature generation with RSA or ECDSA. This SFR has
                          been included in this security target in addition to the SFRs defined by the
 Application Note:        Protection Profiles claimed in section 2.2. The digital signature creation is
                          necessary to allow Active Authentication (AA). This extension does not conflict
                          with the strict conformance to the claimed Protection Profiles.




 FCS_COP.1/CA_MAC                    Cryptographic operation – MAC

 Hierarchical to:                    No other components

 Dependencies:                       [FDP_ITC.1 Import of user data without security attributes, or
                                     FDP_ITC.2 Import of user data with security attributes, or FCS_CKM.1


CC Document                                          43
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                                        Cryptographic key generation]FCS_CKM.4 Cryptographic key
                                        destruction

 FCS_COP.1.1/CA_MAC                     The TSF shall perform secure messaging – message authentication
                                        code in accordance with a specified cryptographic algorithm AES CMAC
                                        and 3DES-CBC and cryptographic key sizes 128, 192, 256 bits for AES
                                        CMAC and 112 for 3DES-CBC that meet the following: compliant to
                                        [ICAO_SAC] .


                                        Personalisation of the TOE is done using the secure channel protocol
 [IFX specific]
                                        03 as specified in [GPv2_3_1] with AES 256 bits key length with CMAC
 Application note                       compliant with NIST 800-38A.




7.1.5.3             Class FIA Identification and Authentication


The following table provides an overview of the authentication mechanisms used.

 Name                                                               SFR for the TOE

 Authentication Mechanism for Personalisation Agents                FIA_UAU.4/PACE
 Chip authentication v.1                                            FIA_API.1,
                                                                    FIA_UAU.5/PACE,
                                                                    FIA_UAU.6/EAC

 Chip Active Authentication                                         FIA_API.1/AA
 Terminal Authentication Protocol v.1                               FIA_UAU.5/PACE
 PACE protocol (listed only for information purposes, so will not   FIA_UAU.1/PACE
 be described further in this section)                              FIA_UAU.5/PACE
                                                                    FIA_AFL.1/PACE

 Passive authentication                                             FIA_UAU.5/PACE




 FIA_API.1/AA              Authentication Proof of Identity (Active Authentication)

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.


CC Document                                            44
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          The TSF shall provide the Active Authentication Mechanisms according to
 FIA_API.1.1/AA
                          [ICAO_9303_1] to prove the identity of the TOE.


 [IFX specific]           The SFR FIA_API.1/AA has been included in this security target in addition to the
 Application Note:        SFRs defined by the Protection Profiles claimed in section 3.2. This extension does
                          not conflict with the strict conformance to the claimed Protection Profiles.




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110_1]
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-03110_1]
                          (see next item 6)
                           6. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is identified.


 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification.

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish the communication channel


CC Document                                            45
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                          FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key
                          5. to carry out the Chip Authentication Protocol Version 1 according to [TR-
                          03110_1]
                          6. to carry out the Terminal Authentication Protocol Version 1 according to [TR-
                          03110_1] (see next item 7)
                           7. to carry out the Active Authentication Mechanism
                          on behalf of the user to be performed before the user is authenticated.



 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




                          Single-use authentication mechanisms - Single-use authentication of the
 FIA_UAU.4/PACE
                          Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according [ICAO_SAC],
                          2. Authentication Mechanism based on Triple- DES or AES .
                          3. Terminal Authentication Protocol v.1 according to [TR-03110_1].




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide

CC Document                                            46
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. PACE Protocol according to [ICAO_SAC],
                          2. Passive Authentication according to [ICAO_9303_01],
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC],
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                              length
                          5. Terminal Authentication Protocol v.1 according to [TR-03110_1],
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                          commands with correct message authentication code sent by means of secure
                          messaging with the key agreed with the terminal by means of the PACE protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by secure
                          channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key length.
                          3. After run of the Chip Authentication Protocol Version 1 the TOE accepts only
                          received commands with correct message authentication code sent by means of
                          secure messaging with key agreed with the terminal by means of the Chip
                          Authentication Mechanism v1.
                          4. The TOE accepts the authentication attempt by means of the Terminal
                          Authentication Protocol v.1 only if the terminal uses the public key presented
                          during the Chip Authentication Protocol v.1 and the secure messaging established
                          by the Chip Authentication Mechanism v.1 19.
                          5. None

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6/EAC            Re-authenticating – Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.




CC Document                                          47
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE after successful run of the Chip Authentication Protocol Version 1 shall
                          be verified as being sent by the Inspection System.




 FIA_API.1                 Authentication Proof of Identity

 Hierarchical to:          No other components.

 Dependencies:             No dependencies.

 FIA_API.1.1              The TSF shall provide a Chip Authentication Protocol Version 1 according to [TR-
                          03110_1] to prove the identity of the TOE.




7.1.5.4             Class User Data Protection


 FDP_ACC.1/TRM             Subset access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1/TRM          The TSF shall enforce the Access Control SFP on terminals gaining access to the
                          User Data and data stored in EF.SOD of the logical travel document



The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below
(Common Criteria Part 2).



 FDP_ACF.1/TRM             Security attribute based access control

 Hierarchical to:          No other components.

 Dependencies:             FDP_ACC.1 Subset access controlFMT_MSA.3 Static attribute initialization

 FDP_ACF.1.1/TRM           The TSF shall enforce the Access Control SFP to objects based on the following:

CC Document                                          48
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          1. Subjects:
                            a.Terminal,
                            b.BIS-PACE
                            c.Extended Inspection System
                          2. Objects:
                             a.data in EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                          logical travel document ,
                            b.data in EF.DG3 of the logical travel document ,
                            c.data in EF.DG4 of the logical travel document ,
                            d.all TOE intrinsic secret cryptographic keys stored in the travel document
                          3. Security attributes:
                            a.PACE Authentication
                            b.Terminal Authentication v.1
                            c.Authorisation of the Terminal.

 FDP_ACF.1.2/TRM          The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed: A BIS-PACE is allowed to
                          read data objects from FDP_ACF.1.1/TRM according to [4] after a successful PACE
                          authentication as required by FIA_UAU.1/PACE.

 FDP_ACF.1.3/TRM          The TSF shall explicitly authorize access of subjects to objects based on the
                          following additional rules: none.

 FDP_ACF.1.4/TRM          The TSF shall explicitly deny access of subjects to objects based on the following
                          additional rules:
                          1.Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                          allowed to read, to write, to modify, to use any User Data stored on the travel
                          document.
                          2.Terminals not using secure messaging are not allowed to read, to write, to
                          modify, to use any data stored on the travel document.
                          3.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 3 (Fingerprint) granted by the relative
                          certificate holder authorization encoding is not allowed to read the data objects
                          2b) of FDP_ACF.1.1/TRM.
                          4.Any terminal being not successfully authenticated as Extended Inspection
                          System with the Read access to DG 4 (Iris) granted by the relative certificate holder
                          authorization encoding is not allowed to read the data objects 2c) of
                          FDP_ACF.1.1/TRM.
                          5.Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.

CC Document                                           49
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          6.Terminals authenticated as CVCA or as DV are not allowed to read data in the
                          EF.DG3 and EF.DG4 .




7.1.5.5             Class FMT Security Management


 FMT_SMR.1/PACE            Security roles

 Hierarchical to:          No other components.

 Dependencies:             FIA_UID.1 Timing of identification.

 FMT_SMR.1.1/PACE          The TSF shall maintain the roles
                           1.Manufacturer ,
                           2.Personalisation Agent,
                           3.Terminal,
                           4.PACE authenticated BIS-PACE,
                           5.Country Verifying Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            D.1/CAPK, FMT_MTD.1/KEY_READ,
                                                                                        6.3.1
                                      FIA_API.1/CA, FMT_MTD.1/AAPK, FIA_API.1/AA,
                                      FCS_COP.1/SIG_GEN
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/SIG_VER,
                                      FCS_COP.1/PACE_ENC, FCS_COP.1/PACE_MAC,
                                      FCS_COP.1/CA_ENC, FCS_COP.1/CA_MAC,
                                      FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                      FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                      FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                      FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                      FDP_RIP.1/POLY, FDP_RIP.1, FDP_ACC.1/POLY,
                                      FDP_ACF.1/POLY, FDP_ACC.1/TRM, FDP_ACF.1/TRM,
                                      FDP_UCT.1/TRM, FDP_UIT.1/TRM, FTP_ITC.1/PACE,     Section
OT.Polymorphic_Data_Confidentiality
                                      FMT_SMF.1, FMT_SMR.1/POLY,                        6.3.1
                                      FMT_MTD.1/CVCA_INI, FMT_MTD.1/CVCA_UPD,
                                      FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                      FMT_MTD.1/KEY_READ, FMT_MTD.1/PI_PP_CPI_Read,
                                      FMT_MTD.1/PI_PP_CPI_Load,
                                      FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                      FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                      FCS_CKM.1/CA, FIA_UAU.6/POLY, FMT_MTD.3,
                                      FCS_CKM.4, FIA_UAU.5/POLY, FCS_CKM.1/POLY,
                                      FCS_COP.1/POLY
                                      FCS_CKM.1/DH_PACE, FCS_COP.1/CA_ENC,
                                      FCS_COP.1/CA_MAC, FCS_RND.1,
                                      FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                      FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,       Section
OT.Polymorphic_Data_Integrity
                                      FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,   6.3.1
                                      FIA_UAU.6/EAC, FDP_RIP.1/POLY, FDP_RIP.1,
                                      FDP_ACC.1/POLY, FDP_ACF.1/POLY, FDP_ACC.1/TRM,
                                      FDP_ACF.1/TRM, FDP_UCT.1/TRM, FDP_UIT.1/TRM,
                             Security Target Lite
                                                                            Ref.:
                      IDeal Pass v2.3-n JC with Privacy
                                                                     2018_2000036361
                      Protection (SAC/EAC/Polymorphic
                                                                       Page: 118/150
                            eMRTD Configuration)

                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,
                                   FMT_MTD.1/PA, FMT_MTD.1/CAPK,
                                   FMT_MTD.1/KEY_READ, FPT_PHP.3,
                                   FMT_MTD.1/PI_PP_CPI_Read,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/PACE_MAC,
                                   FCS_RND.1, FIA_AFL.1/Suspend_PIN,
                                   FIA_AFL.1/Block_PIN, FIA_AFL.1/Suspend_PUK,
                                   FIA_AFL.1/Block_PUK, FIA_UID.1/POLY,
                                   FIA_UAU.1/POLY, FIA_UAU.4/POLY, FIA_UAU.6/EAC,
                                   FIA_AFL.1/PACE, FDP_RIP.1/POLY, FDP_RIP.1,        Section
OT.Polymorphic_Data_Authenticity
                                   FTP_ITC.1/PACE, FMT_SMF.1, FMT_SMR.1/POLY,        6.3.1
                                   FMT_MTD.1/PA, FMT_MTD.1/KEY_READ,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY, FCS_CKM.1/POLY, FCS_COP.1/POLY
                                   FCS_CKM.1/DH_PACE, FCS_COP.1/POLY,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                                                                     Section
OT.Polymorphic_Data_Privacy        FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                                                                     6.3.1
                                   FMT_MTD.1/PI_PP_CPI_Read, FPR_ANO.1,
                                   FPR_UNL.1, FCS_CKM.4, FCS_CKM.1/POLY
                                   FCS_COP.1/SIG_VER, FCS_COP.1/CA_ENC,
                                   FCS_COP.1/CA_MAC, FCS_RND.1,
                                   FIA_AFL.1/Suspend_PIN, FIA_AFL.1/Block_PIN,
                                   FIA_AFL.1/Suspend_PUK, FIA_AFL.1/Block_PUK,
                                   FIA_UID.1/POLY, FIA_UAU.1/POLY, FIA_UAU.4/POLY,
                                   FIA_UAU.6/EAC, FDP_ACC.1/POLY, FDP_ACF.1/POLY,
                                   FDP_ACC.1/TRM, FDP_ACF.1/TRM, FAU_SAS.1,          Section
OT.AC_Pers_Polymorphic             FMT_SMF.1, FMT_SMR.1/POLY, FMT_MTD.1/PA,          6.3.1
                                   FMT_MTD.1/KEY_READ, FPT_EMS.1,
                                   FMT_MTD.1/PI_PP_CPI_Load,
                                   FMT_MTD.1/Initialize_PIN, FMT_MTD.1/Change_PIN,
                                   FMT_MTD.1/Unblock_PIN, FMT_MTD.1/Resume_PIN,
                                   FCS_CKM.1/CA, FMT_MTD.1/INI_DIS,
                                   FMT_MTD.1/INI_ENA, FIA_UAU.6/POLY, FCS_CKM.4,
                                   FIA_UAU.5/POLY
                                   FIA_AFL.1/Suspend_PIN,                            Section
OT.DoS
                                   FIA_AFL.1/Suspend_PUK                             6.3.1

                    Table 7 Security Objectives and SFRs - Coverage
                        Security Target Lite
                                                                       Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                                2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                  Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACE_CAM             No Dependencies
FIA_UID.1/POLY                 No Dependencies
FIA_UAU.1/POLY                 (FIA_UID.1)                FIA_UID.1/POLY
FIA_UAU.4/POLY                 No Dependencies
FIA_UAU.5/POLY                 No Dependencies
FIA_UAU.6/POLY                 No Dependencies
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_READ
                               (FMT_SMR.1)                FMT_SMR.1/PACE
                               (FMT_SMF.1) and            FMT_SMF.1,
FMT_MTD.1/PACE_CAM_KEY_WRITE
                               (FMT_SMR.1)                FMT_SMR.1/PACE
FIA_API.1/CA                   No Dependencies
FIA_API.1/AA                   No Dependencies
FDP_ACC.1/TRM                  (FDP_ACF.1)                FDP_ACF.1/TRM
                               (FDP_ACC.1) and
FDP_ACF.1/TRM                                             FDP_ACC.1/TRM
                               (FMT_MSA.3)
FDP_RIP.1                      No Dependencies
FDP_ACC.1/POLY                 (FDP_ACF.1)                FDP_ACF.1/POLY
                               (FDP_ACC.1) and
FDP_ACF.1/POLY                                            FDP_ACC.1/POLY
                               (FMT_MSA.3)
FDP_RIP.1/POLY                 No Dependencies
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UCT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
                               (FDP_ACC.1 or FDP_IFC.1)
                                                          FDP_ACC.1/TRM,
FDP_UIT.1/TRM                  and (FTP_ITC.1 or
                                                          FTP_ITC.1/PACE
                               FTP_TRP.1)
FTP_ITC.1/PACE                 No Dependencies
FAU_SAS.1                      No Dependencies
FMT_SMF.1                      No Dependencies
                                                          FIA_UID.1/PACE,
FMT_SMR.1/PACE                 (FIA_UID.1)
                                                          FIA_UID.1/PACE_CAM
                          Security Target Lite
                                                                    Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                               Page: 120/150
                         eMRTD Configuration)

FMT_LIM.1                     (FMT_LIM.2)               FMT_LIM.2
FMT_LIM.2                     (FMT_LIM.1)               FMT_LIM.1
FMT_SMR.1/POLY                (FIA_UID.1)               FIA_UID.1/POLY
FMT_LIM.1/POLY                (FMT_LIM.2)               FMT_LIM.2/POLY
FMT_LIM.2/POLY                (FMT_LIM.1)               FMT_LIM.1/POLY
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_ENA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/INI_DIS
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/PA
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_INI
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CVCA_UPD
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/DATE
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/CAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/AAPK
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                              (FMT_SMF.1) and           FMT_SMF.1,
F                             MT_MTD.1/KEY_READ
                              (FMT_SMR.1)               FMT_SMR.1/PACE
                                                        FMT_MTD.1/CVCA_INI,
FMT_MTD.3                     (FMT_MTD.1)
                                                        FMT_MTD.1/CVCA_UPD
                              (FMT_SMF.1) and           FMT_SMF.1,
FMT_MTD.1/Initialize_PIN
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Change_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Unblock_PIN         (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/Resume_PIN          (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Load      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FMT_MTD.1/PI_PP_CPI_Read      (FMT_SMF.1) and           FMT_SMF.1,
                              (FMT_SMR.1)               FMT_SMR.1/POLY
FPT_EMS.1                     No Dependencies
FPT_FLS.1                     No Dependencies
FPT_TST.1                     No Dependencies
FPT_PHP.3                     No Dependencies
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/DH_PACE             FCS_COP.1) and            FCS_COP.1/PACE_ENC,
                              (FCS_CKM.4)               FCS_COP.1/PACE_MAC
                              (FCS_CKM.2 or             FCS_CKM.4,
FCS_CKM.1/CA                  FCS_COP.1) and            FCS_COP.1/CA_ENC,
                              (FCS_CKM.4)               FCS_COP.1/CA_MAC
                              (FCS_CKM.2 or
                                                        FCS_CKM.4,
FCS_CKM.1/POLY                FCS_COP.1) and
                              (FCS_CKM.4)               FCS_COP.1/POLY
                              (FCS_CKM.1 or FDP_ITC.1
FCS_CKM.4                                               FCS_CKM.1/DH_PACE
                              or FDP_ITC.2)
FCS_COP.1/PACE_ENC            (FCS_CKM.1 or FDP_ITC.1   FCS_CKM.1/DH_PACE,
                          Security Target Lite
                                                                      Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                 Page: 121/150
                         eMRTD Configuration)

                                or FDP_ITC.2) and         FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/DH_PACE,
FCS_COP.1/PACE_MAC              or FDP_ITC.2) and
                                                          FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_ENC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_VER               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/SIG_GEN               or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
                                (FCS_CKM.1 or FDP_ITC.1
FCS_COP.1/CA_MAC                or FDP_ITC.2) and         FCS_CKM.1/CA, FCS_CKM.4
                                (FCS_CKM.4)
FCS_COP.1/POLY                  (FCS_CKM.1 or FDP_ITC.1
                                                          FCS_CKM.1/POLY,
                                or FDP_ITC.2) and
                                (FCS_CKM.4)               FCS_CKM.4
FCS_RND.1                       No Dependencies
FPR_ANO.1                       No Dependencies
FPR_UNL.1                       No Dependencies

                          Table 8 SFRs Dependencies


6.3.3.1.1 Rationale for the exclusion of Dependencies


The dependency FMT_MSA.3 of FDP_ACF.1/TRM is discarded. The access
  control TSF according to FDP_ACF.1/TRM uses security attributes which are
  defined during the personalisation and are fixed over the whole life time of the
  TOE. No management of these security attribute (i.e. SFR FMT_MSA.1 and
  FMT_MSA.3) is necessary here.
                         Security Target Lite
                                                                      Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                 Page: 122/150
                        eMRTD Configuration)

6.3.3.2 SARs Dependencies
Requirements     CC Dependencies                          Satisfied Dependencies
ADV_ARC.1       (ADV_FSP.1) and (ADV_TDS.1)               ADV_FSP.5, ADV_TDS.4
ADV_FSP.5       (ADV_IMP.1) and (ADV_TDS.1)               ADV_IMP.1, ADV_TDS.4
ADV_IMP.1       (ADV_TDS.3) and (ALC_TAT.1)               ADV_TDS.4, ALC_TAT.2
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
ADV_INT.2
                (ALC_TAT.1)                               ALC_TAT.2
ADV_TDS.4       (ADV_FSP.5)                               ADV_FSP.5
AGD_OPE.1       (ADV_FSP.1)                               ADV_FSP.5
AGD_PRE.1       No Dependencies
                (ALC_CMS.1) and (ALC_DVS.1) and           ALC_CMS.5, ALC_DVS.2,
ALC_CMC.4
                (ALC_LCD.1)                               ALC_LCD.1
ALC_CMS.5       No Dependencies
ALC_DEL.1       No Dependencies
ALC_DVS.2       No Dependencies
ALC_LCD.1       No Dependencies
ALC_TAT.2       (ADV_IMP.1)                               ADV_IMP.1
                (ASE_ECD.1) and (ASE_INT.1) and           ASE_ECD.1, ASE_INT.1,
ASE_CCL.1
                (ASE_REQ.1)                               ASE_REQ.2
ASE_ECD.1       No Dependencies
ASE_INT.1       No Dependencies
ASE_OBJ.2       (ASE_SPD.1)                               ASE_SPD.1
ASE_REQ.2       (ASE_ECD.1) and (ASE_OBJ.2)               ASE_ECD.1, ASE_OBJ.2
ASE_SPD.1       No Dependencies
                (ADV_FSP.1) and (ASE_INT.1) and           ADV_FSP.5, ASE_INT.1,
ASE_TSS.1
                (ASE_REQ.1)                               ASE_REQ.2
ATE_COV.2       (ADV_FSP.2) and (ATE_FUN.1)               ADV_FSP.5, ATE_FUN.1
                (ADV_ARC.1) and (ADV_TDS.4) and           ADV_ARC.1, ADV_TDS.4,
ATE_DPT.3
                (ATE_FUN.1)                               ATE_FUN.1
ATE_FUN.1       (ATE_COV.1)                               ATE_COV.2
                (ADV_FSP.2) and (AGD_OPE.1) and           ADV_FSP.5, AGD_OPE.1,
ATE_IND.2       (AGD_PRE.1) and (ATE_COV.1) and           AGD_PRE.1, ATE_COV.2,
                (ATE_FUN.1)                               ATE_FUN.1
                (ADV_ARC.1) and (ADV_FSP.4) and           ADV_ARC.1, ADV_FSP.5,
                (ADV_IMP.1) and (ADV_TDS.3) and           ADV_IMP.1, ADV_TDS.4,
AVA_VAN.5
                (AGD_OPE.1) and (AGD_PRE.1) and           AGD_OPE.1, AGD_PRE.1,
                (ATE_DPT.1)                               ATE_DPT.3

                           Table 9 SARs Dependencies


6.3.4 Rationale for the Security Assurance Requirements
The EAL5 was chosen to permits a developer to gain maximum assurance from
positive security engineering based upon rigorous commercial development
practices supported by moderate application of specialist security engineering
techniques. Such a TOE will probably be designed and developed with the intent
of achieving EAL5 assurance. It is likely that the additional costs attributable to
the EAL5 requirements, relative to rigorous development without the application
of specialised techniques, will not be large.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                            2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                              Page: 123/150
                       eMRTD Configuration)

6.3.5 AVA_VAN.5 Advanced methodical vulnerability analysis
The selection of the component AVA_VAN.5 provides the assurance that the TOE
is shown to be highly resistant to penetration attacks to meet the security
objectives OT.Prot_Inf_Leak, OT.Prot_Phys-Tamper and OT.Prot_Malfunction.

6.3.6 ALC_DVS.2 Sufficiency of security measures
The selection of the component ALC_DVS.2 provides a higher assurance of the
secu-rity of the MRTD's development and manufacturing especially for the secure
handling of the MRTD's material.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 124/150
                       eMRTD Configuration)


7 TOE Summary Specification

7.1 TOE Summary Specification
This section provides a description of the security functions and assurance
measures of the TOE that meet the TOE security requirements.

The TOE provides security features (SF) which can be associated to following
groups:
  Identification and Authentication mechanisms
  Cryptographic functions support
  Access control /Storage and protection of logical travel document data
  Secure messaging
  Security and Life-cycle management
Moreover, the TOE will protect itself against interference, logical tampering and
bypass. The security functionality of the TOE respectively the IDeal Pass v2.3-n
JC with Privacy Protection (SAC/EAC/Polymorphic eMRTD Configuration) applet
will be externally available to the user by APDU commands according to the
access conditions specified by the according policies considering the life cycle
state, user role and security state.

7.1.1 SF.IA Identification and Authentication
The different authentication mechanisms are supported by APDU commands and
parameters using the cryptographic functions provided by the platform. The
authentication mechanisms are enforced by protocols and APDU methods as
specified in the functional specification.

Note that Symmetric Basic Access Control (BAC) Authentication Mechanism is
supported by the TOE but not covered by this Security Target.

The TOE supports the following authentication mechanisms:
        SF.IA.1: Password Authenticated Connection Establishment (PACE)
        SF.IA.2: EAC Chip Authentication v. 1
        SF.IA.3: EAC Terminal Authentication Protocol v.1
        SF.IA.4: Authentication of the Personalization Agent with a
         personalisation key set based on a symmetric authentication
         mechanism
        SF.IA.5: ICAO Active Authentication
        SF.IA.6: Optionally PACE with additional Chip Authentication Mapping
         (PACE CAM)
        SF.IA.7: Polymorphic Authentication (PMA)
        SF.IA.8: Polymorphic eMRTD Document Holder Verification
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 125/150
                       eMRTD Configuration)

7.1.2 SF.CF Cryptographic functions support
Cryptographic function support is provided by the underlying NXP JCOP 3 P60,
i.e. the TOE relies on the underlying platform for performing its required
cryptographic operations.

SF.CF Cryptographic functions include:
        SF.CF.1: 3DES and AES cipher operations for secure messaging
        SF.CF.2: Digest calculations (SHA-1, SHA-224, SHA-256, SHA-384 and
         SHA-512)
        SF.CF.3: Signature generation (ECDSA, RSA)
        SF.CF.4: Signature verification (ECDSA, RSA)
        SF.CF.5: Diffie-Hellman Key Agreement (ECDH and DH)
        SF.CF.6: Key Generation (PACE ECDH/DH ephemeral keys and secure
         messaging MAC and ENC session keys)
        SF.CF.7: Key and secret authentication data Destruction
        SF.CF.8: True Random Number generation
        SF.CF.9: Randomization of PI/PP/CPI data as part of the Polymorphic
         Authentication protocol (PMA)




7.1.3 SF.ILTB Protection against interference, logical tampering
and bypass

SF.ILTB.1
  Protection against interference, logical tampering and bypass
  Security domains are supported by the Java Card platform used by the TOE
  underlying NXP JCOP 3 P60. The NXP JCOP 3 P60 provides protection against
  physical attack and performs self-tests as described in [PLTF-ST].
  The platform protects the TOE against malfunctions that are caused by
  exposure to operating conditions that may cause a malfunction. This includes
  hardware resets and operation outside the specified norms.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet uses transient memory where a hardware reset
  always reverts the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet into an unauthenticated
  state.
                         Security Target Lite
                                                                        Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                   Page: 126/150
                        eMRTD Configuration)

7.1.4 SF.AC Access control / Storage and protection of logical
travel document data

SF.AC.1
  Access control / Storage and protection of logical travel document
  data
  The TOE provided access control, storage and protection of logical travel
  document data including access control to MRTD data. The TOE implements
  the subjects, objects, security attributes and rules according to the security
  attribute based access control. Access control is enforced by the APDU
  methods as specified in the interface defined in the functional specification.

7.1.5 SF.SM Secure Messaging

SF.SM.1
  Secure Messaging
  Secure messaging MAC and ENC operations are performed by the TOE’s
  platform.
  Secure messaging in ENC_MAC mode is established during PACE or re-
  established during Chip Authentication v1 and is based on SF.CF.1, 5, 6 and 8.

SF.SM.2
  Secure Messaging – Re-authentication
  The Retail MAC for 3DES and CMAC for AES are part of every APDU
  command/response when secure messaging is active after a successful PACE
  or Chip Authentication has been accomplished. Re-authentication after reset of
  the SM protocol is assured by accepting only valid (mandatory) MAC or CMAC
  cryptograms.

7.1.6 SF.LCM Security and life cycle management

SF.LCM.1
  Management of phases and roles
  For the TOE the following life-cycle phases have been identified:
      1. Manufacturing phase
      2. Personalisation phase
      3. Operational phase
      4. Termination phase
  Each life-cycle phase (or state) has its typical user acting as role holder.
                        Security Target Lite
                                                                  Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 127/150
                       eMRTD Configuration)

Life-cycle phase           Role
Manufacturing phase        IC Manufacturer
                           MRTD Manufacturer Platform initialisation)
                           MRTD Manufacturer (Pre-personalisation)
Personalisation phase      Personalisation Agent
                           Basic or Extended Inspection system
Operational phase          Polymorphic Authentication System
                           Polymorphic eMRTD document holder
Terminated phase           None

  All role holders in Manufacturing, Pre-Personalisation and Personalisation
  phases are identified by cryptographic authentication keys. In Operational
  phase the PACE password is required to authenticate the Basic or Extended
  Inspection System in order to get access to the non-sensitive ICAO LDS
  datagroups.
  The IDeal Pass v2.3-n JC with Privacy Protection (SAC/EAC/Polymorphic
  eMRTD Configuration) Applet maintains the internal life-cycle state the
  moment that the applet is installed. This state, together with the access
  control mechanisms force the Terminal into a specific role, for the pre-
  personalisation and subsequent, personalisation and operational phases. The
  phases (and corresponding life-cycle states) are controlled by APDU
  commands.



SF.LCM.2
  Life Cycle states of the IDeal Pass v2.3-n JC with Privacy Protection
  (SAC/EAC/Polymorphic eMRTD Configuration) Applet
  The TOE supports the following life-cycle states:
      1. Not instantiated (applet resides in ROM or in EEPROM)
      2. PRE-PERSONALISATION state
      3. PERSONALISATION state
      4. OPERATIONAL state
      5. TERMINATED state (irreversibly)
  Each Page: 119/150
                       eMRTD Configuration)

6.3.3 Dependencies

6.3.3.1 SFRs Dependencies
Requirements                   CC Dependencies            Satisfied Dependencies
FIA_AFL.1/PACE                 (FIA_UAU.1)                FIA_UAU.1/PACE
FIA_AFL.1/Suspend_PIN          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Suspend_PUK          (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PIN            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_AFL.1/Block_PUK            (FIA_UAU.1)                FIA_UAU.1/POLY
FIA_UID.1/PACE                 No Dependencies
FIA_UAU.1/PACE                 (FIA_UID.1)                FIA_UID.1/PACE
FIA_UAU.4/PACE                 No Dependencies
FIA_UAU.5/PACE                 No Dependencies
FIA_UAU.6/EAC                  No Dependencies
FIA_UAU.6/PACE                 No Dependencies
FIA_UID.1/PACE_CAM             No Dependencies
FIA_UAU.1/PACE_CAM             (FIA_UID.1)                FIA_UID.1/PACE_CAM
FIA_UAU.4/PACE_CAM             No Dependencies
FIA_UAU.5/PACE_CAM             No Dependencies
FIA_UAU.6/PACE_CAM             No Dependencies
FIA_UID.1/POLY                 No Dependencies
FIA_UAU.1/POLY                 (FIA_UID.1)                FIA_UID.1/POLY
FIA_UAU.4/POLY                 No Dependencies
FIA_UAU.5/POLY                 No Dependencies
FIA_UAU.6/POLY                 No Dependencies
                               (FMT_SMF.1) and            FMT_SMF.1,es.

6.2.1.2     Random Number Generation (FCS_RND.1)
FCS_RND.1 Quality metric for random numbers
Hierarchical to:           No other components.
Dependencies:              No dependencies.
FCS_RND.1.1                The TSF shall provide a mechanism to generate random numbers that meet the
                           AIS20 Class DRG.3 quality metric39.



32   [assignment: cryptographic algorithm]
33   [assignment: cryptographic key sizes]
34   [assignment: list of standards]
35   [assignment: list of cryptographic operations]
36   [assignment: cryptographic algorithm]
37   [assignment: cryptographic key sizes]
38   [assignment: list of standards]
39   [assignment: a defined quality metric]

                                                      55 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP0068v2 application note 31: This SFR requires the TOE to generate random numbers (random nonce)
used for the authentication protocol (PACE) as required by FIA_UAU.4/PACE.


Application note: This SFR was added to the standard set of SFRs to address the requirements of the PACE
protocol. The random number generation is provided by the underlying JCOP4 P71 platform.
Developer note: The corresponding platform SFR (FCS_RNG.1) states that the platform provides a deter-
ministic random number generator (RNG) that fulfills the following:
       (DRG.3.1) If initialized with a random seed using a PTRNG of class PTG.2 (as defined in [AIS20]) as
        random source, the internal state of the RNG shall have at least 256 bit of entropy.
       (DRG.3.2) The RNG provides forward secrecy (as defined in [AIS20]).
       (DRG.3.3) The RNG provides enhanced backward secrecy even if the current internal state is
        known (as defined in [AIS20])
       (DRG.3.4) The RNG, initialized with a random seed using a PTRNG of class PTG.2 (as defined in
        [AIS20]) as random source, generates output for which for AES-mode 248 and for TDEA-mode 235
        strings of bit length 128 are mutually different with probability at least 1 - 224.
       (DRG.3.5) Statistical test suites cannot practically distinguish the random numbers from output
        sequences of an ideal RNG. The random numbers must pass test procedure A (as defined in
        [AIS20]).

Thus the platform RNG implements AIS20/31 [AIS20] class DRG.3.



6.2.2 Class FIA Identification and Authentication
PP Application note 19, extended to include Active Authentication: The following table provides an over-
view of the authentication mechanisms used:


                     Name                                                SFR for the TOE
                     Symmetric Authentication Mechanismfor               FIA_UAU.4/PACE
                     Personalisation Agents
                     Chip Authentication Protocol                        FIA_API.1,
                                                                         FIA_UAU.5/PACE,
                                                                         FIA_UAU.6/EAC
                     Terminal Authentication Protocol                    FIA_UAU.5/PACE
                     PACE protocol                                       FIA_UAU.1/PACE
                                                                         FIA_UAU.5/PACE
                                                                         FIA_AFL.1/PACE
                     Passive Authentication                              FIA_UAU.5/PACE
                     Active Authentication Mechanism                     FIA_API.1/AA
                                 Table 13: Overview on authentication SFR

Note the Chip Authentication Protocol Version 1 as defined in this security target includes
       the asymmetric key agreement to establish symmetric secure messaging keys between the TOE
        and the terminal based on the Chip Authentication Public Key and the Terminal Public Key used
        later in the Terminal Authentication Protocol Version 1,


                                                   56 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


        the check whether the TOE is able to generate the correct message authentication code with the
         expected key for any message received by the terminal.
The Chip Authentication Protocol v.1 may be used independent of the Terminal Authentication Protocol v.1.
But if the Terminal Authentication Protocol v.1 is used the terminal shall use the same public key as pre-
sented during the Chip Authentication Protocol v.1.


The TOE shall meet the requirement “Timing of identification (FIA_UID.1)” as specified below (Common
Criteria Part 2).


FIA_AFL.1/PACE Authentication failure handling – PACE authentication using non-blocking authorisation
data
Hierarchical to:         No other components.
Dependencies:            FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE         The TSF shall detect when 1040 unsuccessful authentication attempt occurs related
                         to authentication attempts using the PACE password as shared password.
FIA_AFL.1.2/PACE         When the defined number of unsuccessful authentication attempts has been met,
                         the TSF shall delay each of the following authentication attempt until the next
                         successful authentication attempt by an increasing amount of time41.


PP0068v2 Application Note 32: The open assignment operation shall be performed according to a concrete
implementation of the TOE, whereby actions to be executed by the TOE may either be common for all data
concerned (PACE passwords, see [ICAO_SAC]) or for an arbitrary subset of them or may also separately be
defined for each datum in question. Since all non-blocking authorisation data (PACE passwords) being used
as a shared secret within the PACE protocol do not possess a sufficient entropy42, the TOE shall not allow a
quick monitoring of its behaviour (e.g. due to a long reaction time) in order to make the first step of the
skimming attack43 requiring an attack potential beyond high, so that the threat T.Tracing can be averted in
the frame of the security policy of this ST. One of some opportunities for performing this operation might
be ‘consecutively increase the reaction time of the TOE to the next authentication attempt using PACE pass-
words’.


FIA_API.1 Authentication Proof of Identity
Hierarchical to:         No other components.
Dependencies:            No dependencies.
FIA_API.1.1              The TSF shall provide a Chip Authentication Protocol Version 1 according to [TR-
                         03110] to prove the identity of the TOE.




40   [assignment: positive integer number]
 [assignment: list of actions]
41

42 ≥ 100 bits; a theoretical maximum of entropy which can be delivered by a character string is N*ld(C),
whereby N is the length of the string, C – the number of different characters which can be used within the
string.
43   guessing CAN or MRZ, see T.Skimming above

                                                   57 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP Application note 30: This SFR requires the TOE to implement the Chip Authentication Mechanism v.1
specified in [TR-03110]. The TOE and the terminal generate a shared secret using the Diffie-Hellman Proto-
col (DH or EC-DH) and two session keys for secure messaging in ENC_MAC mode according to [ICAODoc].
The terminal verifies by means of secure messaging whether the travel document’s chip was able or not to
run his protocol properly using its Chip Authentication Private Key corresponding to the Chip Authentication
Key (EF.DG14).


FIA_API.1/AA Authentication Proof of Identity (Active Authentication)
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_API.1.1/AA            The TSF shall provide the Active Authentication Mechanisms according to [ICAO-
                          Doc]44 to prove the identity of the TOE45.


Application Note: The SFR FIA_API.1/AA has been included inthis security target in addition to the SFRs
defined by the Protection Profiles claimed insection 2.2. This extension does not conflict with the strict
conformance to the claimed Protection Profiles.


FIA_UID.1/PACE Timing of identification
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_UID.1.1/PACE          The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                              FMT_MTD.1/INI_DIS,
                          4. to carry out the Chip Authentication Protocol v.1 according to [TR-03110],
                          5. to carry out the Terminal Authentication Protocol v.1 according to [TR-
                              03110],
                          6. to carry out the Active Authentication Mechanism46
                          on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE          The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.


PP0068v2 application note 33: User identified after a successfully performed PACE protocol is a PACE au-
thenticated BIS-PACE. Please note that neither CAN nor MRZ effectively represent secrets (but other PACE
passwords may do so), but are restricted-revealable; i.e. it is either the travel document holder itself or an
authorised other person or device (BIS-PACE).
PP Application note 20: The SFR FIA_UID.1/PACE in PP0056v2 covers the definition in PACE PP [PP0068v2]
and extends it by EAC aspect 4. This extension does not conflict with the strict conformance to PACE PP.



44   [assignment: authentication mechanism]
45   [assignment: authorized user or role]
46   [assignment: list of TSF-mediated actions]

                                                   58 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP Application note 21: In the Phase 2 “Manufacturing of the TOE” the Manufacturer is the only user role
known to the TOE which writes the Initialization Data and/or Pre-personalisation Data in the audit records
of the IC. The travel document manufacturer may create the user role Personalisation Agent for transition
from Phase 2 to Phase 3 “Personalisation of the travel document”. The users in role Personalisation Agent
identify themselves by means of selecting the authentication key. After personalisation in the Phase 3 the
PACE domain parameters, the Chip Authentication data and Terminal Authentication Reference Data are
written into the TOE. The Inspection System is identified as default user after power up or reset of the TOE
i.e. the TOE will run the PACE protocol, to gain access to the Chip Authentication Reference Data and to run
the Chip Authentication Protocol Version 1. After successful authentication of the chip the terminal may
identify itself as (i) Extended Inspection System by selection of the templates for the Terminal Authentica-
tion Protocol Version 1 or (ii) if necessary and available by authentication as Personalisation Agent (using
the Personalisation Agent Key).
PP Application note 22: User identified after a successfully performed PACE protocol is a terminal. Please
note that neither CAN nor MRZ effectively represent secrets, but are restricted revealable; i.e. it is either
the travel document holder itself or an authorised other person or device (Basic Inspection System with
PACE).
PP Application note 23: In the life-cycle phase ‘Manufacturing’ the Manufacturer is the only user role known
to the TOE. The Manufacturer writes the Initialisation Data and/or Pre-personalisation Data in the audit
records of the IC. Please note that a Personalisation Agent acts on behalf of the travel document Issuer
under his and CSCA and DS policies. Hence, they define authentication procedure(s) for Personalisation
Agents. The TOE must functionally support these authentication procedures being subject to evaluation
within the assurance components ALC_DEL.1 and AGD_PRE.1. The TOE assumes the user role ‘Personalisa-
tion Agent’, when a terminal proves the respective Terminal Authorisation Level as defined by the related
policy (policies).


FIA_UAU.1/PACE Timing of authentication
Hierarchical to:          No other components.
Dependencies:             FIA_UID.1 Timing of identification
FIA_UAU.1.1/PACE          The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                              FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key,
                          5. to carry out the Chip Authentication Protocol v.1 according to [TR-03110],
                          6. to carry out the Terminal Authentication Protocol v.1 according to [TR-
                              03110],
                          7. to carry out the Active Authentication Mechanism
                          8. None47
                          on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE          The TSF shall require each user to be successfully authenticated before allowing any
                          other TSF-mediated actions on behalf of that user.


PP0068v2 application note 34: <Superseded by PP application note 25 below>.


47   [assignment: list of TSF-mediated actions]

                                                   59 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP application note 24: The SFR FIA_UAU.1/PACE in this ST covers the definition in PACE PP [PP0068v2] and
extends it by EAC aspect 5. This extension does not conflict with the strict conformance to PACE PP.
PP application note 25: The user authenticated after a successfully performed PACE protocol is a terminal.
Please note that neither CAN nor MRZ effectively represent secrets, but are restricted revealable; i.e. it is
either the travel document holder itself or an authorised other person or device (BIS-PACE).If PACE was
successfully performed, secure messaging is started using the derived session keys (PACE-KMAC, PACE-
KEnc), cf. FTP_ITC.1/PACE.


FIA_UAU.4/PACE Single-use authentication of the Terminal by the TOE
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_UAU.4.1/PACE          The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according to [ICAO_SAC]
                          2. Authentication Mechanism based on AES,48
                          3. Terminal Authentication Protocol v.1 according to [TR-03110]49

PP0068v2 application note 35: For the PACE protocol, the TOE randomly selects a nonce s of 128 bits length
being (almost) uniformly distributed.
PP application note 26: The SFR FIA_UAU.4.1 in this ST covers the definition in PACE PP [PP0068v2] and
extends it by the EAC aspect 3. This extension does not conflict with the strict conformance to PACE PP. The
generation of random numbers (random nonce) used for the authentication protocol (PACE) and Terminal
Authentication as required by FIA_UAU.4/PACE is required by FCS_RND.1 from [PP0068v2].
PP application note 27: The authentication mechanisms may use either a challenge freshly and randomly
generated by the TOE to prevent reuse of a response generated by a terminal in a successful authentication
attempt. However, the authentication of Personalisation Agent may rely on other mechanisms ensuring
protection against replay attacks, such as the use of an internal counter as a diversifier.


FIA_UAU.5/PACE Multiple authentication mechanisms
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_UAU.5.1/PACE          The TSF shall provide
                          1.   PACE Protocol according to [ICAO_SAC],
                          2.   Passive Authentication according to [ICAODoc],
                          3.   Secure Messaging in MAC-ENC mode according to [ICAO_SAC],
                          4.   Symmetric Authentication Mechanism based on AES50,
                          5.   Terminal Authentication Protocol v.1 according to [TR-03110]51


48   [assignment: identified authentication algorithms]
 [assignment: identified authentication mechanism(s)]
49

50The TOE implements a symmetric authentication mechanism based on AES for the Personalization Agent
as defined in [ISO18013-3], which is equivalent to the BAC protocol, but based on AES (in CBC mode for
encryption and decryption following [NIST800-38A] and as a CMAC for message authentication following
[NIST800-38B]).
 [selection: Triple-DES, AES or other approved algorithms]
51




                                                   60 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                         to support user authentication.
FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                         rules:
                         1. Having successfully run the PACE protocol the TOE accepts only received
                            commands with correct message authentication code sent by means of se-
                            cure messaging with the key agreed with the terminal by means of the PACE
                            protocol.
                         2. The TOE accepts the authentication attempt as Personalisation Agent by Au-
                            thentication Mechanism with Personalization Agent Keys52.
                         3. After run of the Chip Authentication Protocol v. 1 the TOE accepts only re-
                            ceived commands with correct message authentication code sent by means
                            of secure messaging with key agreed with the terminal by means of the Chip
                            Authentication Mechanism v. 1.
                         4. The TOE accepts the authentication attempt by means of the Terminal Au-
                            thentication Protocol v.1 only if the terminal uses the public key presented
                            during the Chip Authentication Protocol v.1 and the secure messaging estab-
                            lished by the Chip Authentication Protocol v.1.53
                         5. None.54

PP application note 28: The SFR FIA_UAU.5.1/PACE in this ST covers the definition in PACE PP [PP0068v2]
and extends it by EAC aspects 4), 5), and 6). The SFR FIA_UAU.5.2/PACE in this ST covers the definition in
PACE PP [PP0068v2] and extends it by EAC aspects 2), 3), 4) and 5). These extensions do not conflict with
the strict conformance to PACE PP.
PP0068v2 application note 36: Please note that Passive Authentication does not authenticate any TOE’s
user, but provides evidence enabling an external entity (the terminal connected) to prove the origin of
ePassport application.


FIA_UAU.6/EAC Re-authenticating – Re-authenticating of Terminal by the TOE
Hierarchical to:         No other components.
Dependencies:            No dependencies.
FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent to
                         the TOE after successful run of the Chip Authentication Protocol Version 1 shall be
                         verified as being sent by the Inspection System.


PP application note 29: The Password Authenticated Connection Establishment and the Chip Authentica-
tion Protocol specified in [ICAODoc] include secure messaging for all commands exchanged after successful
authentication of the Inspection System. The TOE checks by secure messaging in MAC_ENC mode each
command based on a corresponding MAC algorithm whether it was sent by the successfully authenticated
terminal (see FCS_COP.1/CA_MAC for further details). The TOE does not execute any command with incor-
rect message authentication code. Therefore the TOE re-authenticates the user for each received command
and accepts only those commands received from the previously authenticated user.


 [selection: the Authentication Mechanism with Personalisation Agent Key(s)]
52

53   [assignment: rules describing how the multiple authentication mechanisms provide authentication]
 [assignment: rules describing how the multiple authentication mechanisms provide authentication]
54




                                                   61 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite




FIA_UAU.6/PACE Re-authenticating – Re-authenticating of Terminal by the TOE
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FIA_UAU.6.1/PACE        The TSF shall re-authenticate the user under the conditions each command sent to
                        the TOE after successful run of the PACE protocol shall be verified as being sent by
                        the PACE terminal.


PP0068v2 Application note 37:The PACE protocol specified in [ICAO-SAC] starts secure messaging used for
all commands exchanged after successful PACE authentication. The TOE checks each command by secure
messaging in encrypt-then-authenticate mode based on CMAC or Retail-MAC, whether it was sent by the
successfully authenticated terminal (see FCS_COP.1/PACE_MAC for further details). The TOE does not exe-
cute any command with incorrect message authentication code. Therefore, the TOE re-authenticates the
terminal connected, if a secure messaging error occurred, and accepts only those commands received from
the initially authenticated terminal.

6.2.3 Class FDP User Data Protection
The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below (Common Cri-
teria Part 2).
FDP_ACC.1/TRM Subset access control
Hierarchical to:        No other components.
Dependencies:           FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1/TRM         The TSF shall enforce the Access Control SFP on terminals gaining access to the
                        User data and data stored in EF.Sod of the logical travel document.


PP Application note 31: The SFR FDP_ACC.1.1 in this ST covers the definition in PACE PP [PP0068v2] and
extends it by data stored in EF.SOD of the logical travel document. This extension does not conflict with the
strict conformance to PACE PP.
PP0068v2 application note 38:<applied>


FDP_ACF.1/TRM Security attribute based access control
Hierarchical to:        No other components.
Dependencies:           FDP_ACC.1 Subset access control
                        FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1/TRM         The TSF shall enforce the Access Control SFP to objects based on thefollowing:
                        1. Subjects:
                           a. Terminal,
                           b. BIS-PACE,
                           c. Extended Inspection System.
                        2. Objects:
                           a. data EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                              logicalMRTD,
                           b. data in EF.DG3 of the logical MRTD,


                                                   62 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                             c. data in EF.DG4 of the logical MRTD,
                             d. all TOE intrinsic secret cryptographic keys stored in the travel document.
                        3. Security attributes:
                             a. PACE Authentication,
                             b. Terminal Authentication v.1,
                             c. Authorization of the Terminal.
FDP_ACF.1.2/TRM         The TSF shall enforce the following rules to determine if an operation among con-
                        trolled subjects and controlled objects is allowed: A BIS-PACE is allowed to read
                        data objects from FDP_ACF.1.1/TRM according to [TR-03110] after a successful
                        PACE authentication as required by FIA_UAU.1/PACE.
FDP_ACF.1.3/TRM         The TSF shall explicitly authorize access of subjects to objects based on the following
                        additional rules: none.
FDP_ACF.1.4/TRM         The TSF shall explicitly deny access of subjects to objects based on the rule:
                        1. Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                           allowed to read, to write, to modify, to use any User Data stored on the travel
                           document.
                        2. Terminals not using secure messaging are not allowed to read, to write, to
                           modify, to use any data stored on the travel document.
                        3. Any terminal being not successfully authenticated as Extended Inspection Sys-
                           tem with the Read access to DG 3 (Fingerprint) granted by the relative certifi-
                           cate holder authorization encoding is not allowed to read the data objects 2b)
                           of FDP_ACF.1.1/TRM.
                        4. Any terminal being not successfully authenticated as Extended Inspection Sys-
                           tem with the Read access to DG 4 (Iris) granted by the relative certificate
                           holder authorization encoding is not allowed to read the data objects 2c) of
                           FDP_ACF.1.1/TRM.
                        5. Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.
                        6. Terminals authenticated as CVCA or as DV are not allowed to read data in the
                           EF.DG3 and EF.DG4.

PP application note 32: The SFR FDP_ACF.1.1/TRM in this ST covers the definition in PACE PP [PP0068v2]
and extends it by additional subjects and objects. The SFRs FDP_ACF.1.2/TRM and FDP_ACF.1.3/TRM in this
ST cover the definition in PACE PP [PP0068v2]. The SFR FDP_ACF.1.4/TRM in this ST covers the definition in
PACE PP [PP0068v2] and extends it by 3) to 6).These extensions do not conflict with the strict conformance
to PACE PP.
PP0068v2 application note 39: <applied>
PP application note 33: The relative certificate holder authorization encoded in the CVC of the inspection
system is defined in [TR-03110]. The TOE verifies the certificate chain established by the Country Verifying
Certification Authority, the Document Verifier Certificate and the Inspection System Certificate (cf.
FMT_MTD.3). The Terminal Authorization is the intersection of the Certificate Holder Authorization in the
certificates of the Country Verifying Certification Authority, the Document Verifier Certificate and the In-
spection System Certificate in a valid certificate chain.
PP application note 34, PP0068v2 application note 40: Please note that the Document Security Object
(SOD) stored in EF.SOD (see [ICAODoc]) does not belong to the user data, but to the TSF data. The Document
Security Object can be read out by Inspection Systems using PACE, see [ICAO_SAC].



                                                   63 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP application note 35: FDP_UCT.1/TRM and FDP_UIT.1/TRM require the protection of the User Data trans-
mitted from the TOE to the terminal by secure messaging with encryption and message authentication
codes after successful Chip Authentication Version 1 to the Inspection System. The Password Authenticated
Connection Establishment, and the Chip Authentication Protocol v.1 establish different key sets to be used
for secure messaging (each set of keys for the encryption and the message authentication key).
PP0068v2 application note 41: Please note that the control on the user data transmitted between the TOE
and the PACE terminal is addressed by FTP_ITC.1/PACE.


FDP_RIP.1 Subset residual information protection
Hierarchical to:        No other components.
Dependencies:           No dependencies
FDP_RIP.1.1             The TSF shall ensure that any previous information content of a resource is made
                        unavailable upon the deallocation of the resource from55 the following objects:
                        1. Session Keys (immediately after closing related communication session),
                        2. the ephemeral private key ephem SKPICC PACE (by having generated a DH
                           shared secret K)
                        3. None56

PP0068v2 application note 42: The functional family FDP_RIP possesses such a general character, so that it
is applicable not only to user data (as assumed by the class FDP), but also to TSF-data; in this respect it is
similar to the functional family FPT_EMS. Applied to cryptographic keys, FDP_RIP.1 requires a certain quality
metric (‘any previous information content of a resource is made unavailable’) for key’s destruction in addi-
tion to FCS_CKM.4 that merely requires a fact of key destruction according to a method/standard.


FDP_UCT.1/TRM Basic data exchange confidentiality – MRTD
Hierarchical to:        No other components.
Dependencies:           FTP_ITC.1 Inter-TSF trusted channel, or
                        FTP_TRP.1 Trusted path]: fulfilled by FTP_ITC.1/PACE
                        [FDP_ACC.1 Subset access control, or
                        FDP_IFC.1 Subset information flow control]: fulfilled by FDP_ACC.1/TRM
FDP_UCT.1.1/TRM         The TSF shall enforce the Access Control SFP to be able to transmit and receive user
                        data in a manner protected from unauthorized disclosure.


FDP_UIT.1/TRM Data exchange integrity
Hierarchical to:        No other components.
Dependencies:           [FTP_ITC.1 Inter-TSF trusted channel, or
                        FTP_TRP.1 Trusted path]: fulfilled by FTP_ITC.1/PACE
                        [FDP_ACC.1 Subset access control, or
                        FDP_IFC.1 Subset information flow control]: fulfilled by FDP_ACC.1/TRM



 [selection: allocation of the resource to, deallocation of the resource from]
55


 [assignment: list of objects]
56




                                                   64 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


FDP_UIT.1.1/TRM         The TSF shall enforce the Access Control SFP to be able to transmit and receive user
                        data in a manner protected from modification, deletion, insertion and replay er-
                        rors.
FDP_UIT.1.2/TRM         The TSF shall be able to determine on receipt of user data, whether modification,
                        deletion, insertion and replay has occurred.

6.2.4 Class FTP Trusted Path/Channels
FTP_ITC.1/PACE Inter-TSF trusted channel after PACE
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FTP_ITC.1.1/PACE        The TSF shall provide a communication channel between itself and another trusted
                        IT product that is logically distinct from other communication channels and provides
                        assured identification of its end points and protection of the channel data from
                        modification or disclosure.
FTP_ITC.1.2/PACE        The TSF shall permit another trusted IT product to initiate communication via the
                        trusted channel.
FTP_ITC.1.3/PACE        The TSF shall initiate enforce communication via the trusted channel for any data
                        exchange between the TOE and the Terminal.


PP0068v2 application note 43: The trusted IT product is the terminal. In FTP_ITC.1.3/PACE, the word “initi-
ate” is changed to ‘enforce”, as the TOE is a passive device that can not initiate the communication. All the
communication are initiated by the Terminal, and the TOE enforce the trusted channel.
PP0068v2 application note 44: The trusted channel is established after successful performing the PACE
protocol (FIA_UAU.1/PACE). If the PACE was successfully performed, secure messaging is immediately
started using the derived session keys (PACE-KMAC, PACE-KEnc): this secure messaging enforces preventing
tracing while Passive Authentication and the required properties of operational trusted channel; the cryp-
tographic primitives being used for the secure messaging are as required by FCS_COP.1/PACE_ENC and
FCS_COP.1/PACE_MAC. The establishing phase of the PACE trusted channel does not enable tracing due to
the requirements FIA_AFL.1/PACE.
PP0068v2 application note 45: Please note that the control on the user data stored in the TOE is addressed
by FDP_ACF.1/TRM.

6.2.5 Class FAU Security Audit
FAU_SAS.1 Audit storage
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FAU_SAS.1.1             The TSF shall provide the Manufacturer with the capability to store the Initialisa-
                        tion and Pre-Personalisation Data in the audit records.


PP0068v2 application note 46: The Manufacturer role is the default user identity assumed by the TOE in
the life cycle phase ‘manufacturing’. The IC manufacturer and the travel document manufacturer in the
Manufacturer role write the Initialisation and/or Pre-personalisation Data as TSF-data into the TOE. The
audit records are usually write-only-once data of the travel document (see FMT_MTD.1/INI_ENA,
FMT_MTD.1/INI_DIS). Please note that there could also be such audit records which cannot be read out,
but directly used by the TOE.


                                                   65 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite




6.2.6 Class FMT Security Management
FMT_SMF.1 Specification of Management Functions
Hierarchical to:        No other components.
Dependencies:           No Dependencies
FMT_SMF.1.1             The TSF shall be capable of performing the following management functions:
                        1. Initialization,
                        2. Pre-personalization,
                        3. Personalization,
                        4. Configuration.

PP application note 36:The SFR FMT_SMR.1/PACE provides basic requirements to the management of the
TSF data.


FMT_SMR.1/PACE Security roles
Hierarchical to:        No other components.
Dependencies:           FIA_UID.1 Timing of identification.
FMT_SMR.1.1/PACE                 The TSF shall maintain the roles
                        1. Manufacturer,
                        2. Personalization Agent,
                        3. Terminal,
                        4. PACE authenticated BIS-PACE,
                        5. Country Verifying Certification Authority,
                        6. Document Verifier,
                        7. Domestic Extended Inspection System,
                        8. Foreign Extended Inspection System.
FMT_SMR.1.2/PACE        The TSF shall be able to associate users with roles.


PP application note 37: The SFR FMT_SMR.1.1/PACE in this ST covers the definition in PACE PP [PP0068v2]
and extends it by 5) to 8). This extension does not conflict with the strict conformance to PACE PP.
PP application note 38: The SFR FMT_LIM.1 and FMT_LIM.2 address the management of the TSF and TSF
data to prevent misuse of test features of the TOE over the life-cycle phases.
PP0068v2 application note 47: For explanation on the role Manufacturer and Personalisation Agent please
refer to the glossary of [PP0068v2]. The role Terminal is the default role for any terminal being recognised
by the TOE as not PACE authenticated BIS-PACE (‘Terminal’ is used by the travel document presenter).
The TOE recognises the travel document holder or an authorised other person or device (BIS-PACE) by using
PACE authenticated BIS-PACE (FIA_UAU.1/PACE).


FMT_LIM.1 Limited capabilities
Hierarchical to:        No other components.
Dependencies:           FMT_LIM.2 Limited availability.



                                                   66 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


FMT_LIM.1.1             The TSF shall be designed in a manner that limits their capabilities so that in con-
                        junction with “Limited availability (FMT_LIM.2)” the following policy is enforced:
                        Deploying Test Features after TOE Delivery does not allow,
                        1. User Data to be manipulated,
                        2. TSF data to be disclosed or manipulated,
                        3. software to be reconstructed,
                        4. substantial information about construction of TSF to be gathered which may
                           enable other attacks,
                        5. sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.

FMT_LIM.2 Limited availability
Hierarchical to:        No other components.
Dependencies:           FMT_LIM.1 Limited capabilities.
FMT_LIM.2.1             The TSF shall be designed in a manner that limits their availability so that in con-
                        junction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced:
                        Deploying Test Features after TOE Delivery does not allow
                        1. User Data to be manipulated,
                        2. TSF data to be disclosed or manipulated,
                        3. software to be reconstructed,
                        4. substantial information about construction of TSF to be gathered which may
                           enable other attacks,
                        5. sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.

PP application note 39: The formulation of “Deploying Test Features …” in FMT_LIM.2.1 might be a little bit
misleading since the addressed features are no longer available (e.g. by disabling or removing the respective
functionality). Nevertheless the combination of FMT_LIM.1 and FMT_LIM.2 is introduced to provide an op-
tional approach to enforce the same policy.
PP0068v2 application note 48: Note that the term “software” in item 4 of FMT_LIM.1.1 and FMT_LIM.2.1
refers to both IC Dedicated and IC Embedded Software.
PP application note 40: The following SFR are iterations of the component Management of TSF data
(FMT_MTD.1). The TSF data include but are not limited to those identified below.


FMT_MTD.1/CVCA_INI Management of TSF data – Initialisation of CVCA Certificate and Current Date
Hierarchical to:        No other components.
Dependencies:           FMT_SMF.1 Specification of management functions: fulfilled byFMT_SMF.1
                        FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
CVCA_INI
                        The TSF shall restrict the ability to write the
                        1. initial Country Verifying Certification Authority Public Key,
                        2. initial Country Verifying Certification Authority Certificate,
                        3. initial Current Date




                                                   67 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                          4. None57
                          To the Personalization Agent58.


PP application note 41:<applied>. The initial Country Verifying Certification Authority Public Keys (and their
updates later on) are used to verify the Country Verifying Certification Authority Link-Certificates. The initial
Country Verifying Certification Authority Certificate and the initial Current Date is needed for verification of
the certificates and the calculation of the Terminal Authorization.


FMT_MTD.1/CVCA_UPD Management of TSF data – Country Verifying Certification Authority
Hierarchical to:          No other components.
Dependencies:             FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
CVCA_UPD
                          The TSF shall restrict the ability to update the
                          1. Country Verifying Certification Authority Public Key,
                          2. Country Verifying Certification Authority Certificate,
                          to Country Verifying Certification Authority.


PP application note 42: The Country Verifying Certification Authority updates its asymmetric key pair and
distributes the public key be means of the Country Verifying CA Link-Certificates (cf. [TR-03110]). The TOE
updates its internal trust-point if a valid Country Verifying CA Link-Certificates (cf. FMT_MTD.3) is provided
by the terminal (cf. [TR-03110]).


FMT_MTD.1/DATE Management of TSF data – Current date
Hierarchical to:          No other components.
Dependencies:             FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/DATE          The TSF shall restrict the ability to modify the Current date to
                          1. Country Verifying Certification Authority,
                          2. Document Verifier,
                          3. Domestic Extended Inspection System.

PP application note 43: The authorized roles are identified in their certificate (cf. [TR-03110]) and author-
ized by validation of the certificate chain (cf. FMT_MTD.3). The authorized role of the terminal is part of the
Certificate Holder Authorization in the card verifiable certificate provided by the terminal for the identifica-
tion and the Terminal Authentication v.1 (cf. to [TR-03110]).


FMT_MTD.1/CAPK Management of TSF data – Chip Authentication Private Key
Hierarchical to:          No other components.


 [assignment: list of TSF data]
57

58   [assignment: the authorised identified roles]

                                                     68 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/CAPK           The TSF shall restrict the ability to load59 the Chip Authentication Private Key to the
                           Personalization Agent60.


PP application note 44: <applied> The verb “load” means here that the Chip Authentication Private Key is
generated securely outside the TOE and written into the TOE memory. Thus according to PP application
note 44 no additional key generation SFR is necessary.


FMT_MTD.1/INI_ENA Management of TSF data – Writing of Initialization Data and Prepersonalization
Data
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
INI_ENA
                           The TSF shall restrict the ability to write the Initialization Data and Prepersonaliza-
                           tion Data to the Manufacturer.


FMT_MTD.1/INI_DIS Management of TSF data – Disabling of Read Access to Initialization Data and Pre-
personalization Data
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
INI_DIS
                           The TSF shall restrict the ability to disable read access for users to the Initialization
                           Data to the Personalization Agent.


PP0068v2 application note 49: The TOE may restrict the ability to write the Initialisation Data and the Pre-
personalisation Data by (i) allowing writing these data only once and (ii) blocking the role Manufacturer at
the end of the manufacturing phase. The Manufacturer may write the Initialisation Data (as required by
FAU_SAS.1) including, but being not limited to a unique identification of the IC being used to trace the IC in
the life cycle phases ‘manufacturing’ and ‘issuing’, but being not needed and may be misused in the ‘oper-
ational use’. Therefore, read and use access to the Initialisation Data shall be blocked in the ‘operational
use’ by the Personalisation Agent, when he switches the TOE from the life cycle phase ‘issuing’ to the life
cycle phase ‘operational use’.


FMT_MTD.1/KEY_READ Management of TSF data – Key Read
Hierarchical to:           No other components.



59   [selection: create, load]
60   [assignment: the authorised identified roles]

                                                      69 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/
KEY_READ                   The TSF shall restrict the ability to read the
                           1. PACE passwords,
                           2. Chip Authentication Private Key,
                           3. Personalization Agent Keys,
                           to none.
PP application note 45:The SFR FMT_MTD.1/KEY_READ in [PP0056v2] covers the definition in PACE PP
[PP0068v2] and extends it by additional TSF data. This extension does not conflict with the strict conform-
ance to PACE PP.


FMT_MTD.1/PAManagement of TSF data – Personalisation Agent
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
                           FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
FMT_MTD.1.1/PA             The TSF shall restrict the ability to write the Document Security Object (SOD) to the
                           Personalisation Agent.


PP0068v2 application note 50: By writing SOD into the TOE, the Personalisation Agent confirms (on behalf
of DS) the correctness and genuineness of all the personalisation data related. This consists of user- and
TSF- data.


FMT_MTD.1/AAManagement of TSF data – Active Authentication Private Key
Hierarchical to:           No other components.
Dependencies:              FMT_SMF.1 Specification of management functions: fulfilled by the user role ‘Personalisa-
tion Agent’, when a terminal proves the respective Terminal Authorisation Level as defined by the related
policy (policies).


FIA_UAU.1/PACE Timing of authentication
Hierarchical to:          No other components.
Dependencies:             FIA_UID.1 Timing of identification
FIA_UAU.1.1/PACE          The TSF shall allow
                          1. to establish the communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC],
                          3. to read the Initialization Data if it is not disabled by TSF according to
                              FMT_MTD.1/INI_DIS,
                          4. to identify themselves by selection of the authentication key,
                          5. to carry out the Chip Authentication Protocol v.1 according to [TR-03110],
                          6. to carry out the Terminal Authentication Protocol v.1 according to [TR-
                              03110],
                          7. to carry out the Active Authentication Mechanism
                          8. None47
                          on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE          The TSF shall require each user to be successfully authenticated before allowing any
                          other TSF-mediated actions on behalf of that user.


PP0068v2 application note 34: <Superseded by PP application note 25 below>.


47   [assignment: list of TSF-mediated actions]

                                                   59 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP application note 24: The SFR FIA_UAU.1/PACE in this ST covers the definition in PACE PP [PP0068v2] and
extends it by EAC aspect 5. This extension does not conflict with the strict conformance to PACE PP.
PP application note 25: The user authenticated after a successfully performed PACE protocol is a terminal.
Please note that neither CAN nor MRZ effectively represent secrets, but are restricted revealable; i.e. it is
either the travel document holder itself or an authorised other person or device (BIS-PACE).If PACE was
successfully performed, secure messaging is started using the derived session keys (PACE-KMAC, PACE-
KEnc), cf. FTP_ITC.1/PACE.


FIA_UAU.4/PACE Single-use authentication of the Terminal by the TOE
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_UAU.4.1/PACE          The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according to [ICAO_SAC]
                          2. Authentication Mechanism based on AES,48
                          3. Terminal Authentication Protocol v.1 according to [TR-03110]49

PP0068v2 application note 35: For the PACE protocol, the TOE randomly selects a nonce s of 128 bits length
being (almost) uniformly distributed.
PP application note 26: The SFR FIA_UAU.4.1 in this ST covers the definition in PACE PP [PP0068v2] and
extends it by the EAC aspect 3. This extension does not conflict with the strict conformance to PACE PP. The
generation of random numbers (random nonce) used for the authentication protocol (PACE) and Terminal
Authentication as required by FIA_UAU.4/PACE is required by FCS_RND.1 from [PP0068v2].
PP application note 27: The authentication mechanisms may use either a challenge freshly and randomly
generated by the TOE to prevent reuse of a response generated by a terminal in a successful authentication
attempt. However, the authentication of Personalisation Agent may rely on other mechanisms ensuring
protection against replay attacks, such as the use of an internal counter as a diversifier.


FIA_UAU.5/PACE Multiple authentication mechanisms
Hierarchical to:          No other components.
Dependencies:             No dependencies.
FIA_UAU.5.1/PACE          The TSF shall provide
                          1.   PACE Protocol according to [ICAO_SAC],
                          2.   Passive Authentication according to [ICAODoc],
                          3.   Secure Messaging in MAC-ENC mode according to [ICAO_SAC],
                          4.   Symmetric Authentication Mechanism based on AES50,
                          5.   Terminal Authentication Protocol v.1 according to [TR-03110]51


48   [assignment: identified authentication algorithms]
 [assignment: identified authentication mechanism(s)]
49

50The TOE implements a symmetric authentication mechanism based on AES for the Personalization Agent
as defined in [ISO18013-3], which is equivalent to the BAC protocol, but based on AES (in CBC mode for
encryption and decryption following [NIST800-38A] and as a CMAC for message authentication following
[NIST800-38B]).
 [selection: Triple-DES, AES or other approved algorithms]
51




                                                   60 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                         to support user authentication.
FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                         rules:
                         1. Having successfully run the PACE protocol the TOE accepts only received
                            commands with correct message authentication code sent by means of se-
                            cure messaging with the key agreed with the terminal by means of the PACE
                            protocol.
                         2. The TOE accepts the authentication attempt as Personalisation Agent by Au-
                            thentication Mechanism with Personalization Agent Keys52.
                         3. After run of the Chip Authentication Protocol v. 1 the TOE accepts only re-
                            ceived commands with correct message authentication code sent by means
                            of secure messaging with key agreed with the terminal by means of the Chip
                            Authentication Mechanism v. 1.
                         4. The TOE accepts the authentication attempt by means of the Terminal Au-
                            thentication Protocol v.1 only if the terminal uses the public key presented
                            during the Chip Authentication Protocol v.1 and the secure messaging estab-
                            lished by the Chip Authentication Protocol v.1.53
                         5. None.54

PP application note 28: The SFR FIA_UAU.5.1/PACE in this ST covers the definition in PACE PP [PP0068v2]
and extends it by EAC aspects 4), 5), and 6). The SFR FIA_UAU.5.2/PACE in this ST covers the definition in
PACE PP [PP0068v2] and extends it by EAC aspects 2), 3), 4) and 5). These extensions do not conflict with
the strict conformance to PACE PP.
PP0068v2 application note 36: Please note that Passive Authentication does not authenticate any TOE’s
user, but provides evidence enabling an external entity (the terminal connected) to prove the origin of
ePassport application.


FIA_UAU.6/EAC Re-authenticating – Re-authenticating of Terminal by the TOE
Hierarchical to:         No other components.
Dependencies:            No dependencies.
FIA_UAU.6.1/EAC          The TSF shall re-authenticate the user under the conditions each command sent to
                         the TOE after successful run of the Chip Authentication Protocol Version 1 shall be
                         verified as being sent by the Inspection System.


PP application note 29: The Password Authenticated Connection Establishment and the Chip Authentica-
tion Protocol specified in [ICAODoc] include secure messaging for all commands exchanged after successful
authentication of the Inspection System. The TOE checks by secure messaging in MAC_ENC mode each
command based on a corresponding MAC algorithm whether it was sent by the successfully authenticated
terminal (see FCS_COP.1/CA_MAC for further details). The TOE does not execute any command with incor-
rect message authentication code. Therefore the TOE re-authenticates the user for each received command
and accepts only those commands received from the previously authenticated user.


 [selection: the Authentication Mechanism with Personalisation Agent Key(s)]
52

53   [assignment: rules describing how the multiple authentication mechanisms provide authentication]
 [assignment: rules describing how the multiple authentication mechanisms provide authentication]
54




                                                   61 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite




FIA_UAU.6/PACE Re-authenticating – Re-authenticating of Terminal by the TOE
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FIA_UAU.6.1/PACE        The TSF shall re-authenticate the user under the conditions each command sent to
                        the TOE after successful run of the PACE protocol shall be verified as being sent by
                        the PACE terminal.


PP0068v2 Application note 37:The PACE protocol specified in [ICAO-SAC] starts secure messaging used for
all commands exchanged after successful PACE authentication. The TOE checks each command by secure
messaging in encrypt-then-authenticate mode based on CMAC or Retail-MAC, whether it was sent by the
successfully authenticated terminal (see FCS_COP.1/PACE_MAC for further details). The TOE does not exe-
cute any command with incorrect message authentication code. Therefore, the TOE re-authenticates the
terminal connected, if a secure messaging error occurred, and accepts only those commands received from
the initially authenticated terminal.

6.2.3 Class FDP User Data Protection
The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below (Common Cri-
teria Part 2).
FDP_ACC.1/TRM Subset access control
Hierarchical to:        No other components.
Dependencies:           FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1/TRM         The TSF shall enforce the Access Control SFP on terminals gaining access to the
                        User data and data stored in EF.Sod of the logical travel document.


PP Application note 31: The SFR FDP_ACC.1.1 in this ST covers the definition in PACE PP [PP0068v2] and
extends it by data stored in EF.SOD of the logical travel document. This extension does not conflict with the
strict conformance to PACE PP.
PP0068v2 application note 38:<applied>


FDP_ACF.1/TRM Security attribute based access control
Hierarchical to:        No other components.
Dependencies:           FDP_ACC.1 Subset access control
                        FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1/TRM         The TSF shall enforce the Access Control SFP to objects based on thefollowing:
                        1. Subjects:
                           a. Terminal,
                           b. BIS-PACE,
                           c. Extended Inspection System.
                        2. Objects:
                           a. data EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the
                              logicalMRTD,
                           b. data in EF.DG3 of the logical MRTD,


                                                   62 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


                             c. data in EF.DG4 of the logical MRTD,
                             d. all TOE intrinsic secret cryptographic keys stored in the travel document.
                        3. Security attributes:
                             a. PACE Authentication,
                             b. Terminal Authentication v.1,
                             c. Authorization of the Terminal.
FDP_ACF.1.2/TRM         The TSF shall enforce the following rules to determine if an operation among con-
                        trolled subjects and controlled objects is allowed: A BIS-PACE is allowed to read
                        data objects from FDP_ACF.1.1/TRM according to [TR-03110] after a successful
                        PACE authentication as required by FIA_UAU.1/PACE.
FDP_ACF.1.3/TRM         The TSF shall explicitly authorize access of subjects to objects based on the following
                        additional rules: none.
FDP_ACF.1.4/TRM         The TSF shall explicitly deny access of subjects to objects based on the rule:
                        1. Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                           allowed to read, to write, to modify, to use any User Data stored on the travel
                           document.
                        2. Terminals not using secure messaging are not allowed to read, to write, to
                           modify, to use any data stored on the travel document.
                        3. Any terminal being not successfully authenticated as Extended Inspection Sys-
                           tem with the Read access to DG 3 (Fingerprint) granted by the relative certifi-
                           cate holder authorization encoding is not allowed to read the data objects 2b)
                           of FDP_ACF.1.1/TRM.
                        4. Any terminal being not successfully authenticated as Extended Inspection Sys-
                           tem with the Read access to DG 4 (Iris) granted by the relative certificate
                           holder authorization encoding is not allowed to read the data objects 2c) of
                           FDP_ACF.1.1/TRM.
                        5. Nobody is allowed to read the data objects 2d) of FDP_ACF.1.1/TRM.
                        6. Terminals authenticated as CVCA or as DV are not allowed to read data in the
                           EF.DG3 and EF.DG4.

PP application note 32: The SFR FDP_ACF.1.1/TRM in this ST covers the definition in PACE PP [PP0068v2]
and extends it by additional subjects and objects. The SFRs FDP_ACF.1.2/TRM and FDP_ACF.1.3/TRM in this
ST cover the definition in PACE PP [PP0068v2]. The SFR FDP_ACF.1.4/TRM in this ST covers the definition in
PACE PP [PP0068v2] and extends it by 3) to 6).These extensions do not conflict with the strict conformance
to PACE PP.
PP0068v2 application note 39: <applied>
PP application note 33: The relative certificate holder authorization encoded in the CVC of the inspection
system is defined in [TR-03110]. The TOE verifies the certificate chain established by the Country Verifying
Certification Authority, the Document Verifier Certificate and the Inspection System Certificate (cf.
FMT_MTD.3). The Terminal Authorization is the intersection of the Certificate Holder Authorization in the
certificates of the Country Verifying Certification Authority, the Document Verifier Certificate and the In-
spection System Certificate in a valid certificate chain.
PP application note 34, PP0068v2 application note 40: Please note that the Document Security Object
(SOD) stored in EF.SOD (see [ICAODoc]) does not belong to the user data, but to the TSF data. The Document
Security Object can be read out by Inspection Systems using PACE, see [ICAO_SAC].



                                                   63 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


PP application note 35: FDP_UCT.1/TRM and FDP_UIT.1/TRM require the protection of the User Data trans-
mitted from the TOE to the terminal by secure messaging with encryption and message authentication
codes after successful Chip Authentication Version 1 to the Inspection System. The Password Authenticated
Connection Establishment, and the Chip Authentication Protocol v.1 establish different key sets to be used
for secure messaging (each set of keys for the encryption and the message authentication key).
PP0068v2 application note 41: Please note that the control on the user data transmitted between the TOE
and the PACE terminal is addressed by FTP_ITC.1/PACE.


FDP_RIP.1 Subset residual information protection
Hierarchical to:        No other components.
Dependencies:           No dependencies
FDP_RIP.1.1             The TSF shall ensure that any previous information content of a resource is made
                        unavailable upon the deallocation of the resource from55 the following objects:
                        1. Session Keys (immediately after closing related communication session),
                        2. the ephemeral private key ephem SKPICC PACE (by having generated a DH
                           shared secret K)
                        3. None56

PP0068v2 application note 42: The functional family FDP_RIP possesses such a general character, so that it
is applicable not only to user data (as assumed by the class FDP), but also to TSF-data; in this respect it is
similar to the functional family FPT_EMS. Applied to cryptographic keys, FDP_RIP.1 requires a certain quality
metric (‘any previous information content of a resource is made unavailable’) for key’s destruction in addi-
tion to FCS_CKM.4 that merely requires a fact of key destruction according to a method/standard.


FDP_UCT.1/TRM Basic data exchange confidentiality – MRTD
Hierarchical to:        No other components.
Dependencies:           FTP_ITC.1 Inter-TSF trusted channel, or
                        FTP_TRP.1 Trusted path]: fulfilled by FTP_ITC.1/PACE
                        [FDP_ACC.1 Subset access control, or
                        FDP_IFC.1 Subset information flow control]: fulfilled by FDP_ACC.1/TRM
FDP_UCT.1.1/TRM         The TSF shall enforce the Access Control SFP to be able to transmit and receive user
                        data in a manner protected from unauthorized disclosure.


FDP_UIT.1/TRM Data exchange integrity
Hierarchical to:        No other components.
Dependencies:           [FTP_ITC.1 Inter-TSF trusted channel, or
                        FTP_TRP.1 Trusted path]: fulfilled by FTP_ITC.1/PACE
                        [FDP_ACC.1 Subset access control, or
                        FDP_IFC.1 Subset information flow control]: fulfilled by FDP_ACC.1/TRM



 [selection: allocation of the resource to, deallocation of the resource from]
55


 [assignment: list of objects]
56




                                                   64 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


FDP_UIT.1.1/TRM         The TSF shall enforce the Access Control SFP to be able to transmit and receive user
                        data in a manner protected from modification, deletion, insertion and replay er-
                        rors.
FDP_UIT.1.2/TRM         The TSF shall be able to determine on receipt of user data, whether modification,
                        deletion, insertion and replay has occurred.

6.2.4 Class FTP Trusted Path/Channels
FTP_ITC.1/PACE Inter-TSF trusted channel after PACE
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FTP_ITC.1.1/PACE        The TSF shall provide a communication channel between itself and another trusted
                        IT product that is logically distinct from other communication channels and provides
                        assured identification of its end points and protection of the channel data from
                        modification or disclosure.
FTP_ITC.1.2/PACE        The TSF shall permit another trusted IT product to initiate communication via the
                        trusted channel.
FTP_ITC.1.3/PACE        The TSF shall initiate enforce communication via the trusted channel for any data
                        exchange between the TOE and the Terminal.


PP0068v2 application note 43: The trusted IT product is the terminal. In FTP_ITC.1.3/PACE, the word “initi-
ate” is changed to ‘enforce”, as the TOE is a passive device that can not initiate the communication. All the
communication are initiated by the Terminal, and the TOE enforce the trusted channel.
PP0068v2 application note 44: The trusted channel is established after successful performing the PACE
protocol (FIA_UAU.1/PACE). If the PACE was successfully performed, secure messaging is immediately
started using the derived session keys (PACE-KMAC, PACE-KEnc): this secure messaging enforces preventing
tracing while Passive Authentication and the required properties of operational trusted channel; the cryp-
tographic primitives being used for the secure messaging are as required by FCS_COP.1/PACE_ENC and
FCS_COP.1/PACE_MAC. The establishing phase of the PACE trusted channel does not enable tracing due to
the requirements FIA_AFL.1/PACE.
PP0068v2 application note 45: Please note that the control on the user data stored in the TOE is addressed
by FDP_ACF.1/TRM.

6.2.5 Class FAU Security Audit
FAU_SAS.1 Audit storage
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FAU_SAS.1.1             The TSF shall provide the Manufacturer with the capability to store the Initialisa-
                        tion and Pre-Personalisation Data in the audit records.


PP0068v2 application note 46: The Manufacturer role is the default user identity assumed by the TOE in
the life cycle phase ‘manufacturing’. The IC manufacturer and the travel document manufacturer in the
Manufacturer role write the Initialisation and/or Pre-personalisation Data as TSF-data into the TOE. The
audit records are usually write-only-once data of the travel document (see FMT_MTD.1/INI_ENA,
FMT_MTD.1/INI_DIS). Please note that there could also be such audit records which cannot be read out,
but directly used by the TOE.


                                                   65 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite




6.2.6 Class FMT Security Management
FMT_SMF.1 Specification of Management Functions
Hierarchical to:        No other components.
Dependencies:           No Dependencies
FMT_SMF.1.1             The TSF shall be capable of performing the following management functions:
                        1. Initialization,
                        2. Pre-personalization,
                        3. Personalization,
                        4. Configuration.

PP application note 36:The SFR FMT_SMR.1/PACE provides basic requirements to the management of the
TSF data.


FMT_SMR.1/PACE Security roles
Hierarchical to:        No other components.
Dependencies:           FIA_UID.1 Timing of identification.
FMT_SMR.1.1/PACE                 The TSF shall maintain the roles
                        1. Manufacturer,
                        2. Personalization Agent,
                        3. Terminal,
                        4. PACE authenticated BIS-PACE,
                        5. Country Verifying Certification Authority,
                        6. Document Verifier,
                        7. Domestic Extended Inspection System,
                        8. Foreign Extended Inspection System.
FMT_SMR.1.2/PACE        The TSF shall be able to associate users with roles.


PP application note 37: The SFR FMT_SMR.1.1/PACE in this ST covers the definition in PACE PP [PP0068v2]
and extends it by 5) to 8). This extension does not conflict with the strict conformance to PACE PP.
PP application note 38: The SFR FMT_LIM.1 and FMT_LIM.2 address the management of the TSF and TSF
data to prevent misuse of test features of the TOE over the life-cycle phases.
PP0068v2 application note 47: For explanation on the role Manufacturer and Personalisation Agent please
refer to the glossary of [PP00n JCOP4 P71 / PP0056v2 based Security Target Lite


  SFR                            Dependencies                            Support of the Dependencies
  FAU_SAS.1                      No dependencies.                        n.a.
  FCS_CKM.1/DH_PACE              [FCS_CKM.2 Cryptographic key dis-       Justification 2 for non-satisfied
                                 tribution or                            dependencies
                                 FCS_COP.1 Cryptographic opera-
                                 tion],                                  Fulfilled by FCS_CKM.4
                                 FCS_CKM.4 Cryptographic key de-
                                 struction
  FCS_CKM.1/CA                   [FCS_CKM.2 Cryptographic key dis-       Fulfilled by FCS_COP.1/CA_ENC,
                                 tribution or                            and FCS_COP.1/CA_MAC,
                                 FCS_COP.1 Cryptographic opera-
                                 tion],                                  Fulfilled by FCS_CKM.4
                                 FCS_CKM.4 Cryptographic key de-
                                 struction
  FCS_CKM.1/AA                   [FCS_CKM.2 Cryptographic key dis-       Fulfilled by FCS_COP.1/SIG_GEN,
                                 tribution or
                                 FCS_COP.1 Cryptographic opera-
                                 tion],
                                                                         Justification 3 for non-satisfied
                                 FCS_CKM.4 Cryptographic key de-         dependencies
                                 struction
  FCS_CKM.4                      [FDP_ITC.1 Import of user data with-    Fulfilled by
  from[PP0068v2]                 out security attributes, or             FCS_CKM.1/DH_PACE,
                                 FDP_ITC.2 Import of user data with      FCS_CKM.1/AA and
                                 security attributes, or                 FCS_CKM.1/CA
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration]
  FCS_COP.1/PACE_ENC             [FDP_ITC.1 Import of user data with-    Fulfilled by
                                 out security attributes,                FCS_CKM.1/DH_PACE,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               Fulfilled by FCS_CKM.4

  FCS_COP.1/PACE_MAC             [FDP_ITC.1 Import of user data with-    Fulfilled by
                                 out security attributes,                FCS_CKM.1/DH_PACE,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               Fulfilled by FCS_CKM.4




                                                   77 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


  FCS_COP.1/CA_ENC               [FDP_ITC.1 Import of user data with-    Fulfilled by FCS_CKM.1/CA,
                                 out security attributes,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographickey gener-
                                 ation],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               Fulfilled by FCS_CKM.4
  FCS_COP.1/CA_MAC               [FDP_ITC.1 Import of user data with-    Fulfilled by FCS_CKM.1/CA,
                                 out security attributes,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               Fulfilled by FCS_CKM.4
  FCS_COP.1/SIG_VER              [FDP_ITC.1 Import of user data with-    Fulfilled by FCS_CKM.1/CA,
                                 out security attributes,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               Fulfilled by FCS_CKM.4
  FCS_COP.1/SIG_GEN              [FDP_ITC.1 Import of user data with-    Fulfilled by FCS_CKM.1/AA,
                                 out security attributes,
                                 FDP_ITC.2 Import of user data with
                                 security attributes, or
                                 FCS_CKM.1 Cryptographic key gen-
                                 eration],
                                 FCS_CKM.4 Cryptographic key de-
                                 struction                               See justification No. 3.
  FCS_RND.1                      No dependencies                         n.a.
  FIA_AFL.1/PACE                 FIA_UAU.1 Timing of authentication      Fulfilled by FIA_UAU.1/PACE
  FIA_UID.1/PACE                 No dependencies                         n.a.
  FIA_UAU.1/PACE                 FIA_UID.1 Timing ofidentfication        Fulfilled by FIA_UID.1/PACE
  FIA_UAU.4/PACE                 No dependencies                         n.a.
  FIA_UAU.5/PACE                 No dependencies                         n.a.
  FIA_UAU.6/EAC                  No dependencies                         n.a.
  FIA_API.1                      No dependencies                         n.a.
  FIA_API.1/AA                   No dependencies                         n.a.
  FDP_ACC.1/TRM                  FDP_ACF.1 Security attribute based      Fulfilled by FDP_ACF.1/TRM
                                 access control


                                                   78 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


  FDP_ACF.1/TRM                  FDP_ACC.1 Subset accesscontrol,         Fulfilled by FDP_ACC.1/TRM,
                                 FMT_MSA.3 Static attribute initiali-    Justification 1 for non-satisfied
                                 zation                                  dependencies
  FDP_RIP.1                      No dependencies                         n.a.
  FDP_UCT.1/TRM                  [FTP_ITC.1 Inter-TSF trusted chan-      Fulfilled by FTP_ITC.1/PACE
                                 nel, or
                                 FTP_TRP.1 Trusted path]
                                 [FDP_ACC.1 Subset access control,
                                 or
                                                                         Fulfilled by FDP_ACC.1/TRM
                                 FDP_IFC.1 Subset information flow
                                 control]
  FDP_UIT.1/TRM                  [FTP_ITC.1 Inter-TSF trusted chan-      Fulfilled by FTP_ITC.1/PACE
                                 nel, or
                                 FTP_TRP.1 Trusted path]
                                 [FDP_ACC.1 Subset access control,
                                 or
                                                                         Fulfilled by FDP_ACC.1/TRM
                                 FDP_IFC.1 Subset information flow
                                 control]
  FMT_SMF.1                      No dependencies                         n.a.
  FMT_SMR.1/PACE                 FIA_UID.1 Timing of identification      Fulfilled by FIA_UID.1/PACE
  FMT_LIM.1                      FMT_LIM.2                               Fulfilled by FMT_LIM.2
  FMT_LIM.2                      FMT_LIM.1                               Fulfilled by FMT_LIM.1
  FMT_MTD.1/INI_ENA              FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE
  FMT_MTD.1/INI_DIS              FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE
  FMT_MTD.1/CVCA_INI             FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions,
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE
  FMT_MTD.1/CVCA_UPD             FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions,
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE
  FMT_MTD.1/DATE                 FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions,
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE
  FMT_MTD.1/CAPK                 FMT_SMF.1 Specification of man-         Fulfilled by FMT_SMF.1
                                 agement functions,
                                 FMT_SMR.1 Security roles                Fulfilled by FMT_SMR.1/PACE



                                                   79 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


     FMT_MTD.1/ PA                 FMT_SMF.1 Specification of man-       Fulfilled by FMT_SMF.1
                                   agement functions
                                   FMT_SMR.1 Security roles              Fulfilled by FMT_SMR.1/PACE
     FMT_MTD.1/AA                  FMT_SMF.1 Specification of man-       Fulfilled by FMT_SMF.1
                                   agement functions,
                                   FMT_SMR.1 Security roles              Fulfilled by FMT_SMR.1/PACE
     FMT_MTD.3                     FMT_MTD.1                             Fulfilled by
                                                                         FMT_MTD.1/CVCA_INI
                                                                         andFMT_MTD.1/CVCA_UPD
     FPT_EMS.1                     No dependencies                       n.a.
     FTP_ITC.1/PACE                No dependencies                       n.a.
                             Table 15: Dependencies between the SFR for the TOE

Justifications for non-satisfied dependencies between the SFR for TOE:
No. 1: The access control TSF according to FDP_ACF.1/TRM uses security attributes which are defined during
the personalisation and are fixed over the whole life time of the TOE. No management of these security
attribute (i.e. SFR FMT_MSA.1 and FMT_MSA.3) is necessary here.
No. 2: A Diffie-Hellman key agreement is used in order to have no key distribution, therefore FCS_CKM.2
makes no sense in this case.77
No. 3: The Active Authentication key pair cannot be deleted or regenerated.

6.4.3 Security Assurance Requirements Rationale
The EAL5 was chosen to permit a developer to gain maximum assurance from positive security engineering
based on good commercial development practices and a Java card platform that offers cryptographic func-
tionality certified according to EAL5 or higher.
The selection of the component ALC_DVS.2 provides a higher assurance of the security of the travel docu-
ment’s development and manufacturing especially for the secure handling of the travel document’s mate-
rial.
The selection of the component AVA_VAN.5 provides a higher assurance of the security by vulnerability
analysis to assess the resistance to penetration attacks performed by an attacker possessing a high attack
potential. This vulnerability analysis is necessary to fulfil the security objectives OT.Sens_Data_Conf and
OT.Chip_Auth_Proof.
The component ALC_DVS.2 has no dependencies. The component AVA_VAN.5 has the following dependen-
cies:
          ADV_ARC.1 Security architecture description
          ADV_FSP.4 Complete functional specification
          ADV_TDS.3 Basic modular design
          ADV_IMP.1 Implementation representation of the TSF
          AGD_OPE.1 Operational user guidance
          AGD_PRE.1 Preparative procedures
All of these are met or exceeded in the EAL5 assurance package.



77   This justification was taken from [PP0068v2].

                                                     80 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


6.4.4 Security Requirements – Mutual Support and Internal Consistency
This security target claims strict conformance to the Protection Profiles given insection 2.2. Therefore this
security target includes the analysis of the internal consistency of the Security Requirements of the Protec-
tion Profiles without repeating these here.
As the complete Security Problem Definition, the Extended Components and the Security Functional Re-
quirements have also been included, the consistency analysis of the Protection Profiles is also valid for this
security target.
The additions made to include the Active Authentication Mechansim have been integrated in a consistent
way to the model designed by the Protection Profiles, e. g. by using the subject, object and operation defi-
nitions.
Inconsistency between functional and assurance requirements could only arise if there are functional-as-
surance dependencies which are not met, a possibility which has been shown not to arise in sections 6.3.2
Dependency Rationale and 6.3.3 Security Assurance Requirements Rationale. Furthermore, as also dis-
cussed in section 6.3.3 Security
Assurance Requirements Rationale, the chosen assurance components are adequate for the functionality
of the TOE. So the assurance requirements and security functional requirements support each other and
there are no inconsistencies between the goals ofthese two groups of security requirements.




                                                   81 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


7 TOE summary specification (ASE_TSS)

7.1 TOE Security Functionality

7.1.1 TSF_Access: Access Control
This security functionality manages the access to objects (files, directories, data and secrets) stored in the
applet’s file system. It also controls write access of initialization, pre-personalization and personalization
data. Access control for initialization and pre-personalization in Phase 2 – while the actual applet is not yet
present – is based on the card manager of the underlying JCOP4 P71 Java Card platform (SF.CM).
Access is granted (or denied) in accordance to access rights that depend on appropriate identification and
authentication mechanisms.
TSF_Access covers the following SFRs:
       FIA_UID.1.1/PACE requires that the TSF shall allow to establish the communication channel, to carry
        out the PACE Protocol, to read the Initialization Data if it is not disabled by TSF according to
        FMT_MTD.1/INI_DIS, to carry out the Chip Authentication Protocol, to carry out the Terminal Au-
        thentication Protocol, and to carry out the Active Authentication Mechanism on behalf of the user
        to be performed before the user is identified. FIA_UID.1.2 requires that the TSF shall require each
        user to be successfully identified before allowing any other TSF-mediated actions on behalf of that
        user. TSF_Access realizes the appropriate control of the access rights, TSF_Auth the authentication
        mechanisms.
       FIA_UAU.1/PACE requires that the TSF shall allow to establish the communication channel, to carry
        out the PACE Protocol, to read the Initialization Data if it is not disabled by TSF according to
        FMT_MTD.1/INI_DIS, to identify themselves by selection of the authentication key, to carry out the
        Chip Authentication Protocol, to carry out the Terminal Authentication Protocol, and to carry out
        the Active Authentication Mechanism on behalf of the user to be performed before the user is au-
        thenticated. FIA_UAU.1.2 requires that the TSF shall require each user to be successfully authenti-
        cated before allowing any other TSF-mediated actions on behalf of that user. TSF_Access realizes
        the appropriate control of the access rights.
       FIA_UAU.4/PACE requires that the TSF shall prevent reuse of authentication data related to the
        PACE Protocol, the Terminal Authentication Protocol, and the Authentication Mechanism based on
        AES. TSF_Access realizes the appropriate control of the access rights.
       FIA_UAU.5.1/PACE requires that the TSF shall provide the PACE Protocol, Passive Authentication,
        Terminal Authentication, Secure messaging in MAC-ENC mode, Symmetric Authentication Mecha-
        nism based on AES, and the Terminal Authentication Protocol to support user authentication.
        FIA_UAU.5.2/PACE requires that the TSF shall authenticate any user’s claimed identity according to
        specified rules. TSF_Access realizes the appropriate control of the access rights.
       FIA_UAU.6/PACE requires that the TSF shall re-authenticate the user under the condition that each
        command sent to the TOE after successful run of the PACE Protocol shall be verified as being sent
        by the terminal. TSF_Access realizes the appropriate control of the access rights.
       FIA_UAU.6/EAC requires that the TSF shall re-authenticate the user under the condition that each
        command sent to the TOE after successful run of the Chip Authentication Protocol shall be verified
        as being sent by the Inspection System. TSF_Access realizes the appropriate control of the access
        rights.
       FDP_ACC.1/TRM requires that the TSF shall enforce the Access Control SFP on terminals gaining
        access to the User data and data stored in EF.Sod of the logical travel document.. TSF_Access real-
        izes the appropriate control of the access rights.


                                                   82 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


      FDP_ACF.1/TRM: FDP_ACF.1.1 requires that the TSF shall enforce the Access Control SFP to objects
       based on Subjects (Terminal,BIS-PACE, Extended Inspection System), Objects (data EF.DG1, EF.DG2
       and EF.DG5 to EF.DG16, EF.SOD and EF.COM of the logical MRTD, data in EF.DG3 of the logical
       MRTD, data in EF.DG4 of the logical MRTD, all TOE intrinsic secret cryptographic keys stored in the
       travel document) and Security attributes (PACE Authentication,Terminal Authentication v.1,Author-
       ization of the Terminal). FDP_ACF.1.2 requires that the TSF shall enforce the following rules to de-
       termine if an operation among con-trolled subjects and controlled objects is allowed: a BIS-PACE is
       allowed to read data objects from FDP_ACF.1.1/TRM according to [TR-03110] after a successful
       PACE authentication as required by FIA_UAU.1/PACE. FDP_ACF.1.3 requires that the TSF shall ex-
       plicitly authorize access of subjects to objects based on the following additional rules: none.
       FDP_ACF.1.4 requires that the TSF shall explicitly deny access of subjects to objects based on the
       rules: (1.) Any terminal being not authenticated as PACE authenticated BIS-PACE is not allowed to
       read, to write, to modify, to use any User Data stored on the travel document; (2) Terminals not
       using secure messaging are not allowed to read, to write, to modify, to use any data stored on the
       travel document; (3) Any terminal being not successfully authenticated as Extended Inspection Sys-
       tem with the Read access to DG 3 (Fingerprint) granted by the relative certificate holder authoriza-
       tion encoding is not allowed to read the data objects 2b) of FDP_ACF.1.1/TRM; (4) any terminal
       being not successfully authenticated as Extended Inspection System with the Read access to DG 4
       (Iris) granted by the relative certificate holder authorization encoding is not allowed to read the
       data objects 2c) of FDP_ACF.1.1/TRM; (5) nobody is allowed to read the data objects 2d) of
       FDP_ACF.1.1/TRM; (6) terminals authenticated as CVCA or as DV are not allowed to read data in the
       EF.DG3 and EF.DG4.TSF_Access realizes the appropriate control of the access rights.
      FDP_UCT.1/TRM requires that the TSF shall enforce the Access Control SFP to be able to transmit
       and receive user data in a manner protected from unauthorized disclosure. TSF_Access realizes the
       appropriate control of the access rights.
      FDP_UIT.1/TRM requires that the TSF shall enforce the Access Control SFP to be able to transmit
       and receive user data in a manner protected from modification, deletion, insertion and replay er-
       rors. FDP_UIT.1.2 requires that the TSF shall be able to determine on receipt of user data, whether
       modification, deletion, insertion and replay has occurred. TSF_Access realizes the appropriate con-
       trol of the access rights.
      FMT_SMR.1/PACE requires that the TSF shall maintain the roles (1.) Manufacturer , (2.) Personali-
       zation Agent , (3) Terminal, (4) PACE authenticated BIS-PACE, (5) Country Verifying Certification
       Authority, (6) Document Verifier, (7) Domestic Extended Inspection System, (8) Foreign Extended
       Inspection System. FMT_SMR.1.2 requires that the TSF shall be able to associate users with roles.
       TSF_Access realizes the appropriate control of the access rights.
      FMT_LIM.1 requires that the TSF shall be designed in a manner that limits their capabilities so that
       in conjunction with “Limited availability (FMT_LIM.2)” the following policy is enforced: Deploying
       Test Features after TOE Delivery does not allow (1) User Data to be manipulated, (2) TSF data to be
       disclosed or manipulated, (3) software to be reconstructed, (4) substantial information about con-
       struction of TSF to be gathered which may enable other attacks, (5) sensitive User Data (EF.DG3 and
       EF.DG4) to be disclosed. This is realized by TSF_Access.
      FMT_LIM.2 requires that the TSF shall be designed in a manner that limits their availability so that
       in conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is enforced: Deploying
       Test Features after TOE Delivery does not allow (1) User Data to be manipulated, (2) TSF data to be
       disclosed or manipulated, (3) software to be reconstructed, (4) substantial information about con-
       struction of TSF to be gathered which may enable other attacks, (5) sensitive User Data (EF.DG3 and
       EF.DG4) to be disclosed. This is realized by TSF_Access.




                                                   83 of 104
NXP eDoc Suite v3.5 on JCOP4 P71 / PP0056v2 based Security Target Lite


       FMT_MTD.1.1/CVCA_INI requires that the TSF shall restrict the ability to write the (1.) initial Coun-
        try Verifying Certification Authority Public Key, the (2.) initial Country Verifying Certification Author-
        ity Certificate, and the (3.) initial Current Date to the Personalization Agent. TSF_Access realizes the
        appropriate control of the access rights.
       FMT_MTD.1.1/CVCA_UPD requires that the TSF shall restrict the ability to update the (1.) Country
        Verifying Certification Authority Public Key and the (2.) Country Verifying Certification Authority
        Certificate to the Country Verifying Certification Authority. TSF_Access realizes the appropriate con-
        trol of the access rights.
       FMT_MTD.1.1/DATE requires that the TSF shall restrict the ability to modify the Current date to the
        (1.) Country Verifying Certification Authority, the (2.) Document Verifier, and the (3.) Domestic Ex-
        tended Inspection System. TSF_Access realizes the appropriate control of the access rights.
       FMT_MTD.1.1/CAPK requires that the TSF shall restrict the ability to load the Chip Authentication
        Private Key to the Personalization Agent. TSF_Access realizes the appropriate control of the access
        rights.
       FMT_MTD.1.1/KEY_READ requires that the TSF shall restrict the ability to read the (1.) PACE pass-
        words, the (2.) Chip Authentication Private Key, and the (3.) Personalization Agent Keys to none.
        TSF_Access realizes the appropriate control of the access rights.
       FMT_MTD.1/AA requires that the TSF shall restrict the ability to create or load the Active Authen-
        tication Private Key to the Manufacturer and the Personalisation Agent. TSF_Access realizes the
        appropriate control of the access rights.
       FMT_MTD.1/PA requires that the TSF shall restrict the ability to write the Document Security Object
        (SOD) to the Personalisation Agent. TSF_Access realizes the appropriate control of the access rights.
       FIA_AFL.1/PACE requires that the TOE shall detect when 10 unsuccessful authentication attempts
        have occured related to authentication attempts using the PACE password, and that there shall be
        an delay by an increasing amount of time after each of the following authentication attempt until
        the next successful authentication attempt has happened. This is realized by TSF_Access.
       FTP_ITC.1/PACE: FTP_ITC.1.1/PACE requires that the TSF shall provide a communication channel
        between itself and another trusted IT product that is logically distinct from other communication
        channels and provides assured identification of its end points and protection of the channel data
        from modification or disclosure; FTP_ITC.1.2/PACE requires that the TSF shall permit another
        trusted IT product to initiate communication via the trusted channel, and FTP_ITC.1.3/PACE re-
        quires that the TSF shall initiate enforce communication via the trusted channel for any data ex-
        change                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECC over GF(p) Library                1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECDAA                                 1.0
                                                                                                                  SN200x Crypto Library: User Manual – TwdEdMontGfp Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – eUICC Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Symmetric Cipher Library (SymCfg)     1.1
                                                                                                                  SN200x Crypto Library: User Manual – Utils Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – HASH Library                          1.0
                                                                                                                  SN200x Crypto Library: Errata sheet                                        1.0


                                                                                                 Table 4 Manuals of SN200_SE B1.1 specific for C04
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 2.6      IT Product Testing
                                                                                                 Testing (depth, coverage, functional tests, independent testing): The evaluators examined the
                                                                                                 developer’s testing activities documentation and verified that the developer has met their testing
                                                                                                 responsibilities.

                                                                                                 2.6.1      Testing approach and depth
                                                                                                 The developer has performed extensive testing on functional specification, subsystem and modules
                                                                                                 (according to EAL6 requirements). The testing was largely automated using industry standard and
                                                                                                 proprietary test suites. Test scripts were extensively used to verify that the functions return the
                                                                                                 expected values.
                                                                                                 For the testing performed by the evaluators, the developer has provided samples and a test
                                                                                                 environment. The evaluators have reproduced a selection of the developer tests, as well as a small
                                                                                                 number of test cases designed by the evaluator. For the evaluator defined tests the developer
                                                                                                 delivered samples (and support in writing scripts). However, Riscure’s test environment was used for
                                                                                                 these ATE_IND tests.
                                                                                                 The underlying hardware and crypto-library test results are extendable to composite evaluations, as
                                                                                                 the underlying platform is operated according to its guidance and the composite evaluation
                                                                                                 requirements are met.
                                                                                                 Page: 11/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                 2.6.2    Independent Penetration Testing
                                                                                                 The evaluator independent penetration tests were conducted according to the following testing
                                                                                                 approach:
                                                                                                     • During evaluation of the ADV, ATE and ALC classes the evaluators hypothesized possible
                                                                                                        vulnerabilities. This resulted in a shortlist of possible vulnerabilities to be further analysed in
                                                                                                        AVA using the design knowledge gained in particular from the source code analysis in IMP.
                                                                                                        This resulted in a shortlist of potential vulnerabilities to be tested.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    