Public




   Common Criteria Public Security Target
   EAL6 augmented / EAL6+
   IFX_CCI_000003h
   IFX_CCI_000005h
   IFX_CCI_000008h
   IFX_CCI_00000Ch
   IFX_CCI_000013h
   IFX_CCI_000014h
   IFX_CCI_000015h
   IFX_CCI_00001Ch
   IFX_CCI_00001Dh
   IFX_CCI_000021h
   IFX_CCI_000022h

   H13

   Resistance to attackers with HIGH attack potential
                                    Including optional Software Libraries
                            Flash Loader ‚Äì 3x ACL ‚Äì 4x HSL ‚Äì 2x SCL ‚Äì NRG ‚Äì CCL




 Author: Infineon Technologies
 Revision: 1.8




CC Document            Please read the Important Notice and Warnings at the end of this document          1.8
www.infineon.com                                                                                   2020-04-22
Public




Table of Contents
2.2.1         Hardware of the TOE ...................................................................................................................26
2.2.2         Firmware and software of the TOE .............................................................................................. 27
2.2.3         Interfaces of the TOE................................................................................................................... 32
2.2.4         Guidance documentation ............................................................................................................ 33
2.2.5         Forms of delivery ......................................................................................................................... 35
2.2.6         Production sites ........................................................................................................................... 37
3.1.1         Adding Objectives ....................................................................................................................... 39
3.1.2         AES and TDES .............................................................................................................................40
3.1.3         Loader .........................................................................................................................................40
3.1.4         CIPURSE Cryptographic Library (CCL) ......................................................................................... 41
3.1.5         Summary .....................................................................................................................................42
4.1.1         Additional Threat due to TOE specific Functionality .................................................................... 43
4.1.2         Assets regarding the Threats .......................................................................................................44
4.2.1         Augmented Organizational Security Policy .................................................................................46
4.3.1         Augmented Assumptions ............................................................................................................ 47
4.3.2         Note regarding CIPURSE‚Ñ¢ CL .....................................................................................................48
5.3.1         Clarification of ‚ÄúTreatment of User Data (OE.Resp-Appl)‚Äù .......................................................... 54
5.3.2         Clarification of ‚ÄúProtection during Composite product Manufacturing (OE.Process-Sec-IC)‚Äù ...... 54
6.1.1         Definition of FPT_TST.2 ..............................................................................................................60
6.1.2         TSF self-test (FPT_TST) ............................................................................................................... 61
7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1 ................................................................... 65
7.1.2         Subset of TOE testing.................................................................................................................. 70
7.1.3         Memory access control ................................................................................................................ 71
7.1.4         Support of Cipher Schemes ......................................................................................................... 74
7.1.5         Data Integrity FDP_SDI.2 and FDP_SDC.1 ................................................................................. 103
7.1.6         Application Note to FPT_FLS.1 Failure with preservation of secure state .................................. 104
7.3.1         Refinements .............................................................................................................................. 109
7.4.1         Rationale for the Security Functional Requirements .................................................................. 113
7.4.2         Rationale of the Assurance Requirements ................................................................................. 124
8.1.1         Listing of SFRs implemented by SF_DPM Device Phase Management ...................................... 126
8.2.1         Listing of SFRs implemented by SF_PS Protection against Snooping........................................ 129
8.3.1         Listing of SFRs implemented by SF_PMA Protection against Modifying Attacks ...................... 131
8.4.1         Listing of SFRs implemented by SF_PLA Protection against Logical Attacks ............................ 132
8.5.1         Implementation of AES and TDES by the Symmetric Cryptographic Coprocessor SCP ............. 133
8.5.2         Implementation of TDES, AES and CMAC by the Symmetric Cryptographic Library SCL .......... 135
8.5.3         RSA Cryptographic Library for all versions................................................................................. 137
8.5.4         Elliptic Curves Cryptographic Library for all versions ................................................................. 139
8.5.5         Toolbox Library for all versions .................................................................................................. 140
8.5.6         CIPURSE‚Ñ¢ Cryptographic Library ............................................................................................. 141
8.5.7         Hybrid PTRNG ........................................................................................................................... 141
8.5.8         Listing of SFRs implemented by SF_CS ‚ÄúCryptographic Support‚Äù ............................................. 142




CC Document                 Please read the Important Notice and Warnings at the end of this document                                                   1.8
www.infineon.com                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



1              Security Target Introduction (ASE_INT)

1.1            Security Target and Target of Evaluation Reference
The title of this document is Confidential Security Target as given on the front page and it covers and describes
one hardware platform respectively one IC representing the Target of Evaluation (TOE) with following Common
Criteria Identifiers:
    ÔÇ∑ IFX_CCI_000003h
      ÔÇ∑   IFX_CCI_000005h
      ÔÇ∑   IFX_CCI_000008h
      ÔÇ∑   IFX_CCI_00000Ch
      ÔÇ∑   IFX_CCI_000013h
      ÔÇ∑   IFX_CCI_000014h
      ÔÇ∑   IFX_CCI_000015h
      ÔÇ∑   IFX_CCI_00001Ch
      ÔÇ∑   IFX_CCI_00001Dh
      ÔÇ∑   IFX_CCI_000021h
     ÔÇ∑ IFX_CCI_000022h
in the design step H13 and including optional software libraries and dedicated firmware in several versions as
stated and assigned in the table below.

In order to ease the readability of this document the bunch of Common Criteria Identifiers as listed above is
shortened and simply expressed with TOE (Target of Evaluation) or IFX_CCI_000003h with options.

This document is formed according to Common Criteria CCv3.1 EAL6 augmented (EAL6+) and comprises the
Infineon Technologies AG Security Controller (Integrated Circuit IC) with the above listed Common Criteria
Identifiers and with specific IC dedicated firmware and optional software.

The target of evaluation (TOE) is described in the following.
This Public Security Target has the revision 1.8 and is dated 2020-04-22.




CC Document                                              3                                                      1.8
                                                                                                         2020-04-22
Public Security Target       NXP Secure Smart Card Controller
       N7021 VA
       Security Target Lite
       Rev. 2.3 ‚Äì 2019-06-04                                   Evaluation documentation
       Final                                                                         Public
       BSI-DSZ-CC-0977




Document Information

Info                     Content

Keywords                 CC, Security Target Lite, N7021 VA

Abstract                 Security Target Lite of the NXP Secure Smart Card Controller
                         N7021 VA, which is developed and provided by NXP Semiconduc-
                         tors, Business Unit Security & Connectivity according to the Com-
                         mon Criteria for Information Technology Security Evaluation Version
                         3.1 at EAL6 augmented
NXP Semiconductors                                                                 N7021 VA
                                                                                   Security Target Lite
                                                                                                              Public




Rev     Date                Description
1.0     03-April-2017       First version
1.1     31-May-2017         Minor update after certifier feedback.
2.0     06-September-2018   Updated document version numbers in Tab. 1.1. Updated CC conformance to v3.1
                            rev5.
2.1     15-November-2018    Updated SP 800-67 reference. Updated delivery information in section 1.4.1.1.
2.2     09-May-2019         Removed single-DES and 2-key TDES references.
2.3     06-June-2019        Updated Guidance and Operation Manual reference.




Final                                                                                 ¬©NXP N.V. 2019. All rights reserved.

Evaluation documentation            Rev. 2.3 ‚Äì 2019-06-04                                                    1 of 95
 NXP Semiconductors                                                                         N7021 VA
                                                                                             Security Target Lite
                                                                                                                       Public




1        ST Introduction
This chapter is divided into the following sections: ‚ÄùST Reference‚Äù, ‚ÄùTOE Reference‚Äù, ‚ÄùTOE Overview‚Äù and ‚ÄùTOE
Description‚Äù.


1.1       ST Reference
NXP Secure Smart Card Controller N7021 VA Security Target, 2.3, NXP Semiconductors, 2019-06-04.


1.2       TOE Reference
The TOE is named "NXP Secure Smart Card Controller N7021 VA including IC Dedicated Software". In this doc-
ument the TOE is abbreviated to NXP Secure Smart Card Controller N7021 VA or to N7021 VA. All components
of the TOE and their respective version numbers are listed in section 1.4.1.1.


1.3       TOE Overview
1.3.1     Usage and Major Security Functionality of the TOE
The TOE is the IC hardware platform NXP Secure Smart Card Controller N7021 VA with IC Dedicated Software
and documentation describing instruction set and usage of the TOE. The TOE does not include a customer-
specific Security IC Embedded Software.
The IC hardware is a microcontroller incorporating a central processing unit (CPU), memories accessible via a
Memory Management Unit (MMU), cryptographic coprocessors, other security components and several electrical
communication interfaces. The central processing unit supports a 32-/16-bit instruction set optimized for smart
card applications. The first and in some cases the second byte of an instruction are used for operation encoding.
On-chip memories are ROM, RAM and Flash. The Flash can be used as data or program memory. It consists of
highly reliable memory cells, which are designed to provide data integrity. Flash is optimized for applications that
require reliable non-volatile data storage for data and program code. Dedicated security functionality protects the
contents of all memories. Notice, that the Flash is also referred to as Non-Volatile Memory (NVM) in this Security
Target.
The IC Dedicated Software comprises IC Dedicated Test Software for test purposes and IC Dedicated Support
Software. The IC Dedicated Support Software consists of the Boot Software, which controls the boot process
of the hardware platform. Furthermore, it provides a Firmware Interface and optionally Shared OS Libraries,
simplifying access to the hardware for the Security IC Embedded Software. A System Mode OS is available
(optional), offering ready-to-use resource and access management for customer applications that do not want to
be exposed to the more low-level features of the TOE. The Flashloader OS (optional) supports download of code
and data to Flash by the Composite Product Manufacturer before Operational Usage (e.g. during develo
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The Target of Evaluation (TOE) is the Infineon Security Controller with following optional available software
packages:
   ÔÇ∑ The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
            o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
            o All ACL libraries provide elliptic curve cryptography EC3
   ÔÇ∑ the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
   ÔÇ∑ the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
   ÔÇ∑ the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH‚Ñ¢ NVM to the user
   ÔÇ∑ the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH‚Ñ¢ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method
   ÔÇ∑ the CIPURSE‚Ñ¢ Cryptographic Library (CIPURSE‚Ñ¢ CL and CCL) in the version v02.00.0004 provides the
       user OSPT alliance CIPURSE‚Ñ¢ V2 conformant communication functionality between a PICC and a PCD
   ÔÇ∑ the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).
and with further specific IC dedicated firmware in several alternative versions.

Please note that always the highest version number points to the most recent status of a library coming usually
with improvements and/or additional functionality.

Note that each of the versions of the ACL, SCL, HSL, CCL and the NRG are optional and alternatively. This means
that the TOE comes either with one of the alternative library types‚Äì depending on the user choice - or with none.
The library types can freely be combined but not two versions of the equal type. For examples ACL with SCL with
HSL with NRG is welcome but a combination of HSL in version 03.11.8339 and at the same time with HSL in
version 01.22.4346 would not work. The library types are entirely independent from each other.
The security relevant differences in the versions - if any - are detailed in chapter 8. The claims of this Security
Target take the corresponding versions into account and thus the wording in the following refers to the library
type which is cited or else the claim includes always all named versions.

The design step of this TOE is H13.

The Security Target is based on the Protection Profile PP-0084 Security IC Platform Protection Profile with
Augmentation Packages [9] as publicly available for download at https://www.bsi.bund.de and certified under
BSI-CC-PP-0084-2014.
The Security Target is built in compliance with Common Criteria v3.1 Revision 5.

The Security Target takes into account all relevant current final interpretations.

1
 Rivest-Shamir-Adleman asymmetric cryptographic algorithm
2
 BSI ‚Äì Bundesamt f√ºr Sicherheit in der Informationstechnik ‚Äì Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
3 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                           4                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



This TOE concept is based on the architecture, family concept and principles of the Integrity Guard implemented
in the controllers by Infineon Technologies AG deemed for high security requiring applications.

The certification body of this process is the German BSI, whereas the abbreviation stands for Federal Office for
Information Security, in German language Bundesamt f√ºr Sicherheit in der Informationstechnik.




CC Document                                             5                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                                          Table 1     Identification
                         Version           Date                            Registration
Security Target             1.8          2020-04-22                       This document
Target of Evaluation                                      The hardware controller with following identifiers:
                                                 [20]      MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf
       and NT4H2x21Tf
       Security Target Lite
       Rev. 1.0 ‚Äì 2018-12-31                                  Evaluation documentation
       Final                                                                      PUBLIC
       <Certid>




Document Information

Info                     Content

Keywords                 Common Criteria, Security Target Lite, MF2DL(H)x0, MF2ID(H)10,
                         NT4H2x21Gf, NT4H2x21Tf

Abstract                 Evaluation of the MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and
                         NT4H2x21Tf product, developed and provided by NXP Semicon-
                         ductors, Business Unit Security & Connectivity, according to the
                         Common Criteria for Information Technology Evaluation Version 3.1
                         at EAL4
NXP Semiconductors                   MF2DL, MF2ID, NTAG42x(Tf)
                                                                                      Security Target Lite
                                                                                                              PUBLIC




Rev     Date               Description
1.0     31-December-2018   Initial version of this Security Target Lite based on Security Target Revision 1.9




Final                                                                                    ¬©NXP B.V. 2018. All rights reserved.

Evaluation documentation           Rev. 1.0 ‚Äì 2018-12-31                                                        1 of 62
 NXP Semiconductors                                MF2DL, MF2ID, NTAG42x(Tf)
                                                                                             Security Target Lite
                                                                                                                     PUBLIC




1        ST Introduction
1.1        ST Reference
MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and NT4H2x21Tf Security Target Lite, Revision 1.0, NXP Semiconduc-
tors, Date 2018-12-31.


1.2        TOE Reference
MF2DL(H)x0, MF2ID(H)10, NT4H2x21Gf and NT4H2x21Tf, Version 01.1


1.3        TOE Overview
1.3.1       Introduction
NXP has developed the TOE to be used with Proximity Coupling Devices (PCDs, also called "terminals")
according to ISO14443 Type A [10][12][13][11]. The communication protocol complies to ISO 14443 part 3 [13]
and 4 [11]. The TOE is primarily designed for secure contactless transport applications, loyalty programs, access
management, closed loop payment, account based services and secure NFC applications. It fully complies with
the requirements for fast and highly secure data transmission and interoperability with existing infrastructure.


The TOE provides resistance against attack of an attacker with an enhanced-basic attack potential. This is
achieved by a combination of different security features that provide a base-line protection against information
leakage via side-channels, fault injections and physical attacks. Furthermore, the TOE protects the different
operating modes of the Security IC to avoid ab-use by an attacker. Protected by these security features the TOE
implements the following main security services:

     ‚Ä¢ secure mutual authentication to support authentication of authorized users and the TOE
     ‚Ä¢ secure channel establishment and secure messaging to support confidential and integrity protected data
         transfer
     ‚Ä¢ secure dynamic messaging to allow secure export of user data in unauthenticated state on MIFARE IDentity
         and NTAG42x DNA (Tf) variants of the TOE
     ‚Ä¢ supporting non-traceability of the TOE by providing the option to use random IDs during contactless protocol
         establishment
     ‚Ä¢ enhanced secure transaction management provided by the MIFARE DESFire Light and MIFARE IDentity
         variants of the TOE
     ‚Ä¢ additional functionality to check the status of a tamper evident tag provided by the NTAG42x DNA Tf variant
         of the TOE




 Final                                                                                          ¬©NXP B.V. 2018. All rights reserved.

 Evaluation documentation                      Rev. 1.0 ‚Äì 2018-12-31                                                   2 of 62
 NXP Semiconductors                                      MF2DL, MF2ID, NTAG42x(Tf)
                                                                                             Security Target Lite
                                                                                                                     PUBLIC



These security functionalities aim at enabling card issuers to use the product for various use-cases as outlined in
the following.


The TOE is a Security IC comprising a hardware platform and a fixed software                          ÔÇ∑ IFX_CCI_000003h
                                                                         ÔÇ∑ IFX_CCI_000005h
                                                                         ÔÇ∑ IFX_CCI_000008h
                                                                         ÔÇ∑ IFX_CCI_00000Ch
                                                                         ÔÇ∑ IFX_CCI_000013h
                                                                         ÔÇ∑ IFX_CCI_000014h
                                                                         ÔÇ∑ IFX_CCI_000015h
                                                                         ÔÇ∑ IFX_CCI_00001Ch
                                                                         ÔÇ∑ IFX_CCI_00001Dh
                                                                         ÔÇ∑ IFX_CCI_000021h
                                                                         ÔÇ∑ IFX_CCI_000022h
                                                      In the Design Step      H13
                                                           With following alternative FW-Identifiers
                                                                            ÔÇ∑ v80.100.17.3
                                                                            ÔÇ∑ v80.100.17.2
                                                                            ÔÇ∑ v80.100.17.1
                                                                            ÔÇ∑ v80.100.17.0
                                                      And following optional SW ‚Äì libraries:
                                                      ACL-1 to -3 RSA2048 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 RSA4096 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 EC          v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to 3 Toolbox      v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      HSL-1                   03.12.8812
                                                      HSL-2                   03.11.8339
                                                      HSL-3                   02.01.6634
                                                      HSL-4                   01.22.4346
                                                      SCL-1                   v2.04.002
                                                      SCL-2                   v2.02.010
                                                      NRG                     v02.04.3957
                                                      CIPURSE‚Ñ¢ CL             v02.00.0004
                                                      Each of the above named libraries comes with a specific
                                                      user guidance document
                                                      Security IC Platform Protection Profile with
Protection Profile          1.0          2014-01-13
                                                      Augmentation Packages BSI-CC-PP-0084-2014



CC Document                                           6                                                     1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                             Version         Date                              Registration
                                                         Common Criteria for
                                                         Information Technology Security Evaluation
                                                         Part 1: Introduction and general model
                                3.1
                                                         CCMB-2017-04-001
Common Criteria                             2017-04
                                                         Part 2: Security functional requirements
                             Revision 5                  CCMB-2017-04-002
                                                         Part 3: Security Assurance Components
                                                         CCMB-2017-04-003
User Guidance Documentation Set
Chapter describes briefly the contents of the individual documents of the User Guidance Documentation,
while the individual documents are versioned and entitled in chapter 9 literature and references. The in this
chapter listed set of user guidance documents belongs to the TOE.

This TOE is represented by a number of various products which are all based on the equal design sources. The
TOE hardware remains entirely equal throughout all derivatives, but the usage for example in form of available
memory sizes, availability of the various interfaces, or other functions varies by means of blocking and chip
configuration. The firmware identifier on board depends on the order.
All TOE derivatives are derived from the equal hardware design results.

The TOE can be identified with the Generic Chip Identification Mode (GCIM). The IFX_CCI_000003h with options
hardware platform is identified by defined bytes of the GCIM as detailed in the HRM [1].
The unique hexadecimal values as stated in the title are:
                        ÔÇ∑ IFX_CCI_000003h
                         ÔÇ∑    IFX_CCI_000005h
                         ÔÇ∑    IFX_CCI_000008h
                         ÔÇ∑    IFX_CCI_00000Ch
                         ÔÇ∑    IFX_CCI_000013h
                         ÔÇ∑    IFX_CCI_000014h
                         ÔÇ∑    IFX_CCI_000015h
                         ÔÇ∑    IFX_CCI_00001Ch
                         ÔÇ∑    IFX_CCI_00001Dh
                         ÔÇ∑    IFX_CCI_000021h
                         ÔÇ∑ IFX_CCI_000022h
The user can easily identify from which production line a certain IC is coming. The corresponding identifier is
given in chapter 2.2.6

These bytes clearly identify the hardware platform, or, in other words, the therein possible values for
IFX_CCI_000003h with options (without prefix IFX_CCI_) represent the equal hardware platform of this TOE. This
means that the hardware entirely equals throughout all derivatives and that the differences are achieved by
configuration and blocking means only. These values are unique for this hardware platform. This means that
these values will not be used in any other platform or product.
The interpretation of the output GCIM data is clearly explained in the user guidance, Hardware Reference Manual
HRM [1].
Although the TOE is represented by a number of various products, all based on the equal design sources, the
hardware is constituted out of few slightly different mask sets enabling to adapt to various external contactless
and contact based devices not being part of this TOE. Except this external adapt capability the TOE hardware
CC Document                                              7                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Cpment).
The Symmetric Crypto Library (optional) provides simplified access to frequently used symmetric cryptography
algorithms.




 Final                                                                                         ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                      Rev. 2.3 ‚Äì 2019-06-04                                                  2 of 95
 NXP Semiconductors                                                                            N7021 VA
                                                                                                Security Target Lite
                                                                                                                          Public



The documentation includes a Product Data Sheet with several addenda, an Instruction Set Manual, a Guidance
and Operation Manual, Symmetric Crypto Library User Manuals and a Wafer and Delivery Specification. This
documentation comprises a description of the architecture, the secure configuration and usage of the IC hardware
platform and the IC Dedicated Support Software by the Security IC Embedded Software.
The security functionality of the TOE is designed to act as an integral part of a complete security system in order
to strengthen the design as a whole. Several security mechanisms are completely implemented in and controlled
by the TOE. Other security mechanisms allow for configuration by or even require support of the Security IC
Embedded Software.
N7021 VA provides high security for smartcard applications and in particular for being used in the banking and
finance market, in electronic commerce or in governmental applications. Hence, N7021 VA shall maintain

     ‚Ä¢ the integrity and the confidentiality of code and data stored in its memories,

     ‚Ä¢ the different TOE modes with the related capabilities for configuration and memory access and

     ‚Ä¢ the integrity, the correct operation and the confidentiality of security functionality provided by the TOE.

This is ensured by the construction of the TOE and its security functionality.
NXP Secure Smart Card Controller N7021 VA basically provides a hardware platform for an implementation of a
smart card application with

     ‚Ä¢ functionality to calculate Data Encryption Standard (Triple-DES) with up to three keys,

     ‚Ä¢ hardware to calculate Advanced Encryption Standard (AES) with different key lengths,

     ‚Ä¢ support for large integer arithmetic operations like multiplication, addition and logical operations, which are
         suitable for public key cryptography and elliptic curve cryptography,

     ‚Ä¢ a True Random Number Generator,

     ‚Ä¢ a Hybrid Deterministic Random Number Generator,

     ‚Ä¢ a Hybrid Physical Random Number Generator,

     ‚Ä¢ memory management control,

     ‚Ä¢ cyclic redundancy check (CRC) calculation,

     ‚Ä¢ ISO/IEC 7816 contact interface with UART,

     ‚Ä¢ ISO/IEC14443A contactless interface.

In addition, several security mechanisms are implemented to ensure proper operation as well as integrity and
confidentiality of stored data. For example, this includes security mechanisms for memory protection and security
exceptions as well as sensors, which allow operation under specified conditions only. Memory encryption is used
for memory protection and chip shielding is added to the chip.



 Final                                                                                            ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                         Rev. 2.3 ‚Äì 2019-06-04                                                  3 of 95
 NXP Semiconductors                                                                                 N7021 VA
                                                                                                    Security Target Lite
                                                                                                                               Public



Note:        Large integer arithmetic operations are intended to be used for calculation of asymmetric cryptographic
             algorithms. Any asymmetric cryptographic algorithm utilizing the support for large integer arithmetic opera-
             tions has to be implemented in the Security IC Embedded Software. The support for large integer arithmetic
             operations does not provide security functionality like cryptography. The Security IC Embedded Software
             that implements an asymmetric cryptographic algorithm is not included in this Security Target, but the sup-
             port for large integer arithmetic operations is a security relevant component of the TOE, which resists to the
             attacks mentioned in this Security Target and operates correctly as specified in the data sheet. The same
             scope is applied to the CRC calculation. Similarly, even though single DES and two-key version of TDES
             are supported, they are not within the scope of evaluation.


1.3.2    TOE Type
The TOE NXP Secure Smart Card Controller N7021 VA is provided as IC hardware platform with IC Dedicated
Software for various operating systems and applications with high security requirements.

1.3.3    Required non-TOE Hardware/Software/Firmware
None


1.4      TOE Description
1.4.1    Physical Scope of TOE
N7021 VA is manufactured in 90nm CMOS technology. A block diagram of the IC hardware is depicted in Figure
1.1.




 Final                                                                                                 ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 ‚Äì 2019-06-04                                                        4 of 95
 NXP Semiconductors                                                                                                                                   N7021 VA
                                                                                                                                                      Security Target Lite
                              †                                                                                                                                                  Public



                          LA                                                     ROM                     FLASH                                RAM
                                    RF                  CIU
                                INTERFACE            ISO 14443
                          LB

                                                                          up to 188 KB                 up to 320 KB                           10 KB
                                                                       PROGRAM MEMORY


                                   I/O 1               UART
                         IO1
                                                     ISO 7816



                                                                                              MEMORY MANAGEMENT UNIT (MMU)



                                 POR            OSCILLATOR




                                                                                                 SECURE SmartMX3 P71 CPU


                                CLOCK             CLOCK
                         CLK
                                FILTER          GENERATION




                                                                                                                      COPROCESSORS
                                       SECURITY SENSORS
                       RST_N
                                       RESET GENERATION                                                                                        PKC (PUBLIC
                                                                       CRC
                                                                                                 WATCHDOG                        AES           KEY CRYPTO)
                                                                      8-bit,           TRNG
                                                                                                   TIMER              DES   128-bit/192-bit   COPROCESSOR
                                                                      16-bit
                                                                                                                              or 256-bit       e.g. RSA, ECC
                                                                     or 32-bit
                                    VOLTAGE REGULATOR




                                  VDD                     VSS



                                                                 Fig. 1.1: Block Diagram


N7021 VA consists of the IC hardware and IC Dedicated Software. The IC Dedicated Software is composed of IC
Dedicated Test Software for test purposes and IC Dedicated Support Software. The IC Dedicated Test Software
contains the Test Software, the IC Dedicated Support Software is composed of the Boot Software, the Firmware
Interface, the Shared OS Libraries, the Symmetric Crypto Library, the System Mode OS and the Flashloader OS.
All other software is called Security IC Embedded Software. The Security IC Embedded Software is not part of
the TOE. All components of the TOE are listed in section 1.4.1.1.

1.4.1.1    TOE components

  Type                         Name                                                                                         Version                    Form of Delivery
  All configurations
  IC Hardware                  N7021                                                                                        VA                         Wafer, modules and
                                                                                                                                                       package
  IC     Dedicated     Test    Test Software                                                                                20.0                       On-chip software
  Software
  IC Dedicated Support         Boot Software                                                                                20.0                       On-chip software
  Software                     Firmware Interface                                                                           20.0                       On-chip software
  Document                     SmartMX3 family P71D320 Overview, pinning and electri-                                       3.1                        PDF via NXP Doc-
                               cal characteristics, Product Data Sheet [25]                                                                            Store
  Document                     SmartMX3 N7021 Instruction Set Manual, Product Data                                          1.4                        PDF via NXP Doc-
                               Sheet addendum [16]                                                                                                     Store




 Final                                                                                                                                                   ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                                        Rev. 2.3 ‚Äì 2019-06-04                                                                                          5 of 95
NXP Semiconductors                                                                           N7021 VA
                                                                                             Security Target Lite
                                                                                                                       Public



 Type                    Name                                                      Version   Form of Delivery
 Document                SmartMX3 family N7021 Wafer and delivery specification,   1.3       PDF via NXP Doc-
                         Data Sheet addendum [24]                                            Store
 Document                SmartMX3 N7021 Post Delivery Configuration Post Deliv-    1.1       PDF via NXP Doc-
                         ery Configuration, Data Sheet addendum [21]                         Store
 Document                SmartMX3 N7021 Chip Health Mode, Data Sheet adden-        1.0       PDF via NXP Doc-
                         dum [14]                                                            Store
 Document                SmartMX3 N7021 Peripheral Configuration and Use, Data     1.4       PDF via NXP Doc-
                         Sheet addendum [20]                  N7021 VA
                                                                                                  Security Target Lite
                                                                                                                             Public



With respect to Application Note 3 in [26] the TOE supports the authentic delivery using the FabKey feature. For
further details refer to the data sheet [25] and the guidance and operation manual [13].
During the design and the layout process only personnel involved in the specific development project for an IC
have access to sensitive data. Different teams are responsible for the design data and for customer related data.
The production of the wafers includes two different steps regarding the production flow. In the first step the wafers
are produced with the fixed masks independent of the NCN or CCN. After that step the wafers are completed with
the product type specific data, including ROM and Flash Code, and data (if applicable) as identified by NCN and
CCN. The test process of every die is performed by a test center of NXP. Delivery processes between the involved
sites provide accountability and traceability of the TOE. NXP embeds the dice into modules, inlays or packages
depending on the individual commercial type.
Information about non-functional items (so-called failed die) is stored on electronic media, and the access to this
media made available with the delivery. The availability of major configuration options of the TOE in package
types is detailed in section 1.4.2.1.

1.4.5    TOE Intended Usage
The end-consumer environment of the TOE is phase 7 of the Security IC product life-cycle as defined in the PP
[26]. In this phase the Security IC product is in usage by the end-consumer. Its method of use now depends on
the Security IC Embedded Software. The Security ICs including the N7021 VA can be used to perform various
functions in a wide range of applications. Examples are identity cards, Banking Cards, Pay-TV, Health cards and
Transportation cards. The end-user environment covers a wide spectrum of very different functions, thus making
it difficult to monitor and avoid abuse of the TOE. The TOE is intended to be used in an insecure environment,
which does not protect against threats.
The device is developed for high-end safeguarded applications, and is designed for embedding into chip cards
according to ISO/IEC 7816 [9] and for contactless applications according to ISO/IEC 14443 [30]. Usually a Secu-
rity IC (e.g. a smartcard) is assigned to a single individual only, but it may also be used by multiple applications in
a multi-provider environment. Therefore the TOE might store and process secrets of several systems, which must
be protected from each other. The TOE then must meet security requirements for each single security module.
Secret data shall be used as input for calculation of authentication data, calculation of signatures and encryption
of data and keys.
In development and production environment of the TOE the Security IC Embedded Software developer and system
integrators such as the terminal software developer may use samples of the TOE for their testing purposes. It is
not intended that they are able to change the behaviour of the Security IC in another way than an end-consumer.
The user environment of the TOE ranges from TOE delivery to phase 7 of the Security IC product life-cycle, and
must be a controlled environment up to phase 6.
Note:         The phases from TOE Delivery to phase 7 of the Security IC Product life-cycle are not part of the TOE
              construction process in the sense of this Security Target. Information about these phases is just included
              to describe how the TOE is used after its construction. Nevertheless such security functionality of the




 Final                                                                                               ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                        Rev. 2.3 ‚Äì 2019-06-04                                                    16 of 95
 NXP Semiconductors                                                                                      N7021 VA
                                                                                                         Secuommon Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


and firmware ‚Äì depending on the order option ‚Äì remains entirely equal throughout all derivatives, but the usage
for example in form of available memory sizes, availability of the various interfaces, or other functions varies by
means of blocking and chip configuration. This blocking is applied by Infineon settings during the production
only. Again, all TOE derivatives are derived from the equal hardware design results, the IFX_CCI_000003h with
options.
The differences between the derivatives are achieved by blocking only and have no impact on the TOEs security
policies and related functions. Details are explained in the user guidance hardware reference manual HRM [1].
All product derivatives are identically from module design, layout and footprint, but are made different in their
possibilities to connect to different types of external antennas or to a contact based interface only. Therefore,
the TOE is represented and made out of different mask sets with following TOE internal and security irrelevant
differences:
The differences between the mask sets implement different input capacitances in the analogue part of the radio
frequency interface (RFI). This differentiation in the input capacitances enable for the connection of a wider
range of various antenna types. Note that external antennas or interfaces are not part of the TOE.
To each of the mask sets, an individual value is assigned, which is part of the data output of the Generic Chip
Identification Mode (GCIM). This number is located in the GCIM part individual length byte to clearly
differentiate between the mask sets related to the different input capacitances. Details are explained in the user
guidance hardware reference manual (HRM) and in the errata sheet.
There are no other differences between the mask sets the TOE is produced with.
The IFX_CCI_000003h with options products enable for a maximum of configuration possibilities defined by the
customer order following the market needs. For example, a TOE product can come in one project with the fully
available SOLID FLASH‚Ñ¢ NVM1 or in another project with any other SOLID FLASH‚Ñ¢ NVM ‚Äìsize below the
physical implementation size, or with a different RAM size. And more, the user has the free choice, whether he
needs the symmetric co-processor SCP, or the asymmetric co-processor Crypto2304T, or both, or none of them.
In addition, the user decides, whether the TOE comes with a free combination of software libraries or without
any. And, to be even more flexible, various interface options can be chosen as well.

To sum up the major selections, the user defines by his order:
     ÔÇ∑ the firmware identifier in several alternatives
     ÔÇ∑ the available memory sizes of the SOLID FLASH‚Ñ¢ NVM and RAM
     ÔÇ∑ the availability of the cryptographic coprocessors SCP and Crypto@2304T
     ÔÇ∑ the availability and free combinations of the cryptographic libraries
         ACL-1, ACL-2, ACL-3, SCL-1 and SCL-2
     ÔÇ∑ the availability of the CIPURSE‚Ñ¢ Cryptographic Library
     ÔÇ∑ the availability of the Flash Loader
     ÔÇ∑ the availability of the alternative libraries HSL-1 or HSL-2 or HSL-3 or HSL-4
     ÔÇ∑ the availability of the library NRG
     ÔÇ∑ the availability of various interface options
     ÔÇ∑ the possibility to tailor the product by blocking on his own premises (BPU)
     ÔÇ∑ the possibility to apply the PIN letter in combination with the Flash Loader
The degree of freedom of the chip configuration is predefined by Infineon Technologies AG and made available
via the order tool.

Beside fix TOE configurations, writy Target Lite
                                                                                                                                    Public



                 TOE, that is independent of the Security IC Embedded Software, is active at TOE Delivery and cannot be
                 disabled by the Security IC Embedded Software in the following phases.


1.4.6       Interface of the TOE
The electrical interface of the N7021 VA are the pads to connect the lines power supply, ground, reset input, clock
input, serial communication pad I/O1, as well as two pads (called LA and LB) for the antenna of the RF interface
(See Figure 1.1). Communication with the TOE can be established via the contact interface through the ISO/IEC
7816 UART or direct usage of the I/O ports. Contactless communication is done via the the contactless interface
unit (CIU) compatible to ISO/IEC 14443.
The logical interface of the TOE depends on the CPU mode and the associated software.

     ‚Ä¢ Upon every start-up the Boot Software is executed in Super System Mode. This software initializes and
         ˛ˇˇ˘igures the TOE. This comprises the selection of IC Dedicated Test Software (before TOE delivery) and
         of Security IC Embedded Software (after TOE delivery). Only in case the minor configuration option ‚ÄôEnable
         Chip Health Mode‚Äô is enabled, starting of built-in self test routines and read-out of TOE identification items is
         supported. If this minor configuration option is disabled the Boot Software provides no interface. In this case
         there is no possibility to interact with this software. The Boot Software is stored in the SSM_Code_Seg.

     ‚Ä¢ Before TOE delivery the logical interface is defined by the IC Dedicated Test Software. This IC Dedicated
         Test Software is executed in Super System Mode and comprises the test operating system used for produc-
         tion testing. IC Dedicated Test Software is embedded in the Test Software.

     ‚Ä¢ In System Mode and User Mode (after TOE Delivery) the software interface is the set of instructions, the
         bits in the special function registers that are related to these modes and the physical address map of the
         CPU including memories. The access to the special function registers as well as to the memories depends
         on the TOE mode configured by the Security IC Embedded Software.

Note:            The logical interface of the TOE that is visible on the electrical interface after TOE Delivery is based on the
                 Security IC Embedded Software developed by the software developer. The identification and authentication
                 of the user in System Mode or User Mode must be controlled by the Security IC Embedded Software.

The chip surface can be seen as an interface of the TOE, too. This interface must be taken into account regarding
environmental stress e.g. like temperature and in the case of an attack, for which the attacker manipulates the
chip surface.
Note:            An external voltage and timing supply as well as a logical interface are necessary for the operation of the
                 TOE. Beyond the physical behavior the logical interface is defined by the Security IC Embedded Software.




 Final                                                                                                      ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                             Rev. 2.3 ‚Äì 2019-06-04                                                      17 of 95
 NXP Semiconductors                                                                                N7021 VA
                                                                                                    Security Target Lite
                                                                                                                              Public




2        Conformance Claims
This Security Target claims to be conformant to the Common Criteria version 3.1:

     ‚Ä¢ Common Criteria for Information Technology Security Evaluation, Part 1 ‚Äì Introduction and general model -
         Version 3.1 CCMB-2017-04-001, Revision 5, April 2017, [3]

     ‚Ä¢ Common Criteria for Information Technology Security Evaluation, Part 2 ‚Äì Security functional components,
         Version 3.1 CCMB-2017-04-002, Revision 5, April 2017, [4]

     ‚Ä¢ Common Criteria for Information Technology Security Evaluation, Part 3 ‚Äì Security Assurance Components,
         Version 3.1 CCMB-2017-04-003, Revision 5, April 2017, [5]

For the evaluation the following methodology will be used:

     ‚Ä¢ Common Methodology for Information Technology Security Evaluation, Evaluation Methodology, Version 3.1
         CCMB-2017-04-004, Revision 5, April 2017, [6]

This Security Target claims to be CC Part 2 extended and CC Part 3 conformant. The extended Security Func-
tional Requirements are defined in chapter 5.


2.1        Package Claim
This Security Target claims conformance to the assurance package EAL6 augmented. The augmentations to
EAL6 is ALC_FLR.1. In addition, the Security Target is augmented using the component ASE_TSS.2, which is
chosen to include architectural information on the security functionality of the TOE.
Note:            The Protection Profile (PP) ‚ÄùSecurity IC Platform Protection Profile with Augmentation Packages‚Äù [26] to
                 which this Security Target claims conformance (refer to section 2.2) requires assurance level EAL4 aug-
                 mented. The changes, which are needed for EAL6, are described in the relevant sections of this Security
                 Target.

The level of evaluation and the functionality of the TOE are chosen in order to allow the confirmation that the TOE
is suitable for use within devices compliant with the German Digital Signature Law.


2.2        PP Claim
This Security Target claims strict conformance to the Protection Profile (PP) "Security IC Platform Protection
Profile with Augmentation Packages, Version 1.0, registered and certified by Bundesamt fuer Sicherheit in der
Informationstechnik (BSI) under the reference BSI-PP-0084-2014" [26]. Thus, the concepts are used in the same
sense. For the definition of terms refer to [26]. This chapter does not need any supplement in the Security Target.
This conformance claim includes the following packages of security requirements out of those for Cryptographic
Services defined in the Protection Profile [26]:




 Final                                                                                                ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                          Rev. 2.3 ‚Äì 2019-06-04                                                   18 of 95
 NXP Semiconductors                                                                         N7021 VA
                                                                                             Security Target Lite
                                                                                                                       Public



     ‚Ä¢ Package ‚ÄùTDES‚Äù (package conformant)

     ‚Ä¢ Package ‚ÄùAES‚Äù (package conformant)

This conformance claim includes the following packages of security requirements out of those for Loader defined
in the Protection Profile [26]:

     ‚Ä¢ Package ‚ÄùPackage 1: Loader dedicated for usage in Secured Environment only‚Äù (package conformant)

     ‚Ä¢ Package ‚ÄùPackage 2: Loader dedicated for usage by authorized users only‚Äù (package conformant)

The TOE provides additional functionality, which is not covered in [26]. In accordance with Application Note 4 of
[26] this additional functionality is added using the policy P.Add-Components (see section 3.3).


2.3      Conformance Claim Rationale
According to section 2.2 this ST claims strict conformance to the Security IC Platform Protection Profile with
Augmentation Packages [26].
The TOE type defined in section 1.3.2 of this Security Target is a smartcard controller with IC Dedicated Software.
This is consistent with the TOE definition for a Security IC in section 1.2.2 of [26].
The sections within this document where security problem definitions, security objectives and security require-
ments are defined, clearly state which of these items are taken from the Protection Profile and which are added
in this Security Target. Moreover, all additionally stated items in this Security Target do not contradict the items
included from the PP (see the respective sections in this document). The operations done for the SFRs taken
from the PP are also clearly indicated.
The evaluation assurance level claimed for this TOE is shown in section 6.2 to include respectively exceed the
requirements claimed by the PP (EAL4+).
These considerations show that the Security Target correctly claims conformance to the Security IC Platform
Protection Profile with Augmentation Packages, [26].




 Final                                                                                         ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                       Rev. 2.3 ‚Äì 2019-06-04                                               19 of 95
 NXP Semiconductors                                                                                  N7021 VA
                                                                                                      Security Target Lite
                                                                                                                                Public




3        Security Problem Definition
This chapter lists the assets, threats, assumptions and organizational security policies from the PP [26] and
describes extensions to these elements in detail.


3.1        Description of Assets
All assets, which are defined in section 3.1 of the PP [26], are related to standard functionality. They are applied
in this Security Target. These assets are:

     ‚Ä¢ Integrity and confidentiality of User Data stored and in operation,

     ‚Ä¢ Integrity and confidentiality of Security IC Embedded Software, stored and in operation,

     ‚Ä¢ Correct operation of the Security Services provided by the TOE for the Security IC Embedded Software,

     ‚Ä¢ Deficiency of random numbers.

To be able to protect these assets the TOE shall protect its security functionality. Therefore critical information on
the TOE shall be protected. Critical information includes:

     ‚Ä¢ Logical design data, physical design data, IC Dedicated Software,

     ‚Ä¢ Initialization data and pre-personalization data, Security IC Embedded Software, specific development aids,
         test and characterization related data, material for software development support, photo masks.

Note that the keys for cryptographic calculations using security services of the TOE are treated as User Data.


3.2        Threats
All threats, which are defined in section 3.2 of the PP [26], are valid for this Security Target.
T.Leak-Inherent          Inherent Information Leakage
                         An attacker may exploit information which is leaked from the TOE during usage of the Security IC
                         in order to disclose confidential user data as part of the assets.

T.Phys-Probing           Physical Probing
                         An attacker may perform physical probing of the TOE in order

                           (i) to disclose user data while stored in protected memory areas,
                          (ii) to disclose/reconstruct the user data while processed or
                          (iii) to disclose other critical information about the operation of the TOE to enable attacks dis-
                              closing or manipulating the user data of the Composite TOE or the Security IC Embedded
                              Software.




 Final                                                                                                  ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                            Rev. 2.3 ‚Äì 2019-06-04                                                   20 of 95
 NXP Semiconductors                                                                               N7021 VA
                                                                                                  Security Target Lite
                                                                                                                             Public



T.Malfunction         Malfunction due to Environmental Stress
                      An attacker may cause a malfunction of TSF or of the Security IC Embedded Software by applying
                      environmental stress in order to

                        (i) modify security services of the TOE or
                        (ii) modify functions of the Security IC Embedded Software
                       (iii) deactivate or affect security mechanisms of the TOE to enable attacks disclosing or manipu-
                            lating the user data of the Composite TOE or the Security IC Embedded Software.

                      This may be achieved by operating the Security IC outside the normal operating conditions (Num-
                      bers 1, 2 and 9 in Figure 8 of the Security IC PP).

T.Phys-Manipulation Physical Manipulation
                      An attacker may physically modify the Security IC in order to

                        (i) modify user data of the Composite TOE,
                        (ii) modify the Security IC Embedded Software,
                       (iii) modify or deactivate security services of the TOE, or
                       (iv) modify security mechanisms of the TOE to enable attacks disclosing or manipulating the user
                            data of the Composite TOE or the Security IC Embedded Software.

T.Leak-Forced         Forced Information Leakage
                      An attacker may exploit information which is leaked from the TOE during usage of the Security IC
                      in order to disclose confidential user data of the Composite TOE as part of the assets even if the
                      information leakage is not inherent but caused by the attacker.

T.Abuse-Func          Abuse of Functionality
                      An attacker may use functions of the TOE which may not be used after TOE Delivery in order to

                        (i) disclose or manipulate user data of the Composite TOE,
                        (ii) manipulate (explore, bypass, deactivate or cha from disclosure and manipulation.

O.Ctrl_Auth_Loader       Access control and authenticity for the Loader
                         The TSF provides trusted communication channel with authorized user, supports confidentiality
                         protection and authentication of the user data to be loaded and access control for usage of the
                         Loader functionality.

O.TDES                   Cryptographic service Triple-DES
                         The TOE provides secure hardware based cryptographic services implementing the Triple-DES
                         for encryption and decryption.

O.AES                    Cryptographic service AES
                         The TOE provides secure hardware based cryptographic services implementing the AES for
                         encryption and decryption.

The security objectives of the TOE defined in the PP [26] are listed in Table 4.1.

             Name                            Title
             O.Leak-Inherent                 Protection against Inherent Information Leakage
             O.Phys-Probing                  Protection against Physical Probing
             O.Malfunction                   Protection against Malfunctions
             O.Phys-Manipulation             Protection against Physical Manipulation
             O.Leak-Forced                   Protection against Forced Information Leakage
             O.Abuse-Func                    Protection against Abuse of Functionality
             O.Identification                TOE Identification
             O.RND                           Random Numbers
             O.Cap_Avail_Loader              Capability and availability of the Loader
             O.Ctrl_Auth_Loader              Access control and authenticity for the Loader
             O.TDES                          Cryptographic service Triple-DES
             O.AES                           Cryptographic service AES

Tab. 4.1: Security Objectives of the TOE defined in the Security IC Platform Protection Profile with Augmentation Packages




 Final                                                                                                  ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                            Rev. 2.3 ‚Äì 2019-06-04                                                   28 of 95
 NXP Semiconductors                                                                                N7021 VA
                                                                                                    Security Target Lite
                                                                                                                               Public



In compliance with Application Notes 8 and 9 in the PP [26], additional security objectives for the TOE are defined
below based on additional functionality provided by the TOE.
O.CUST_RECONFIG         Post Delivery Configuration
                      ‚Äì in all alternative versions - has seen a small enhancement to
enable for BPU.
If BPU is available, the blocking is done by the user at user premises, usually by taking an enhancement of the
user own personali   The TOE shall provide the customer with the functionality to reconfigure parts of the TOE prop-
                        erties as specified for the Post Delivery Configuration.

O.NVM_INTEGRITY         Integrity Support of data stored to NVM
                        The TOE shall provide detection and correction of failures in NVM memories to support integrity
                        of contents stored there.

O.MEM_ACCESS            Area based Memory Access Control
                        The TOE shall control access of CPU instructions to memory areas depending on memory parti-
                        tioning and based on TOE modes Super System Mode, System Mode and User Mode. In Super
                        System Mode, System Mode and User Mode the TOE shall control access also based on config-
                        uration. In User Mode, the TOE shall control access also based on memory segments, which are
                        configured in System Mode when implementing a memory management scheme. This control
                        shall be individual to each memory segment and consider different access rights.

O.SFR_ACCESS            Special Function Register Access Control
                        The TOE shall control access of CPU instructions to Special Function Registers depending on
                        the purpose of the register and based on TOE modes. The TOE shall provide System Mode with
                        the ability to configure access rights for User Mode to Special Function Registers that interface
                        to hardware components.

O.REUSE                 Application reuse of Memory
                        The TOE shall include measures to ensure that the memory resources being used by an appli-
                        cation of the TOE cannot be disclosed to subsequent users of the same memory resource of
                        another application.

O.Self-Test             Self Test
                        The TOE shall include functionality to perform a self-test to detect physical manipulation.

O.PUF                   Sealing/Unsealing user data
                        The TOE shall provide a PUF functionality that supports sealing/unsealing of user data. Using
                        this functionality, the user data can be sealed within the TOE and can be unsealed by the same
                        TOE that the user data was sealed on. The PUF functionality comprises import/export of data,
                        encryption/decryption of data and calculation of a MAC as a PUF authentication value.
                        Note: The PUF functionality provided by the TOE shall only be active if explicitly configured by
                        the Security IC Embedded Software.

O.Reset                 Reset function
                        The TOE shall provide the Security IC Embedded Software with a function to reset the device.




 Final                                                                                                 ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                           Rev. 2.3 ‚Äì 2019-06-04                                                   29 of 95
 NXP Semiconductors                                                                                  N7021 VA
                                                                                                     Security Target Lite
                                                                                                                                Public



O.Secure-UM-Box-FW          Secure User Mode Box Firewall
                            The TOE shall provide separation between the Secure UM Box code and other parts of the TOE.
                            The separation shall comprise software execution and data access.

The objectives of the TOE defined in this Security Target are summarized in Table 4.2.

              Name                             Title
              O.CUST_RECONFIG                  Post Delivery Configuration
              O.NVM_INTEGRITY                  Integrity Support of data stored to NVM
              O.MEM_ACCESS                     Area based Memory Access Control
              O.SFR_ACCESS                     Special Function Register Access Control
              O.REUSE                          Application reuse of Memory
              O.Self-Test                      Self Test
              O.PUF                            Sealing/Unsealing user data
              O.Reset                          Reset function
              O.Secure-UM-Box-FW               Secure User Mode Box Firewall

                                  Tab. 4.2: Security Objectives of the TOE defined in this ST



4.2      Security Objectives for the Security IC Embedded Software Devel-
         opment Environment
All security objectives for the Security IC Embedded Software development Environment, which are defined in the
PP [26], are applied to this Security Target.
OE.Resp-Appl                Treatment of User Data
                            Security relevant user data of the Composite TOE (especially cryptographic keys) are treated by
                            the Security IC Embedded Software as required by the security needs of the specific application
                            context.

The security objectives defined in the PP [26] are listed in Table 4.3.

              Name                             Title
              OE.Resp-Appl                     Treatment of User Data

Tab. 4.3: Security Objectives of the Development Environment defined in the Security IC Platform Protection Profile with
Augmentation Packages


Clarification related to ‚ÄùTreatment of User Data (OE.Resp-Appl)‚Äù
By definition cipher or plain text data and cryptographic keys are User Data. The Security IC Embedded Software
shall treat these data appropriately, use only proper secret keys (chosen from a large key space) as input for the
cryptographic function of the TOE and use keys and functions appropriately in order to ensure the strength of




 Final                                                                                                  ¬©NXP N.V. 2019. All rights reserved.

 Evaluation documentation                              Rev. 2.3 ‚Äì 2019-06-04                                                 30 of 95
 NXP Semiconductors                                                                                      N7021 VA
                                                                                                         Security Target Lite
                                                                                                                                    Public



cryptographic operation. This means that keys are treated as confidential as soon as they are generated. The
keys must be unique with a very high probability, as well as cryptographically strong. If keys are imported into the
TOE and/or derived from other keys, quality and confidentiality must be maintained. This implies that appropriate
key management has to be realized in the environment.
In case the Security IC Embedded Software operates multiple applications on the TOE, OE.Resp-Appl must also
be met. The Security IC Embedded Software must not disclose security relevant User Data of one application to
another application when processed in or stored to the TOE.


4.3      Security Objectives for the Operational Environment
All security objectives for the operational environment, which are defined in the PP [26], are applied to this Security
Target. Additionally the security objectives for the TOE environment OE.Lim_Block_Loader (Package 1: Loader
dedicated for usage in secured environment only) and OE.Loader_Usage (Package 2: Loader dedicated for usage
by authorized users only) defined in the packages of the PP [26] apply also for this Security Target.
OE.Process-Sec-IC         Protection during composite product manufacturing
                          Security procedures shall be used after TOE Delivery up to delivery to the end-consumer to
                          maintain confidentiality and integrity of the TOE and of its manufacturing and test data (to prevent
                          any possible copy, modifization flow and applying the according APDUs. These APDUs are predefined by Infineon
Technologies and can also depend on the customer order. Only these APDUs can block the chip according to the
user demands.
Infineon Technologies AG provides special software, running in parallel when doing the blocking. This software
summarizes all devices and final configurations allowing for the later commercial balancing. The balancing
depends on the number of chips and their individual final blockings the user has made over a defined time span.
This special software can be used only for the commercial balancing, is not present on the TOE, not security
relevant and therefore not part of this certificate.
All blockings are done by setting the according value in the chip configuration page, where certain parts are left
available to the blocking software. Strong means of authentication are in place. The blocking software
respectively BPU software is an additional part of the Flash Loader software and the only piece of software, able
to manage the blocking APDUs. Therefore, the presence of the Flash Loader software is essential for the BPU
ability.
The user can only apply a predefined and checksum protected set of allowed APDU configuration commands
provided by Infineon Technologies AG. For this, the Flash Loader BPU software part, together with the firmware
‚Äì regardless of the version used -, executes one of those APDUs. After the final blocking is done and the user
additionally may have downloaded his software, the entire Flash Loader including the BPU software part is
permanently deactivated. This is called locking of the Flash Loader.
Of course, exclusively all security relevant settings are contained in the IFX-only part. The Flash Loader BPU
software does not access and has no access to the IFX-only part.
Once the user blocking by applying the APDU has been finalized, the configuration page is no more accessible
for changes. After the locking of the Flash Loader, the product is permanently fixed regarding its configurations
and software. A reactivation of the Flash Loader is not possible. At the next start-up, the Boot-Up-Software
(BOS) applies the made cation, retention, theft or unauthorised use). This means that Phases
                          after TOE Delivery up to the end of Phase 6 (refer to Section 1.2.3 of the Security IC PP) must
                     settings, and, if called, a Resource Management System (RMS)-function can output the
finally made chip configuration for verification and information purposes.
The entire configuration storage area is protected against manipulation, perturbation and false access. Note that
the IFX-only part of the configuration page is already access protected prior delivery to the user and the TOE
leaves the Infineon Technology premises only locked into User Mode.
The BPU software part is only active on the products which have been ordered with the BPU option. In all other
cases this software is disabled on the product. If a product is ordered without Flash Loader, also the Flash Loader
software is disabled and the BPU configuration changes are blocked in the IFX-configuration, which renders BPU
functionality unusable. Therefore, the BPU feature is only possible if the Flash Loader is active.


CC Document                                               9                                    package. The software is stored in
ROM and provides an operating system which implements a set of functions used to manage various kinds of data
files stored in the non-volatile EEPROM mimory. The operating system provides access control if required by
the configura                    1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


If the user decides to use the Flash Loader, regardless whether it is ordered with or without BPU, an additional
process option can be ordered which results in an additional status of the Flash Loader. This process is called PIN-
Letter and enables for simplified logistics and thereby for faster delivery of the ordered TOE products to the user.
The PIN-Letter feature enabling for the PIN-Letter process is an implemented part of the Flash Loader. The
resulting logistical acceleration is possible since the PIN-Letter enables for delivery of not user-specific
configured, not flashed and not personalized TOE products to the user warehouse.
Extra authentication means applied in the PIN-Letter status of the Flash Loader preserve that only the intended
user with the intended PIN-Letter can configure with user specific information and enable the normal Flash
Loader functions in a second step. By that the user orders the products and receives - in a protected way - the
belonging PIN-Letter. PIN-Letter and delivered chips must match.
By delivery the user warehouse gets filled and depending      be protected appropriately. For a preliminary list of assets to be protected refer to paragraph 96
                          of the Security IC PP.

OE.Lim_Block_Loader Limitation of capability and blocking the Loader
                          The Composite Product Manufacturer will protect the Loader functionality against misuse, limit
                          the capability of the Loader and terminate irreversibly the Loader after intended usage of the
                          Loader.

OE.Loader_Usage           Secure communication and usage of the Loader
                          The authorized user must support the trusted communication channel with the TOE by confiden-
                          tiality protection and authenticity proof of the data to be loaded and fulfion market demands the user can immediate apply the
authentication means of the PIN-letter. If passing, the TOE products become user specific configured and the
Flash Loader can be used for this specific user in a second step.
The following table outlines the different ways how the user can input his software on this TOE ‚Äì a TOE without
user available ROM. User software comprises usually the operating system and applications, which are for
Infineon Techlling theno lo