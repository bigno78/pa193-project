Public




   Common Criteria Public Security Target
   EAL6 augmented / EAL6+
   IFX_CCI_000003h
   IFX_CCI_000005h
   IFX_CCI_000008h
   IFX_CCI_00000Ch
   IFX_CCI_000013h
   IFX_CCI_000014h
   IFX_CCI_000015h
   IFX_CCI_00001Ch
   IFX_CCI_00001Dh
   IFX_CCI_000021h
   IFX_CCI_000022h

   H13

   Resistance to attackers with HIGH attack potential
                                    Including optional Software Libraries
                            Flash Loader – 3x ACL – 4x HSL – 2x SCL – NRG – CCL




 Author: Infineon Technologies
 Revision: 1.8




CC Document            Please read the Important Notice and Warnings at the end of this document          1.8
www.infineon.com                                                                                   2020-04-22
Public




Table of Contents
2.2.1         Hardware of the TOE ...................................................................................................................26
2.2.2         Firmware and software of the TOE .............................................................................................. 27
2.2.3         Interfaces of the TOE................................................................................................................... 32
2.2.4         Guidance documentation ............................................................................................................ 33
2.2.5         Forms of delivery ......................................................................................................................... 35
2.2.6         Production sites ........................................................................................................................... 37
3.1.1         Adding Objectives ....................................................................................................................... 39
3.1.2         AES and TDES .............................................................................................................................40
3.1.3         Loader .........................................................................................................................................40
3.1.4         CIPURSE Cryptographic Library (CCL) ......................................................................................... 41
3.1.5         Summary .....................................................................................................................................42
4.1.1         Additional Threat due to TOE specific Functionality .................................................................... 43
4.1.2         Assets regarding the Threats .......................................................................................................44
4.2.1         Augmented Organizational Security Policy .................................................................................46
4.3.1         Augmented Assumptions ............................................................................................................ 47
4.3.2         Note regarding CIPURSE™ CL .....................................................................................................48
5.3.1         Clarification of “Treatment of User Data (OE.Resp-Appl)” .......................................................... 54
5.3.2         Clarification of “Protection during Composite product Manufacturing (OE.Process-Sec-IC)” ...... 54
6.1.1         Definition of FPT_TST.2 ..............................................................................................................60
6.1.2         TSF self-test (FPT_TST) ............................................................................................................... 61
7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1 ................................................................... 65
7.1.2         Subset of TOE testing.................................................................................................................. 70
7.1.3         Memory access control ................................................................................................................ 71
7.1.4         Support of Cipher Schemes ......................................................................................................... 74
7.1.5         Data Integrity FDP_SDI.2 and FDP_SDC.1 ................................................................................. 103
7.1.6         Application Note to FPT_FLS.1 Failure with preservation of secure state .................................. 104
7.3.1         Refinements .............................................................................................................................. 109
7.4.1         Rationale for the Security Functional Requirements .................................................................. 113
7.4.2         Rationale of the Assurance Requirements ................................................................................. 124
8.1.1         Listing of SFRs implemented by SF_DPM Device Phase Management ...................................... 126
8.2.1         Listing of SFRs implemented by SF_PS Protection against Snooping........................................ 129
8.3.1         Listing of SFRs implemented by SF_PMA Protection against Modifying Attacks ...................... 131
8.4.1         Listing of SFRs implemented by SF_PLA Protection against Logical Attacks ............................ 132
8.5.1         Implementation of AES and TDES by the Symmetric Cryptographic Coprocessor SCP ............. 133
8.5.2         Implementation of TDES, AES and CMAC by the Symmetric Cryptographic Library SCL .......... 135
8.5.3         RSA Cryptographic Library for all versions................................................................................. 137
8.5.4         Elliptic Curves Cryptographic Library for all versions ................................................................. 139
8.5.5         Toolbox Library for all versions .................................................................................................. 140
8.5.6         CIPURSE™ Cryptographic Library ............................................................................................. 141
8.5.7         Hybrid PTRNG ........................................................................................................................... 141
8.5.8         Listing of SFRs implemented by SF_CS “Cryptographic Support” ............................................. 142




CC Document                 Please read the Important Notice and Warnings at the end of this document                                                   1.8
www.infineon.com                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



1              Security Target Introduction (ASE_INT)

1.1            Security Target and Target of Evaluation Reference
The title of this document is Confidential Security Target as given on the front page and it covers and describes
one hardware platform respectively one IC representing the Target of Evaluation (TOE) with following Common
Criteria Identifiers:
     IFX_CCI_000003h
         IFX_CCI_000005h
         IFX_CCI_000008h
         IFX_CCI_00000Ch
         IFX_CCI_000013h
         IFX_CCI_000014h
         IFX_CCI_000015h
         IFX_CCI_00001Ch
         IFX_CCI_00001Dh
         IFX_CCI_000021h
      IFX_CCI_000022h
in the design step H13 and including optional software libraries and dedicated firmware in several versions as
stated and assigned in the table below.

In order to ease the readability of this document the bunch of Common Criteria Identifiers as listed above is
shortened and simply expressed with TOE (Target of Evaluation) or IFX_CCI_000003h with options.

This document is formed according to Common Criteria CCv3.1 EAL6 augmented (EAL6+) and comprises the
Infineon Technologies AG Security Controller (Integrated Circuit IC) with the above listed Common Criteria
Identifiers and with specific IC dedicated firmware and optional software.

The target of evaluation (TOE) is described in the following.
This Public Security Target has the revision 1.8 and is dated 2020-04-22.




CC Document                                              3                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The Target of Evaluation (TOE) is the Infineon Security Controller with following optional available software
packages:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
            o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
            o All ACL libraries provide elliptic curve cryptography EC3
    the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
    the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
    the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH™ NVM to the user
    the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method
    the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
       user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
    the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).
and with further specific IC dedicated firmware in several alternative versions.

Please note that always the highest version number points to the most recent status of a library coming usually
with improvements and/or additional functionality.

Note that each of the versions of the ACL, SCL, HSL, CCL and the NRG are optional and alternatively. This means
that the TOE comes either with one of the alternative library types– depending on the user choice - or with none.
The library types can freely be combined but not two versions of the equal type. For examples ACL with SCL with
HSL with NRG is welcome but a combination of HSL in version 03.11.8339 and at the same time with HSL in
version 01.22.4346 would not work. The library types are entirely independent from each other.
The security relevant differences in the versions - if any - are detailed in chapter 8. The claims of this Security
Target take the corresponding versions into account and thus the wording in the following refers to the library
type which is cited or else the claim includes always all named versions.

The design step of this TOE is H13.

The Security Target is based on the Protection Profile PP-0084 Security IC Platform Protection Profile with
Augmentation Packages [9] as publicly available for download at https://www.bsi.bund.de and certified under
BSI-CC-PP-0084-2014.
The Security Target is built in compliance with Common Criteria v3.1 Revision 5.

The Security Target takes into account all relevant current final interpretations.

1
 Rivest-Shamir-Adleman asymmetric cryptographic algorithm
2
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
3 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                           4                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



This TOE concept is based on the architecture, family concept and principles of the Integrity Guard implemented
in the controllers by Infineon Technologies AG deemed for high security requiring applications.

The certification body of this process is the German BSI, whereas the abbreviation stands for Federal Office for
Information Security, in German language Bundesamt für Sicherheit in der Informationstechnik.




CC Document                                             5                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                                          Table 1     Identification
                         Version           Date                            Registration
Security Target             1.8          2020-04-22                       This document
Target of Evaluation                                      The hardware controller with following identifiers:
                                                                          IFX_CCI_000003h
                                                                          IFX_CCI_000005h
                                                                          IFX_CCI_000008h
                                                                          IFX_CCI_00000Ch
                                                                          IFX_CCI_000013h
                                                                          IFX_CCI_000014h
                                                                          IFX_CCI_000015h
                                                                          IFX_CCI_00001Ch
                                                                          IFX_CCI_00001Dh
                                                                          IFX_CCI_000021h
                                                                          IFX_CCI_000022h
                                                      In the Design Step      H13
                                                           With following alternative FW-Identifiers
                                                                             v80.100.17.3
                                                                             v80.100.17.2
                                                                             v80.100.17.1
                                                                             v80.100.17.0
                                                      And following optional SW – libraries:
                                                      ACL-1 to -3 RSA2048 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 RSA4096 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 EC          v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to 3 Toolbox      v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      HSL-1                   03.12.8812
                                                      HSL-2                   03.11.8339
                                                      HSL-3                   02.01.6634
                                                      HSL-4                   01.22.4346
                                                      SCL-1                   v2.04.002
                                                      SCL-2                   v2.02.010
                                                      NRG                     v02.04.3957
                                                      CIPURSE™ CL             v02.00.0004
                                                      Each of the above named libraries comes with a specific
                                                      user guidance document
                                                      Security IC Platform Protection Profile with
Protection Profile          0.0          2014-01-13
                                                      Augmentation Packages BSI-CC-PP-0084-2014



CC Document                                           6                                                     1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                             Version         Date                              Registration
                                                         Common Criteria for
                                                         Information Technology Security Evaluation
                                                         Part 1: Introduction and general model
                                3.1
                                                         CCMB-2017-04-001
Common Criteria                             2017-04
                                                         Part 2: Security functional requirements
                             Revision 5                  CCMB-2017-04-002
                                                         Part 3: Security Assurance Components
                                                         CCMB-2017-04-003
User Guidance Documentation Set
Chapter describes briefly the contents of the individual documents of the User Guidance Documentation,
while the individual documents are versioned and entitled in chapter 9 literature and references. The in this
chapter listed set of user guidance documents belongs to the TOE.

This TOE is represented by a number of various products which are all based on the equal design sources. The
TOE hardware remains entirely equal throughout all derivatives, but the usage for example in form of available
memory sizes, availability of the various interfaces, or other functions varies by means of blocking and chip
configuration. The firmware identifier on board depends on the order.
All TOE derivatives are derived from the equal hardware design results.

The TOE can be identified with the Generic Chip Identification Mode (GCIM). The IFX_CCI_000003h with options
hardware platform is identified by defined bytes of the GCIM as detailed in the HRM [1].
The unique hexadecimal values as stated in the title are:
                         IFX_CCI_000003h
                             IFX_CCI_000005h
                             IFX_CCI_000008h
                             IFX_CCI_00000Ch
                             IFX_CCI_000013h
                             IFX_CCI_000014h
                             IFX_CCI_000015h
                             IFX_CCI_00001Ch
                             IFX_CCI_00001Dh
                             IFX_CCI_000021h
                          IFX_CCI_000022h
The user can easily identify from which production line a certain IC is coming. The corresponding identifier is
given in chapter 2.2.6

These bytes clearly identify the hardware platform, or, in other words, the therein possible values for
IFX_CCI_000003h with options (without prefix IFX_CCI_) represent the equal hardware pIFX_CCI_00002Dh, IFX_CCI_000039h,
IFX_CCI_00003Ah, IFX_CCI_000044h,
IFX_CCI_000045h, IFX_CCI_000046h,
IFX_CCI_000047h, IFX_CCI_000048h,
IFX_CCI_000049h, IFX_CCI_00004Ah,
IFX_CCI_00004Bh, IFX_CCI_00004Ch,
IFX_CCI_00004Dh, IFX_CCI_00004Eh T11
Security Target Lite




Revision: v4.0

Security Target    Please read the Important Notice and Warnings at the end of this document         v4.0
www.infineon.com                                                                               2020-10-15
Table of Contents

Contents
Table of Contents ........................................................................................................................... 2
1              Security Target Introduction (ASE_INT)............................................................................ 4
1.1            ST reference........................................................................................ [22] FMT_SMR.1 for BAC
FMT_MTD.1.1/INI_ENA The TSF shall restrict the ability to write the Initialisation Data and Pre-personalisation
                    Data to the Manufacturer.
Application Note: The application note 42 of [PP_BAC] applies. This application note provides a definition, what
is meant by “Pre-personalization Data”. This definition is also applicable to FMT_MTD.1/INI_ENA from
[PP_SAC]. Therefore FMT_MTD.1/INI_ENA from [PP_BAC] and [PP_SAC] can be combined.



CC Document                                            15                                                     3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

6.2.3              Class FPT Protection of the Security Functions
FPT_TST.1               TSF testing
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_TST.1.1             The TSF shall run a suite of self tests during initial start-up, to demonstrate the correct
                        operation of the TSF.
FPT_TST.1.2             The TSF shall provide authorised users with the capability to verify the integrity of the
                        TSF data.
FPT_TST.1.3             The TSF shall provide authorised users with the capability to verify the integrity of
                        stored TSF executable code.
Application Note: There is no contradiction between application note 46 of [PP_BAC] and application note 52 of
[PP_SAC]. In fact, although the wording is slightly different, the meaning of these application notes is identical.
Therefore either of these application notes applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be
combined.


FPT_PHP.3               Resistance to physical attack
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_PHP.3.1             The TSF shall resist physical manipulation and physical probing to the TSF by
                        responding automatically such that the SFRs are always enforced.
Application Note: Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application note 48 of
[PP_BAC] is only informative to the reader in the sense, that it provides a context to an older CC standard, but
not relevant for the interpretation of FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or
application note 53 of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.


6.3                SFRs specifically from [PP_SAC]

6.3.1              Class FCS: Cryptographic Support
FCS_CKM.1/DH_PACE Cryptographic key generation – Diffie-Hellman for PACE session keys
Hierarchical to:        No other components.
Dependencies:           [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic operation]
                        Justification: A Diffie-Hellman key agreement is used in order to have no key
                        distribution, therefore FCS_CKM.2 makes no sense in this case. FCS_CKM.4
                        Cryptographic key destruction: fulfilled by FCS_CKM.4
FCS_CKM.1.1/DH_PACE       The TSF shall generate cryptographic keys in accordance with a specified
                   cryptographic key generation algorithm Diffie-Hellman-Protocol compliant to
                   [PKCS#3], ECDH compliant to [TR_ECC] and specified cryptographic key size Table 6
                                                                                             SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                             Platform Build ID: 0261A7

                                                                                                                             eUICC plug-in                                        1.5.129

                                                                                                                    JCOP5.2                                 ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????                      R2.01.1

                                                                                                                             Platform ID: N5C2M0029E7D0600
                                                                                                  Software
                                                                                                  TOE
                                                                                                                             Platform Build ID: 029E7D

                                                                                                                             eUICC plug-in                                        1.5.146

                                                                                                                    JCOP5.2                                                       R2.02.1

                                                                                                                             Platform ID: N5C2M002A62D0600

                                                                                                                             Platform Build ID: 02A62D

                                                                                                                             eUICC plug-in                                        1.5.148


                                                                                                 To ensure secure usage a set of guidance documents is provided together with the NXP JCOP 5.2 on
                                                                                                 SN100.C58 Secure Element. Details cqn be found in section “Documentation” of this report.
                                                                                                 For a detailed and precise description of the TOE lifecycle refer to the [ST], chapter 1.3.3.
                                                                                                 Page: 7/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




           y3DES, 3-key 3DES, Retail-MAC, CMAC and CBC-MAC).
                                                                                                                o AES (Advanced Encryption Standard) for en-/decryption (GCM, CBC and ECB) and
                                                                                                                     MAC generation and verification (CMAC, CBC-MAC).
                                                                                                                o RSA and RSA CRT for en-/decryption and signature generation and verification.
                                                                                                                o RSA and RSA CRT key generation.
                                                                                                                o SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                                                                                                                o Secure SHA-1, Secure SHA-224, Secure SHA-256, Secure SHA-384, Secure SHA-
                                                                       NXP Secure Sm                                                512 hash algorithm.
                                                                                                                o HMAC.
                                                                                                                o ECC over GF(p) for signature generation and verification (ECDSA).
                                                                                                                o ECC over GF(p) key generation for key agreement.
                                                                                                                o Random number generation according to class DRG.3 of AIS 20.
                                                                                                           Java Card 3.0.5 functionality.
                                                                                                           GlobalPlatform 2.3 functionality including Amendments A,B,C,D,E,F,H and I and is compliant
                                                                                                            with the Common Implementation Configuration.
                                                                                                           GSMA ’Remote SIM Provisioning Architecture for consumer Devices’.
                                                                                                           Cryptographic Service Provider (CSP) features.
                                                                                                           NXP Proprietary Functionality:
                                                                                                                o MiFare functionality accessible via Applets using the MiFare API – no security
                                                                                                                     functionality is claimed.
                                                                                                                o OSSCA (Chinese Crypto) functionality accessible via Applets using the OSSCA API –
                                                                                                                     No security functionality is claimed.
                                                                                                                o Felica functionality accessible via Applets using the Felica API - no security
                                                                                                                     functionality is claimed for this functionality.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                o Config Applet: JCOP5.2 OS includes a Config Applet that can be used for
                                                                                                                     configuration of the TOE.
                                                                                                                o OS Update Component: Proprietary functionality that can update JCOP5.2 OS or
                                                                                                                     UpdaterOS.
                                                                                                                o UAI update component: Proprietary functionality that is can update JCOP5.2 OS- no
                                                                                                                     security functionality is claimed.
                                                                                                                o Restricted Mode: In Restricted Mode only very limited functionality of the TOE is
                                                                                                                     available such as, e.g.: reading logging information or resetting the Attack Counter.
                                                                                                                o Error Detection Code (EDC) API.
                                                                                                           Functionality introduced in R2, for which there are no specific additional security claims:
                                                                                                                o CAT-TP, with limitations as described in the [AGD_UGM] Section 8.1.
                                                                                                                o 5G features as per SIM Alliance 2.3, as in [AGD_UGM] Section 2.4.4 and 8.1.
                                                                                                                o Extension to Global Platform Amendment H, as in [AGD_UGM] Section 3.5.7.
                                                                                                                o CPLC data made available through SystemInfo, as in [AGD_UGM] Section 2.1.3.22.

                                                                                                 2.3       Assumptions and Clarification of Scope

                                                                                                 2.3.1      Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in section 5.2 of the
                                                                                                 [ST].
                                                                                                 Page: 8/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.
                                                                                                 Note that proprietary applications have been included in the TOE, but as there are no security claims
                                                                                                 on these functionalities, these application functionality has not been assessed, only the self-protection
                                                                                                 of the TSF.

                                                                                                 2.4     Architectural Information
                                                                                                 The TOE consists of a certified Hardware IC, with Micro Controller Firmware (Boot OS, Factory OS
                                                         art Card
  Controller P6022y VB
  Security Targe                                        and Flash driver software) and certified security software library consisting of a crypto library and
                                                                                                 services software. All these parts are depicted in the figure below with the shaded box marked
                                                                                                 SE100_SE. Since, this TOE is a composite on top of this certified platform, this block is not depicted
                                                                                                 in more detail.
                                                                                                 The Software stack consists of the JCOP Core parts marked with salmon coloured blocks
                                                                                                 implementing the Native OS, Global platform functionality and the Java Card 3.05 functionality. The
                                                                                                 TOE also implements a Cryptographic Service Provider marked with an orange coloured block. It
                                                                                                 implements a number of NXP proprietary features like the JCOP extension APIs for MiFare, Felica,
                                                                                                 Updater O/S and Config applet (note there are no security claims relating to MiFare and Felica).
                                                                                                 Furthermore the TOE implements GSMA ‘Remote SIM Provisioning Architecture for consumer
                                                                                                 Devices’, referred to as eUICC. The JCOP O/S supports the eUICC APIs and uses the Broker API to
                                                                                                 forward to the eSIM/SIM/UICC/ISIM commands to the eUICC Plugin Library.
                                                                                                 The TOE supports two domains, the eSE for the Java Card Secure Element domain and an eUICC
                                                                                                 domain providing UICC functionality in accordance with the GSMA Specification.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 9/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.5     Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                  JCOP Version       Identifier                                                        Version
                                                                                                  JCOP 5.2 R1        [AGD_UGM52R1] JCOP 5.2 R1.01.1 User Guidance Manual               1.8, 2019-10-30
                                                                                                                     [AGD_UGMSEMS52R1] JCOP 5.2 R1.01.1 User Guidance
                                                                                                                                                                                       1.1, 2019-10-17
                                                                                                                     Manual Addendum for SEMS API
                                                                                                                     [AGD_CSP52R1] JCOP 5.2 R1.01.1 User Guidance Manual
                                                                                                                                                                                       1.6, 2019-10-15
                                                                                                                     Addendum for CSPAPI
                                                                                                [GP]OP 5.2 R2        [AGD_UGM52R2] JCOP 5.2 R2, User Guidance Manual,
                                                                                                                                                                                       1.3, 2020-06-08
           *                                                                                                         doc. no. 608813
                                                                                                                     [AGD_UGMSEMS52R2] JCOP 5.2 R2, User Guidance
                                                                                                                                        t Lite
  Rev. 2.1 — 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document inf                                               1.2, 2020-06-08
                                                                              ormation
Informat            ecurity
                                    IC Embedded Software may contain the “Crypto Library Cobalt on N7021 VA“ (or parts
                                           1
                                    thereof ) and this Crypto Library is part of the TOE.
                                    RSA
                                    • The RSA algorithm can be used for encryption and decryption as well as for signature
                                      generation, signature verification, message encoding and signature encoding.
                                    • The RSA key generation can be used to generate RSA key pairs.
                                    • The RSA public key computation can be used to compute the public key that belongs to
                                      a given private CRT key.
                                    The TOE supports various key sizes for RSA up to a limit of 4096 bits.
                                    RSA functionality is not available in case the customer disabled the PKCC coprocessor
                                    as part of the hardware configuration. See the Hardware Security Target [13] for more
                                    information.
                                    ECDSA (ECC over GF(p))
                                    • The ECDSA e memories, registers, I/O interfaces and the
                        other system peripherals) during execution of the IC Dedicated Support Software and
                        Security IC Embedded Software. This includes all security mechanisms of the P6022y
                        VB, which directly contribute to a Security Service or a Security Feature.
                        The P6022y VB ensures its correct operation and prevents any malfunction using the
                        following mechanisms: filtering of power supply, clock frequency and reset input as well
                        as monitoring of voltage supply, clock frequency input and the temperature of the chip
P6022y VB                              All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                    Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                        77 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      by means of sensors. There are multiple voltage and frequency sensors for the different
                      ISO/IEC 7816 voltage classes and the contactless operation mode. Light sensors are
                      distributed over the chip surface and used to detect light attacks. In addition to the light
                      sensors the EEPROM provides two functions to detect light attacks. The Security IC
                      Embedded Software can enable/disable the EEPROM double read function.
                      Specific functional units of the P6022y VB are equipped with further fault injection
                      detection. This comprises the Secure Fetch for the processing of code and data by the
                      CPU or special circuitry within a functional unit. The functional units are the Program
                      Counter, the stack pointer, the CPU control register, the MMU address cache and control
                      registers, the SBC interface for the Triple-DES and the AES coprocessors, the Fame2
                      coprocessor, Copy Machine control registers and hardware configuration as well as test
                      control registers. Furthermore the P6022y VB contains a watchdog timer which can be
                      enabled and configured by the Security IC Embedded Software to protect the program
                      execution.
                      If one of the monitored parameters is out of the specified range, either (i) a reset is forced
                      and the actually running program is aborted or (ii) an exception is raised which interrupts
                      the program flow and allows a reaction of the Security IC Embedded Software. In case
                      minor configuration option “Inverse EEPROM Error Correction” is enabled (see Section
                      1.4.2.2) the probability to detect fault injection attack detectors at the EEPROM memory
                      and interface increases and the error correction logic raises an exception when detecting
                      an error. The RAM memory is equipped with additional parity bits which are checked
                      when the corresponding data stored in RAM is read. Additionally a RAM parity watchdog
                      mechanism is supported which checks the parity bits of the complete RAM in random
                      order when the Security IC Embedded Software is not accessing the RAM. In case of
                      detected RAM parity attack detectors both mechanisms trigger a security reset. In case
                      the P6022y VB processes a reset all components of the P6022y VB are initialised with
                      their reset values and the P6022y VB provides a reset cause indicator to the Security IC
                      Embedded Software. In the case an exception is raised an indicator for the reason of the
                      exception is provided. The P6022y VB defends the sensors from being disabled by the
                      Security IC Embedded Software.
                      The P6022y VB controls the specified range of the stack pointer. The stack pointer and
                      the related control logic are implemented threefold for the User Mode, System Mode
                      and Super System Mode (comprising Boot Mode, Test Mode and Firmware Mode). An
                      exception is generated in case the specified limits are exceeded.
                      In addition, SF.OPC comprises a sensor, which checks the high voltage of the write
                      process to the EEPROM during each write sequence. The result of this sensor must
                      be read from a Special Function Register and does not force an automatic event (e.g.
                      exception).
                      SF.PHY: Protection against Physical Manipulation
                      SF.PHY protects the P6022y VB against manipulation of (i) the IC hardware, (ii) the
                      IC Dedicated Software in ROM, (iii) the Security IC Embedded Software in ROM and
                      EEPROM, (iv) the Application Data in EEPROM and RAM including TSF data in the
                      Security Rows. It also protects User Data and TSF data against disclosure by physical
                      probing when stored or while being processed by the P6022y VB.
                      The protection of the P6022y VB comprises several security mechanisms in design and
                      construction, which make reverse-engineering and tamper attacks more difficult. These
                      mechanisms comprise dedicated shielding techniques for the P6022y VB and specific
                      encryption- and check mechanisms for the memories and internal buses. SF.PHY
                      supports the efficiency of other portions of the security functionality.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       78 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.PHY also supports the integrity of the EEPROM, RAM and the ROM. The EEPROM
                      is able to correct a 1-bit error within each byte. The EEPROM corrects these attack
                      detectors automatically without user interaction. The RAM and the ROM provide a parity
                      check. In both cases a reset is forced based on a parity error.
                      The CRC coprocessor is used in Boot Mode by the IC dedicated Software for calculation
                      of a CRC checksum for integrity protection of TSF data.
                      SF.PUF: User Data Protection using PUF
                      SF.PUF implements a mechanism to seal/unseal the user data stored in shared
                      memory against unintended disclosure. SF.PUF encrypts/decrypts the user data with
                      a cryptographic key derived from the PUF data. SF.PUF calculates a MAC as a PUF
                      authentication value. SF.PUF provides this sealing/unsealing mechanism through the
                      specified interfaces FVEC2 (see Fig. 2) only.
                      SF.LOG: Logical Protection
                      SF.LOG implements security mechanisms to limit or eliminate the information in the
                      shape and amplitude of signals or in the time between events, which might be found by
                      measuring such signals. This comprises the power supply, signals on other pads, which
                      are not intentionally used for communication by the terminal or the Security IC Embedded
                      Software as well as emanation of the hardware platform. Thereby SF.LOG prevents from
                      disclosure of User Data and TSF data stored and/or processed in the Security IC through
                      measurement of power consumption or emanation and subsequent complex signal
                      analysis. This protection of the P6022y VB is enforced by several security mechanisms in
                      the design, which support these portions of security functionality.
                      The Triple-DES coprocessor includes specific security mechanisms to prevent SPA/
                      DPA analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the Triple-DES coprocessor further ensures that the calculation time is
                      independent from the chosen key value and plain/cipher text.
                      The AES coprocessor includes specific security mechanisms to prevent SPA/DPA
                      analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the AES coprocessor further ensures that the calculation time is
                      independent from the chosen key any plain/cipher text for a given key length.
                      The Fame2 coprocessor provides measures to prevent timing attacks on basic modular
                      function. The calculation time of an operation depends on the lengths of the operands,
                      but not on the value of the operands, with the following exceptions: multiplication with
                      reduction, modular inversion and modular division. These three operations have no
                      constant timing due to correction cycles that are needed based on the calculation
                      method. In addition, mechanisms are included, which provide limitations of the capability
                      for the analysis of shape and amplitude of the power consumption. Of course the Fame2
                      coprocessor does not realise an algorithm on its own and algorithm-specific leakage
                      countermeasures have to be added by the Security IC Embedded Software when using
                      the Fame2 coprocessor.
                      Additional security mechanisms can be configured by the Security IC Embedded
                      Software. This comprises the configuration of the clock that can be used to prevent the
                      synchronisation between internal operations and external clock or characteristics of the
                      power consumption that can be used as trigger signal to support leakage attacks (DPA or
                      timing attacks)
                      Some mechanisms described for SF.PHY (e.g. the encryption mechanisms) and for
                      SF.OPC (e.g. the filter mechanisms) support SF.LOG.
                      SF.COMP: Protection of Mode Control
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      79 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      SF.COMP provides control of the CPU mode for (i) Boot Mode, (ii) Test Mode and
                      (iii) Firmware Mode. This includes protection of electronic fuses stored in a protected
                      memory area, the so-called Security Rows, and the possibility to store initialisation or
                      pre-personalisation data in the so-called FabKey Area.
                      Control of the CPU mode for Boot Mode, Test Mode and Firmware Mode prevents abuse
                      of test functions after TOE delivery. It also inhibits abuse of features, which are used
                      during start-up or reset to configure the P6022y VB.
                      The integrity control of electronic fuses ensures secure storage and setup of
                      configuration and calibration data, during the start-up in Boot Mode. The protection
                      of electronic fuses especially ensures that configuration options with regard to the
                      security functionality cannot be changed, abused or influenced in any way. The transfer
                      of the content of the electronic fuses into the related hardware configuration registers
                      is protected by a CRC checksum generated using the CRC coprocessor. SF.COMP
                      ensures that activation or deactivation of security mechanisms cannot be influenced by
                      the Security IC Embedded Software so that the TSF provides self-protection against
                      interference and tampering by untrusted Security IC Embedded Software.
                      SF.COMP protects CPU mode switches regarding Boot Mode, Test Mode and Firmware
                      Mode in the following way: Switching from Boot Mode to Test Mode or Firmware Mode is
                      allowed, switching from these modes back to Boot Mode is prevented. Switching to Test
                      Mode is prevented as well after TOE delivery, because Test Mode then is permanently
                      disabled. SF.COMP also ensures that Boot Mode is active only in the boot phase during
                      start-up or reset of the P6022y VB, and cannot be invoked afterwards. Therefore, once
                      the P6022y VB has left the test phase and each time the P6022y VB completed start-up
                      or reset, Firmware Mode is the only Super System Mode available.
                      The TSF controls access to the Security Rows, the top-most 512 Bytes of the EEPROM
                      memory, accessible at reserved addresses in the memory map. The available EEPROM
                      memory space for the Security IC Embedded Software is reduced by this area.
                      SF.COMP provides three memory areas in the Security Rows, which can be used by the
                      Security IC Embedded Software. These are
                      • the User Read Only Area
                      • the User Write Protected Area and
                      • the User Write Once Area.
                      The User Read Only Area contains 32 bytes, which are read-only for the Security IC
                      Embedded Software. The User Write Protected area contains 16 bytes, which can be
                      write-protected by the Security IC Embedded Software on demand. The User Write Once
                      Area contains 32 bytes of which each bit can separately be set to ‘1’ once only, and not
                      reset to ‘0’.
                      SF.COMP also provides a memory area in the Security Row where the current values
                      for the Post Delivery Configuration (see SS.RECONFIG). This area cannot be accessed
                      by the Security IC Embedded Software, but it can be accessed by the Resource
                      Configuration Firmware.
                      If minor configuration option “Card Disable” feature is used (refer to section 1.4.2.2)
                      SF.COMP inhibits any start-up of the Security IC Embedded Software once the Security
                      IC Embedded Software disables the card.
                      If minor configuration option “EEPROM application content erase” is used (see Section
                      1.4.2.2) SF.COMP erases the application data stored in the EEPROM once the Security
                      IC Embedded Software has activated this security feature.


P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       80 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.COMP also provides the FabKey Area where initialisation and identification data can
                      be stored. The FabKey area does not belong to the Security Rows and is not protected
                      by hardware mechanisms. The FabKey Area as well as the Security Rows can be used
                      by SF.COMP to store a unique identification for each die.
                      The complete EEPROM is initialized during wafer testing and pre-personalisation. The
                      values for the Security Row depend on the configuration options and choice of the
                      Security IC Embedded Software developer. The values for the application EEPROM
                      depend on the choice of the Security IC Embedded Software developer and are
                      included in the Order Entry Form. The User Write Protected Area and the User Write
                      Once Area are designed to store the identification of a (fully personalised) Security IC
                      (e.g. smartcard) or a sequence of events over the life-cycle, that can be coded by an
                      increasing number of bits set to "one" or protecting bytes, respectively.
                      SF.COMP limits the capabilities of the test functions and provides test personnel during
                      phase 3 with the capability to store identification and/or pre-personalisation data and/or
                      supplements of the Security IC Embedded Software in the EEPROM. SF.COMP provides
                      self-protection against interference and tampering by untrusted subjects both in the Test
                      Mode and in the other modes. It also enforces the separation of domains regarding the
                      IC Dedicated Software and the Security IC Embedded Software.
                      SF.MEM_ACC: Memory Access Control
                      SF.MEM_ACC controls access of any subject (program code comprising processor
                      instructions) to the memories of the P6022y VB through the Memory Management Unit.
                      Memory access is based on virtual addresses that are mapped to physical addresses.
                      The CPU always uses virtual addresses. The Memory Management Unit performs the
                      translation from virtual to physical addresses and the physical addresses are passed
                      from the Memory Management Unit to the memory interfaces to access the memories.
                      Access control is conducted in two ways:
                      • Memory partitioning: Each memory type ROM, RAM and EEPROM is partitioned into
                        two parts. In Boot Mode and Firmware Mode the CPU has access to the Firmware
                        EEPROM, Firmware RAM and Test-ROM. In System Mode and User Mode the CPU
                        has access to the Application EEPROM, Application RAM and Application ROM.
                        Access to both parts of each type is allowed in Test Mode for testing.
                      • Memory segmentation in User Mode: The three accessible parts of the memory in
                        ROM, RAM and EEPROM can be segmented into smaller memory areas. Access
                        rights (read/write or execute) can be defined for these segments. The operation read
                        and write are considered as one kind of operation, if one is allowed, so is the other.
                        However, in general the access to a segment can be denied.
                        In addition, access rights to Special Function Registers related to hardware
                        components can be defined for code executed in User Mode.
                      Memory partitioning is fixed and cannot be changed. It is determined during
                      production of the P6022y VB and is solely dependent on the major configuration (see
                      Section 1.4.2.1.1) and Post Delivery Configuration (see Section 1.4.2.3.1).
                      Memory segmentation can be defined in System Mode. The segmentation is active when
                      the CPU switches to User Mode. The segments, their access rights and the access
                      rights to Special Function Registers related to hardware components are defined in the
                      MMU Segment Table. The MMU Segment Table stores five values for each segment:
                      The memory access rights, the virtual start address of the segment, the virtual end
                      address of the segment, the address offset for the segment and the access rights to
                      Special Function Registers for code that is executed in the segment. The address offset
                      is used to relocate the segment anywhere in the memory map. The resulting address
                      computed by the Memory Management Unit can not overrule memory partitioning. Up
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      81 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      to 64 segments can be defined in the MMU Segment Table. Special configurations of
                      the memory access rights allow to specify less than 64 segments and to split the MMU
                      Segment Table into several parts being stored at different locations in memory.
                      Note that the MMU Segment Table itself is stored in the memory and therefore the table
                      itself can be placed in a segment accessible in User Mode.
                      In addition, SF.MEM_ACC permanently checks whether accessed addresses point to
                      physically implemented memory. Any access outside the boundaries of the physical
                      implemented memory in all CPU modes except the Test Mode and access to forbidden
                      memory addresses in User Mode are notified by raising an exception.
                      The Memory Management Unit also handles access rights to Special Function Registers
                      related to hardware components for code running in Firmware Mode. The configuration
                      of the access rights for User Mode and Firmware Mode are used by SF.SFR_ACC to
                      grant or block access to the related Special Function Registers. The access rights can
                      be defined for up to 16 groups of Special Function Registers, which are related to 16
                      hardware peripherals or memories described in [9], section 12.4. Thus, User Mode
                      and Firmware Mode can be restricted in their access to the Special Function Registers
                      related to hardware components on demand of the Security IC Embedded Software.
                      Note that SF.MEM_ACC only provides the access rights to SF.SFR_ACC, the access
                      control is enforced by SF.SFR_ACC.
                      SF.SFR_ACC: Special Function Register Access Control
                      SF.SFR_ACC controls access to the Special Function Registers and CPU mode
                      switches based on specific Special Function Register. SF.SFR_ACC implements access
                      control to the Special Function Registers as specified in the Access Control Policy and
                      the Security Functional Requirements FDP_ACC.1[SFR] and FDP_ACF.1[SFR].
                      The function of the Special Function Register and the CPU mode determine, whether
                      read and/or write access to a Special Function Register is allowed or not. Key registers
                      cannot be read since they are write-only to support the confidentiality of keys. Write
                      access is granted depending on the CPU mode. Similar for the output register of the
                      Random Number Generator, which is read-only based on its function, and read access is
                      granted based on the CPU mode.
                      SF.SFR_ACC controls accesses to Special Function Registers. If the access is not
                      allowed or the Special Function Register addressed by the code is not implemented an
                      exception is triggered. The Security IC Embedded Software can react on this exception.
                      Some Special Function Registers are implemented threefold, one for User Mode, a
                      second one for System Mode and a third one for Super System Mode meaning Boot
                      Mode, Test Mode and Firmware Mode. Hence, such Special Function Registers are
                      inherently separated and enforce the separation between the CPU modes.
                      SF.SFR_ACC relies on access rights to Special Function Registers related to hardware
                      components, which are provided by SF.MEM_ACC. Access rights to all other Special
                      Function Registers are pre-defined and cannot be configured by the code running on the
                      hardware platform.
                      This implies that code running in User Mode or Firmware Mode is not able to use
                      SS.RNG, SS.TDES, and SS.AES until access to the respective group of Special Function
                      Registers is explicitly granted by code running in System Mode. This holds for all 16
                      hardware components, which are controlled by the 16 groups of Special Function
                      Registers related to hardware components.
                      SF.SFR_ACC also implements transitions among CPU modes based on specific Special
                      Function Register.
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      82 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      The CPU mode changes by the following operations.
                      • Call of a system call vector (SVEC) address or a firmware vector (FVEC) address. A
                        call of a SVEC enables System Mode, a call of a FVEC sets enables Firmware Mode.
                        Calls of SVEC addresses are allowed in User Mode only, otherwise an exception is
                        raised.
                      • Execution of an exception or interrupt. Any event that leads to the execution of an
                        exception leads to a special status of the related CPU mode. Any further exception in
                        this special status forces a reset. Interrupts can be executed in User Mode or in System
                        Mode as well as in Firmware Mode. The Security IC Embedded Software running in
                        System Mode can configure this option at run time.
                      • Return from an exception/interrupt or vector call with a RETI instruction. This restores
                        the CPU mode before the event occurred. A RETI in User Mode is allowed only in case
                        interrupts are allowed to be executed in User Mode and an interrupt is actually active,
                        otherwise an exception is raised.
                      • Execution of an LCALL/ACALL/ECALL instruction to a specific address. A call of
                        address 0x800000 in System Mode enables User Mode and starts execution at this
                        (virtual) address. This is similar to a FVEC or SVEC call, but no return address is
                        pushed onto the stack.
                      • Direct modification of the specific Special Function Register. Hardware provided by
                        SF.SFR_ACC ensures that the bits can only be cleared. Therefore it is not possible
                        for code running in User Mode to enter System Mode, but System Mode can switch to
                        User Mode.
                      Two CPU modes are available to the Security IC Embedded Software, which are System
                      Mode and User Mode. System Mode is the more privileged CPU mode since it allows
                      access to all Special Function Registers related to hardware components and for system
                      management (i.e. configuration of Memory Management Unit, clock settings and some
                      mechanisms provided by SF.LOG). User Mode is the less privileged, but in regard to
                      hardware components it can be made as powerful as System Mode.
                      SF.SFR_ACC and SF.COMP together ensure that other CPU modes are not available
                      to the Security IC Embedded Software, but reserved for specific purposes fulfilled by the
                      IC Dedicated Software. As described above, SF.MEM_ACC provides the access control
                      information to Special Function Registers related to hardware components in Firmware
                      Mode and User Mode.
                      SF.FFW: Firmware Firewall
                      SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                      data of the different firmware applications (NXP firmware functionality) running in
                      Firmware Mode by means of a firewall separating the application data between each
                      other. The firewall mechanism is based on the security features SF.MEM_ACC and
                      SF.SFR_ACC.
                      SF.FIRMWARE: Firmware Support
                      SF.FIRMWARE (Firmware Operating System) implements specific basic support
                      functionality for the Security IC Embedded Software. The basic support functionality is
                      implemented in a way that the protection and separation of the different type of User
                      Data is enforced. The security feature SF.FIRMWARE is based on the security features
                      SF.MEM_ACC, SF.SFR_ACC and SF.FFW.




P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      83 / 101
NXP Semiconductors
                                                                                                                        P6022y VB
                                                                                                                        Security Target Lite



              7.1.2.2 NXP Secure Smart Card Controller P6022M VB/P6022D VB/P6022J VB
                        The security features of the P6022M VB/P6022D VB/P6022J VB include the security
                        features of the P6022P VB/P6022X VB, except for SF.FFW and SF.FIRMWARE. The
                        security features SF.FFW and SF.FIRMWARE of the P6022M VB/P6022D VB/P6022J
                        VB are described in this section.
                        SF.FFW: Firmware Firewall
                        SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                        data of the different firmware applications (NXP firmware functionality and MIFARE
                        Software) running in Firmware Mode by means of a firewall separating the application
                        data between each other. The firewall mechanism is based on the security features
                        SF.MEM_ACC and SF.SFR_ACC.
                        SF.FIRMWARE: Firmware Support
                        SF.FIRMWARE (Firmware Operating System) implements specific basic support
                        functionality for the Security IC Embedded Software. The basic support functionality is
                        implemented in a way that the protection and separation of the different type of User
                        Data is enforced. The security feature SF.FIRMWARE is based on the security features
                        SF.MEM_ACC, SF.SFR_ACC and SF.FFW.
                        The support comprise
                        •   the integrity protection of the data stored in the EEPROM,
                        •   the baud rate configuration for the contactless operation,
                        •   the enabling / disabling of MIFARE Software,
                        •   the start of MIFARE Software contactless operation,
                        •   the control of exit conditions for MIFARE Software,
                        •   the MIFARE Post Delivery Configuration,
                        •   the MIFARE Remote Interface.


                 7.2 TOE Summary Specification Rationale

               7.2.1 Mapping of Security Functional Requirements and the TOE Security
                     Functionality

              7.2.1.1   NXP Secure Smart Card Controller P6022y VB
                        The following table provides a mapping of portions of the TOE security functionality to the
                        Security Functional Requirements of the P6022y VB. The mapping is described in detail
                        in the text following table.

Table 36. Mapping of Security Functional Requirements and the portions of the Security Functionality of the
P6022y VB
                                 SS. SS.T SS.                    SF. SF.                   SF. SF.C SF.M SF. SF. SF.FI SS.R SF.
                                 RNG DES AES                     OPC PHY                   LOG OMP EM_ SFR_ FFW RMW ECO PUF
                                                                                                    ACC ACC      ARE NFIG
FAU_SAS.1[HW]                                                                                           X
FCS_RNG.1[HW]                    X
FDP_IFC.1                                                                                                                              below.

                                    The requirements listed in Table 3 are detailed in the following sub-sections.
                                    Additional SFR regarding cryptographic functionality
                                    The TSF provides cryptographic functionality to help satisfy several high-level security
                                    objectives. In order for a cryptographic operation to function correctly, the operation must
                                    be performed in accordance with a specified algorithm and with a cryptographic key of a
                                    specified size. The following Functional Requirements to the TOE can be derived from
                                    this CC component:
                                    FCS_COP.1/RSA                                        Cryptographic operation
                                    Hierarchical to:                                     No other components.
                                    FCS_COP.1.1/RSA                                      The TSF shall perform encryption, decryption, signature
                                                                                                                    2
                                                                                         generation and verification in accordance with
                                                                                                                                   3
                                                                                         the specified cryptographic algorithm RSA and
                                                                                                                                      4
                                                                                         cryptographic key sizes 512 bits to 4096 bits that
                                                                                         meet the following: PKCS #1, v2.2: RSAEP, RSADP,
                                                                                                              5
                                                                                         RSASP1, RSAVP1 .
                                    Application Notes:                                   The cryptographic algorithms are designed taking into
                                                                                         account the attacks described in JIL-ATT-SC: Attack
                                                                                         Methods for Smartcards and Similar Devices [19].
                                    Dependencies:                                        [FDP_ITC.1 Import of user data without security
                                                                                         attributes or FDP_ITC.2 Import of user data with
                                                                                         security attributes, or FCS_CKM.1 Cryptographic key
                                                                                         generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/RSA_PAD                                    Cryptographic operation
                                    Hierarchical to:                                     No other components.
                                    FCS_COP.1.1/RSA_PAD                                  The TSF shall perform message and signature
                                                                                                            6
                                                                                         encoding methods in accordance with the specified
                                                                                                                                               7
                                                                                         cryptographic algorithm EME-OAEP and EMSA-PSS
                                                                                                                                          8
                                                                                         and cryptographic key sizes 512 bits to 4096 bits that
                                                                                         meet the following: PKCS #1, v2.2: EME-OAEP and
                                                                                                      9
                                                                                         EMSA-PSS .
                                    Application Notes:                                   Regarding OAEP the input of encode as well as the
                                                                                         input and output of decode are considered sensitive
                                                                                         values. Regarding PSS the input of the encoding and
                                                                                         verify operations are considered sensitive values. In both
                                                                                         cases the length of the sensitive values is assumed to
                                                                                         be public.
                                    Dependencies:                                        [FDP_ITC.1 Import of user data without security
                                                                                         attributes or FDP_ITC.2 Import of user data with

                                       2   [assignment: list of cryptographic operations]
                                       3   [assignment: cryptographic algorithm]
                                       4   [assignment: cryptographic key sizes]
                                       5   [assignment: list of standards]
                                       6   [assignment: list of cryptographic operations]
                                       7   [assignment: cryptographic algorithm]
                                       8   [assignment: cryptographic key sizes]
                                       9   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                       All information provided in this document is subject to legal disclaimers.                     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                             Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                                           15 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/RSA_PubExp   Cryptographic operation
                                    Hierarchical to:       No other components.
                                                                                                         10
                                    FCS_COP.1.1/RSA_PubExp The TSF shall perform public key computation in
                                                           accordance with the specified cryptographic algorithm
                                                                11
                                                           RSA and cryptographic key sizes 512 bits to 4096
                                                               12                                       13
                                                           bits that meet the following: PKCS #1, v2.2 .
                                    Application Notes:
                                                           (1) The cryptographic algorithms are designed taking
                                                           into account the attacks described in JIL-ATT-SC: Attack
                                                           Methods for Smartcards and Similar Devices [19].
                                                                                        (2) The computation will result in the generation of a
                                                                                        public RSA key from the private key (in CRT format). As
                                                                                        this key is implied by the private key, this is not true key
                                                                                        generation, and, to prevent duplication in this ST, this
                                                                                        has not been included as a separate FCS_CKM.1 SFR.

                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with
                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/ECDSA                                     Cryptographic operation
                                    Hierarchical to:                                    No other components.
                                    FCS_COP.1.1/ECDSA                                   The TSF shall perform signature generation and
                                                                                                    14
                                                                                        verification in accordance with the specified
                                                                                                                                            15
                                                                                        cryptographic algorithm ECDSA / ECC over GF(p) and
                                                                                        cryptographic key sizes 224, 256, 320, 384, 512 and 521
                                                                                             16
                                                                                        bits that meet the following: ISO/IEC 14888-3, ANSI
                                                                                                                                             17
                                                                                        X9.62, FIPS PUB 186-4 and IEEE Std 1363™-2000 .
                                    Application Notes:                                  The cryptographic algorithms are designed taking into
                                                                                        account the attacks described in JIL-ATT-SC: Attack
                                                                                        Methods for Smartcards and Similar Devices [19].
                                    Note:                                               Due to BSI regulations the certification covers the
                                                                                        standard curves ansix9p224r1, ansix9p256r1,
                                                                                        ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21],
                                                                                        brainpoolP224r1, brainpoolP224t1, brainpoolP256r1,
                                                                                        brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                                                                        brainpoolP384r1, brainpoolP384t1, brainpoolP512r1
                                                                                        and brainpoolP512t1 from RFC 5639 [23], and ANSSI
                                                                                        FRP256v1 [24] curves.
                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with


                                     10   [assignment: list of cryptographic operations]
                                     11   [assignment: cryptographic algorithm]
                                     12   [assignment: cryptographic key sizes]
                                     13   [assignment: list of standards]
                                     14   [assignment: list of cryptographic operations]
                                     15   [assignment: cryptographic algorithm]
                                     16   [assignment: cryptographic key sizes]
                                     17   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                            Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                          16 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/ECC_DHKE                                  Cryptographic operation
                                    Hierarchical to:                                    No other components.
                                                                                                                                             18
                                    FCS_COP.1.1/ECC_DHKE                                The TSF shall perform Diffie-Hellman Key Exchange
                                                                                        in accordance with the specified cryptographic algorithm
                                                                                                         19
                                                                                        ECC over GF(p) and cryptographic key sizes 224,
                                                                                                                        20
                                                                                        256, 320, 384, 512 and 521 bits that meet the
                                                                                        following: ISO/IEC 11770-3:2015, ANSI X9.63, IEEE Std
                                                                                                     21
                                                                                        1363™-2000 .
                                    Application Notes:
                                                                                        (1) The cryptographic algorithms are designed taking
                                                                                        into account the attacks described in JIL-ATT-SC: Attack
                                                                                        Methods for Smartcards and Similar Devices [19].
                                                                                        (2) The security functionality does not provide the
                                                                                        complete key exchange procedure, but only the point
                                                                                        multiplication which is used for the multiplication of the
                                                                                        private key with the communication partner’s public key.
                                                                                        Therefore this function can be used as part of a Diffie-
                                                                                        Hellman key exchange as well pure point multiplication.

                                    Notes:
                                                                                        Due to BSI regulations the certification covers the
                                                                                        standard curves ansix9p224r1, ansix9p256r1,
                                                                                        ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21],
                                                                                        brainpoolP224r1, brainpoolP224t1, brainpoolP256r1,
                                                                                        brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                                                                        brainpoolP384r1, brainpoolP384t1, brainpoolP512r1
                                                                                        and brainpoolP512t1 from RFC 5639 [23], and ANSSI
                                                                                        FRP256v1 [24] curves.

                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with
                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/SHA                                       Cryptographic operation
                                    Hierarchical to:                                    No other components.
                                                                                                                        22
                                    FCS_COP.1.1/SHA                                     The TSF shall perform hashing in accordance with
                                                                                        a specified cryptographic algorithm SHA-1, SHA-224,
                                                                                                                           23
                                                                                        SHA-256, SHA-384 and SHA-512 and cryptographic
                                                                                                      24
                                                                                        key size none that meet the following: FIPS 180-4
                                                                                            25
                                                                                        [16] .




                                     18   [assignment: list of cryptographic operations]
                                     19   [assignment: cryptographic algorithm]
                                     20   [assignment: cryptographic key sizes]
                                     21   [assignment: list of standards]
                                     22   [assignment: list of cryptographic operations]
                                     23   [assignment: cryptographic algorithm]
                                     24   [assignment: cryptographic key sizes]
                                     25   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                            Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                          17 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                    Application Notes:
                                                                                        1) The security functionality is resistant against template
                                                                                        attacks targeting the input message and the output
                                                                                        digest.
                                                                                        (2) The length of the data to hash has to be a multiple of
                                                                                        one byte. Arbitrary bit lengths are not supported.

                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with
                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    The TSF provides functionality to generate a variety of key pairs. In order for the key
                                    generation to function correctly, the operation must be performed in accordance with
                                    a specified standard and with cryptographic key sizes out of a specified range. The
                                    following Security Functional Requirements to the TOE can be derived from this CC
                                    component:
                                    FCS_CKM.1/RSA                                       Cryptographic Key Generation
                                    Hierarchical to:                                    No other components.
                                    FCS_CKM.1.1/RSA                                     The TSF shall generate cryptographic keys in
                                                                                        accordance with a specified cryptographic key
                                                                                                                  26
                                                                                        generation algorithm RSA and specified cryptographic
                                                                                                               27
                                                                                        key sizes 512-4096 bits that meet the following: PKCS
                                                                                                                28
                                                                                        #1, v2.2 and FIPS 186-4 .
                                    Application Notes:
                                                                                        For the modulus n (n = p*q) the prime numbers p and
                                                                                        q generated by the key generator are congruent to 3
                                                                                        modulo 4.
                                                                                        The cryptographic algorithms are designed taking into
                                                                                        account the attacks described in JIL-ATT-SC: Attack
                                                                                        Methods for Smartcards and Similar Devices [19].

                                    Dependencies:                                       [FCS_CKM.2 Cryptographic key distribution, or
                                                                                        FCS_COP.1 Cryptographic operation] FCS_CKM.4
                                                                                        Cryptographic key destruction
                                    FCS_CKM.1/ECC                                       Cryptographic Key Generation
                                    Hierarchical to:                                    No other components.
                                    FCS_CKM.1.1/ECC                                     The TSF shall generate cryptographic keys in
                                                                                        accordance with a specified cryptographic key
                                                                                                                                        29
                                                                                        generation algorithm ECDSA ( ECC over GF(p)) and
                                                                                        specified cryptographic key sizes 224, 256, 320, 384,
                                                                                                         30
                                                                                        512 and 521 bits that meet the following: ISO/IEC
                                                                                                                                         31
                                                                                        14888-3:2015, ANSI X9.62 and FIPS PUB 186-4 .




                                      26   [assignment: cryptographic key generation algorithm]
                                      27   [assignment: cryptographic key sizes]
                                      28   [assignment: list of standards]
                                      29   [assignment: cryptographic algorithm]
                                      30   [assignment: cryptographic key sizes]
                                      31   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                            Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                          18 / 35
NXP Semiconductors                                                                                              Crypto Library Cobalt on N7021 VA
                                                                                                                                  Security Target Lite



                                    Application Notes:
                                                                                      The cryptographic algorithms are designed taking into
                                                                                      account the attacks described in JIL-ATT-SC: Attack
                                                                                      Methods for Smartcards and Similar Devices [19].

                                    Note:                                             Due to BSI regulations the certification covers the
                                                                                      standard curves ansix9p224r1, ansix9p256r1,
                                                                                      ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21],
                                                                                      brainpoolP224r1, brainpoolP224t1, brainpoolP256r1,
                                                                                      brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                                                                      brainpoolP384r1, brainpoolP384t1, brainpoolP512r1
                                                                                      and brainpoolP512t1 from RFC 5639 [23], and ANSSI
                                                                                      FRP256v1 [24] curves.
                                    Dependencies:                                     [FCS_CKM.2 Cryptographic key distribution, or
                                                                                      FCS_COP.1 Cryptographic operation] FCS_CKM.4
                                                                                      Cryptographic key destruction
                                    FCS_CKM.4                                         Cryptographic Key Destruction
                                    Hierarchical to:                                  No other components.
                                    FCS_CKM.4.1                                       The TSF shall destroy cryptographic keys in accordance
                                                                                      with a specified cryptographic key destruction method
                                                                                               32
                                                                                      overwrite that meets the following: ISO 11568-4:2007
                                                                                          33
                                                                                      [14]
                                    Application Notes:
                                                                                      The Crypto Library provides the smartcard embedded
                                                                                      software with library calls to perform various
                                                                                      cryptographic algorithms that involve keys (e.g., AES,
                                                                                      DES, RSA, etc.). Through the parameters of the library
                                                                                      calls the smartcard embedded software provides
                                                                                      keys for the cryptographic algorithms. To perform
                                                                                      its cryptographic algorithms the library copies these
                                                                                      keys, or a transformation thereof, to the working-buffer
                                                                                      (supplied by the smartcard embedded software) and/
                                                                                      or the memory/special function registers of the Crypto
                                                                                      Library on N7021 VA. Depending upon the algorithm
                                                                                      the library either overwrites these keys before returning
                                                                                      control to the smartcard embedded software or provides
                                                                                      a library call to through which the smartcard embedded
                                                                                      software can clear these keys. In the case of a separate
                                                                                      library call to clear keys the guidance instructs the
                                                                                      smartcard embedded software when/how this call should
                                                                                      be used.

                                    Dependencies:                                     [FDP_ITC.1 Import of user data without security
                                                                                      attributes, or FDP_ITC.2 Import of user data with
                                                                                      security attributes, or FCS_CKM.1 Cryptographic key
                                                                                      generation]
                                    Note:                                             Clearing of keys that are provided by the smartcard
                                                                                      embedded software to the Crypto Library is the
                                                                                      responsibility of the smartcard embedded software.



                                     32 [assignment: cryptographic key destruction method]
                                     33 [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                    All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                          Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        19 / 35
NXP Semiconductors                                                                                               Crypto Library Cobalt on N7021 VA
                                                                                                                                   Security Target Lite



                              6.2 Security Assurance Requirements
                                    Table 4 below lists all security assurance components that are valid for Crypto Library
                                    Cobalt on N7021 VA. These security assurance components are required by EAL6 or by
                                    the Protection Profile [5]. Augmentations by the Security Target are marked with ST.

Table 4. Security Assurance Requirements EAL6+ and PP augmentations for Crypto Library Cobalt on N7021 VA
SAR                                 Title                                                                                          Required by
ADV_ARC.1                           Security architecture description                                                              PP / EAL6
ADV_FSP.5                           Complete semi-formal functional specification with additional error                            EAL6
                                    information
ADV_IMP.2                           Complete mapping of implementation representation of the TSF                                   EAL6
ADV_INT.3                           Minimally complex internals                                                                    EAL6
ADV_TDS.5                           Complete Semiformal modular design                                                             EAL6
ADV_SPM.1                           Security Policy Modelling                                                                      EAL6
AGD_OPE.1                           Operational user guidance                                                                      PP / EAL6
AGD_PRE.1                           Preparative procedures                                                                         PP / EAL6
ALC_CMC.5                           Advanced support                                                                               PP / EAL6
ALC_CMS.5                           Development tools CM coverage                                                                  EAL6
ALC_DEL.1                           Delivery procedures                                                                            PP / EAL6
ALC_DVS.2                           Sufficiency of security measures                                                               PP / EAL6
ALC_FLR.1                           Flaw remediation                                                                               ST
ALC_LCD.1                           Developer defined life-cycle model                                                             PP / EAL6
ALC_TAT.3                           Compliance with implementation standards – all parts                                           EAL6
ASE_CCL.1                           Conformance claims                                                                             PP / EAL6
ASE_ECD.1                           Extended components definition                                                                 PP / EAL6
ASE_INT.1                           ST introduction                                                                                PP / EAL6
ASE_OBJ.2                           Security objectives                                                                            PP / EAL6
ASE_REQ.2                           Derived security requirements                                                                  PP / EAL6
ASE_SPD.1                           Security problem definition                                                                    PP / EAL6
ASE_TSS.2                           TOE summary specification                                                                      ST
ATE_COV.3                           Rigorous analysis of coverage                                                                  EAL6
ATE_DPT.3                           Testing: modular design                                                                        EAL6
ATE_FUN.2                           Ordered functional testing                                                                     EAL6
ATE_IND.2                           Independent testing - sample                                                                   PP / EAL6
AVA_VAN.5                           Advanced methodical vulnerability analysis                                                     PP / EAL6

                                    Security Assurance Requirement ADV_SPM.1 requires the developer to provide a
                                    Security Policy Model for the Crypto Library. However, the N7021 hardware already
                                    provides a Security Policy Model (see [13] for details), which also applies unchanged
                                    to the composite product. As the SFRs introduced in this ST do not add a new Security
                                    Policy or change the rules of existing Security Policies of the hardware, there is no need
                                    for an additional Security Policy Model for the Crypto Library.
Crypto Library Cobalt on N7021 VA                     All information provided in this document is subject to legal disclaimers.        © NXP B.V. 2019. All rights reserved.

Product evaluation document                                           Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                            20 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                           6.2.1 Refinements of the Security Assurance Requirements for EAL6+
                                    The Security Target claims strict conformance to the Protection Profile [5], and therefore
                                    it has to be conform to the refinements of the TOE security assurance requirements (see
                                    Application Note 23 of the PP [5]).
                                    The Hardware Security Target [13] for N7021 has chosen the evaluation assurance
                                    level EAL6+. The Security Target of the hardware platform with IC Dedicated Software
                                    including cryptographic library is based on the Protection Profile [5], which requires
                                    the lower level EAL4+. This implies that the refinements made in the Protection Profile
                                    [5], section 6.2.1 Refinements of the TOE Assurance Requirements, for EAL4+ had to
                                    be refined again in order to ensure EAL6+ in the Hardware Security Target (this was
                                    necessary for ALC_CMS.5, ALC_CMC.5, ADV_IMP.2, ATE_COV.3, and ADV_FSP.5).
                                    Since these refinements explain and interpret the CC for hardware, these refinements do
                                    not affect the additional software in this composite TOE. Therefore all refinements made
                                    in the PP [5] are valid without change for the composite TOE.

                              6.3 Security Requirements Rationale


                           6.3.1    Rationale for the Security Functional Requirements
                                    Section 6.3.1 of the PP [5] and Section 6.3.1 of the Hardware Security Target [13]
                                    provide the mapping between security functional requirements and security objectives of
                                    the TOE. This mapping entirely apply to this Security Target.
                                    This ST lists a number of security objectives and SFRs for Crypto Library, which are
                                    additional to both the PP and the Hardware ST. These are listed in the following table.

Table 5. Mapping of SFRs to Security Objectives for Crypto Library in this ST
Objective                                TOE Security Functional Requirements
O.RSA                                    FCS_COP.1/RSA
                                         FCS_COP.1/RSA_Pad
                                         FDP_IFC.1
                                         FDP_ITT.1[HW]
                                         FPT_ITT.1[HW]
                                         FPT_FLS.1
                                         FRU_FLT.2
                                         FDP_RIP.1[SW]
                                         FCS_CKM.4
O.RSA_PubExp                             FCS_COP.1/RSA_PubExp
                                         FDP_IFC.1
                                         FDP_ITT.1[HW]
                                         FPT_ITT.1[HW]
                                         FPT_FLS.1
                                         FRU_FLT.2
                                         FDP_RIP.1[SW]




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      21 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



Objective                                 TOE Security Functional Requirements
O.RSA_KeyGen                              FCS_CKM.1/RSA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.ECDSA                                   FCS_COP.1/ECDSA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
                                          FCS_CKM.4
O.ECC_DHKE                                FCS_COP.1/ECC_DHKE
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.ECC_KeyGen                              FCS_CKM.1/ECC
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]
O.SHA                                     FCS_COP.1/SHA
                                          FDP_IFC.1
                                          FDP_ITT.1[HW]
                                          FPT_ITT.1[HW]
                                          FPT_FLS.1
                                          FRU_FLT.2
                                          FDP_RIP.1[SW]

                                    The justification of the security objectives O.RSA, O.RSA_PubExp, O.RSA_KeyGen,
                                    O.ECDSA, O.ECC_DHKE, O.ECC_KeyGen and O.SHA are all as follows:
                                    • Each objective is directly implemented by a single SFR specifying the (cryptographic)
                                      service that the objective wishes to achieve (see the above table for the mapping).
                                    • The requirements and architectural measures that originally were taken from the
                                      Protection Profile [5] and thus were also part of the Security Target of the hardware
                                      (chip) evaluation support the security objectives:
                                      – FRU_FLT.2 and FPT_FLS.1 supports the objective by ensuring that the TOE works
                                        correctly (i.e., all of the TOE’s capabilities are ensured) within the specified operating
                                        conditions and maintains a secure state when the TOE is outside the specified

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       22 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                       operating conditions. A secure state is also entered when perturbation or DFA attacks
                                       are detected.
                                     – FDP_ITT.1[HW] (for User Data) and FPT_ITT.1[HW] (for TSF Data) ensure that no
                                       User Data (plain text data, keys) or TSF Data is disclosed when they are transmitted
                                       between different functional units of the TOE (i.e., the different memories, the CPU,
                                       cryptographic co-processors), thereby supporting the objective in keeping confidential
                                       data secret.
                                     – FDP_IFC.1 also supports the aspects of confidentiality by ensuring that User
                                       Data and TSF Data are not accessible from the TOE except when the Security IC
                                       Embedded Software decides to communicate them via an external interface.
                                     – FDP_RIP.1[SW] and FCS_CKM.4 ensures that the TOE provides procedural
                                       measures to prevent disclosure of memory contents that was used by the TOE. The
                                       Crypto Library supports FDP_RIP.1[SW] and FCS_CKM.4 by making all memory
                                       contents used by the library no longer available. Note that the requirement for
                                       residual information protection applies to all functionality of the Crypto Library.

                           6.3.2 Extended requirements
                                    This Security Target does not define extended requirements.

                           6.3.3 Dependencies of security requirements
                                    SFRs [FDP_ITC.1, or FDP_ITC.2 or FCS_CKM.1] are not included in this Security Target
                                    for FCS_COP.1/SHA since the TOE only provides a pure engine for these algorithms
                                    without additional features like the handling of keys or importing data from outside the
                                    TOE. Therefore the Security IC Embedded Software must fulfil these requirements
                                    related to the needs of the realized application.

                           6.3.4 Rationale for the Assurance Requirements
                                    The selection of assurance components and augmentations of Crypto Library on N7021
                                    is generally based on EAL6, the underlying Protection Profile [5], and the Security Target
                                    of the hardware [13] of the N7021.
                                    EAL6 was chosen to provide an even stronger baseline of assurance than the EAL4 in
                                    the Protection Profile. The augmentations ALC_FLR.1 and ASE_TSS.2 were chosen to
                                    extend the level of assurance even further.




Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      23 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



7         TOE Summary Specification
                                    This chapter describes the “IT Security Functionality”.

                              7.1 IT Security Functionality
                                    The evaluation of this cryptographic library is performed as a composite evaluation,
                                    where the TOE comprises both the underlying hardware and the embedded software
                                    (Crypto Library). The TOE of this composite evaluation therefore extends the security
                                    functionality already available in the chip platform (see section 7.1 “Portions of the TOE
                                    Security Functionality” of the Hardware Security [13]).
                                    The security functionality of N7021
                                    The security functionality of the hardware platform for the N7021 is described in the
                                    Hardware Security Target [13]. They entirely apply to this Security Target.
                                    Note 8. The security functionality SF.LOG is extended by the Crypto Library as described
                                    in Security Features of the TOE.


                                    The additional security functionality provided by the TOE is described in the following
                                    sub-sections.
                                    The IT security functionalities directly correspond to the TOE security functional
                                    requirements defined in Section 6.1. The definitions of the IT security functionalities refer
                                    to the corresponding security functional requirements.

                           7.1.1 Security Services of the TOE

                         7.1.1.1    SS.RSA

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for data encryption, decryption, signature and verification. All algorithms are
                                    defined in PKCS #1, v2.2 (RSAEP, RSADP, RSAP1, RSAVP1)
                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    The TOE contains modular exponentiation functions, which, together with other functions
                                    in the TOE, perform the operations required for RSA encryption or decryption. Two
                                    different RSA algorithms are supported by the TOE, namely the "Simple Straight Forward
                                    Method" (called RSA "straight forward", the key consists of the pair n and d) and RSA
                                    using the "Chinese Remainder Theorem" (RSA CRT, the key consists of the quintuple p,
                                    q, dp, dq, qInv).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA

                         7.1.1.2    SS.RSA_Pad

                                    The TOE provides functions that implement the RSA algorithm and the RSA-CRT
                                    algorithm for message and signature encoding. This IT security functionality supports the
                                    EME-OAEP and EMSA-PSS signature scheme. All algorithms are defined in PKCS #1,
                                    v2.2 (EME-OAEP, EMSA-PSS)

Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       24 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                    This routine supports various key lengths from 512 bits to 4096 bits.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PAD

                         7.1.1.3    SS.RSA_PublicExp

                                    The TOE provides functions that implement computation of an RSA public key from a
                                    private CRT key. All algorithms are defined in PKCS #1, v2.2.
                                    This routine supports various key lengths from 512 bits to 4096 bits (CRT).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/RSA_PubExp

                         7.1.1.4 SS.ECDSA

                                    The TOE provides functions to perform ECDSA Signature Generation and Signature
                                    Verification according to ISO/IEC 14888-3:2015 [18], ANSI X9.62 [21], FIPS PUB 186-4
                                    [17] and IEEE Std 1363™-2000 [20]
                                    Note that hashing of the message must be done beforehand and is not provided by this
                                    security functionality, but could be provided by SS.SHA.
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECDSA supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/ECDSA
                                    The TOE further provides functions to perform a full ECC point addition as well as a basic
                                    curve parameter check for EC domain parameter. These functionalities are additionally
                                    assessed by the ITSEF performing the evaluation.

                         7.1.1.5 SS.ECC_DHKE

                                    The TOE provides functions to perform Diffie-Hellman Key Exchange according to ISO/
                                    IEC 11770-3:2015 [15], ANSI X9.63 [22] and IEEE Std 1363™-2000 [20]
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECC_DHKE supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,


Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       25 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/ECC_DHKE

                         7.1.1.6 SS.RSA_KeyGen

                                    The TOE provides functions to generate RSA key pairs as described in PKCS #1, v2.2,
                                    and FIPS 186-4 [17].
                                    It supports various key lengths from 512 bits to 4096 bits.
                                    Two different output formats for the key parameters are supported by the TOE, namely
                                    the "Simple Straight Forward Method" (RSA "straight forward") and RSA using the
                                    "Chinese Remainder Theorem" (RSA CRT).
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_CKM.1/RSA

                         7.1.1.7 SS.ECC_KeyGen

                                    The TOE provides functions to perform ECC over GF(p) Key Generation according to
                                    ISO/IEC 14888-3:2015 [18], ANSI X9.62 [21] and FIPS PUB 186-4 [17].
                                    The supported key length are 224, 256, 320, 384, 512 and 521 bits.
                                    SS.ECC_KeyGen supports the following standard curves: ansix9p224r1, ansix9p256r1,
                                    ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21], brainpoolP224r1,
                                    brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                    brainpoolP384r1, brainpoolP384t1, brainpoolP512r1 and brainpoolP512t1 from RFC
                                    5639 [23], and ANSSI FRP256v1 [24] curves.
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_CKM.1/ECC

                         7.1.1.8 SS.SHA

                                    The TOE implements functions to compute the Secure Hash Algorithms SHA-1,
                                    SHA-224, SHA-256, SHA-384 and SHA-512 according to the standard FIPS 180-4 [16]
                                    Attack resistance for this security functionality is discussed in Security architectural
                                    information.
                                    This security functionality covers:
                                    • FCS_COP.1/SHA




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       26 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



8         Annexes

                              8.1 Further Information contained in the PP
                                    The Annex of the Protection Profile ([5], chapter 7) provides further information. Section
                                    7.1 of the PP describes the development and production process of smartcards,
                                    containing a detailed life-cycle description and a description of the assets of the
                                    Integrated Circuits Designer/Manufacturer. Section 7.6 of the PP gives examples of
                                    Attack Scenarios.

                              8.2 Glossary and Vocabulary
                                    Note: To ease understanding of the used terms the glossary of the Protection Profile [5]
                                    is included here.
                                    Application Data                                 All data managed by the Security IC Embedded
                                                                                     Software in the application context. Application data
                                                                                     comprise all data in the final Security IC.
                                    Authentication reference                         Data used to verify the claimed identity in an
                                    data                                             authentication procedure.
                                    Authentication verification                      Data used to prove the claimed identity in an
                                    data                                             authentication procedure.
                                    Composite Product                                Role installing or finalizing the IC Security IC Embedded
                                    Integrator                                       Software and the applications on platform transforming
                                                                                     the TOE into the unpersonalized Composite Product
                                                                                     after TOE delivery. The TOE Manufacturer may
                                                                                     implement IC Security IC Embedded Software delivered
                                                                                     by the Security IC Embedded Software Developer
                                                                                     before TOE delivery (e.g. if the IC Security IC Embedded
                                                                                     Software is implemented in ROM or is stored in the
                                                                                     non-volatile memory as service provided by the IC
                                                                                     Manufacturer or IC Packaging Manufacturer).
                                    Composite Product                                The Composite Product Manufacturer has the following
                                    Manufacturer                                     roles (i) the Security IC Embedded Software Developer
                                                                                     (Phase 1), (ii) the Composite Product Integrator (Phase
                                                                                     5) and (iii) the Personalizer (Phase 6). If the TOE is
                                                                                     delivered after Phase 3 in form of wafers or sawn
                                                                                     wafers (dice) he has the role of the IC Packaging
                                                                                     Manufacturer (Phase 4) in addition. The customer of the
                                                                                     TOE Manufacturer who receives the TOE during TOE
                                                                                     Delivery. The Composite Product Manufacturer includes
                                                                                     the Security IC Embedded Software developer and all
                                                                                     roles after TOE Delivery up to Phase 6 (refer to Figure 2
                                                                                     on page 10 and Section 7.1.1).
                                    End-consumer                                     User of the Composite Product in Phase 7.
                                    IC Dedicated Software                            IC proprietary software embedded in a Security IC
                                                                                     (also known as IC firmware) and developed by the IC
                                                                                     Developer. Such software is required for testing purpose
                                                                                     (IC Dedicated Test Software) but may provide additional
Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       27 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                                                                    services to facilitate usage of the hardware and/or
                                                                                    to provide additional services (IC Dedicated Support
                                                                                    Software).
                                    IC Dedicated Test Software That part of the IC Dedicated Software (refer to above)
                                                               which is used to test the TOE before TOE Delivery but
                                                               which does not provide any functionality thereafter.
                                    IC Dedicated Support                            That part of the IC Dedicated Software (refer to above)
                                    Software                                        which provides functions after TOE Delivery. The usage
                                                                                    of parts of the IC Dedicated Software might be restricted
                                                                                    to certain phases.
                                    Initialization Data                             Initialization Data defined by the TOE Manufacturer to
                                                                                    identify the TOE and to keep track of the Security IC’s
                                                                                    production and further life-cycle phases are considered
                                                                                    as belonging to the TSF data. These data are for
                                                                                    instance used for traceability and for TOE identification
                                                                                    (identification data).
                                    Integrated Circuit (IC)                                                 3.2 (2)
                                                                                            [IEEE1363], ch. 8.1.3.1(2)
n_d               IFX RSA key generation (i.e. without       512 - 2112 Bits                [RSA-PKCSB] , ch. 3.1 and
                  CRT) and return of (n, d)                                                 3.2 (1)
                                                                                            [IEEE1363] , ch. 8.1.3.1(1)
p_q_d             IFX RSA key generation (i.e. without       512 – 2112 Bits                [IEEE1363] , ch. 8.1.3.1(3)
                  CRT) and return of (p , q, d)

Note:            RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.4/RSA                      Cryptographic key destruction
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/RSA                    The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method destruction of RAM key during system or
                                   power on reset1 that meets the following: None2

Note:            The TOE can be delivered with or without the optional RSA library. If the RSA library is not deliverd, the
                 TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
                 delivered cryptographic RSA library cannot be used and therefore the SFRs of this chapter are also not
                 applicable.

6.1.3.4                 Elliptic Curve Cryptography (ECC)
For cryptographic ECC functionality, the TOE shall meet the requirement cryptographic operation (FCS_COP.1)
and cryptographic key construction (FCS_CKM .1) as specified below:

FCS_COP.1/ECC/<iteration>                 Cryptographic operation
Hierarchical to:                          No other components.
Dependencies:                             [FDP_ITC.1 Import of user data of the Composite TOE without security
                                          attributes, or

1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               34                                                       v4.0
                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                     FDP_ITC.2 Import of user data of the Composite TOE with security
                                     attributes, or
                                     FCS_CKM.1 Cryptographic key management]
                                     FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/ECC/<iteration>          The TSF shall perform [assignment: list of cryptographic operations] in
                                     accordance with a specified cryptographic algorithm [assignment:
                                     cryptographic algorithm]
                                     and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                     meet the following standards: [assignment: list of standards]

Table 20      Cryptographic table for FCS_COP.1/ECC
 <iteration>      [assignment: list of     [assignment: [assignment:             [assignment: list of standards]
                  cryptographic            cryptographic cryptographic
                  operations]              algorithm]    key sizes]

 SIG              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.3
                  generation               ECSP-DSA                              [IEEE1363], ch. 7.2.7
 VER              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.4.1
                  verification             ECVP-DSA                              [IEEE1363], ch. 7.2.8
 DH               ECDH key agreement ECDH                    160 – 521 Bits      [ANSX9.63], ch. 5.4.1
                                     ECSVHDP-DH                                  [ISO11770_3], appendix D.6
                                                                                 [IEEE1363], ch. 7.2.1
 ADD              EC point addition        C = A+B           160 – 521 Bits      n.a.

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

Note:         For the /SIG iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step d) is not supported

Note:         For the /VER iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step b) is not supported.
              Beside noted calculation, our algorithm adds a random multiple of order of the basepoint to the
              calculated values u1 and u2.

Note:         For the/ DH iteration, the implementation always returns the y-coordinate in addition to the x-
              coordinate.

Note:         For the /ADD iteration, the elliptic curve points A, B and C are considered as secrets.

Note:         Cofactor multiplication is not supported

FCS_CKM.1/ECC                 Cryptographic key generation
Hierarchical to               No other components.
Dependencies                  FCS_CKM.2 Cryptographic key distribution, or
                              FCS_COP.1 Cryptographic operation]

Security Target                                            35                                                    v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/ECC                 The TSF shall generate cryptographic keys in accordance with a specified
                                cryptographic key generation algorithm EC key generation1 and specified
                                cryptographic key sizes of 160-521 bits2 that meet the following: [ANSX9.62], ch.
                                A4.3 and [IEEE1363], ch. A.16.9.3

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

FCS_CKM.4/ECC                   Cryptographic key destruction
Hierarchical to:                No other components.
Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                FDP_ITC.2 Import of user data with security attributes, or
                                FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/ECC                 The TSF shall destroy cryptographic keys in accordance with a specified
                                cryptographic key destruction method destruction of RAM key during system or
                                power on reset4 that meets the following: None5


Note:         The TOE can be delivered with or without the optional ECC library. If the ECC library is not deliverd, the
              TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
              delivered cryptographic ECClibrary cannot be used and therefore this SFR is also not applicable. .




6.1.4                Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

FPT_TST.2                       Subset TOE testing
Hierarchical to:                No other components.
Dependencies:                   No dependencies
FPT_TST.2.1                     The TSF shall run a suite of self tests at the conditions request of the Security IC
                                Embedded Software1 to demonstrate the correct operation of the alarm lines
                                and/or the environmental sensor mechanisms:


1
  [assignment: list of cryptographic operations]
2
  [assignment: cryptographic key sizes
3
  [assignment: list of standards]
4
  [assignment: cryptographic key destruction method]
5
  [assignment: list of standards]

Security Target                                             36                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                       Please refer to the confidential Security Target2


6.1.5                  Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent
that one application can access code and/or data of another application. For this reason the TOE provides Area
based Memory Access Control. The underlying Memory Protection Unit (MPU) is documented in Appendix B3.5
of the ARMv7 M architecture reference manual [ARMv7M].
In particular, the MPU provides full support for:
 Protection regions.
 Overlapping protection regions, with ascending region priority:
  − Region 7 = highest priority.
  − Region 0 = lowest priority.
 Access permissions.
   MPU mismatches and permission violations invoke the programmable-priority MemManage fault handler.

The MPU can be used to:
   Enforce privilege rules, preventing user applications from corrupting operating system data.
   Separate processes, blocking the active task from accessing other tasks’ data.
   Enforce access rules, allowing memory regions to be defined as read-only or detecting unexpected memory
    accesses.

The SFRs are provided by the Memory Access Control Policy (FDP_ACC.1 and dependencies).


6.1.5.1                Subjects, objects and operations of the Memory Access Control Policy
Subjects:
 MPU

Objects:
 memory/code addresses

Operations:
 Read a/o write a/o execute access


6.1.5.2                Security attributes of the Memory Access Control Policy
Security Attribute which define the roles for Subject MPU:
 Npriv flag defining privilege/non-privilege mode


Security Attribute which control the behavior of the Subject MPU:



1
  [selection: during initial start-up, perioequirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key lengths of 160, 163, 192,

CC Document                                              98                                                      1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


224, 233, 256, 283, 320, 384, 409, 512 or 521 bits. For one part the definition of the key lengths follows the
national AIS32 regulation regarding the 100 bit security level by the BSI. Numerous other curve types, being also
secure in terms of side channel attacks on this TOE, exist, which the user optionally can add in the composition
certification process.
  All curves are based on finite field GF(p) with value p є [241-1; 2521[ as well as curves based on a finite field GF(2n)
                                        with size n є [41-1; 521] are supported.

 7.1.4.6.4     Elliptic Curve DSA (ECDSA) operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation
(FCS_COP.1)” as specified below.
 FCS_COP.1/ECDSA-3           Cryptographic operation
 Hierarchical to:            No other components.
 Dependencies:               [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                             or
                             FDP_ITC.2 Import of user data of the Composite TOE with security attributes]
                             FCS_CKM.4 Cryptographic key destruction
 FCS_COP.1.1/ECDSA-3         The TSF shall perform signature generation and signature verification in accordance
                             with a specified cryptographic algorithm ECDSA and cryptographic key sizes 160,
                             163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following:
                             ECDSA Signature Generation:
                             1. According to section 7.3 Signing Process in ANSI [23]
                                     Step d) and e) are not supported
                                     The output of step e) has to be provided as input to our function by the caller.
                                   Deviation of step c) and f):
                             The jumps to step a) were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function.
                             2. According to sections 6.4.3 Signature Process in ISO/IEC [27]
                                     Chapter 6.4.3.3 is not supported
                                     Chapter 6.4.3.5 is not supported
                                         o the hash-code of H of the message has to be provided by the caller as
                                             input for our function.
                                  Chapter 6.4.3.7 is not supported
                             Chapter 6.4.3.8 is not supported
                             3. According to section 7.2.7 ECSP-DSA in IEEE [29]
                                   Deviation of step (3) and (4):
                             The jumps to step 1 were substituted by a return of the function with an error code,
                             the jumps are emulated by another call to our function
                             ECDSA Signature Verification:
                             1. According to section 7.4.1 in ANSI [23]
                                     Step b) and c) are not supported.
                                     The output of step c) has to be provided as input to our function by the caller.
                                     Deviation of step d):
                                         o Beside noted calculation, our algorithm adds a random multiple of
                                              BasepointerOrder n to the calculated values u1 and u2.

CC Document                                                 99                                                         1.8
                                                                                                                2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


                            2. According to sections 6.4.4 Signature Verification Process in ISO/IEC [27]
                                   Chapter 6.4.4.2 is not supported
                                   Chapter 6.4.4.3 is not supported:
                                        o The hash-code H of the message has to be provided by the caller as
                                             input to our function
                            3. According to section 7.2.8 ECVP-DSA in IEEE [29].

Note for FCS_COP.1/ECDSA-3:
For easy integration of EC functions into the user’s operating system and/or application, the library contains
single cryptographic functions respectively primitives which are compliant to the standard. The primitives are
referenced above. Therefore, the library supports the user to develop an application representing the standard if
required.
End of note.




CC Document                                             100                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


 7.1.4.6.5    Elliptic Curve (EC) key generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”.

   FCS_CKM.1/EC-3         Cryptographic key generation
   Hierarchical to:       No other components.
   Dependencies:          FCS_CKM.2 Cryptographic key distribution, or
                          FCS_COP.1 Cryptographic operation]
                          FCS_CKM.4 Cryptographic key destruction
   FCS_CKM.1.1/EC-3       The TSF shall generate cryptographic keys in accordance with a specified
                          cryptographic key generation algorithm implemented by following functions which
                      BSI-DSZ-CC-0879-V4-2020

                       for

   Infineon Security Controller M7893 B11 with
 optional RSA2048/4096 v2.03.008, EC v2.03.008,
SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox
v2.03.008 and with specific IC dedicated software
                    (firmware)

                      from

           Infineon Technologies AG
                     BSI - Bundesamt für Sicherheit in der Informationstechnik, Postfach 20 03 63, D-53133 Bonn
                      Phone +49 (0)228 99 9582-0, Fax +49 (0)228 9582-5477, Infoline +49 (0)228 99 9582-111




Certification Report V1.0                                                                                         CC-Zert-327 V5.25
      BSI-DSZ-CC-0879-V4-2020 (*)
      Infineon Security Controller M7893 B11 with optional RSA2048/4096
      v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
      Toolbox v2.03.008 and with specific IC dedicated software (firmware)

      from                       Infineon Technologies AG
      PP Conformance:            Security IC Platform Protection Profile, Version 1.0,                             SOGIS
                                 15 June 2007, BSI-CC-PP-0035-2007                                           Recognition Agreement

      Functionality:             PP conformant plus product specific extensions
                                 Common Criteria Part 2 extended
      Assurance:                 Common Criteria Part 3 conformant
                                 EAL 6 augmented by ALC_FLR.1



The IT Product identified in this certificate has been evaluated at an approved evaluation
facility using the Common Methodology for IT Security Evaluation (CEM), Version 3.1
extended by Scheme Interpretations, by advice of the Certification Body for components
beyond EAL5 and CC Supporting Documents as listed in the Certification Report for
conformance to the Common Criteria for IT Security Evaluation (CC), Version 3.1. CC and
CEM are also published as ISO/IEC 15408 and ISO/IEC 18045.
(*) This certificate applies only to the specific version and release of the product in its
evaluated configuration and in conjunction with the complete Certification Report and
Notification. For details on the validity see Certification Report part A chapter 5.
The evaluation has been conducted in accordance with the provisions of the certification
scheme of the German Federal Office for Information Security (BSI) and the conclusions
                                                                                                             Common Criteria
of the evaluation uired guaranteeing the
traceability and completeness of different charges and lots. Also the number of wafers, dies and chips must be
tracked by this system as well as procedures applied for managing wafers, dies or complete chips being removed
from the production process in order to verify and to control predefined quality standards and production
parameters. It has to be controlled that these wafers, dies or assembled devices are returned to the same
production stage from which they are taken or they have to be securely stored or destroyed otherwise.
The additionally covered extended package of ALC_CMC.5 Advance Support requires advanced support
considering the automatisms configuration management systems, acceptance and documentation procedures
of changes, role separation with regard to functional roles of personnel, automatisms for tracking and version
controlling in those systems, and includes also production control systems. The additional aspects of
ADV_CMC.5 constitute an enhancement of ACL_CMC.4 and therefore the aspects and ACL_CMC.4 refinements
in the PP [9] remain valid. The assurance and evidence was provided.

ALC_DVS Development Security:
The requirement ALC_DVS.2 is refined in the PP [9] requiring the development security documentation
comprising all the physical, procedural, personnel, and other security measures that are necessary to protect the
confidentiality and integrity of the TOE design and implementation in its development environment.
The documentation and evidence was given, reviewed, audited and thus the assurance and evidence was
provided accordingly.

Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the:
      keys are generated with sufficient entropy
      the keys are stored within a HSM as integral part of the vendor environment
      the keys are stored in the non-volatile memory of the chip
All these requirements were subject of an audit; assurance and evidence was provided.



CC Document                                            111                                                     1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


ALC_DEL Delivery Procedure:
Considering the GBIC requirements as outlined in section 10 this assurance class is refined with the confirmation
that the delivery process of the Flash Loader keys - as referenced in the section 10 - is separated from the chip
delivery to the user.


7.3.1.3         Tests (ATE)
ATE_COV Test Coverage:
The PP refined assurance package ATE_COV.2 Analysis of coverage addresses the extent to which the TSF is
tested, and whether or not the testing is sufficiently extensive to demonstrate that the TSF operates as specified.
It includes the test documentation of the TSFIs in the functional specification. In particular the refinement
requires that The TOE must be tested under different operating conditions within the specified ranges. In
addition, the existence and effectiveness of mechanisms against physical attacks should be covered by evidence
that the TOE has the particular physical characteristics. This is furthermore detailed in the PP [9].
This assurance package ATE_COV.2 has been enhanced to ATE_COV.3 to cover the rigorous analysis of
coverage. This requires the presence of evidence that exhaustive testing on rigorous entirely all interfaces as
documented in the functional specification was conducted. By that ATE_COV.2 and refinements as given in the
PP [9] are enhanced by ATE_COV.3 and remain as well. The TSFIs were completely tested according to
ATE_COV.3 and the assurance and evidence was provided.


7.3.1.4         AVA_VAN Vulnerability Analysis
The assurance package AVA_VAN remains unchanged compared to the forerunner processes and requires
advanced methodical vulnerability analysis.




CC Document                                             112                                                     1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


7.4           Security Requirements Rationale

7.4.1         Rationale for the Security Functional Requirements
The objectives O.Authentication and OE.TOE_Auth are discussed in the PP [9] chapter 7.2.1.
The objectives O.Cap_Avail_Loader and OE.Lim_Block_Loader and the covering security functional
requirements FMT_LIM.1/Loader and FMT_LIM.2/Loader are discussed in the PP [9] chapter 7.3.1.
The policy P.Ctrl_Loader and the objectives O.Ctrl_Auth_Loader and OE.Loader_usage are discussed in the PP
[9] chapter 7.3.2.

Additionally, the objective O.Add-Function includes the objectives implemented by the CIPURSE™
Cryptographic Library versions: O.Ctrl_Auth_CCL, O.Prot_Integrity and O.Prot_Confidentiality.
These extended objectives are discussed in this ST in chapter 5.5 P.Add functions.

The additional objectives O.Prot_TSF_Confidentiality is defined in chapter 5.1 and 5.8 in this document.
PP [9] chapter 6.1 includes also the definition of FDP_SDI.2 „Stored data integrity monitoring and action“.
While the above mentioned security functional requirements rationale of the TOE are defined and described in
PP [9] section 6.3.1, the additional introduced SFRs are listed and discussed below:

                              Table 14     Rational for additional SFR in the ST
         Objective                                TOE Security Functional Requirements
                             FCS_COP.1/RSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDSA-1 Cryptographic operation for ACL-1
                             FCS_COP.1/ECDH-1 Cryptographic operation for ACL-1
                             FCS_CKM.1/RSA-1 Cryptographic key generation for ACL-1
                             FCS_CKM.1/EC-1 Cryptographic key generation for ACL-1
                             FCS_COP.1/RSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDSA-2 Cryptographic operation for ACL-2
                             FCS_COP.1/ECDH-2 Cryptographic operation for ACL-2
                             FCS_CKM.1/RSA-2 Cryptographic key generation for ACL-2
                             FCS_CKM.1/EC-2 Cryptographic key generation for ACL-2
O.Add-Functions
                             FCS_COP.1/RSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDSA-3 Cryptographic operation for ACL-3
                             FCS_COP.1/ECDH-3 Cryptographic operation for ACL-3
                             FCS_CKM.1/RSA-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/EC-3 Cryptographic key generation for ACL-3
                             FCS_CKM.1/CCL Cryptographic key generation for CCL
                             FCS_COP.1/CCL Cryptographic Operation CCL Trusted Channel for CCL
                             FCS_CKM.4/CCL Cryptographic key destruction for CCL
                             FCS_COP.1/CMAC-SCL-1 Cryptographic operation CMAC for SCL-1
                             FCS_CKM.4/CMAC-SCL-1 Cryptographic key destruction CMAC for SCL-1
O.Phys-Manipulation          FPT_TST.2 Subset TOE security testing
                             FDP_ACC.1 Subset access control
O.Mem-Access                 FDP_ACF.1 Security attribute based access control
                             FMT_MSA.3 Static attribute initialization

CC Document                                           113                                                   1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Requirements (ASE_REQ)


         Objective                                TOE Security Functional Requirements
                             FMT_MSA.1 Management of security attributes
                             FMT_SMF.1 Specification of Management Functions
O.Malfunction                FDP_SDI.2 Stored data integrity monitoring and action
                             FCS_RNG.1/TRNG Generation of Random Numbers –TRNG
                             FCS_RNG.1/HPRG Generation of Random Numbers – HPRG
O.RND
                             FCS_RNG.1/DRNG Generation of Random Numbers –DRNG
                             FCS_RNG.1/KSG Generation of Random Numbers – KSG
                             FTP_ITC.1 Inter-TSF-trusted channel
O.Prot_TSF_
                             FDP_ACC.1/Loader Subset access control –Loader
Confidentiality
                             FDP_ACF.1/Loader Security attribute based access control – Loader
                             FCS_COP.1/TDES-SCL-1 Cryptographic operation – TDES by SCL-1
                             FCS_CKM.4/TDES-SCL-1 Cryptographic key destruction – TDES by SCL-1
                             FCS_COP.1/TDES-SCL-2 Cryptographic operation – TDES by SCL-2
O.TDES
                             FCS_CKM.4/TDES-SCL-2 Cryptographic key destruction – TDES by SCL-2
                             FCS_COP.1/TDES Cryptographic operation – TDES by SCP
                             FCS_CKM.4/TDES Cryptograpate component: Proprietary functionality that is can update JCOP5.2 OS- no
                                                                                                                     security functionality is claimed.
                                                                                                                o Restricted Mode: In Restricted Mode only very limited functionality of the TOE is
                                                                                                                     available such as, e.g.: reading logging information or resetting the Attack Counter.
                                                                                                                o Error Detection Code (EDC) API.
                                                                                                           Functionality introduced in R2, for which there are no specific additional security claims:
                                                                                                                o CAT-TP, with limitations as described in the [AGD_UGM] Section 8.1.
                                                                                                                o 5G features as per SIM Alliance 2.3, as in [AGD_UGM] Section 2.4.4 and 8.1.
                                                                                                                o Extension to Global Platform Amendment H, as in [AGD_UGM] Section 3.5.7.
                                                                                                                o CPLC data made available through SystemInfo, as in [AGD_UGM] Section 2.1.3.22.

                                                                                                 2.3       Assumptions and Clarification of Scope

                                                                                                 2.3.1      Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in section 5.2 of the
                                                                                                 [ST].
                                                                                                 Page: 8/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.
                                                                                                 Note that proprietary applications have been included in the TOE, but as there are no security claims
                                                                                                 on these functionalities, these application functionality has not been assessed, only the self-protection
                                                                                                 of the TSF.

                                                                                                 2.4     Architectural Information
                                                                                                 The TOE consists of a certified Hardware IC, with Micro Controller Firmware (Boot OS, Factory OS
                                                         art Card
  Controller P6022y VB
  Security Targe                                        and Flash driver software) and certified security software library consisting of a crypto library and
                                                                                                 services software. All these parts are depicted in the figure below with the shaded box marked
                                                                                                 SE100_SE. Since, this TOE is a composite on top of this certified platform, this block is not depicted
                                                                                                 in more detail.
                                                                                                 The Software stack consists of the JCOP Core parts marked with salmon coloured blocks
                                                                                                 implementing the Native OS, Global platform functionality and the Java Card 3.05 functionality. The
                                                                                                 TOE also implements a Cryptographic Service Provider marked with an orange coloured block. It
                                                                                                 implements a number of NXP proprietary features like the JCOP extension APIs for MiFare, Felica,
                                                                                                 Updater O/S and Config applet (note there are no security claims relating to MiFare and Felica).
                                                                                                 Furthermore the TOE implements GSMA ‘Remote SIM Provisioning Architecture for consumer
                                                                                                 Devices’, referred to as eUICC. The JCOP O/S supports the eUICC APIs and uses the Broker API to
                                                                                                 forward to the eSIM/SIM/UICC/ISIM commands to the eUICC Plugin Library.
                                                                                                 The TOE supports two domains, the eSE for the Java Card Secure Element domain and an eUICC
                                                                                                 domain providing UICC functionality in accordance with the GSMA Specification.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 9/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.5     Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                  JCOP Version       Identifier                                                        Version
                                                                                                  JCOP 5.2 R1        [AGD_UGM52R1] JCOP 5.2 R1.01.1 User Guidance Manual               1.8, 2019-10-30
                                                                                                                     [AGD_UGMSEMS52R1] JCOP 5.2 R1.01.1 User Guidance
                                                                                                                                                                                       1.1, 2019-10-17
                                                                                                                     Manual Addendum for SEMS API
                                                                                                                     [AGD_CSP52R1] JCOP 5.2 R1.01.1 User Guidance Manual
                                                                                                                                                                                       1.6, 2019-10-15
                                                                                                                     Addendum for CSPAPI
                                                                                                [GP]OP 5.2 R2        [AGD_UGM52R2] JCOP 5.2 R2, User Guidance Manual,
                                                                                                                                                                                       1.3, 2020-06-08
           *                                                                                                         doc. no. 608813
                                                                                                                     [AGD_UGMSEMS52R2] JCOP 5.2 R2, User Guidance
                                                                                                                                        t Lite
  Rev. 2.1 — 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document inf                                               1.2, 2020-06-08
                                                                              ormation
Informat            ecurity
                                    IC Embedded Software may contain the “Crypto Library Cobalt on N7021 VA“ (or parts
                                           1
                                    thereof ) and this Crypto Library is part of the TOE.
                                    RSA
                                    • The RSA algorithm can be used for encryption and decryption as well as for signature
                                      generation, signature verification, message encoding and signature encoding.
                                    • The RSA key generation can be used to generate RSA key pairs.
                                    • The RSA public key computation can be used to compute the public key that belongs to
                                      a given private CRT key.
                                    The TOE supports various key sizes for RSA up to a limit of 4096 bits.
                                    RSA functionality is not available in case the customer disabled the PKCC coprocessor
                                    as part of the hardware configuration. See the Hardware Security Target [13] for more
                                    information.
                                    ECDSA (ECC over GF(p))
                                    • The ECDSA e memories, registers, I/O interfaces and the
                        other system peripherals) during execution of the IC Dedicated Support Software and
                        Security IC Embedded Software. This includes all security mechanisms of the P6022y
                        VB, which directly contribute to a Security Service or a Security Feature.
                        The P6022y VB ensures its correct operation and prevents any malfunction using the
                        following mechanisms: filtering of power supply, clock frequency and reset input as well
                        as monitoring of voltage supply, clock frequency input and the temperature of the chip
P6022y VB                              All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                    Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                        77 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      by means of sensors. There are multiple voltage and frequency sensors for the different
                      ISO/IEC 7816 voltage classes and the contactless operation mode. Light sensors are
                      distributed over the chip surface and used to detect light attacks. In addition to the light
                      sensors the EEPROM provides two functions to detect light attacks. The Security IC
                      Embedded Software can enable/disable the EEPROM double read function.
                      Specific functional units of the P6022y VB are equipped with further fault injection
                      detection. This comprises the Secure Fetch for the processing of code and data by the
                      CPU or special circuitry within a functional unit. The functional units are the Program
                      Counter, the stack pointer, the CPU control register, the MMU address cache and control
                      registers, the SBC interface for the Triple-DES and the AES coprocessors, the Fame2
                      coprocessor, Copy Machine control registers and hardware configuration as well as test
                      control registers. Furthermore the P6022y VB contains a watchdog timer which can be
                      enabled and configured by the Security IC Embedded Software to protect the program
                      execution.
                      If one of the monitored parameters is out of the specified range, either (i) a reset is forced
                      and the actually running program is aborted or (ii) an exception is raised which interrupts
                      the program flow and allows a reaction of the Security IC Embedded Software. In case
                      minor configuration option “Inverse EEPROM Error Correction” is enabled (see Section
                      1.4.2.2) the probability to detect fault injection attack detectors at the EEPROM memory
                      and interface increases and the error correction logic raises an exception when detecting
                      an error. The RAM memory is equipped with additional parity bits which are checked
                      when the corresponding data stored in RAM is read. Additionally a RAM parity watchdog
                      mechanism is supported which checks the parity bits of the complete RAM in random
                      order when the Security IC Embedded Software is not accessing the RAM. In case of
                      detected RAM parity attack detectors both mechanisms trigger a security reset. In case
                      the P6022y VB processes a reset all components of the P6022y VB are initialised with
                      their reset values and the P6022y VB provides a reset cause indicator to the Security IC
                      Embedded Software. In the case an exception is raised an indicator for the reason of the
                      exception is provided. The P6022y VB defends the sensors from being disabled by the
                      Security IC Embedded Software.
                      The P6022y VB controls the specified range of the stack pointer. The stack pointer and
                      the related control logic are implemented threefold for the User Mode, System Mode
                      and Super System Mode (comprising Boot Mode, Test Mode and Firmware Mode). An
                      exception is generated in case the specified limits are exceeded.
                      In addition, SF.OPC comprises a sensor, which checks the high voltage of the write
                      process to the EEPROM during each write sequence. The result of this sensor must
                      be read from a Special Function Register and does not force an automatic event (e.g.
                      exception).
                      SF.PHY: Protection against Physical Manipulation
                      SF.PHY protects the P6022y VB against manipulation of (i) the IC hardware, (ii) the
                      IC Dedicated Software in ROM, (iii) the Security IC Embedded Software in ROM and
                      EEPROM, (iv) the Application Data in EEPROM and RAM including TSF data in the
                      Security Rows. It also protects User Data and TSF data against disclosure by physical
                      probing when stored or while being processed by the P6022y VB.
                      The protection of the P6022y VB comprises several security mechanisms in design and
                      construction, which make reverse-engineering and tamper attacks more difficult. These
                      mechanisms comprise dedicated shielding techniques for the P6022y VB and specific
                      encryption- and check mechanisms for the memories and internal buses. SF.PHY
                      supports the efficiency of other portions of the security functionality.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       78 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.PHY also supports the integrity of the EEPROM, RAM and the ROM. The EEPROM
                      is able to correct a 1-bit error within each byte. The EEPROM corrects these attack
                      detectors automatically without user interaction. The RAM and the ROM provide a parity
                      check. In both cases a reset is forced based on a parity error.
                      The CRC coprocessor is used in Boot Mode by the IC dedicated Software for calculation
                      of a CRC checksum for integrity protection of TSF data.
                      SF.PUF: User Data Protection using PUF
                      SF.PUF implements a mechanism to seal/unseal the user data stored in shared
                      memory against unintended disclosure. SF.PUF encrypts/decrypts the user data with
                      a cryptographic key derived from the PUF data. SF.PUF calculates a MAC as a PUF
                      authentication value. SF.PUF provides this sealing/unsealing mechanism through the
                      specified interfaces FVEC2 (see Fig. 2) only.
                      SF.LOG: Logical Protection
                      SF.LOG implements security mechanisms to limit or eliminate the information in the
                      shape and amplitude of signals or in the time between events, which might be found by
                      measuring such signals. This comprises the power supply, signals on other pads, which
                      are not intentionally used for communication by the terminal or the Security IC Embedded
                      Software as well as emanation of the hardware platform. Thereby SF.LOG prevents from
                      disclosure of User Data and TSF data stored and/or processed in the Security IC through
                      measurement of power consumption or emanation and subsequent complex signal
                      analysis. This protection of the P6022y VB is enforced by several security mechanisms in
                      the design, which support these portions of security functionality.
                      The Triple-DES coprocessor includes specific security mechanisms to prevent SPA/
                      DPA analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the Triple-DES coprocessor further ensures that the calculation time is
                      independent from the chosen key value and plain/cipher text.
                      The AES coprocessor includes specific security mechanisms to prevent SPA/DPA
                      analysis of shape and amplitude of the power consumption and emanation. The
                      implementation of the AES coprocessor further ensures that the calculation time is
                      independent from the chosen key any plain/cipher text for a given key length.
                      The Fame2 coprocessor provides measures to prevent timing attacks on basic modular
                      function. The calculation time of an operation depends on the lengths of the operands,
                      but not on the value of the operands, with the following exceptions: multiplication with
                      reduction, modular inversion and modular division. These three operations have no
                      constant timing due to correction cycles that are needed based on the calculation
                      method. In addition, mechanisms are included, which provide limitations of the capability
                      for the analysis of shape and amplitude of the power consumption. Of course the Fame2
                      coprocessor does not realise an algorithm on its own and algorithm-specific leakage
                      countermeasures have to be added by the Security IC Embedded Software when using
                      the Fame2 coprocessor.
                      Additional security mechanisms can be configured by the Security IC Embedded
                      Software. This comprises the configuration of the clock that can be used to prevent the
                      synchronisation between internal operations and external clock or characteristics of the
                      power consumption that can be used as trigger signal to support leakage attacks (DPA or
                      timing attacks)
                      Some mechanisms described for SF.PHY (e.g. the encryption mechanisms) and for
                      SF.OPC (e.g. the filter mechanisms) support SF.LOG.
                      SF.COMP: Protection of Mode Control
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      79 / 101
NXP Semiconductors
                                                                                                                   P6022y VB
                                                                                                                   Security Target Lite


                      SF.COMP provides control of the CPU mode for (i) Boot Mode, (ii) Test Mode and
                      (iii) Firmware Mode. This includes protection of electronic fuses stored in a protected
                      memory area, the so-called Security Rows, and the possibility to store initialisation or
                      pre-personalisation data in the so-called FabKey Area.
                      Control of the CPU mode for Boot Mode, Test Mode and Firmware Mode prevents abuse
                      of test functions after TOE delivery. It also inhibits abuse of features, which are used
                      during start-up or reset to configure the P6022y VB.
                      The integrity control of electronic fuses ensures secure storage and setup of
                      configuration and calibration data, during the start-up in Boot Mode. The protection
                      of electronic fuses especially ensures that configuration options with regard to the
                      security functionality cannot be changed, abused or influenced in any way. The transfer
                      of the content of the electronic fuses into the related hardware configuration registers
                      is protected by a CRC checksum generated using the CRC coprocessor. SF.COMP
                      ensures that activation or deactivation of security mechanisms cannot be influenced by
                      the Security IC Embedded Software so that the TSF provides self-protection against
                      interference and tampering by untrusted Security IC Embedded Software.
                      SF.COMP protects CPU mode switches regarding Boot Mode, Test Mode and Firmware
                      Mode in the following way: Switching from Boot Mode to Test Mode or Firmware Mode is
                      allowed, switching from these modes back to Boot Mode is prevented. Switching to Test
                      Mode is prevented as well after TOE delivery, because Test Mode then is permanently
                      disabled. SF.COMP also ensures that Boot Mode is active only in the boot phase during
                      start-up or reset of the P6022y VB, and cannot be invoked afterwards. Therefore, once
                      the P6022y VB has left the test phase and each time the P6022y VB completed start-up
                      or reset, Firmware Mode is the only Super System Mode available.
                      The TSF controls access to the Security Rows, the top-most 512 Bytes of the EEPROM
                      memory, accessible at reserved addresses in the memory map. The available EEPROM
                      memory space for the Security IC Embedded Software is reduced by this area.
                      SF.COMP provides three memory areas in the Security Rows, which can be used by the
                      Security IC Embedded Software. These are
                      • the User Read Only Area
                      • the User Write Protected Area and
                      • the User Write Once Area.
                      The User Read Only Area contains 32 bytes, which are read-only for the Security IC
                      Embedded Software. The User Write Protected area contains 16 bytes, which can be
                      write-protected by the Security IC Embedded Software on demand. The User Write Once
                      Area contains 32 bytes of which each bit can separately be set to ‘1’ once only, and not
                      reset to ‘0’.
                      SF.COMP also provides a memory area in the Security Row where the current values
                      for the Post Delivery Configuration (see SS.RECONFIG). This area cannot be accessed
                      by the Security IC Embedded Software, but it can be accessed by the Resource
                      Configuration Firmware.
                      If minor configuration option “Card Disable” feature is used (refer to section 1.4.2.2)
                      SF.COMP inhibits any start-up of the Security IC Embedded Software once the Security
                      IC Embedded Software disables the card.
                      If minor configuration option “EEPROM application content erase” is used (see Section
                      1.4.2.2) SF.COMP erases the application data stored in the EEPROM once the Security
                      IC Embedded Software has activated this security feature.


P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                   Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                       80 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      SF.COMP also provides the FabKey Area where initialisation and identification data can
                      be stored. The FabKey area does not belong to the Security Rows and is not protected
                      by hardware mechanisms. The FabKey Area as well as the Security Rows can be used
                      by SF.COMP to store a unique identification for each die.
                      The complete EEPROM is initialized during wafer testing and pre-personalisation. The
                      values for the Security Row depend on the configuration options and choice of the
                      Security IC Embedded Software developer. The values for the application EEPROM
                      depend on the choice of the Security IC Embedded Software developer and are
                      included in the Order Entry Form. The User Write Protected Area and the User Write
                      Once Area are designed to store the identification of a (fully personalised) Security IC
                      (e.g. smartcard) or a sequence of events over the life-cycle, that can be coded by an
                      increasing number of bits set to "one" or protecting bytes, respectively.
                      SF.COMP limits the capabilities of the test functions and provides test personnel during
                      phase 3 with the capability to store identification and/or pre-personalisation data and/or
                      supplements of the Security IC Embedded Software in the EEPROM. SF.COMP provides
                      self-protection against interference and tampering by untrusted subjects both in the Test
                      Mode and in the other modes. It also enforces the separation of domains regarding the
                      IC Dedicated Software and the Security IC Embedded Software.
                      SF.MEM_ACC: Memory Access Control
                      SF.MEM_ACC controls access of any subject (program code comprising processor
                      instructions) to the memories of the P6022y VB through the Memory Management Unit.
                      Memory access is based on virtual addresses that are mapped to physical addresses.
                      The CPU always uses virtual addresses. The Memory Management Unit performs the
                      translation from virtual to physical addresses and the physical addresses are passed
                      from the Memory Management Unit to the memory interfaces to access the memories.
                      Access control is conducted in two ways:
                      • Memory partitioning: Each memory type ROM, RAM and EEPROM is partitioned into
                        two parts. In Boot Mode and Firmware Mode the CPU has access to the Firmware
                        EEPROM, Firmware RAM and Test-ROM. In System Mode and User Mode the CPU
                        has access to the Application EEPROM, Application RAM and Application ROM.
                        Access to both parts of each type is allowed in Test Mode for testing.
                      • Memory segmentation in User Mode: The three accessible parts of the memory in
                        ROM, RAM and EEPROM can be segmented into smaller memory areas. Access
                        rights (read/write or execute) can be defined for these segments. The operation read
                        and write are considered as one kind of operation, if one is allowed, so is the other.
                        However, in general the access to a segment can be denied.
                        In addition, access rights to Special Function Registers related to hardware
                        components can be defined for code executed in User Mode.
                      Memory partitioning is fixed and cannot be changed. It is determined during
                      production of the P6022y VB and is solely dependent on the major configuration (see
                      Section 1.4.2.1.1) and Post Delivery Configuration (see Section 1.4.2.3.1).
                      Memory segmentation can be defined in System Mode. The segmentation is active when
                      the CPU switches to User Mode. The segments, their access rights and the access
                      rights to Special Function Registers related to hardware components are defined in the
                      MMU Segment Table. The MMU Segment Table stores five values for each segment:
                      The memory access rights, the virtual start address of the segment, the virtual end
                      address of the segment, the address offset for the segment and the access rights to
                      Special Function Registers for code that is executed in the segment. The address offset
                      is used to relocate the segment anywhere in the memory map. The resulting address
                      computed by the Memory Management Unit can not overrule memory partitioning. Up
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      81 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      to 64 segments can be defined in the MMU Segment Table. Special configurations of
                      the memory access rights allow to specify less than 64 segments and to split the MMU
                      Segment Table into several parts being stored at different locations in memory.
                      Note that the MMU Segment Table itself is stored in the memory and therefore the table
                      itself can be placed in a segment accessible in User Mode.
                      In addition, SF.MEM_ACC permanently checks whether accessed addresses point to
                      physically implemented memory. Any access outside the boundaries of the physical
                      implemented memory in all CPU modes except the Test Mode and access to forbidden
                      memory addresses in User Mode are notified by raising an exception.
                      The Memory Management Unit also handles access rights to Special Function Registers
                      related to hardware components for code running in Firmware Mode. The configuration
                      of the access rights for User Mode and Firmware Mode are used by SF.SFR_ACC to
                      grant or block access to the related Special Function Registers. The access rights can
                      be defined for up to 16 groups of Special Function Registers, which are related to 16
                      hardware peripherals or memories described in [9], section 12.4. Thus, User Mode
                      and Firmware Mode can be restricted in their access to the Special Function Registers
                      related to hardware components on demand of the Security IC Embedded Software.
                      Note that SF.MEM_ACC only provides the access rights to SF.SFR_ACC, the access
                      control is enforced by SF.SFR_ACC.
                      SF.SFR_ACC: Special Function Register Access Control
                      SF.SFR_ACC controls access to the Special Function Registers and CPU mode
                      switches based on specific Special Function Register. SF.SFR_ACC implements access
                      control to the Special Function Registers as specified in the Access Control Policy and
                      the Security Functional Requirements FDP_ACC.1[SFR] and FDP_ACF.1[SFR].
                      The function of the Special Function Register and the CPU mode determine, whether
                      read and/or write access to a Special Function Register is allowed or not. Key registers
                      cannot be read since they are write-only to support the confidentiality of keys. Write
                      access is granted depending on the CPU mode. Similar for the output register of the
                      Random Number Generator, which is read-only based on its function, and read access is
                      granted based on the CPU mode.
                      SF.SFR_ACC controls accesses to Special Function Registers. If the access is not
                      allowed or the Special Function Register addressed by the code is not implemented an
                      exception is triggered. The Security IC Embedded Software can react on this exception.
                      Some Special Function Registers are implemented threefold, one for User Mode, a
                      second one for System Mode and a third one for Super System Mode meaning Boot
                      Mode, Test Mode and Firmware Mode. Hence, such Special Function Registers are
                      inherently separated and enforce the separation between the CPU modes.
                      SF.SFR_ACC relies on access rights to Special Function Registers related to hardware
                      components, which are provided by SF.MEM_ACC. Access rights to all other Special
                      Function Registers are pre-defined and cannot be configured by the code running on the
                      hardware platform.
                      This implies that code running in User Mode or Firmware Mode is not able to use
                      SS.RNG, SS.TDES, and SS.AES until access to the respective group of Special Function
                      Registers is explicitly granted by code running in System Mode. This holds for all 16
                      hardware components, which are controlled by the 16 groups of Special Function
                      Registers related to hardware components.
                      SF.SFR_ACC also implements transitions among CPU modes based on specific Special
                      Function Register.
P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      82 / 101
NXP Semiconductors
                                                                                                                  P6022y VB
                                                                                                                  Security Target Lite


                      The CPU mode changes by the following operations.
                      • Call of a system call vector (SVEC) address or a firmware vector (FVEC) address. A
                        call of a SVEC enables System Mode, a call of a FVEC sets enables Firmware Mode.
                        Calls of SVEC addresses are allowed in User Mode only, otherwise an exception is
                        raised.
                      • Execution of an exception or interrupt. Any event that leads to the execution of an
                        exception leads to a special status of the related CPU mode. Any further exception in
                        this special status forces a reset. Interrupts can be executed in User Mode or in System
                        Mode as well as in Firmware Mode. The Security IC Embedded Software running in
                        System Mode can configure this option at run time.
                      • Return from an exception/interrupt or vector call with a RETI instruction. This restores
                        the CPU mode before the event occurred. A RETI in User Mode is allowed only in case
                        interrupts are allowed to be executed in User Mode and an interrupt is actually active,
                        otherwise an exception is raised.
                      • Execution of an LCALL/ACALL/ECALL instruction to a specific address. A call of
                        address 0x800000 in System Mode enables User Mode and starts execution at this
                        (virtual) address. This is similar to a FVEC or SVEC call, but no return address is
                        pushed onto the stack.
                      • Direct modification of the specific Special Function Register. Hardware provided by
                        SF.SFR_ACC ensures that the bits can only be cleared. Therefore it is not possible
                        for code running in User Mode to enter System Mode, but System Mode can switch to
                        User Mode.
                      Two CPU modes are available to the Security IC Embedded Software, which are System
                      Mode and User Mode. System Mode is the more privileged CPU mode since it allows
                      access to all Special Function Registers related to hardware components and for system
                      management (i.e. configuration of Memory Management Unit, clock settings and some
                      mechanisms provided by SF.LOG). User Mode is the less privileged, but in regard to
                      hardware components it can be made as powerful as System Mode.
                      SF.SFR_ACC and SF.COMP together ensure that other CPU modes are not available
                      to the Security IC Embedded Software, but reserved for specific purposes fulfilled by the
                      IC Dedicated Software. As described above, SF.MEM_ACC provides the access control
                      information to Special Function Registers related to hardware components in Firmware
                      Mode and User Mode.
                      SF.FFW: Firmware Firewall
                      SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                      data of the different firmware applications (NXP firmware functionality) running in
                      Firmware Mode by means of a firewall separating the application data between each
                      other. The firewall mechanism is based on the security features SF.MEM_ACC and
                      SF.SFR_ACC.
                      SF.FIRMWARE: Firmware Support
                      SF.FIRMWARE (Firmware Operating System) implements specific basic support
                      functionality for the Security IC Embedded Software. The basic support functionality is
                      implemented in a way that the protection and separation of the different type of User
                      Data is enforced. The security feature SF.FIRMWARE is based on the security features
                      SF.MEM_ACC, SF.SFR_ACC and SF.FFW.




P6022y VB                            All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation document                                  Rev. 2.1 — 6 April 2018
PUBLIC                                                                                                                                      83 / 101
NXP Semiconductors
                                                                                                                        P6022y VB
                                                                                                                        Security Target Lite



              7.1.2.2 NXP Secure Smart Card Controller P6022M VB/P6022D VB/P6022J VB
                        The security features of the P6022M VB/P6022D VB/P6022J VB include the security
                        features of the P6022P VB/P6022X VB, except for SF.FFW and SF.FIRMWARE. The
                        security features SF.FFW and SF.FIRMWARE of the P6022M VB/P6022D VB/P6022J
                        VB are described in this section.
                        SF.FFW: Firmware Firewall
                        SF.FFW (Protected Firmware Mode) implements a mechanism to protect the application
                        data of the different firmware applications (NXP firmware functionality and MIFARE
                        Software) running in Firmware Mode by means of a firewall separating the application
                        data between each other. The firewall mechanism is based on the security features
                        SF.MEM_ACC and SF.SFR_ACC.
                        SF.FIRMWARE: Firmware Support
                        SF.FIRMWARE (Firmware Operating System) implements specific basic support
                        functionality for the Security IC Embedded Software. The basic support functionality is
                        implemented in a way that the protection and separation of the different type of User
                        Data is enforced. The security feature SF.FIRMWARE is based on the security features
                        SF.MEM_ACC, SF.SFR_ACC and SF.FFW.
                        The support comprise
                        •   the integrity protection of the data stored in the EEPROM,
                        •   the baud rate configuration for the contactless operation,
                        •   the enabling / disabling of MIFARE Software,
                        •   the start of MIFARE Software contactless operation,
                        •   the control of exit conditions for MIFARE Software,
                        •   the MIFARE Post Delivery Configuration,
                        •   the MIFARE Remote Interface.


                 7.2 TOE Summary Specification Rationale

               7.2.1 Mapping of Security Functional Requirements and the TOE Security
                     Functionality

              7.2.1.1   NXP Secure Smart Card Controller P6022y VB
                        The following table provides a mapping of portions of the TOE security functionality to the
                        Security Functional Requirements of the P6022y VB. The mapping is described in detail
                        in the text following table.

Table 36. Mapping of Security Functional Requirements and the portions of the Security Functionality of the
P6022y VB
                                 SS. SS.T SS.                    SF. SF.                   SF. SF.C SF.M SF. SF. SF.FI SS.R SF.
                                 RNG DES AES                     OPC PHY                   LOG OMP EM_ SFR_ FFW RMW ECO PUF
                                                                                                    ACC ACC      ARE NFIG
FAU_SAS.1[HW]                                                                                           X
FCS_RNG.1[HW]                    X
FDP_IFC.1                                                                                                                              below.

                                    The requirements listed in Table 3 are detailed in the following sub-sections.
                                    Additional SFR regarding cryptographic functionality
                                    The TSF provides cryptographic functionality to help satisfy several high-level security
                                    objectives. In order for a cryptographic operation to function correctly, the operation must
                                    be performed in accordance with a specified algorithm and with a cryptographic key of a
                                    specified size. The following Functional Requirements to the TOE can be derived from
                                    this CC component:
                                    FCS_COP.1/RSA                                        Cryptographic operation
                                    Hierarchical to:                                     No other components.
                                    FCS_COP.1.1/RSA                                      The TSF shall perform encryption, decryption, signature
                                                                                                                    2
                                                                                         generation and verification in accordance with
                                                                                                                                   3
                                                                                         the specified cryptographic algorithm RSA and
                                                                                                                                      4
                                                                                         cryptographic key sizes 512 bits to 4096 bits that
                                                                                         meet the following: PKCS #1, v2.2: RSAEP, RSADP,
                                                                                                              5
                                                                                         RSASP1, RSAVP1 .
                                    Application Notes:                                   The cryptographic algorithms are designed taking into
                                                                                         account the attacks described in JIL-ATT-SC: Attack
                                                                                         Methods for Smartcards and Similar Devices [19].
                                    Dependencies:                                        [FDP_ITC.1 Import of user data without security
                                                                                         attributes or FDP_ITC.2 Import of user data with
                                                                                         security attributes, or FCS_CKM.1 Cryptographic key
                                                                                         generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/RSA_PAD                                    Cryptographic operation
                                    Hierarchical to:                                     No other components.
                                    FCS_COP.1.1/RSA_PAD                                  The TSF shall perform message and signature
                                                                                                            6
                                                                                         encoding methods in accordance with the specified
                                                                                                                                               7
                                                                                         cryptographic algorithm EME-OAEP and EMSA-PSS
                                                                                                                                          8
                                                                                         and cryptographic key sizes 512 bits to 4096 bits that
                                                                                         meet the following: PKCS #1, v2.2: EME-OAEP and
                                                                                                      9
                                                                                         EMSA-PSS .
                                    Application Notes:                                   Regarding OAEP the input of encode as well as the
                                                                                         input and output of decode are considered sensitive
                                                                                         values. Regarding PSS the input of the encoding and
                                                                                         verify operations are considered sensitive values. In both
                                                                                         cases the length of the sensitive values is assumed to
                                                                                         be public.
                                    Dependencies:                                        [FDP_ITC.1 Import of user data without security
                                                                                         attributes or FDP_ITC.2 Import of user data with

                                       2   [assignment: list of cryptographic operations]
                                       3   [assignment: cryptographic algorithm]
                                       4   [assignment: cryptographic key sizes]
                                       5   [assignment: list of standards]
                                       6   [assignment: list of cryptographic operations]
                                       7   [assignment: cryptographic algorithm]
                                       8   [assignment: cryptographic key sizes]
                                       9   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                       All information provided in this document is subject to legal disclaimers.                     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                             Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                                           15 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/RSA_PubExp   Cryptographic operation
                                    Hierarchical to:       No other components.
                                                                                                         10
                                    FCS_COP.1.1/RSA_PubExp The TSF shall perform public key computation in
                                                           accordance with the specified cryptographic algorithm
                                                                11
                                                           RSA and cryptographic key sizes 512 bits to 4096
                                                               12                                       13
                                                           bits that meet the following: PKCS #1, v2.2 .
                                    Application Notes:
                                                           (1) The cryptographic algorithms are designed taking
                                                           into account the attacks described in JIL-ATT-SC: Attack
                                                           Methods for Smartcards and Similar Devices [19].
                                                                                        (2) The computation will result in the generation of a
                                                                                        public RSA key from the private key (in CRT format). As
                                                                                        this key is implied by the private key, this is not true key
                                                                                        generation, and, to prevent duplication in this ST, this
                                                                                        has not been included as a separate FCS_CKM.1 SFR.

                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with
                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/ECDSA                                     Cryptographic operation
                                    Hierarchical to:                                    No other components.
                                    FCS_COP.1.1/ECDSA                                   The TSF shall perform signature generation and
                                                                                                    14
                                                                                        verification in accordance with the specified
                                                                                                                                            15
                                                                                        cryptographic algorithm ECDSA / ECC over GF(p) and
                                                                                        cryptographic key sizes 224, 256, 320, 384, 512 and 521
                                                                                             16
                                                                                        bits that meet the following: ISO/IEC 14888-3, ANSI
                                                                                                                                             17
                                                                                        X9.62, FIPS PUB 186-4 and IEEE Std 1363™-2000 .
                                    Application Notes:                                  The cryptographic algorithms are designed taking into
                                                                                        account the attacks described in JIL-ATT-SC: Attack
                                                                                        Methods for Smartcards and Similar Devices [19].
                                    Note:                                               Due to BSI regulations the certification covers the
                                                                                        standard curves ansix9p224r1, ansix9p256r1,
                                                                                        ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21],
                                                                                        brainpoolP224r1, brainpoolP224t1, brainpoolP256r1,
                                                                                        brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                                                                        brainpoolP384r1, brainpoolP384t1, brainpoolP512r1
                                                                                        and brainpoolP512t1 from RFC 5639 [23], and ANSSI
                                                                                        FRP256v1 [24] curves.
                                    Dependencies:                                       [FDP_ITC.1 Import of user data without security
                                                                                        attributes or FDP_ITC.2 Import of user data with


                                     10   [assignment: list of cryptographic operations]
                                     11   [assignment: cryptographic algorithm]
                                     12   [assignment: cryptographic key sizes]
                                     13   [assignment: list of standards]
                                     14   [assignment: list of cryptographic operations]
                                     15   [assignment: cryptographic algorithm]
                                     16   [assignment: cryptographic key sizes]
                                     17   [assignment: list of standards]
Crypto Library Cobalt on N7021 VA                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                            Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                          16 / 35
NXP Semiconductors                                                                                                Crypto Library Cobalt on N7021 VA
                                                                                                                                    Security Target Lite



                                                                                        security attributes, or FCS_CKM.1 Cryptographic key
                                                                                        generation], FCS_CKM.4 Cryptographic key destruction.
                                    FCS_COP.1/ECC_DHKE                                  Cryptographic operation
                                    Hierarchical to:                                    No other components.
                                                                                                                                             18
                                    FCS_COP.1.1/ECC_DHKE                                The TSF shall perform Diffie-Hellman Key Exchange
                                                                                        in accordance with the specified cryptographic algorithm
                                                                                                         19
                                                                                        ECC over GF(p) and cryptographic key sizes 224,
                                                                                                                        20
                                                                                        256, 320, 384, 512 and 521 bits that meet the
                                                                                        following: ISO/IEC 11770-3:2015, ANSI X9.63, IEEE Std
                                                                                                     21
                                                                                        1363™-2000 .
                                    Application Notes:
                                                                                        (1) The cryptographic algorithms are designed taking
                                                                                        into account the attacks described in JIL-ATT-SC: Attack
                                                                                        Methods for Smartcards and Similar Devices [19].
                                                                                        (2) The security functionality does not provide the
                                                                                        complete key exchange procedure, but only the point
                                                                                        multiplication which is used for the multiplication of the
                                                                                        private key with the communication partner’s public key.
                                                                                        Therefore this function can be used as part of a Diffie-
                                                                                        Hellman key exchange as well pure point multiplication.

                                    Notes:
                                                                                        Due to BSI regulations the certification covers the
                                                                                        standard curves ansix9p224r1, ansix9p256r1,
                                                                                        ansix9p384r1 and ansix9p521r1 from ANSI X9.62 [21],
                                                                                        brainpoolP224r1, brainpoolP224t1, brainpoolP256r1,
                                                                                        brainpoolP256t1, brainpoolP320r1, brainpoolP320t1,
                                                             Ux         Ux         Ux            Wafer not thinner than 50 µm
                                                                    (The letter “x” in “Ux” stands for a capital letter or a number, which
                                                                    identifies the wafer type)
                                Xn         Xn         Xn            Module
                                                                    (The letter “n” in” Xn” stands for a capital letter or a number, which
                                                                    identifies the module type)
                                A4         A4                       MOB4 module
                                A6         A6                       MOB6 module
                                Ai         Ai                       Inlay
                                                                    (The letter ‘i” in “Ai” stands for a capital letter, which identifies both, the inlay
                                                                    type and the package type inside the inlay.)


                       For example, commercial type name P60D024PX0/9Brrff denotes major configuration
                       P60D024yVB(Y/Z/A)/yVF in PDM1.1 dual interface smart card module. The characters ‘rr’
                       and ‘ff’ are individual for each customer product.
                       The package types do not influence the security functionality of the TOE. They only define
                       which pads are connected in the package and for what purpose and in which environment
                       the chip can be used. Note that the security of the TOE is not dependent on which pad is
                       connected or not - the connections just define how the product can be used. If the TOE is
                       delivered as wafer the customer can choose the connections on his own.
                       Security during development and production is ensured for all package types listed above,
                       for details refer to section 1.4.4.
                       The commercial type name identifies major configuration and package type of the TOE as
                       well as the Security IC Embedded Software. However, the commercial type name does not
                       itemize the minor configuration options of the TOE, which are introduced in section 1.4.2.2.
                       Instead, minor configuration options are identified in the Order Entry Form, which is
                       assigned to the ROM code number and the FabKey number of the commercial type name.




                                                      All information provided in this document is subject to legal disclaimers.            © NXP B.V. 2018. All rights reserved.

Evaluation documentation                                             Rev. 4.4 — 29 October 2018                                                                    15 of 87
PUBLIC
NXP Semiconductors                                               P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                                     Security Target Lite



                          Minor configuration options as well as configuration options changed by means of Post
                          Delivery Configuration are coded in the Security Rows and can be read out for identification
                          of the TOE. Further details regarding Security Rows content and identification of the TOE
                          after applying Post Delivery Configuration refer to [9].


                  1.4.3 Logical Scope of TOE
                1.4.3.1     Hardware Description
                          The CPU of the P60D024/016/012yVB(Y/Z/A)/yVF supports a 32-/24-/16-/8-bit instruction
                          set and distinguishes five CPU modes, which are summarized in Table 12.

                          Table 12.    CPU modes of the TOE
                                            Super System Mode
                           Boot Mode            Test Mode                            Firmware Mode                     System Mode        User Mode

                          Boot Mode, Test Mode and Firmware Mode are sub-modes of the so-called Super System
                          Mode. These three modes are not available to the Security IC Embedded Software; they
                          are reserved for the Security IC Dedicated Software. The Security IC Dedicated Software is
                          composed of Security IC Dedicated Test Software and Security IC Dedicated Support
                          Software, (Boot-ROM Software and Firmware Operating System) as introduced in section
                          1.4.1. The three software components are mapped one-to-one to the three CPU modes: In
                          Boot Mode the TOE executes the Boot-ROM Software, in Test Mode the TOE executes the
                          IC Dedicated Test Software and in Firmware Mode the TOE executes the Firmware
                          Operating System. Please note that the Super System Mode is not a mode on its own:
                          When the TOE is in Super System Mode, it is always either in Boot Mode, Test Mode or
                          Firmware Mode.
                          The P60D024/016/012yVB(Y/Z/A)/yVF is able to control two different logical phases. After
                          production of the Security IC every start-up or reset completes with Test Mode and
                          execution of the IC Dedicated Test Software. The Test Mode is disabled at the end of the
                          production test. Afterwards, every start-up or reset ends up in System Mode and execution
                          of the Security IC Embedded Software.
                          In case the minor configuration option ‘Post Delivery Configuration’ is enabled and not finally
                          locked by the customer, the resource configuration functionality allows the customer to
                          enable or disable specific functionality of the hardware platform, refer to Table 9.
                          In case the minor configuration option ‘Chip Health/Ident Mode’ is enabled, during the boot
                          process routines either starting built-in self tests checking the functional integrity of the TOE
                          or sending back identification items of the TOE can be activated by the user.
                          System Mode and User Mode are available to the developer of the Security IC Embedded
                          Software. System Mode has unlimited access to the hardware components available to the
                          Security IC Embedded Software. User Mode has restricted access to the CPU, specific
                          Special Function Registers and the memories depending on the access rights granted by
                          software running in System Mode. The hardware components are controlled by the Security
                          IC Embedded Software via Special Function Registers. Special Function Registers are
                          interrelated to the activities of the CPU, the Memory Management Unit, interrupt control, I/O
                          configuration, EEPROM, timers, UART, the contactless interface and the coprocessors.




                                          All information provided in this document is subject to legal disclaimers.                   © NXP B.V. 2018. All rights reserved.

Evaluation documentation                              Rev. 4.4 — 29 October 2018                                                                              16 of 87
PUBLIC
NXP Semiconductors                                            P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                    Security Target Lite



                       The P60D024/016/012yVB(Y/Z/A)/yVF provides two types of interrupts: (i) exception
                       interrupts, called “exception” in the following and (ii) event interrupts, called “interrupts” in
                       the following. Exceptions and interrupts each force a jump to a specific fixed vector address
                       in the ROM. Any exception and interrupt can therefore be controlled and guided by a specific
                       part     of     the    Security     IC     Embedded       Software.      In     addition,    the
                       P60D024/016/012yVB(Y/Z/A)/yVF provides eight firmware vectors (FVEC) and 32 system
                       call vectors (SVEC). These vectors have to be explicitly called by the Security IC Embedded
                       Software. A jump to a firmware vector forces Firmware Mode and starts execution of the
                       Firmware Operating System, a jump to a system call vector forces System Mode.
                       The Watchdog timer is intended to abort irregular program executions by a time-out
                       mechanism and is enabled and configured by the Security IC Embedded Software.
                       The P60D024yVB(Y/Z/A)/yVF incorporates 352 kBytes of ROM, 8.125 kBytes of RAM and
                       24 kBytes of EEPROM. Access control to all three memory types is enforced by a Memory
                       Management Unit. The Memory Management Unit partitions each memory into two                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                       d control
and against download of malicious software before, during and after the user downloads his software. This is
formalized with the objectives O.Cap_Avail_Loader, O.Authentication and O.Ctrl_Auth_Loader requiring
authentication of the TOE to external entities and a trusted communication channel. The O.Authentication
implements a mutual authentication and involves the environment therefore.
And the policies cover also the environmental objective OE.Process-Sec-IC at user premises, as it must be
regardless in which environment the Flash Loader is operated.
The implemented mutual authentication requires first to authenticate the TOE to the external user. This requires
also knowledge by the user about the sequence of the protocol, interpretation of the transferred data and how to
start the authentication of the TOE. This authentication mean counters the threat T.Masquerade_TOE as only
the genuine TOE is able to identify itself correctly to the enabled user, which covers O.Authentication.
The second step of the mutual authentications mean implements the authentication of the user to the TOE. Only
the user enabled to present the correct authentication data and knowing about the sequence, data
interpretation and signaling of the authentication to the TOE is able to proceed further on.
This enforces OE.TOE_Auth, requiring the support of the verification mechanism and known authentication
reference data by the operational environment.

It is normal business that products enabled for software download by the user are either on their way to the user
or are already stored at user premises. At both situations it cannot be excluded that an attacker could manage to
steal such products enabled for software downloads. The ability to download software on a chip without
operating system and/or application is defined as open sample.
This situation generates the threat T.Open_Samples_Diffusion which is defined as follows:
The download of analysis software could enable an attacker to characterize the product and to construct an
attack path out of the gained information.
This threat is countered by the Flash Loader by following rational:
As long as the Flash Loader is active, controlled usage to the Flash Loader functionality (P.Ctrl_Loader) is
enforced which protects the TOE from achieving the status of being an open sample. And more, even the
attacker could observe, meaning in the sense of measurements during, or induce faults during an authorized
download, the Flash Loader protects the user data of the download by confidentiality and integrity protection
means. The Flash Loader functionalities of mutual authentication, establishing a dedicated trusted
communication channel, the encryption and integrity protection means cover the objectives
O.Prot_TSF_Confidentiality, O.Leak-Inherent and O.Leak-Forced.
The policy P.Ctrl_Loader covers also the environmental objective OE.Process-Sec-IC at user                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].            • functionality to calculate the Advanced Encryption Standard (AES) with different key
                        lengths,
                      • support for large integer arithmetic operations like multiplication, addition and logical
                        operations, which are suitable for public key cryptography (e.g. RSA or ECC),
                      • a True Random Number Generator,
                      • memory management control,
                      • cyclic redundancy check (CRC) calculation,
                      • ISO/IEC 7816 contact interface with UART, and
                      • ISO/IEC 14443 A contactless interface supporting.

P6022y VB                             All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           