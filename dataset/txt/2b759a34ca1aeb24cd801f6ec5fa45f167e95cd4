  JCOP 4.7 SE051
  Security Target Lite
  Rev. 1.3 — 30 June 2020                                         Evaluation document
  NSCIB-CC-0095534                                                             PUBLIC




Document information
Information     Content
Keywords        ASE, JCOP, Common Criteria, EAL6 augmented
Abstract        This document contains information to fulfill the requirements of the Common
                Criteria component ASE (Security Target) for the Evaluation of the JCOP
                4.7 SE051 developed and provided by NXP Semiconductors, Business Unit
                Security & Connectivity, according to the Common Criteria for Information
                Technology Security Evaluation Version 3.1 at EAL6 augmented
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


Revision history
Rev          Date           Description
1.3          30 June 2020   Initial version.




JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                              2 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


1       ST Introduction (ASE_INT)

                 1.1 ST Reference and TOE Reference
                      Table 1. ST Reference and TOE reference
                      Title          JCOP 4.7 SE051 Security Target Lite
                      Version        Revision 1.3
                      Date           30 June 2020
                      Product Type   Java Card
                      TOE name       JCOP 4.7 SE051
                      Certification ID NSCIB-CC-0095534
                      CC version     Common Criteria for Information Technology Security Evaluation Version 3.1,
                                     Revision 5, April 2017 (Part 1 [1], Part 2 [2] and Part 3 [3])


                 1.2 TOE Overview
                      The TOE consists of the Micro Controller and a software stack which is stored on the
                      Micro Controller and which can be executed by the Micro Controller. The software stack
                      can be further split into the following components:
                      • Firmware for booting and low level functionality of the Micro Controller (MC FW)
                        like writing to flash memory. This includes software for implementing cryptographic
                        operations, called Crypto Library.
                      • Software for implementing a Java Card Virtual Machine [15], a Java Card Runtime
                        Environment [16] and a Java Card Application Programming Interface [14], called
                        JCVM, JCRE and JCAPI.
                      • Software for implementing content management according to GlobalPlatform [17],
                        called GlobalPlatform (GP) Framework.
                      • Software for executing native libraries, called Secure Box.
                      The TOE is referred to as JCOP 4.7 SE051. The JCOP 4 Operating System (JCOP 4
                      OS) consists of the software stack without the Crypto Library (Crypto Lib) and without
                      the Micro Controller Firmware (MC FW). The TOE uses one or more communication
                      interfaces to communicate with its environment.
                      The complete TOE is depicted in Figure 1. The elements are described in more detail in
                      Section 1.3 "TOE Description".




JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                             3 / 120
NXP Semiconductors
                                                                                                                               JCOP 4.7 SE051
                                                                                                                                           Security Target Lite




                                                                                Communication Interface(s)
                                                                                    to Environment



         Java Card Applets                                                                                      Secure
                                                                                                                 Secure
                                                                                                                 Box
                                                                                                                  Box
                  User
                    User
                 Applet
                                            GP Framework                                                        Native
                                                                                                                 Native
                   Applet
                                                                                                                  Lib
                                                                                                                   Lib

                                                                                                                                              Optional
                                                                                                                                            Functionality

                            JCVM, JCRE and JCAPI

                                                                                                                               SecureBox
                                                      MC FW and
                                                     Crypto Library


                                                                       Micro Controller



                                  TOE Border                                                                    Optional interaction
                                                                                                                 CC Certified Hardware,
                                  JCOP 4 OS                                                                      Firmware and Crypto Lib
                                  Not certified


 Figure 1. Components of the TOE

                               Figure 1 shows the components of the TOE. The TOE is a composite product on top
                               of CC certified Hardware, Firmware and Crypto Library. Part of the TOE are the JCVM,
                               JCRE, JCAPI and the GP Framework. Also included is optional functionality and the
                               Secure Box mechanism. The Secure Box Native Librarys provide native functions for
                               untrusted third parties and are not part of the TOE.
                               The figure shows Java Card applets which are small programs in Java language that can
                               be executed by the TOE, but are not part of the TOE.

                     1.2.1 Usage and Major Security Features of the TOE
                               The usage of the TOE is focused on security critical applications in small form factors.
                               One main usage scenario is the use of so called smart cards. Examples of such cards
                               are banking cards or electronic drivers’ licenses. The TOE can also be used in an
                               electronic passport. Another usage scenario is device authentication, where the TOE can
                               be used to prove the authenticity or originality of a device like an accessory for a gaming
                               console.
                               The TOE provides a variety of security features. The hardware of the Micro Controller
                               already protects against logical and physical attacks by applying various sensors to
                               detect manipulations and by processing data in ways which protect against leakage
                               of data by side channel analysis. With the software stack the TOE provides many

JCOP 4.7 SE051                                    All information provided in this document is subject to legal disclaimers.                 © NXP B.V. 2020. All rights reserved.

Evaluation document                                              Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                                 4 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                      cryptographic primitives for encryption and decryption of data but also for signing and
                      signature verification. Also the software stack contains security features to protect
                      against attacks.
                      The following list contains the features of this TOE:
                      • Supported communication protocols:
                        1. ISO 7816 T=1.
                        2. ISO 7816 T=0.
                        3. ISO 14443 T=CL.
                        4. I2C Slave.
                      • Cryptographic algorithms and functionality:
                        1. Data Encryption Standard with 3 keys (3DES) for en-/decryption (CBC and ECB)
                           and MAC generation and verification (Retail-MAC, CMAC and CBC-MAC).
                        2. Advanced Encryption Standard (AES) for en-/decryption (CBC, ECB and counter
                           mode) and MAC generation and verification (CMAC, CBC-MAC).
                        3. Rivest Shamir Adleman asymmetric algorithm (RSA) and RSA CRT for en-/
                           decryption and signature generation and verification.
                                                                                              1
                        4. RSA and RSA Chinese Remainder Theorem (CRT) key generation .
                        5. Elliptic Curve Cryptography (ECC) over GF(p) for signature generation and
                                                 1
                           verification (ECDSA) .
                                                           1
                        6. ECC over GF(p) key generation .
                        7. Random number generation according to class DRG.3 or DRG.4 of AIS 20 [21].
                                                                                   1
                        8. Diffie-Hellman with ECDH and modular exponentiation .
                        9. SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                        10.Following cryptographic algorithms are part of the TOE but without claims for
                           security functional requirements:
                                                                                 1
                           a. AES in Counter with CBC-MAC mode (AES CCM) .
                                                                                    1
                           b. Keyed-Hash Message Authentication Code (HMAC) .
                                                                                  1
                           c. HMAC based Key Derivation Function (HKDF) [28] .
                                                                                        1
                           d. Elliptic Curve Direct Anonymous Attestation (ECDAA) [30] .
                                                                                                     1
                           e. Elliptic curve cryptography based on Edwards and Montgomery curves .
                      • Java Card functionality:
                        1. Executing the Java byte codes which are generated from the Java compiler when
                           Java source code is compiled.
                        2. Managing memory allocation of code and data of applets.
                        3. Enforcing access rules between applets and the JCRE.
                        4. Mapping of Java method calls to native implementations of e.g. cryptographic
                           operation.
                        5. Support for Extended Length APDUs.
                        6. Garbage Collection with memory reclamation and compaction.
                        7. Persistent Memory Management and Transaction Mechanism.
                      • GlobalPlatform functionality:
                        1. Loading of Java packages.
                        2. Instantiating applet instances.
                        3. Removing of Java packages.
                        4. Removing of applet instances.
                        5. Issuer Security Domain (ISD), Supplementary Security Domain (SSD).

                         1 Optional functionality
JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                5 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                        6. Creating SSDs.
                        7. Associating applets to Security Domains.
                        8. Installation of keys.
                        9. Verification of signatures of signed applets.
                        10.Verification of signatures for commands.
                        11.CVM Management (Global PIN).
                        12.Secure Channel Protocol (SCP01, SCP02 and SCP03).
                        13.Delegated Management, Data Authentication Pattern (DAP).
                        14.Post-issuance installation and deletion of applets and packages.
                        15.Compliance to several GP configurations.
                        16.Executable Load File Upgrade.
                        17.Secure Element Management Service.
                      • NXP Proprietary Functionality
                                        2
                        1. Secure Box .
                        2. Java Card APIs for:
                           – Data encryption via PUF [12].
                           – Data integrity protection with an EDC.
                           – Asserting results of sensitive functions.
                                                                         2
                        3. Time representation and counter functionality .

                 1.2.2 TOE Type
                      The TOE is a Java Card with a GP Framework. It can be used to load and execute off-
                      card verified Java Card applets.

                 1.2.3 Required non-TOE Hardware/Software/Firmware
                      Three groups of users shall be distinguished here.
                      The first group is the end-users group, which uses the TOE with one or more loaded
                      applets in the final form factor like a banking card or an electronic passport. These users
                      only require a communication device to be able to communicate with the TOE. The
                      communication protocol of the TOE is standardized in either ISO7816 [31] (T=1, T=0),
                      ISO14443 [32] (T=CL), or UM10204 [33] (I2C Slave).
                      The second group of users are administrators of cards. They want to configure the
                      card by using the Configuration Module, to install additional applets and to configure and
                      personalise these applets. These users require the same equipment as end-users.
                      The third group of users wants to develop Java Card applets and execute them on
                      the TOE. These applet developers need in addition to the communication device a
                      set of tools for the development of applets. This set of tools can be obtained from the
                      TOE vendor and comprises elements such as PC development environment, byte code
                      verifier, compiler, linker and debugger.




                         2 Optional functionality
JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                6 / 120
NXP Semiconductors
                                                                                                                              JCOP 4.7 SE051
                                                                                                                                   Security Target Lite


                     1.3 TOE Description

                    1.3.1 TOE Components and Composite Certification
                           The certification of this TOE is a composite certification. The following sections provide
                           a more detailed description of the components of Figure 1. It is also made clear whether
                           a component is covered by a previous certification or whether it is covered in the
                           certification of this TOE.

                  1.3.1.1 Micro Controller

                           The Micro Controller is a secure smart card controller from NXP’s SmartMX3 family.
                           The Micro Controller contains a co-processor for symmetric cryptographic operations,
                           supporting DES and AES, as well as an accelerator for asymmetric cryptographic
                           algorithms. The Micro Controller further contains a physical random number generator.
                           The supported memory technologies are volatile (Random Access Memory (RAM)) and
                           non-volatile (Read Only Memory (ROM) and FLASH) memory.
                           Access to all memory types is controlled by a Memory Management Unit (MMU) which
                           allows to separate and restrict access to parts of the memory.
                           The Micro Controller has been certified in a previous certification and the results are re-
                           used for this certification. The exact reference to the previous certification is given in the
                           following Table 2 "Reference to Certified Micro Controller":

                           Table 2. Reference to Certified Micro Controller
                           Name                            NXP Secure Smart Card Controller N7121 with IC Dedicated Software and
                                                                          [1]
                                                           Crypto Library
                           Certification ID                BSI-DSZ-CC-1040
                           Reference                       [10]

                           [1]   The SE051 hardware is an instantiation of the N7121 hard macro with I2C side-car.


                  1.3.1.2 Security IC Dedicated Software

                 1.3.1.2.1 MC FW (Micro Controller Firmware)

                           The Micro Controller Firmware is used for testing of the Micro Controller at production,
                           for booting of the Micro Controller after power-up or after reset, for configuration of
                           communication devices and for writing data to volatile and non-volatile memory.
                           The MC FW has been certified together with the Micro Controller and the same reference
                           [10] as given for the Micro Controller also apply for the MC FW.

                 1.3.1.2.2 Crypto Library

                           The Crypto Library provides implementations for symmetric and asymmetric
                           cryptographic operations, hashing, the generation of hybrid deterministic and hybrid
                           physical random numbers and further functions like secure copy and compare.
                           Some of the cryptographic algorithms offered by the Crypto Lib are not certified, see
                           Section 1.3.1.4 "Excluded functionality".
                           The symmetric cryptographic operations comprise the algorithms 3DES and AES. These
                           algorithms use the symmetric co-processor of the Micro Controller.



JCOP 4.7 SE051                                   All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                             Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                         7 / 120
NXP Semiconductors
                                                                                                                      JCOP 4.7 SE051
                                                                                                                           Security Target Lite


                          The supported asymmetric cryptographic operations are ECC and RSA. These
                          algorithms use the Public Key Crypto Coprocessor (PKCC) of the Micro Controller for the
                          cryptographic operations.
                          The Crypto Library has been certified together with the Micro Controller and the same
                          reference [10] as given for the Micro Controller also applies.

                  1.3.1.3 Security IC Embedded Software

                 1.3.1.3.1 JCOP 4.7 SE051

                          The OS of the TOE consists of JCVM, JCRE, JCAPI and GP framework. It is
                          implemented according to the Java Card Specification and GlobalPlatform. Additionally it
                          consists of a proprietary API, which is described in the UGM [9].
                          The TOE can be identified by using the IDENTIFY APDU command (see UGM [9]). This
                          command returns the card identification data, which includes a Platform ID, a Patch ID
                          and other information that allows to identify the content in ROM, FLASH and loaded
                          patches (if any).
                          The TOE also includes a Configuration Module (see Section 1.3.2 "Optional TOE
                          Functionality") which is used for personalisation and configuration of the TOE. It must be
                          deleted after the personalisation is finished (end of Phase 6 ”Personalisation”) by using
                          the DELETE APDU command. Once the Configuration Module is deleted, it is no longer
                          possible to configure the TOE.
                          The TOE contains further functionality for integrity protection of user data via an
                          EDC, encryption of user data via PUF [12] and optional functionality as described in
                          Section 1.3.2 "Optional TOE Functionality".

                  1.3.1.4 Excluded functionality

                          All Secure Box Native Libraries are not part of the TOE. No security functional
                          requirements are claimed on AES CCM, HMAC, HKDF, ECDAA, elliptic curve
                          cryptography based on Edwards and Montgomery curves and FIPS self-tests, they are
                          TSF non-interfering.

                   1.3.2 Optional TOE Functionality
                          Some dedicated functionality of the TOE as listed below can be removed:
                          • RSA key generation,
                          • Elliptic curve cryptographic functionality,
                          • eGov accelerators,
                          • TOE self-tests according to FIPS 140-2 [22],
                          • SecureBox,
                          • TOE Configuration Module (the TOE Configuration Module has to be deleted at the end
                            of life cycle phase 6) [9],
                          • AES CCM as defined in the Java Card AEADCipher API [14], HMAC and HKDF
                            cryptographic functionality as defined in the Java Card API [14] and the UGM [9]. Timer
                            functionality as defined in the UGM [9].
                          • ECDAA [30] and elliptic curve cryptography based on Edwards and Montgomery
                            curves.
                          • I2C slave protocol and T = 1 over I2C.


JCOP 4.7 SE051                           All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                     Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                 8 / 120
NXP Semiconductors
                                                                                                                      JCOP 4.7 SE051
                                                                                                                           Security Target Lite


                  1.3.3 TOE Reduced Feature Set
                        The TOE is also available to customers with a reduced feature set. This variant of the
                        TOE contains a different base mask configuraton and has some features removed from
                        the TOE. The removed features are:
                        •   No support for SecureBox
                        •   No RSA support in GP
                        •   No DES support in GP
                        •   SCP01 not supported
                        •   SCP02 not supported
                        •   GP CVM service not supported
                        •   GP command chaining is not supported
                        •   ISO 7816 T=1, T=0 (UART) interface not supported
                        The base mask with the reduced feature set is known as IOT Reduced, while the base
                        mask with full functionality is known as IOT Full. For more information on the difference
                        in feature set, please refer to Table 3.1 in the User Guidance and Administration Manual
                        [9].

                 1.3.3.1 Reduced Security Functional Requirements

                        Some security functionality claimed in this Security Target is no longer available in the
                        IOT Reduced base mask or has limited functionality and the corresponding Security
                        Functional Requirements are not (completely) applicable for this variant of the TOE. The
                        table below lists which SFRs are affected in the IOT Reduced variant of the TOE.

                        Table 3. SFRs affected in the IOT Reduced variant of the TOE
                         Functionality                             SFRs
                         Secure Box                                FDP_ACC.2[SecureBox] is no longer available.
                                                                   FDP_ACF.1[SecureBox] is no longer available.
                                                                   FMT_MSA.1[SecureBox] is no longer available.
                                                                   FMT_MSA.3[SecureBox] is no longer available.
                                                                   FMT_SMF.1[SecureBox] is no longer available.
                         RSA support in GP                         FCS_COP.1.1[DAP] no longer supports algorithm ALG_RSA_
                                                                   SHA_PKCS1.


                  1.3.4 TOE Life Cycle
                        The life cycle for this Java Card is based on the general smart card life cycle defined in
                        the Java Card Protection Profile - Open Configuration [6], see Figure 2.




JCOP 4.7 SE051                           All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                     Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                 9 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite




                      Figure 2. TOE Life Cycle within Product Life Cycle

                      Table 4. TOE Life Cycle phases
                      Phase Name                                               Description
                      1      Security IC Embedded                              The Security IC Embedded Software Developer is in
                             Software Development                              charge of
                                                                               • SmartCard embedded software development including
                                                                                 the development of Java Card applets and
                                                                               • specification of IC pre-personalization requirements,
                                                                                 though the actual data for IC pre-personalization come
                                                                                 from phase 4, 5, or 6.


JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                           10 / 120
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


                      Phase Name                                                Description
                      2       Security IC Development                           The IC Developer
                                                                                • designs the IC,
                                                                                • develops Security IC Dedicated Software,
                                                                                • provides information, software or tools to the Security IC
                                                                                  Embedded Software Developer, and
                                                                                • receives the embedded software from the developer,
                                                                                  through trusted delivery and verification procedures.
                                                                                From the IC design, Security IC Dedicated Software and
                                                                                Smart-Card Embedded Software, the IC Developer
                                                                                • constructs the SmartCard IC database, necessary for
                                                                                  the IC photomask fabrication.
                      3       Security IC Manufacturing                         The IC Manufacturer is responsible for
                                                                                • producing the IC through three main steps: IC
                                                                                  manufacturing, IC testing, and IC pre-personalization.
                                                                                The IC Mask Manufacturer
                                                                                • generates the masks for the IC manufacturing based
                                                                                  upon an output from the SmartCard IC database.
                                                                                  Configuration items may be changed.
                      4       Security IC Packaging                             The IC Packaging Manufacturer is responsible for
                                                                                • IC packaging and testing.
                      5       Composite Product                                 The Composite Product Manufacturer is responsible for
                              Integration                                       • SmartCard product finishing process including applet
                                                                                  loading and testing. Configuration items may be
                                                                                  changed by using the Configuration Module.
                      6       Personalization                                   The Personalizer is responsible for
                                                                                • SmartCard (including applet) personalization and final
                                                                                  tests. User Applets may be loaded onto the chip at the
                                                                                  personalization process and configuration items may be
                                                                                  changed by using the Configuration Module, which must
                                                                                  be deleted at the end of this cycle by using the DELETE
                                                                                  APDU command.
                      7       Operational Usage                                 The Consumer of Composite Product is responsible for
                                                                                • SmartCard product delivery to the SmartCard end-user,
                                                                                  and the end of life process.
                                                                                • applets may be loaded onto the chip.

                      The evaluation process is limited to phases 1 to 5. User Applet development is outside
                      the scope of this evaluation. Applets can be loaded into FLASH in phases 3, 4, 5, and 6.
                      Applet loading in phase 7 is also allowed. This means post-issuance loading of applets
                      can be done for a certified TOE.
                      The Configuration Module is loaded into FLASH and has special privileges to personalize
                      and configure the TOE. Before life cycle Phase 7 "Operational Use" the Configuration
                      Module is deleted and hence it is ensured that its functionality cannot be used
                      afterwards. It is possible to load patch code into FLASH in phases 3, 4, 5, and 6. The
                      certification is only valid for the ROM code having the Platform Identifiers and the Patch
                      IDs (if applicable) as stated in Table 5 "Delivery Items".
                      The delivery process from NXP to their customers (to phase 4 or phase 5 of the life
                      cycle) guarantees that the customer is aware of the exact versions of the different parts
                      of the TOE as outlined above.

JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                            11 / 120
NXP Semiconductors
                                                                                                                           JCOP 4.7 SE051
                                                                                                                                          Security Target Lite


                         TOE documentation is delivered in electronic form (encrypted according to defined
                         mailing procedures).
                         Note: Phases 1 to 3 are under the TOE developer scope of control. Therefore, the
                         objectives for the environment related to phase 1 to 3 are covered by Assurance
                         measures, which are materialized by documents and procedures evaluated through the
                         TOE evaluation process.
                         During phases 4 to 7 the TOE is no more under the developer control. In this
                         environment, the TOE protects itself with its own Security functions. But some additional
                         usage procedures must also be followed in order to ensure that the TOE is correctly
                         and securely handled, and not damaged or comprised. This ST assumes (A.USE_
                         DIAG, A.USE_KEYS) that users handle securely the TOE and related Objectives for the
                         environment are defined (OE.USE_DIAG, OE.USE_KEYS).

                  1.3.5 TOE Identification

                 1.3.5.1 TOE Delivery

                         The delivery comprises the following items:

                         Table 5. Delivery Items
                         Type             Name                                                                             Version   Form of Delivery
                         Hardware         NXP Secure Smart Card Controller N7121                                           B1        Micro Controller including
                                          with IC Dedicated Software and Crypto                                                      on-chip software:
                                          Library                                                                                                             [1]
                                                                                                                                     Firmware and Crypto Lib
                                                                                                                                                             [2]
                         JCOP 4 OS ROM Code (Platform ID)                                                                  see UGM On-chip software :
                                   FLASH content (FLASH ID)                                                                [9]     JCOP 4 OS
                                   Patch Code (Patch ID)
                                                                                                                                                                   [3]
                         Document         User Guidance and Administration Manual                                          1.2       Electronic document
                                          [9]
                                                                                                                                                                   [3]
                         Document         HW Objective Data Sheet [11]                                                     1.0       Electronic document

                         [1]   The TOE is delivered as wafer or module. The TOE can be collected at NXP site or is being shipped to the customer. See
                               UGM [9] for details.
                         [2]   Included in the Micro Controller.
                         [3]   Via the NXP Docstore [13].


                 1.3.5.2 TOE Identification

                         The TOE can be identified by using the Platform ID, the FLASH ID and the Patch ID. The
                         IDENTIFY command and the identification output for this TOE are described in detail
                         in Chapter 2 of the UGM [9]. The IDENTIFY command also returns information about
                         presence of optional functionality and allows to identify the IOT Full and IOT Reduced
                         base mask configuration.

                  1.3.6 Evaluated Package Types
                         A number of package types are supported for this TOE. All package types, which are
                         covered by the certification of the used hardware (see [10]), are also allowed to be used
                         in combination with each product of this TOE.
                         The package types do not influence the security functionality of the TOE. They only
                         define which pads are connected in the package and for what purpose and in which
                         environment the chip can be used. Note that the security of the TOE is not dependent on
JCOP 4.7 SE051                                All information provided in this document is subject to legal disclaimers.                    © NXP B.V. 2020. All rights reserved.

Evaluation document                                          Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                                              12 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


                      which pad is connected or not - the connections just define how the product can be used.
                      If the TOE is delivered as wafer the customer can choose the connection on his own.




JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                           13 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


2       Conformance Claims (ASE_CCL)
                      This Chapter is divided into the following sections: "CC Conformance Claim", "Package
                      Claim", "PP Claim", and "Conformance Claim Rationale".

                  2.1 CC Conformance Claim
                      This Security Target claims to be conformant to version 3.1 of Common Criteria for
                      Information Technology Security Evaluation according to
                      • "Common Criteria for Information Technology Security Evaluation, Part 1, Version 3.1,
                        Revision 5, April 2017" [1]
                      • "Common Criteria for Information Technology Security Evaluation, Part 2, Version 3.1,
                        Revision 5, April 2017" [2]
                      • "Common Criteria for Information Technology Security Evaluation, Part 3, Version 3.1,
                        Revision 5, April 2017" [3]
                      The following methodology will be used for the evaluation:
                      • Common Methodology for Information Technology Security Evaluation, Evaluation
                        Methodology, Version 3.1, Revision 5, April 2017" [4]
                      This Security Target claims to be CC Part 2 extended and CC Part 3 conformant.
                      The extended Security Functional Requirements are defined in Section 6 "Extended
                      Components Definition (ASE_ECD)".

                  2.2 Package Claim
                      This Security Target claims conformance to the assurance package EAL6. The
                      augmentation to EAL6 is ASE_TSS.2 “TOE summary specification with architectural
                      design summary” and ALC_FLR.1 “Basic flaw remediation”.

                  2.3 PP Claim
                      The Security Target claims demonstrable conformance to the Java Card System -
                      Open Configuration Protection Profile, December 2017, Version 3.0.5 [6], certified by
                      Bundesamt für Sicherheit in der Informationstechnik (BSI, BSI-CC-PP-0099-2017). The
                      Java Card Protection Profile makes the use of Java Card RMI optional. The TOE does
                      not support Java Card RMI. This ST is more restrictive than the PP [6] which Section 2.4
                      "Conformance Claim Rationale" provides a rational for.

                  2.4 Conformance Claim Rationale

                 2.4.1 TOE Type
                      The TOE type as stated in Section Section 1.2 "TOE Overview" of this ST corresponds
                      to the TOE type of the PP as stated in Section 2.1 of [6] namely a Java Card platform,
                      implementing the Java Card Specification Version 3.0.5 [15], [16], [14].




JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                           14 / 120
NXP Semiconductors
                                                                                                                      JCOP 4.7 SE051
                                                                                                                           Security Target Lite


                  2.4.2 SPD Statement

                 2.4.2.1 Threats

                         The Security Problem Definition (SPD) statement that is presented in Section 4 "Security
                         Problem Definition (ASE_SPD)" includes the threats as presented in the PP [6], but also
                         includes additional threats. These threats are:
                         •   T.OS_OPERATE
                         •   T.RND
                         •   T.COM_EXPLOIT
                         •   T.LIFE_CYCLE
                         •   T.UNAUTHORIZED_CARD_MNGT
                         •   T.INTEG-APPLI-DATA[REFINED]
                         •   T.CONFIG
                         •   T.SEC_BOX_BORDER
                         •   T.MODULE_EXEC
                         •   T.MODULE_REPLACEMENT
                         The threat T.OS_OPERATE is an additional threat added to cover incorrect operating
                         system behavior, it is an addition to the threats in the PP [6].
                         The threat T.RND is taken from the Security IC PP [5].
                         The threat T.COM_EXPLOIT is included to cover communication channels attacks and it
                         is an addition to the threats in the PP [6].
                         The threat T.LIFE_CYCLE is included to cover content management attacks and it is an
                         addition to the threats in the PP [6].
                         The threat T.UNAUTHORIZED_CARD_MNGT refines the threats T.INSTALL and
                         T.DELETION from the Security IC PP [5].
                         The threat T.INTEG-APPLI-DATA[REFINED] refines the threat T.INTEG-APPLI-DATA in
                         the Security IC PP [5].
                         The threat T.CONFIG is an additional threat to cover unauthorized modifications and
                         read access of the configuration area in the TOE. It is an addition to the threats defined in
                         the PP [6].
                         The threat T.SEC_BOX_BORDER is included for the Secure Box which is additional
                         functionality the PP [6] allows.
                         The threats T.MODULE_EXEC and T.MODULE_REPLACEMENT are included for the
                         Modular Design which is additional functionality the PP [6] allows. Furthermore some
                         threats from the PP [6] are refined to cover additional assets from the Modular Design.
                         This comprises threats T.CONFID-JCS-CODE, T.CONFID-JCS-DATA, T.INTEG-APPLI-
                         CODE, T.INTEG-JCS-CODE, T.INTEG-JCS-DATA, and T.SID.1.
                         Note that the threat T.EXE-CODE-REMOTE is not included, since the TOE does not
                         support Java Card RMI. The Java Card Protection Profile [6] makes the use of Java Card
                         RMI optional.

                 2.4.2.2 Organizational Security Policies

                         The SPD statement presented in Section 4 "Security Problem Definition (ASE_SPD)",
                         copies the OSP from the PP [6], and adds following additional OSPs:
                         • OSP.PROCESS-TOE
JCOP 4.7 SE051                           All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                     Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                               15 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                        • OSP.KEY-CHANGE
                        • OSP.SECURITY-DOMAINS
                        • OSP.SECURE-BOX
                        The Organizational Security Policy (OSP) OSP.PROCESS-TOE is introduced for the pre-
                        personalisation feature of the TOE and is an addition to the OSPs in PP [6]. This OSP is
                        copied from the Security IC PP [5].
                        The OSP OSP.KEY-CHANGE is introduced for the Security Domain (SD) feature of the
                        TOE and is an addition to the OSPs in PP [6].
                        The OSP OSP.SECURITY-DOMAINS is introduced for the SD feature of the TOE and is
                        an addition to the OSPs in PP [6].
                        The OSP.SECURE-BOX is introduced to allow execution of third party native code and is
                        an addition to the OSPs in PP [6].

                 2.4.2.3 Assumptions

                        The SPD statement includes two of the three assumptions from the PP [6]. The
                        assumption A.Deletion is excluded. The Card Manager is part of the TOE and therefore
                        the assumption is no longer relevant. Leaving out the assumption, makes the SPD of this
                        ST more restrictive than the SPD in the PP [6]. As the Card Manager is part of the TOE,
                        it is ensuring that the deletion of applets through the Card Manager is secure, instead of
                        assuming that it is handled by the Card Manager in the environment of the TOE.
                        Besides the assumptions from the PP [6], following additional assumptions are added:
                        •   A.PROCESS-SEC-IC
                        •   A.USE_DIAG
                        •   A.USE_KEYS
                        •   A.APPS-PROVIDER
                        •   A.VERIFICATION-AUTHORITY
                        The assumption A.PROCESS-SEC-IC is taken from the underlying certified Micro
                        Controller [10], which is compliant to the Security IC PP [5].
                        The assumptions A.USE_DIAG and A.USE_KEYS are included because the Card
                        Manager is part of the TOE and no longer part of the environment.
                        The assumptions A.APPS-PROVIDER and A.VERIFICATION-AUTHORITY are added
                        because Security Domains from the GlobalPlatform Specification are introduced. All the
                        applets and packages are signed by the Application Provider Security Domain (APSD)
                        and the correctness is verified on the TOE by Verification Authority Security Domain
                        (VASD) before the package or applet is installed or loaded. A.APPS-PROVIDER and
                        A.VERIFICATION-AUTHORITY are additions to PP [6] for card content management
                        environment.

                  2.4.3 Security Objectives Statement
                        The statement of security objectives in the ST presented in Section 5 "Security
                        Objectives" includes all security objectives as presented in the PP [6], but also includes a
                        number of additional security objectives. These security objectives are:
                        • OT.IDENTIFICATION
                        • OT.DOMAIN-RIGHTS
                        • OT.APPLI-AUTH

JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                              16 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


                      •   OT.COMM_AUTH
                      •   OT.COMM_INTEGRITY
                      •   OT.COMM_CONFIDENTIALITY
                      •   OT.CARD-CONFIGURATION
                      •   OT.SEC_BOX_FW
                      •   OT.SID_MODULE
                      •   OT.RNG
                      •   OT.SECURE_LOAD_ACODE
                      •   OT.SECURE_ACTIVATION_ADDITIONAL_CODE
                      •   OT.TOE_IDENTIFICATION
                      The security objective OT.IDENTIFICATION is part of the security objectives of the
                      certified Micro Controller [10] (see also Section 1.3.1.1 "Micro Controller") and Crypto
                      Lib [10] (see also Section 1.3.1.2.2 "Crypto Library"), which are also components of this
                      composite certification. Therefore the security objective statement is equivalent to the PP
                      [6] for these two security objectives. OT.IDENTIFICATION is also included for the pre-
                      personalisation feature of the TOE, which is additional functionality the PP allows.
                      The security objectives OT.DOMAIN-RIGHTS, OT.APPLI-AUTH, OT.COMM_AUTH,
                      OT.COMM_INTEGRITY, OT.COMM_CONFIDENTIALITY are objectives for the TOE as
                      the GlobalPlatform API and the definitions for Secure Channel, Security Domains and
                      Card Content Management are used from it.
                      The security objectives OT.CARD-CONFIGURATION, OT.SECURE_LOAD_ACODE,
                      OT.SECURE_ACTIVATION_ADDITIONAL_CODE, OT.TOE_IDENTIFICATION are
                      related to the configuration of the TOE via the Configuration Module, which is additional
                      functionality the PP [6] allows.
                      The security objective OT.SEC_BOX_FW is related to the Secure Box, which is
                      additional functionality the PP allows.
                      The security objective OT.SID_MODULE is related to the Modular Design of the TOE,
                      which is additional functionality the PP [6] allows.
                      The security objective OT.RNG is related to the Random Number Generator, and is
                      taken from the Security IC PP [5].
                      The ST contains OE.APPLET, OE.VERIFICATION and OE.CODE-EVIDENCE from
                      Security Objectives for the Operational Environment from [6]. Additionally, some of the
                      Security Objectives for the Operational Environment from [6] are listed as TOE Security
                      Objectives in this ST:
                      •   OT.SCP.RECOVERY instead of OE.SCP.RECOVERY
                      •   OT.SCP.SUPPORT instead of OE.SCP.SUPPORT
                      •   OT.SCP.IC instead of OE.SCP.IC
                      •   OT.CARD-MANAGEMENT instead of OE.CARD-MANAGEMENT
                      OT.SCP.RECOVERY, OT.SCP.SUPPORT, and OT.SCP.IC are objectives for the
                      TOE as the Smart Card Platform belongs to the TOE for this evaluation. OT.CARD-
                      MANAGEMENT is an objective for the TOE as the Card Manager belongs to the TOE
                      for this evaluation. Moving objectives from the environment to the TOE adds objectives
                      to the TOE without changing the overall objectives. The statement of security objectives
                      is therefore equivalent to the security objectives in the PP [6] to which conformance is
                      claimed.



JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                           17 / 120
NXP Semiconductors
                                                                                                                    JCOP 4.7 SE051
                                                                                                                         Security Target Lite


                       The security objectives O.INSTALL, O.LOAD, and O.DELETION from the PP [6] are not
                       included since these functionality and objectives are covered by the refined OT.CARD-
                       MANAGEMENT.
                       Note that the objective O.REMOTE is not included, since the TOE does not support Java
                       Card RMI. The Java Card Protection Profile makes the use of Java Card RMI optional.
                       A part of the security objectives for the environment defined in the PP [6] has been
                       included in this ST. The other part of security objectives for the environment, which is
                       present in the PP [6], is used as part of the security objectives for the TOE in this ST. The
                       ST also introduces following additional security objectives for the environment:
                       •   OE.PROCESS_SEC_IC
                       •   OE.USE_DIAG
                       •   OE.USE_KEYS
                       •   OE.APPS-PROVIDER
                       •   OE.VERIFICATION-AUTHORITY
                       •   OE.KEY-CHANGE
                       •   OE.SECURITY-DOMAINS
                       The security objective for the environment OE.PROCESS_SEC_IC is from the hardware
                       platform (Micro Controller [10] see also Section 1.3.1.1 "Micro Controller") that is part of
                       this composite product evaluation. Therefore the statement of security objectives for the
                       environment is equivalent to the statement in the Security IC PP [5].
                       OE.USE_KEYS and OE.USE_DIAG are included because the Card Manager is part of
                       the TOE and not a security objective for the environment as in PP [6].
                       OE.APPS-PROVIDER and OE.VERIFICATION-AUTHORITY cover trusted actors which
                       enable the creation, distribution and verification of secure applications.
                       OE.KEY-CHANGE covers the switch to trusted keys for the AP.
                       OE.SECURITY-DOMAINS covers the management of security domains in the context of
                       the GlobalPlatform Specification.
                       The statement of security objectives for the environment is therefore considered to be
                       equivalent to the security objectives in the PP [6] to which conformance is claimed.

                 2.4.4 Security Functional Requirements Statement
                       The statement of security functional requirements copies most SFRs as defined in the
                       PP [6], with the exception of a number of options. For the copied set of SFRs the ST is
                       considered equivalent to the statement of SFRs in the PP [6]. Moreover as requested
                       by the PP [6] the ST adds additional threats, objectives and SFRs to fully cover and
                       describe additional security functionality implemented in the TOE.
                       The TOE does not implement Java Card RMI, therefore this ST restricts remote access
                       from the CAD to the services implemented by the applets on the card to none. As a
                       result the SFRs concerning Java Card RMI (FDP_ACF.1/JCRMI, FDP_IFC.1/JCRMI,
                       FDP_IFF.1/JCRMI, FMT_MSA.1/EXPORT, FMT_MSA.1/REM_ REFS, FMT_MSA.3/
                       JCRMI, FMT_SMF.1/JCRMI, FMT_REV.1/JCRMI, and FMT_SMR.1/JCRMI) are not
                       included in the ST. In the PP [6] the use of the Java Card RMI is optional.
                       The SFR FDP_ITC.2/INSTALLER from the PP [6] is replaced by FDP_ITC.2[CCM] which
                       enforces the Security Domain access control policy and the Secure Channel Protocol
                       information flow policy and which are more restrictive than the PACKAGE LOADING
                       information flow control SFP from PP [6].
JCOP 4.7 SE051                         All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                   Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                             18 / 120
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


                      The set of SFRs that define the card content management mechanism CarG are partly
                      replaced or refined and are considered to be equivalent or more restrictive because of
                      the newly introduced SFPs:
                      1. Security Domain access control policy,
                      2. Secure Channel Protocol information flow policy
                      provide a concrete and more restrictive implementation of the PACKAGE LOADING
                      information flow control SFP from PP [6].
                      The table below lists the SFRs from CarG of PP [6] and their corresponding refinements
                      in this ST.

                      Table 6. CarG SFRs refinements
                      SFR from PP [6]                                                               Refinement
                      FCO_NRO.2/CM                                                                  FCO_NRO.2[SC]
                      FDP_IFC.2/CM                                                                  FDP_IFC.2[SC]
                      FDP_IFF.1/CM                                                                  FDP_IFF.1[SC]
                      FDP_UIT.1/CM                                                                  FDP_UIT.1[CCM]
                      FIA_UID.1/CM                                                                  FIA_UID.1[SC]
                      FMT_MSA.1/CM                                                                  FMT_MSA.1[SC]
                      FMT_MSA.3/CM                                                                  FMT_MSA.3[SC]
                      FMT_SMF.1/CM                                                                  FMT_SMF.1[SC]
                      FMT_SMR.1/CM                                                                  FMT_SMR.1[SD]
                      FTP_ITC.1/CM                                                                  FTP_ITC.1[SC]

                      The following SFRs realize refinements of SFRs from PP [6] and add functionality to the
                      TOE making the statement of security requirements more restrictive than the PP [6]:
                      FDP_ROL.1[CCM] and FPT_FLS.1[CCM] realize additional security functionality for the
                      card manager which is allowed by the PP [6].
                      The set of SFRs that define the security domains mechanism as specified by
                      GlobalPlatform realize refinements of SFRs from PP [6] (see above Table 6 "CarG
                      SFRs refinements") and additional security functionality which is allowed by the PP
                      [6]. This set of SFRs comprise FDP_ACC.1[SD], FDP_ACF.1[SD], FMT_MSA.1[SD],
                      FMT_MSA.3[SD], FMT_SMF.1[SD], and FMT_SMR.1[SD].
                      The set of SFRs that define the secure channel mechanism as specified by
                      GlobalPlatform realize refinements of SFRs from PP [6] (see above Table 6 "CarG SFRs
                      refinements"), add additional security functionality and include a JCOPX API which is
                      allowed by the PP [6]. This set of SFRs comprise FCO_NRO.2[SC], FDP_IFC.2[SC],
                      FDP_IFF.1[SC], FMT_MSA.1[SC], FMT_MSA.3[SC], FMT_SMF.1[SC], FIA_UID.1[SC],
                      FIA_UAU.1[SC], FIA_UAU.4[SC], and FTP_ITC.1[SC].
                      The set of SFRs that define the Configuration Module realize additional
                      security functionality, which is allowed by the PP [6]. This set of SFRs comprise
                      FDP_IFC.2[CFG], FDP_IFF.1[CFG], FIA_UID.1[CFG], FMT_MSA.1[CFG],
                      FMT_MSA.3[CFG], FMT_SMF.1[CFG] and FMT_SMR.1[CFG].
                      The set of SFRs that define the Secure Box, realize additional security functionality
                      which is allowed by the Protection Profile (PP) [6]. This set of SFRs comprise


JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                            19 / 120
NXP Semiconductors
                                                                                                                  JCOP 4.7 SE051
                                                                                                                       Security Target Lite


                      FDP_ACC.2[SecureBox], FDP_ACF.1[SecureBox], FMT_MSA.1[SecureBox],
                      FMT_MSA.3[SecureBox], and FMT_SMF.1[SecureBox].
                      The set of SFRs that define the Modular Design realize additional security functionality,
                      which is allowed by the PP [6]. This set of SFRs comprise FDP_IFC.1[MODULAR-
                      DESIGN], FDP_IFF.1[MODULAR-DESIGN], FIA_ATD.1[MODULAR-DESIGN],
                      FIA_USB.1[MODULAR-DESIGN], FMT_MSA.1[MODULAR-DESIGN],
                      FMT_MSA.3[MODULAR_DESIGN, FMT_SMF.1[MODULAR-DESIGN],
                      FMT_SMR.1[MODULAR-DESIGN], and FPT_FLS.1[MODULAR-DESIGN].
                      Some SFRs from the PP [6] are refined to cover deletion of Modules. This makes
                      the SFRs more restrictive which is allowed by the PP [6]. This set of SFRs comprise
                      FDP_ACC.2[ADEL], FDP_ACF.1[ADEL], FMT_SMF.1[ADEL], and FPT_FLS.1[ADEL].
                      The SFRs FAU_SAS.1[SCP], FIA_AFL.1[PIN], FPT_EMSEC.1 and FPT_PHP.3 realize
                      additional security functionality which is allowed by the PP [6]. The SFRs FCS_CKM.2
                      and FCS_CKM.3 realize security functionality required by the Java Card API [14] which is
                      allowed by the PP [6].




JCOP 4.7 SE051                       All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                 Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                           20 / 120
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


3       Security Aspects
                       This Chapter describes the main security issues of the Java Card System and its
                       environment addressed in this ST, called "security aspects", in a CC-independent way.
                       In addition to this, they also give a semi-formal framework to express the CC security
                       environment anePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




CC Document    Please read the Important Notice and Warnings at the end of this document   1.2
www.infineon.com                                                                           2020-05-27
Table of Contents
1             Revision History ............................................................................................................ 3
2             Security Target Introduction (ASE_INT) ............................................................................ 4
2.1           ST Reference ............................................................................................................................................ 4
2.2           TOE Reference ......................................................................................................................................... 4
2.3           TOE Identification.................................................................................................................................... 4
2.4           TOE Overview .......................................................................................................................................... 5
2.4.1            TOE Definition .................................................................................................................................... 5
2.4.2            TOE Operational Usage ...................................................................................................................... 5
2.4.3            TOE Major Security Features.............................................................................................................. 5
2.5           Guidance Documentation ....................................................................................................................... 6
2.6           TOE Description ....................................................................................................................................... 6
2.6.1            Component Overview ........................................................................................................................ 6
2.6.2            Interfaces of the TOE .......................................................................................................................... 8
2.6.3            Package Types .................................................................................................................................... 8
2.6.4            Lifecycle and Delivery ........................................................................................................................ 8
3             Conformance Claims (ASE_CCL)...................................................................................... 10
3.1           CC Conformance Claim ......................................................................................................................... 10
3.2           PP Claim ................................................................................................................................................. 10
3.3           Package Claim ....................................................................................................................................... 10
4             Security Problem Definition (ASE_SPD) ........................................................................... 11
5             Security Objectives (ASE_OBJ) ....................................................................................... 12
5.1           Security Objectives defined in the claimed PPs ................................................................................... 12
5.2           Security Objectives defined in this ST .................................................................................................. 12
5.3           Security Objective Rationale................................................................................................................. 12
6             Extended Components Definition (ASE_ECD) ................................................................... 13
7             Security Requirements (ASE_REQ) .................................................................................. 14
7.1           TOE Security Functional Requirements ............................................................................................... 14
7.1.1            About the Application Notes in this ST ............................................................................................ 17
7.1.2            Common SFRs from [PP_BAC] and [PP_SAC] ................................................................................. 17
7.1.3            SFRs specifically from [PP_SAC] ...................................................................................................... 20
7.1.4            SFRs specifically from [PP_BAC] ...................................................................................................... 31
7.1.5            SFRs specifically from [PP_EAC] ...................................................................................................... 41
7.2           Security Assurance Requirements ........................................................................................................ 55
7.3           Security Requirements Rationale ......................................................................................................... 56
7.3.1            Security Functional Requirements Rationale ................................................................................. 56
7.3.2            Rationale for SFR’s Dependencies ................................................................................................... 56
7.3.3            Security Assurance Requirements Rationale .................................................................................. 56
7.3.4            Security Requirements – Internal Consistency ............................................................................... 56
8             TOE Summary Specification ........................................................................................... 57
9             References ................................................................................................................... 61
9.1           Literature ............................................................................................................................................... 61
9.2           List of Abbreviations.............................................................................................................................. 64




CC Document        Please read the Important Notice and Warnings at the end of this document                                                                1.2
www.infineon.com                                                                                                                                            2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 1             Revision History
 Version 1.2                                             Final version of the ST




CC Document                                          3
                                                                                   1.2
                                                                                   2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 2            Security Target Introduction (ASE_INT)

 2.1          ST Reference
The title of this document is “ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD
V1.0”.


 2.2          TOE Reference
The name of the TOE is “ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0”
interchangeably called ePass in this ST.
The TOE is a secure chip implementing an ePassport. The TOE is subject to a composite certification based on
the Infineon Java Card Secora ID S platform, for details on the latter refer to [ST_JC_ID_S_Platform].
This ST is compatible to [ST_JC_ID_S_Platform].


 2.3          TOE Identification
The TOE identification data is as shown in the following table:



 TOE release date            24 February 2020

 TOE version number          1.0

 Applet version              1.1

 JC OS Platform related      CC Identifier of underlying hardware     IFX_CCI_000005
 identification data         platform

                             Build number                             1357

                             Version of Assymetric Crypto Library     2.07.003
                             (ACL)

                             Version of Symetric Crypto Library       2.04.002
                             (SCL)

                             Version of Hardware Support Library      03.12.8812
                             (HSL)



The TOE provides a command ‘GET DATA’ with tag 00C1 which provides the release date and the version of the
product.



CC Document                                             4
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



The underlying Secora ID S platform provides the APDU command “GET TOE Info“ which returns the Common
Criteria identifier of the platform, the OS build number, the specific versions of the cryptographic and hardware
support libraries.


    2.4         TOE Overview

2.4.1               TOE Definition
The Target of Evaluation (TOE) addressed by this ST is an electronic passport representing a smart card
implementing [ICAO_9303_10], [ICAO_9303_11], [TR-03110_1] and [TR-03110_3]. This smart card / passport
provides the following application:
     the travel document containing the related user data as well as data needed for authentication with BAC,
     PACE, EAC or AA protocols (incl. PACE/BAC passwords); this application is intended to be used by
     governmental organisations as a machine readable travel document (MRTD).
For the ePassport application, the travel document holder can control access to his user data by conscious
presenting his travel document to governmental organisations.The travel document’s chip is integrated into a
physical (plastic or paper), optically readable part of the travel document, which – as the final product – shall
eventually supersede still existing, merely optically readable travel documents. The plastic or paper, optically
readable cover of the travel document, where the travel document’s chip is embedded in, is not part of the
TOE. The tying-up of the travel document’s chip to the plastic travel document is achieved by physical and
organizational security measures being out of scope of the TOE.

2.4.2               TOE Operational Usage
A State or Organization issues MRTDs to be used by the holder for international travel. The traveler presents a
MRTD to the inspection system to prove his or her identity. The MRTD in context of this ST contains (i) visual
(eye readable) biographical data and portrait of the holder, (ii) a separate data summary (MRZ data) for visual
and machine reading using OCR methods (see [ICAO_9303_01]) in the Machine readable zone (MRZ) and (iii)
data elements on the MRTD’s chip. The authentication of the traveller is based on (i) the possession of a valid
travel document personalised for a holder with the claimed identity as given on the biographical data page and
(ii) biometrics using the reference data stored in the travel document. The issuing State or Organisation ensures
the authenticity of the data of genuine travel documents. The receiving State trusts a genuine travel document
of an issuing State or Organisation.

2.4.3               TOE Major Security Features
The following TOE security features are the most significant for its operational use:
    Verifying authenticity and integrity as well as securing confidentiality of user data in the communication
     channel between the TOE and the connected terminal supporting the protocols BAC, SAC(PACE) as per
     [ICAO_9303_11] and EAC as per [TR-03110_1]
    Averting of inconspicuous tracing of the travel document as per [TR-03110_1]
    Self-protection of the TOE security functionality and the data stored inside as per [TR-03110_1]
    Means to check authenticity of the terminal, Terminal Authentication as per [TR-03110_1]
    Means to prove authenticity of the chip by means of Active Authentication or Chip Authentication as per [TR-
     03110_1]
    Chip authentication followed by terminal authentication used as a precondition to provide access to
     biometric data known as EAC, as per [TR-03110_1]


CC Document                                             5
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



Any product using BAC will be conformant to [PP_BAC] only. Any product using PACE but not using EAC will be
conformant to [PP_SAC] only. Any product using PACE and EAC will be conformant to [PP_EAC] only.
Organizations being responsible for the operation of inspection systems shall be aware of this context.

 2.5              Guidance Documentation
The following guidance documentation is delivered to the customer together with the TOE

 Document name                                                               Version          Date

 Infineon Applet Collection eMRTDV1.0 Administration Guide
                                                                             1.4              2020-04-14


 Infineon Applet Collection eMRTDV1.0 Databook
                                                                             1.6              2020-04-17




 2.6              TOE Description

2.6.1               Component Overview
The TOE is a DI chip with the ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0.
It is based on the requirements from the ICAO for machine readable travel documents, i.e. [ICAO_9303_10],
[ICAO_9303_11], [TR-03110_1] and [TR-03110_3].
Figure 1 shows the TOE in terms of its components.
The grey color indicates what contributes to fulfill the security claims in this ST. The white color indicates
optional components which are not in the scope of the security claims of this ST, in CC terminology these are
non interefering with the TSF of the TOE.
   -    The two lower layers in the picture represent the smart card controller referenced by IFX_CCI_000005
        together with the Firmware, Asymmetric Cryptographic Library (ACL) and a Symmetric Crypto Library
        (SCL). Note that these components are certified by the same CC certificate BSI-DSZ-CC-1110-V2-2019.
        The hardware platform provides effective protection mechanisms against fault attacks. The platform
        contains hardware co-processors, which support cryptographic standards such as TDES, AES, RSA and
        EC. The hardware co-processor SCP has integrated measures against successful SCA.
   -    The OS platform called “Secora ID S” is a Java Card OS and offers services for:
                 The standard Java Card features like API, the Java Card Runtime Environment and the Java
                  Card Virtual Machine
               Proprietary PACE API providing special countermeasures against side channel leakage
               GP for content management
               Crypto operations (hash, EC, RSA, TDES and AES)
               Communication via the contactless interface and contact interface.
        It is certified in Common Criteria under the Certificate NSCIB-CC-175887.
        Secora ID S supports the standard open Java Card mode as well as the proprietary static mode
        (installation of preloaded code is possible) and the proprietary mode native (specially tailored mode for
        eMRTD usecase which enforces non traceablity of the TOE). Open and static modes are the two possible
CC Document                                             6
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



       modes during personalization of the TOE. The TOE goes into native mode once the personalization is
       terminated. See [ST_JC_ID_S_Platform] for more details on the supported modes in Secora ID S OS.
   -   ISO or EU Electronic Driving License (eDL) or an Electronic ID(eID) are configurations of SECORA™ ID S
       Applet Infineon Applet Collection - eMRTD V1.0. For more information on these optional features refer
       to [UserGuideDataBook], [UserGuideAdmin]. As already said these applications are not part of the TOE
       Security Functionalities and are non interfering with the TSFs of the TOE. The installation of eDL and
       eID is done by the customer who uses the cap file of SECORA™ ID S Applet Infineon Applet Collection
       preloaded on the card by Infineon. Again, no claims of the security for the eDL or the eID applications
       are made in this ST.
   -   ePassport configuration of SECORA™ ID S Applet Infineon Applet Collection - eMRTD V1.0 is a Java Card
       applet which provides the functions of the electronic Passport as per [ICAO_9303_10], [ICAO_9303_11],
       [TR-03110_1] and [TR-03110_3].
       The installation of ePass is done by the customer who uses for this purpose the cap file of SECORA™ ID
       S Applet Infineon Applet Collection preloaded on the card by Infineon.
       The applet uses the services of the Java Card Secora ID S OS described above. It manages the various
       stages of the product’s lifecycle once the application is onto the hardware up to its end of life. The
       application implements the protocols:
                 BAC
                 PACE
                 EAC
                 AA
       It does not implement any cryptographic primitives, as these are provided by the underlying Java Card
       OS. Further it manages file access control and authentication failure handling. Also the application
       controls the secure messaging including error handling using the Java Card OS Crypto services, which
       subsequently relies on the features of the underlying hardware providing high integrity and side
       channel protection. The claims in terms of SFRs in this ST target the SECORA™ ID S Applet Infineon
       Applet Collection - eMRTD V1.0.

   -   Third party applications can be installed by the customer and running on the card. Note that in this
       case the JC Secora ID S is delivered in open mode, see [ST_JC_ID_S_Platform] to the customer which
       will be then able to load and install 3rd party applications.
The TOE user guidance comprises:
   -   [UserGuideDataBook] and [UserGuideAdmin] which provide guidance, how to perform personalization
       and maintain the targeted security level during Personalisation and Operation phase.




CC Document                                           7
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




Figure 1      TOE components overview




2.6.2              Interfaces of the TOE
   -    The physical interface of the TOE to the external environment is the entire surface of the IC.
   -    The RF interface (radio frequency power and signal interface) enabling contactless communication
        between a PICC (proximity integration chip card, PICC) and a terminal reader/writer (proximity coupling
        device, terminal). The transmission protocol meets [ISO/IEC 14443-3] and [ISO/IEC 14443-4] Type B.
   -    The contact based interface ISO 7816-3 supported for the purposes of eID and eDL.
   -    The command interface to the TOE is provided by the ePassport Application.



2.6.3              Package Types
The TOE package types and formats are exactly the same as for the underlying Java Card OS. The package
types and formats of the Java Card OS Secora ID S are described in [ST_JC_ID_S_Platform], section 1.4.3 and
1.4.6.


2.6.4              Lifecycle and Delivery
The [PP_EAC], [PP_SAC] and [PP_BAC] define the lifecycle phases for the TOE as follows:
1. Development
   - Step 1: Development of hardware and IC dedicated software (firmware)
   - Step 2: Development of IC embedded software

CC Document                                            8
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



2. Manufacturing
   - Step 3: manufacturing of IC and IC dedicated software. As the TOE does not provide any user ROM,
       manufacturing of IC embedded software parts in ROM are not relevant here.
   - Step 4 (optional): Combination of IC with contactless interface of the travel document
   - Step 5 (Prepersonalization): loading on the device of the executable Java Card OS image. Loading of
       the application JC package containing the TOE code, eDL and eID code.
3. Personalisation of Travel Document
   - Step 6: this step is performed by the customer. The customer receives from Infineon the TOE
       composed of the following components:
           o The underlying hardware
           o The underlying Java Card OS can be in two possible modes: either in the standard Java Card
                open mode (loading and installation of applets are possible) or in the proprietary Java Card
                static mode (preloaded by Infineon packages can be installed, applet loading is not possible).
           o The cap file of SECORA™ ID S Applet Infineon Applet Collection - eMRTD V1.0 is preloaded by
                Infineon.
           o The customer then proceeds to installing the ePassport configuration of SECORA™ ID S Infineon
                Applet Collection - eMRTD V1.0 and optionally installing the ISO/EU eDL or eID. In case the
                Secora ID S is in open mode the customer can load and install 3rd party applets. During this step
                the customer also performs the personalisation with biometric data and configuration of the
                TSF if necessary.
4. Operational Use
   - Step 7: once the personalization of the product is finished, the Java Card ID S OS is switched to its
       proprietary native mode usage of the TOE by the personalizer. Native mode switches off GP and
       identification commands to disallow tracking of the end user.




CC Document                                             9
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 3             Conformance Claims (ASE_CCL)

 3.1           CC Conformance Claim
This Security Target and the TOE is Common Criteria version v3.1 revision 5 part 2 [CCPart2] extended and
Common Criteria version v3.1 revision 5 part 3 [CCPart3] conformant.


 3.2           PP Claim
The TOE is strictly conformant
     -   to [PP_BAC], if a BIS chooses BAC as authentication method
     -   to [PP_SAC], if a BIS chooses PACE as authentication method
     -   to [PP_EAC], if a EIS choses PACE as authentication method and additionally uses Extended Access
         Control, which consists of two parts (i) the Chip Authentication Protocol Version 1 (v.1) and (ii) the
         Terminal Authentication Protocol Version 1 (v.1) as defined in [TR-03110_1].


 3.3           Package Claim
The assurance level for the TOE is EAL5 augmented with the components ALC_DVS.2 and AVA_VAN.5 in case
PACE is used and EAC is not used and conform to [PP_SAC].
The assurance level for the TOE is EAL5 augmented with the components ALC_DVS.2 and AVA_VAN.5 in case
PACE and EAC are used and conform to [PP_EAC].
The assurance level for the TOE is EAL4 augmented with the components ALC_DVS.2 in case BAC is chosen as
authentication method whereby conformancy to [PP_BAC] is claimed.




CC Document                                              10
                                                                                                           1.2
                                                                                                           2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 4            Security Problem Definition (ASE_SPD)
All assets, subjects and external entities, threats, organisational security policies and assumptions from
[PP_EAC], [PP_SAC] and [PP_BAC] section 3 “Security Problem Definition” are applicable for this TOE.




CC Document                                             11
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 5             Security Objectives (ASE_OBJ)
Here follows a concise description of the security objectives applying to this ST followed by a the security
objective rationale.

 5.1           Security Objectives defined in the claimed PPs
All Security Objectives provided by the TOE or by the operational environment as well as the security objectives
rationale from the claimed PPs [PP_EAC], [PP_SAC] and [PP_BAC] section 4 “Security Objectives” are applicable
for this TOE.

 5.2           Security Objectives defined in this ST
The following security objective is defined additionally in this ST to formally express the extra features of the
TOE not present in the claimed PPs:
OT.Active_Auth Travel document’s chip authenticity
The TOE shall support the Basic Inspection Systems to verify the identity and authenticity of the travel doc-
ument’s chip as issued by the identified issuing State or Organisation by means of the Active Authentication as
defined in [ICAO_9303_01]. The authenticity proof provided by travel document’s chip shall be protected
against attacks with high attack potential.



 5.3           Security Objective Rationale
The Security Objective Rationale from the claimed PPs [PP_EAC], [PP_SAC] and [PP_BAC] stays the same here.
The additionally defined in this ST security objective OT.Active_Auth above counters the threat T.Counterfeit
(threat defined in [PP_EAC].




CC Document                                              12
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 6            Extended Components Definition (ASE_ECD)
[PP_EAC], [PP_SAC] and [PP_BAC] respective sections 5 “Extended Components Definition” are applicable for
this TOE.




CC Document                                          13
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  7             Security Requirements (ASE_REQ)

  7.1           TOE Security Functional Requirements
 The security functional requirements (SFR) for this TOE are defined in this chapter.
This ST covers the three PPs [PP_SAC], [PP_EAC] and [PP_BAC] each two of which have a non empty
intersection of SFRs. In the rest of this section we provide a classification of the SFRs of these PPs depending on
where these SFRs are declared and if they need a refinement here in this ST.
 Table 1 lists all SFRs appearing both in [PP_SAC] and [PP_BAC].
 Table 2 lists all SFRs declared in [PP_SAC].
Table 3 lists all SFRs specific to [PP_BAC]. Note that some of the SFRs appear in both [PP_SAC] and [PP_BAC]
with same name but different content. In such cases the SFR is iterated with either the extension …/BAC or
…/PACE.
Table 4 lists all SFRs specific to [PP_EAC]. Note that [PP_EAC] is an extension of [PP_SAC], therefore all SFRs of
[PP_SAC] are SFRs in [PP_EAC], i.e. the SFRs listed in Table 3 and Table 4 are also SFRs of [PP_EAC].
Table 5 lists the SFRs introduced in this ST which are related to the Active Authentication mechanism
supported by the TOE.

Table 1       TOE SFRs equivalent from both [PP_SAC] and [PP_BAC]
  FCS_CKM.4
  FCS_RND.1
  FMT_MTD.1/INI_ENA
  FPT_TST.1
  FPT_PHP.3



Table 2       TOE SFRs specifically from [PP_SAC]
  FCS_CKM.1/DH_PACE
  FCS_COP.1/PACE_ENC
  FCS_COP.1/PACE_MAC
  FIA_AFL.1/PACE
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/PACE
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FDP_RIP.1

CC Document                                             14
                                                                                                          1.2
                                                                                                          2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FDP_UCT.1/TRM
  FDP_UIT.1/TRM
  FTP_ITC.1/PACE
  FAU_SAS.1
  FMT_SMF.1
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/INI_DIS
  FMT_MTD.1/KEY_READ
  FMT_MTD.1/PA
  FPT_EMS.1
  FPT_FLS.1

Table 3

Table 4       TOE SFRs specifically from [PP_BAC]
  FCS_CKM.1
  FCS_COP.1/SHA
  FCS_COP.1/ENC
  FCS_COP.1/AUTH
  FCS_COP.1/MAC
  FIA_UID.1
  FIA_UAU.1
  FIA_UAU.4
  FIA_UAU.5
  FIA_UAU.6
  FIA_AFL.1
  FDP_ACC.1
  FDP_ACF.1
  FDP_UCT.1
  FDP_UIT.1
  FAU_SAS.1/BAC
  FMT_SMF.1/BAC
  FMT_SMR.1
  FMT_LIM.1/BAC
  FMT_LIM.2/BAC
  FMT_MTD.1/INI_DIS/BAC

CC Document                                          15
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




  FMT_MTD.1/KEY_WRITE
  FMT_MTD.1/KEY_READ/BAC
  FPT_EMSEC.1
  FPT_FLS.1/BAC




Table 5       TOE SFRs specifically from [PP_EAC]
  FCS_CKM.1/CA
  FCS_COP.1/CA_ENC
  FCS_COP.1/CA_MAC
  FCS_COP.1/SIG_VER
  FIA_UID.1/PACE
  FIA_UAU.1/PACE
  FIA_UAU.4/PACE
  FIA_UAU.5/PACE
  FIA_UAU.6/EAC
  FIA_API.1
  FDP_ACC.1/TRM
  FDP_ACF.1/TRM
  FMT_SMR.1/PACE
  FMT_LIM.1
  FMT_LIM.2
  FMT_MTD.1/CVCA_INI
  FMT_MTD.1/DATE
  FMT_MTD.1/CAPK
  FMT_MTD.1/CVCA_UPD
  FMT_MTD.1/KEY_READ
  FMT_MTD.3
  FPT_EMS.1




CC Document                                          16
                                                                                  1.2
                                                                                  2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



Table 6       TOE SFRs introduced in this ST
 FIA_API.1/AA
 FMT_MTD.1/AA
 FCS_COP.1/SIG_GEN




7.1.1                About the Application Notes in this ST
Note that if an SFR has application notes as per the PPs [PP_SAC], [PP_EAC] and [PP_BAC] then these
application notes apply and can be found in the respective PPs.
Some SFRs contain additional application notes to ease the understanding of the specificities of this TOE.
These application notes do not come from the PPs and are prefixed with [IFX specific].



7.1.2                Common SFRs from [PP_BAC] and [PP_SAC]

7.1.2.1              Class FCS: Cryptographic Support




  FCS_CKM.4                Cryptographic key destruction – Session keys

  Hierarchical to:         No other components.

  Dependencies:            [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of
                           user data with security attributes, or FCS_CKM.1 Cryptographic key generation]:
                           fulfilled by FCS_CKM.1 in case of BAC;
                           fulfilled by FCS_CKM.1/DH_PACE in case of PACE

  FCS_CKM.4.1              The TSF shall destroy cryptographic keys in accordance with a specified
                           cryptographic key destruction method overwriting the key values with random
                           values that meets the following: none

                           Application note 19 of [PP_BAC] and application note 28 of [PP_SAC] are both
 [IFX specific]            applicable for this SFR. There is no contradiction between the two application
 Application Note:         notes. While the application note from [PP_BAC] simply requests the encryption
                           and message authentication keys to be destroyed, the application note from
                           [PP_SAC] provides more detailed requests, when the session keys have to be
                           destroyed. Therefore FCS_CKM.4 from [PP_SAC] and [PP_BAC] can be combined.




CC Document                                            17
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FCS_RND.1                Quality metric for random numbers

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FCS_RND.1.1              The TSF shall provide a mechanism to generate random numbers that meet
                          Random numbers generation Class PTG.3 according to [AIS31]

 [IFX specific]           There is no contradiction between application note 24 of [PP_BAC] and application
 Application Note:        note 31 of [PP_SAC]. Both application notes shall apply and therefore FCS_RND.1
                          from [PP_BAC] and [PP_SAC] can be combined, i.e. the random numbers shall be
                          used for the PACE, BAC and the authentication mechanism based on Triple-DES (as
                          defined in FIA_UAU.4/PACE and FIA_UAU.4).




7.1.2.2             Class FMT Security Management

 FMT_MTD.1/INI_ENA        Management of TSF data – Writing Initialisation and Pre-personalisation Data

 Hierarchical to:         No other components.

 Dependencies:            FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1 for
                          PACE; fulfilled by FMT_SMF.1/BAC for BAC
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE for PACE; fulfilled by
                          FMT_SMR.1 for BAC

 FMT_MTD.1.1/INI_ENA      The TSF shall restrict the ability to write the Initialisation Data and Pre-
                          personalisation Data to the Manufacturer.

 [IFX specific]           The application note 42 of [PP_BAC] applies. This application note provides a
 Application Note:        definition, what is meant by “Pre-Personalisation Data”. This definition is also
                          applicable to FMT_MTD.1/INI_ENA from [PP_SAC]. Therefore FMT_MTD.1/INI_ENA
                          from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            18
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.2.3             Class FPT Protection of the Security Functions


 FPT_TST.1                TSF testing

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_TST.1.1              The TSF shall run a suite of self tests during initial start-up, to demonstrate the
                          correct operation of the TSF.

 FPT_TST.1.2              The TSF shall provide authorised users with the capability to verify the integrity of
                          the TSF data.

 FPT_TST.1.3              The TSF shall provide authorised users with the capability to verify the integrity of
                          stored TSF executable code.



 [IFX specific]           There is no contradiction between application note 46 of [PP_BAC] and application
                          note 52 of [PP_SAC]. In fact, although the wording is slightly different, the meaning
 Application Note:
                          of these application notes is identical. Therefore either of these application notes
                          applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be combined.




 FPT_PHP.3                Resistance to physical attack

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FPT_PHP.3.1              The TSF shall resist physical manipulation and physical probing to the TSF by
                          responding automatically such that the SFRs are always enforced.

 [IFX specific]           Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application
                          note 48 of [PP_BAC] is only informative to the reader in the sense, that it provides a
 Application Note:
                          context to an older CC standard, but not relevant for the interpretation of
                          FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or application note 53
                          of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.




CC Document                                            19
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




7.1.3                SFRs specifically from [PP_SAC]

7.1.3.1              Class FCS: Cryptographic Support


  FCS_CKM.1/DH_PACE        Cryptographic key generation – Diffie-Hellman for PACE session keys

  Hierarchical to:         No other components.

  Dependencies:             [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic
                           operation]: fulfilled by FCS_CKM.4
                           Justification: A ECDH agreement is used in order to have no key distribution,
                           therefore FCS_CKM.2 makes no sense in this case while FCS_CKM.4 Cryptographic
                           key destruction makes sense.

  FCS_CKM.1.1/DH_PACE      The TSF shall generate cryptographic keys in accordance with a specified
                           cryptographic key generation algorithm ECDH compliant to [TR_ECC] and
                           specified cryptographic key size Table 7 column key size that meet the following:
                           [ICAO_SAC].




Table 7       FCS_CKM/DH_PACE Key Sizes
  Algorithm                                                               Key size
  ECDH key agreement algorithm                                            224, 256, 320, 384, 512
  AES session keys                                                        128, 192, 256
  TDES session keys                                                       112




  FCS_COP.1/PACE_ENC        Cryptographic operation – Encryption / Decryption AES / 3DES

  Hierarchical to:          No other components.

  Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import
                            of user data with security attributes, or FCS_CKM.1 Cryptographic key
                            generation]: fulfilled by FCS_CKM.1/DH_PACE
                            FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.

  FCS_COP.1.1/PACE_ENC      The TSF shall perform secure messaging – encryption and decryption in
                            accordance with a specified cryptographic algorithm AES and 3DES in CBC mode

CC Document                                           20
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                           and cryptographic key sizes 128, 192 and 256 bits for AES and 112 bits for 3DES
                           that meet the following: compliant to [ICAO_SAC].

 [IFX specific]            3DES in CBC mode is used with key size of 112 bit. AES in CBC mode is used with
 Application Note:         key size of 128, 192 or 256 bit. The TOE implements the cryptographic primitives
                           (i.e. Triple-DES and AES) for secure messaging with encryption of the transmitted
                           data and encrypting the nonce in the first step of PACE. The keys are agreed
                           between the TOE and the terminal as part of the PACE protocol according to
                           FCS_CKM.1/DH_PACE.




 FCS_COP.1/PACE_MAC        MAC Cryptographic operation – MAC

 Hierarchical to:          No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import
                           of user data with security attributes, or FCS_CKM.1 Cryptographic key
                           generation]: fulfilled by FCS_CKM.1/DH_PACE
                           FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.

 FCS_COP.1.1/PACE_MAC      The TSF shall perform secure messaging – message authentication code in
                           accordance with a specified cryptographic algorithm CMAC d objectives of the TOE. They can be instantiated as assumptions,
                       threats, objectives (for the TOE and the environment) or organizational security policies.
                       The description is based on [6].
                       This chapters described only the Security Aspects which have been added in comparison
                       to the PP [6].

                  3.1 Integrity

                 3.1.1 SA.INTEG-APPLI-DATA-PHYS: Integrity of Application Data (Sensitive
                       Result)
                       Integrity-sensitive application data must be protected against unauthorized modification
                       by physical attacks.

                  3.2 Configuration Module

                 3.2.1 SA.CONFIGURATION-MODULE: Configuration Module
                       The Configuration Module is a JCOP functionality which allows to read and modify
                       configuration items in the configuration area of the TOE.

                  3.3 Modular Design

                 3.3.1 SA.MODULAR-DESIGN: Modular Design
                       The TOE might contain one or more Modules implementing particular functionality. The
                       list of Modules present in the TOE must be retrievable. The Modules have an associated
                       AID which allows to identify them. The AID is equivalent to the Package AID of JavaCard
                       packages. Modules can only be deleted, re-loading of a previously deleted module or
                       replacing a present module must not be possible. Interfaces to a Module can be Public
                       or TOE internal. Public Interfaces can directly be accessed by any Applet or via an
                       APDU, TOE internal interfaces can only be accessed by the TOE itself, Applets use the
                       corresponding JavaCard API [14].

                 3.3.2 SA.MODULE-INVOCATION: Module Invocation
                       Invoking a module must be transparent to the user. If a Module has a TOE internal
                       interface, is not present and is invoked by the user, the TOE must preserve a secure
                       state by throwing an exception or returning an appropriate error status word to the CAD.




JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                            21 / 120
NXP Semiconductors
                                                                                                                   JCOP 4.7 SE051
                                                                                                                        Security Target Lite


4       Security Problem Definition (ASE_SPD)
                       The Security Problem Definition is described within the following sections. Only additional
                       and refined items compared to the PP [6] are described.

                  4.1 Assets
                       Assets are security-relevant elements to be directly protected by the TOE. Confidentiality
                       of assets is always intended with respect to un-trusted people or software, as various
                       parties are involved during the first stages of the smart card product life-cycle. Details
                       concerning the threats are given in Section 4.2 "Threats" hereafter.
                       Assets have to be protected, some in terms of confidentiality and some in terms of
                       integrity or both integrity and confidentiality. These assets might get compromised by the
                       threats that the TOE is exposed to.
                       The assets to be protected by the TOE are listed below. They are grouped according to
                       whether it is data created by and for the user (User data) or data created by and for the
                       TOE (TSF data). This definition of grouping is taken from Section 5.1 of [6].

                 4.1.1 User Data

                       D.APSD_KEYS                        Refinement of D.APP_KEYS of [6]. Application Provider Security
                                                          Domains cryptographic keys are needed to establish secure channels
                                                          with the AP. These keys can be used to load and install applications
                                                          on the card if the Security Domain has the appropriate privileges. To
                                                          be protected from unauthorized disclosure and modification.
                       D.ISD_KEYS                         Refinement of D.APP_KEYS of [6]. Issuer Security Domain
                                                          cryptographic keys are needed to perform card management
                                                          operations on the card. To be protected from unauthorized disclosure
                                                          and modification.
                       D.VASD_KEYS                        Refinement of D.APP_KEYS of [6]. Verification Authority Security
                                                          Domain cryptographic keys needed to verify applications Mandated
                                                          DAP signature. To be protected from unauthorized disclosure and
                                                          modification.
                       D.CARD_MNGT_DATA                   The data of the card management environment, like for instance,
                                                          the identifiers, the privileges, life cycle states. To be protected from
                                                          unauthorized modification.


                 4.1.2 TSF Data

                       D.CONFIG_ITEM                 A configuration that can be changed using the Configuration Mechanism.
                       D.MODULE_CODE                 The code of a Module. The code of a module might comprise Java code,
                                                     native code, code of a native Library or a combination of them. To be
                                                     protected against unauthorized disclosure and modification. Further to be
                                                     protected against unauthorized removal or presence forgery.
                       D.MODULE_DATA                 Private data of a Module, like the contents of its private fields. To be
                                                     protected from unauthorized disclosure and modification.




JCOP 4.7 SE051                        All information provided in this document is subject to legal disclaimand Retail-MAC and
                           cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant
                           to [ICAO_SAC] .

 [IFX specific]            In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used
                           in Retail mode for secure messaging.
 Application Note:




7.1.3.2             Class FIA Identification and Authentication


 FIA_AFL.1/PACE           Authentication failure handling – PACE authentication using non-blocking
                          authorisation data

 Dependencies:            FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE

 Hierarchicalto:          No other components.



CC Document                                          21
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FIA_AFL.1.1/PACE         The TSF shall detect when a configurable number (see application note below) of
                          unsuccessful authentication attempt occurs related to authentication attempts
                          using the PACE password as shared password

 FIA_AFL.1.2/PACE         When the defined number of unsuccessful authentication attempts has been met,
                          the TSF shall increasingly slow down the performance up to a maximum not
                          higher than 7 seconds verifying the authentication token.

 [IFX specific]           The number of failed authentication attempts is configurable. This configurable
                          number can be in the range [1..7f].
 Application note




 FIA_UID.1/PACE           Timing of identification

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UID.1.1/PACE         The TSF shall allow
                          1. to establish a communication channel,
                          2. carry out the PACE Protocol according to [ICAO_SAC]
                          3. to read the Initialization Data if it is not disabled by TSF according to
                             FMT_MTD.1/INI_DIS
                          4. none
                          on behalf of the user to be performed before the user is identified.

 FIA_UID.1.2/PACE         The TSF shall require each user to be successfully identified before allowing any
                          other TSF-mediated actions on behalf of that user.




 FIA_UAU.1/PACE           Timing of authentication

 Hierarchical to:         No other components.

 Dependencies:            FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE

 FIA_UAU.1.1/PACE         The TSF shall allow
                          1. to establish a communication channel,
                          2. carrying out the PACE Protocol according to [ICAO_SAC]
                          3. to read the Initialization Data if it is not disabled by TSF according to
                             FMT_MTD.1/INI_DIS,
                          4. none
CC Document                                           22
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




                          on behalf of the user to be performed before the user is authenticated.

 FIA_UAU.1.2/PACE         The TSF shall require each user to be successfully authenticated before allowing
                          any other TSF-mediated actions on behalf of that user.




 FIA_UAU.4/PACE           Single-use authentication of the Terminals by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.



 FIA_UAU.4.1/PACE         The TSF shall prevent reuse of authentication data related to
                          1. PACE Protocol according to [ICAO_SAC]
                          2. Authentication Mechanism based on Triple-DES and AES
                          3. none




 FIA_UAU.5/PACE           Multiple authentication mechanisms

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.5.1/PACE         The TSF shall provide
                          1. PACE Protocol according to [ICAO_SAC] ,
                          2. Passive Authentication according to [ICAO_9303_1]
                          3. Secure messaging in MAC-ENC mode according to [ICAO_SAC]
                          4. secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                             length
                          5. none
                          to support user authentication.



 FIA_UAU.5.2/PACE         The TSF shall authenticate any user’s claimed identity according to the following
                          rules:
                          1. Having successfully run the PACE protocol the TOE accepts only received
                             commands with correct message authentication code sent by means of secure

CC Document                                          23
                                                                                                    1.2
                                                                                                    2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                             messaging with the key agreed with the terminal by means of the PACE
                             protocol.
                          2. The TOE accepts the authentication attempt as Personalisation Agent by
                             secure channel protocol 03 as specified in [GPv2_3_1] with AES 256 bits key
                             length.
                          3. none

 [IFX specific]           This SFR also specifies the means for authentication of the personalization agent
 Application Note:        that are used during personalization phase which are the scp03 as per [GPv2_3_1],
                          see point 2 of FIA_UAU.5.2/PACE above.




 FIA_UAU.6/PACE           Re-authenticating of Terminal by the TOE

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FIA_UAU.6.1/PACE         The TSF shall re-authenticate the user under the conditions each command sent
                          to the TOE after successful run of thers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                  Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                            22 / 120
NXP Semiconductors
                                                                                                                      JCOP 4.7 SE051
                                                                                                                           Security Target Lite


                   4.2 Threats

                  4.2.1 Integrity

                 4.2.1.1 T.INTEG-APPLI-DATA[REFINED]: Integrity of Application Data

                        The attacker executes an application to alter (part of) another application’s data.
                        Directly threatened asset(s): D.APP_I_ DATA, D.PIN, D.APP_KEYS, D.ISD_KEYS,
                        D.VASD_KEYS and S.APSD_KEYS.
                        This threat is a refinement of the Threat T.INTEG-APPLI-DATA from [6].

                  4.2.2 Unauthorized Execution

                 4.2.2.1 T.MODULE_EXEC: Code Execution of Modules

                        The attacker bypasses the presence check of a Module which is not present with
                        TOE internal interface to execute arbitrary code. See SA.MODULAR-DESIGN and
                        SA.MODULE-INVOCATION for details. Directly threatened asset(s): D.MODULE_
                        CODE.

                  4.2.3 Card Management

                 4.2.3.1 T.UNAUTHORIZED_CARD_MNGT: Unauthorized Card Management

                        The attacker performs unauthorized card management operations (for instance
                        impersonates one of the actor represented on the card) in order to take benefit of the
                        privileges or services granted to this actor on the card such as fraudulent:
                        •   load of a package file
                        •   installation of a package file
                        •   extradition of a package file or an applet
                        •   personalization of an applet or a Security Domain
                        •   deletion of a package file or an applet
                        •   privileges update of an applet or a Security Domain
                        Directly threatened asset(s): D.ISD_KEYS, D.APSD_KEYS, D.APP_C_DATA, D.APP_
                        I_DATA, D.APP_CODE, D.SEC_DATA, and D.CARD_MNGT_DATA (any other asset
                        may be jeopardized should this attack succeed, depending on the virulence of the
                        installed application).
                        This security objective is a refinement of the Threats T.INSTALL and T.DELETION from
                        [6].

                 4.2.3.2 T.COM_EXPLOIT: Communication Channel Remote Exploit

                        An attacker remotely exploits the communication channels established between a third
                        party and the TOE in order to modify or disclose confidential data.
                        All assets are threatened.

                 4.2.3.3 T.LIFE_CYCLE: Life Cycle

                        An attacker accesses to an application outside of its expected availability range thus
                        violating irreversible life cycle phases of the application (for instance, an attacker

JCOP 4.7 SE051                           All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                     Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                               23 / 120
NXP Semiconductors
                                                                                                                     JCOP 4.7 SE051
                                                                                                                          Security Target Lite


                        repersonalizes the application). Directly threatened asset(s): D.APP_I_ DATA,
                        D.APP_C_DATA, and D.CARD_MNGT_DATA.

                  4.2.4 Operating System

                 4.2.4.1 T.OS_OPERATE: Incorrect Operating System Behavior

                        Modification of the correct OS behavior by unauthorized use of TOE or use of incorrect
                        or unauthorized instructions or commands or sequence of commands, in order to obtain
                        an unauthorized execution of the TOE code. An attacker may cause a malfunction of TSF
                        or of the Smart Card embedded OS in order to (1) by-pass the security mechanisms (i.e.
                        authentication or access control mechanisms) or (2) obtain unexpected result from the
                        embedded OS behavior. Different kind of attack path may be used as:
                        1. Applying incorrect unexpected or unauthorized instructions, commands or command
                           sequences,
                        2. Provoking insecure state by insertion of interrupt (reset), premature termination of
                           transaction or communication between IC and the reading device.
                        Info: Any implementation flaw in the OS itself can be exploited with this attack path
                        to lead to an unsecured state of the state machine of the OS. The attacker uses the
                        available interfaces of the TOE. A user could have certain specified privileges that allow
                        loading of selected programs. Unauthorized programs, if allowed to be loaded, may
                        include either the execution of legitimate programs not intended for use during normal
                        operation (such as patches, filters, Trojan horses, etc.) or the unauthorized loading of
                        programs specifically targeted at penetration or modification of the security functions.
                        Attempts to generate a non-secure state in the Smart Card may also be made through
                        premature termination of transactions or communications between the IC and the card
                        reading device, by insertion of interrupts, or by selecting related applications that may
                        leave files open.

                  4.2.5 Random Numbers

                 4.2.5.1 T.RND: Deficiency of Random Numbers

                        An attacker may predict or obtain information about random numbers generated by
                        the TOE for instance because of a lack of entropy of the random numbers provided.
                        An attacker may gather information about the produced random numbers which might
                        be a problem because they may be used for instance to generate cryptographic keys.
                        Here the attacker is expected to take advantage of statistical properties of the random
                        numbers generated by the TOE without specific knowledge about the TOE’s generator.
                        Malfunctions or premature ageing are also considered which may assist in getting
                        information about random numbers.

                  4.2.6 Configuration Module

                 4.2.6.1 T.CONFIG: Unauthorized configuration

                        The attacker tries to change configuration items without authorization. Directly threatened
                        asset(s): D.CONFIG_ITEM.




JCOP 4.7 SE051                          All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                    Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                              24 / 120
NXP Semiconductors
                                                                                                                    JCOP 4.7 SE051
                                                                                                                         Security Target Lite


                  4.2.7 Secure Box

                 4.2.7.1 T.SEC_BOX_BORDER: SecureBox Border Infringement

                        An attacker may try to use malicious code placed in the Secure Box to modify the correct
                        behavior of the Operating System (OS). With the aim to
                        1. disclose the Java Card System code,
                        2. disclose or alter applet code, disclose or alter Java Card System data, or disclose or
                           alter applet data.

                  4.2.8 Module replacement

                 4.2.8.1 T.MODULE_REPLACEMENT: Replacement of Module

                        An attacker loads a Module with functionality differing from a previously deleted Module
                        to bypass TOE Security Functions. See SA.MODULAR-DESIGN for details. Directly
                        threatened assets: D.JCS_DATA.

                   4.3 Organisational Security Policies

                  4.3.1 OSP.PROCESS-TOE: Identification of the TOE
                        An accurate identification must be established for the TOE. This requires that each
                        instantiation of the TOE carries this identification.

                  4.3.2 OSP.KEY-CHANGE: Security Domain Keys Change
                        The Application Provider (AP) shall change its initial security domain keys (APSD) before
                        any operation on its Security Domain.

                  4.3.3 OSP.SECURITY-DOMAINS: Security Domains
                        Security domains can be dynamically created, deleted and blocked during usage phase
                        in post-issuance mode.

                  4.3.4 OSP.SECURE-BOX: Secure Box Border
                        Execution of untrusted native code shall be possible without any harm, manipulation, or
                        influence on other parts of the TOE.

                   4.4 Assumptions
                        Note that the assumption A.DELETION is excluded. The Card Manager is part of the
                        TOE and therefore the assumption is no longer relevant.

                  4.4.1 A.USE_DIAG: Usage of TOE’s Secure Communication Protocol by OE
                        It is assumed that the operational environment supports and uses the secure
                        communication protocols offered by the TOE.




JCOP 4.7 SE051                         All information provided in this document is subject to legal disclaimers.          © NXP B.V. 2020. All rights reserved.

Evaluation document                                   Rev. 1.3 — 30 June 2020
PUBLIC                                                                                                                                             25 / 120
NXP Semiconductors
                                                                                                                    JCOP 4.7 SE051
                                                                                                                         Security Target Lite


                 4.4.2 A.USE_KEYS: Protected Storage of Keys Outside of TOE
                       It is assumed that the keys which are stored outside the TOE and which are used for
                       secure communication and authentication between Smart Card and terminals are
                       protected for confidentiality and integrity in their own storage environment. This is
                       especially true for D.APSD_KEYS, D.ISD_KEYS, and D.VASD_KEYS.
                       Info: This is to assume that the keys used in terminals or systems are correctly
                       protected for confidentiality and integrity in their own environment, as the disclosure of
                       such information which is shared with the TOE but is not under the TOE control, may
                       compromise the security of the TOE.

                 4.4.3 A.PROCESS-SEC-IC: Protection during Packaging, Finishing and
                       Personalisation
                       It is assumed that security procedures are used after delivery of the TOE by the TOE
                       Manufacturer up to delivery to the end consumer to maintain confidentiality and integrity
                       of the TOE and of its manufacturing and test e PACE protocol shall be verified as being sent
                          by the PACE terminal.




7.1.3.3             Class FDP User Data Protection


 FDP_ACC.1/TRM            Subset access control – Terminal Access

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACF.1 Security attribute based access control: fulfilled by FDP_ACF.1/TRM

 FDP_ACC.1.1/TRM          The TSF shall enforce the Access Control SFP on terminals gaining access to the
                          User Data stored in the travel document and EF.SOD

 Application note:        Please note that the Document Security Object (SOD) stored in EF.SOD (see
                          [ICAO_9303_01]) does not belong to the user data, but to the TSF-data. The
                          Document Security Object can be read out by the PACE authenticated BIS-PACE,
                          see [ICAO_9303_01].




CC Document                                          24
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_ACF.1/TRM            Security attribute based access control – Terminal Access

 Hierarchical to:         No other components.

 Dependencies:            FDP_ACC.1 Subset access control: fulfilled by FDP_ACC.1/TRM
                          FMT_MSA.3 Static attribute initialisation: not fulfilled, but justified
                          The access control TSF according to FDP_ACF.1/TRM uses security attributes
                          having been defined during the personalisation and fixed over the whole life time
                          of the TOE. No management of these security attributes (i.e. SFR FMT_MSA.1 and
                          FMT_MSA.3) is necessary here.

 FDP_ACF.1.1/TRM          The TSF shall enforce the Access Control SFP to objects based on the following:
                          1. Subjects:
                                                      a) Terminal,
                                                      b) BIS-PACE;
                          2. Objects:
                                                      a) data in EF.DG1, EF.DG2 and EF.DG5 to EF.DG16 ,
                                                         EF.SOD and EF.COM of the logical travel document
                                                      b) data in EF.DG3 of the logical travel document,
                                                      c) data in EF.DG4 of the logical travel document
                          3. Security attributes:
                                                      a) Authentication status of terminals
                          4. none



 FDP_ACF.1.2/TRM          The TSF shall enforce the following rules to determine if an operation among
                          controlled subjects and controlled objects is allowed:
                          1. A BIS-PACE is allowed to read data objects from FDP_ACF.1/TRM according to
                             [ICAO_SAC] after a successful PACE authentication as required by
                             FIA_UAU.1/PACE.

 FDP_ACF.1.3/TRM          The TSF shall explicitly authorise access of subjects to objects based on the
                          following additional rules: none

 FDP_ACF.1.4/TRM          The TSF shall explicitly deny access of subjects to objects based on the following
                          additional rules:
                          1. Any terminal being not authenticated as PACE authenticated BIS-PACE is not
                             allowed to read, to write, to modify, to use any User Data stored on the travel
                             document.
                          2. Terminals not using secure messaging are not allowed to read, to write, to
                             modify, to use any data stored on the travel document
                          3. None



CC Document                                            25
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FDP_RIP.1                Subset residual information protection

 Hierarchical to:         No other components.

 Dependencies:            No dependencies.

 FDP_RIP.1.1              The TSF shall ensure .Personalisation Agent,
                           3.Terminal,
                           4.PACE authenticated BIS-PACE,
                           5.Country Verifying Certification Authority,
                           6.Document Verifier,
                           7.Domestic Extended Inspection System
                           8.Foreign Extended Inspection System.

 FMT_SMR.1.2/PACE          The TSF shall be able to associate users with roles.




 FMT_LIM.1                Limited capabilities

 Hierarchical to:         No other components.

 Dependencies:            FMT_LIM.2 Limited availability.

 FMT_LIM.1.1              The TSF shall be designed in a manner that limits their capabilities so that in
                          conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                          enforced: Deploying Test Features after TOE Delivery does not allow,
                          1.User Data to be manipulated and disclosed,


CC Document                                           50
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2.TSF data to be disclosed or manipulated,
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed.




 FMT_LIM.2                Limited availability

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_LIM.1 Limited capabilities.

 FMT_LIM.2.1              The TSF shall be designed in a manner that limits their availability so that in
                          conjunction with “Limited capabilities (FMT_LIM.1)” the following policy is
                          enforced:
                          Deploying Test Features after TOE Delivery does not allow:
                          1.User Data to be manipulated and disclosed,
                          2.TSF data to be disclosed or manipulated
                          3.software to be reconstructed,
                          4.substantial information about construction of TSF to be gathered which may
                          enable other attacks and
                          5.sensitive User Data (EF.DG3 and EF.DG4) to be disclosed .




 FMT_MTD.1/CVCA_INI        Management of TSF data – Initialization of CVCA Certificate and Current Date

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions
                           FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_INI      The TSF shall restrict the ability to write the

CC Document                                            51
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                           1.initial Country Verifying Certification Authority Public Key,
                           2.initial Country Verifying Certification Authority Certificate,
                           3.initial Current Date,
                           4. none
                           to Personalisation agent.




 FMT_MTD.1/CVCA_UPD         Management of TSF data – Country Verifying Certification Authority

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functions
                            FMT_SMR.1 Security roles

 FMT_MTD.1.1/CVCA_UPD       The TSF shall restrict the ability to update the
                            1.Country Verifying Certification Authority Public Key,
                            2.Country Verifying Certification Authority Certificate
                            to Country Verifying Certification Authority.




 FMT_MTD.1/DATE             Management of TSF data – Current date

 Hierarchical to:
                            No other components.


 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/DATE           The TSF shall restrict the ability to modify the Current date to
                            1.Country Verifying Certification Authority,
                            2.Document Verifier,
                            3.Domestic Extended Inspection System.




CC Document                                            52
                                                                                                 1.2
                                                                                                 2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FMT_MTD.1/CAPK            Management of TSF data – Chip Authentication Private Key

 Hierarchical to:
                           No other components.


 Dependencies:             FMT_SMF.1 Specification of management functions, FMT_SMR.1 Security roles

 FMT_MTD.1.1/CAPK         The TSF shall restrict the ability to load the Chip Authentication Private Key to
                          Personalisation agent.




 FMT_MTD.1/KEY_READ         Management of TSF data – Key Read

 Hierarchical to:           No other components.

 Dependencies:              FMT_SMF.1 Specification of management functionsFMT_SMR.1 Security roles

 FMT_MTD.1.1/KEY_READ       The TSF shall restrict the ability to read the
                            1.PACE passwords ,
                            2.Chip Authentication Private Key,
                            3.Personalisation Agent Keys
                            to none.




 FMT_MTD.3                Secure TSF data

 Hierarchical to:
                          No other components.


 Dependencies:            FMT_MTD.1 Management of TSF data

 FMT_MTD.3.1              The TSF shall ensure that only secure values of the certificate chain are accepted
                          for TSF data of the Terminal Authentication Protocol v.1 and the Access Control.

 Refinement:              The certificate chain is valid if and only if
                          1. the digital signature of the Inspection System Certificate can be verified as
                          correct with the public key of the Document Verifier Certificate and the expiration
                          date of the Inspection System Certificate is not before the Current Date of the TOE,


CC Document                                             53
                                                                                                       1.2
                                                                                                       2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          2. the digital signature of the Document Verifier Certificate can be verified as
                          correct with the public key in the Certificate of the Country Verifying Certification
                          Authority and the expiration date of the Certificate of the Country Verifying
                          Certification Authority is not before the Current Date of the TOE and the expiration
                          date of the Document Verifier Certificate is not before the Current Date of the TOE,
                          3.the digital signature of the Certificate of the Country Verifying Certification
                          Authority can be verified as correct with the public key of the Country Verifying
                          Certification Authority known to the TOE.
                          The Inspection System Public Key contained in the Inspection System Certificate
                          in a valid certificate chain is a secure value for the authentication reference data of
                          the Extended Inspection System.
                          The intersection of the Certificate Holder Authorizations contained in the
                          certificates of a valid certificate chain is a secure value for Terminal Authorization
                          of a successful authenticated Extended Inspection System.




 FMT_MTD.1/AA
 Management of TSF        Active Authentication Private Key
 data

 Hierarchical to:         No other components.

                          FMT_SMF.1 Specification of management functions: fulfilled by FMT_SMF.1
 Dependencies:
                          FMT_SMR.1 Security roles: fulfilled by FMT_SMR.1/PACE
                          The TSF shall restrict the ability to create and load the Active Authentication
 FMT_MTD.1.1/AA
                          Private Key to the Manufacturer and the Personalisation Agent.

 [IFX specific]           This SFR has been included in this security target in addition to the SFRs defined
                          by the Protection Profiles claimed in section 3.2 to address the import of private
 Application Note:
                          key used for AA. This extension does not conflict with the strict conformance to the
                          claimed Protection Profiles




7.1.5.6             Class FPT Protection of the Security Functions


 FPT_EMS.1                  TOE Emanation

 Hierarchical to:           No other components.

 Dependencies:              No Dependencies.



CC Document                                           54
                                                                                                         1.2
                                                                                                         2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 FPT_EMS.1.1                The TOE shall not emit variations in power consumption or timing during com-
                            mand execution in excess of non-useful information enabling access to
                            1.Chip Authentication Session Keys
                            2.PACE session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s),
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.

 FPT_EMS.1.2                The TSF shall ensure any users are unable to use the following interface smart card
                            circuit contacts to gain access to
                            1.Chip Authentication Session Keys
                            2.PACE Session Keys (PACE-K MAC, PACE-KEnc),
                            3.the ephemeral private key ephem SK PICC-PACE,
                            4.none
                            5.Personalisation Agent Key(s) and
                            6.Chip Authentication Private Key and
                            7. Active Authentication Private Key.




 7.2           Security Assurance Requirements
For the BAC feature, the TOE claims EAL 4 augmented with ALC_DVS.2, therefore [PP_BAC] section 6.2 “Security
Assurance Requirements for the TOE” applies.
For PACE and PACE-EAC features, the current document claims EAL5 augmented with ALC_DVS.2 and
AVA_VAN.5 therefore it claims a higher assurance level compared to [PP_SAC] and [PP_EAC], section 6.2
respectively.




CC Document                                           55
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 7.3          Security Requirements Rationale

7.3.1             Security Functional Requirements Rationale
Respective sections 6.3.1 “Security Functional Requirements Rationale” of [PP_SAC], [PP_BAC] and [PP_EAC]
are applicable for this chapter.
For the additionally defined SFRs in this ST, FIA_API.1/AA, FMT_MTD.1/AA and FCS_COP.1/SIG_GEN formalizing
the Active Authentication feature they meet the security objective OT.Active_Auth.




7.3.2             Rationale for SFR’s Dependencies
[PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.2 “Rationale for SFR’s Dependencies” are also applicable for this
chapter.


7.3.3             Security Assurance Requirements Rationale
[PP_BAC] section 6.3.3 “Security Assurance Requirements Rationale “ is applicable for this chapter.
[PP_EAC] and [PP_SAC] and their respective sections 6.3.3 “Security Assurance Requirements Rationale“ are
also applicable for this chapter with one additional rationale justifying the security assurance dependencies.
With the exception of ALC_DVS.2 and AVA_VAN.5, all assurance components are part of the EAL5 package,
which by package design does not have any dependency conflicts and is hierarchical to EAL4. The assurance
components ALC_DVS.2 and AVA_VAN.5 are also part of the assurance requirements from [PP_SAC], where
assurance dependencies are met as is shown in section 6.3.3 from [PP_SAC].
EAL5+ augmented with ALC_DVS.2 and AVA_VAN.5 is appropriate for this TOE, because this assurance level is
requested by several states. The assurance expectations for this kind of application are high due to the
sensitivity of data stored by the TOE. Therefore several governmental organizations request for an increased
assurance level.


7.3.4              Security Requirements – Internal Consistency
The rationale for the internal consistency of the SFRs from [PP_SAC], [PP_BAC] and [PP_EAC] section 6.3.4
“Security Requirements – Internal Consistency” are also applicable to this chapter.
The assurance package EAL5 and EAL4 are pre-defined sets of internally consistent assurance requirements.
The dependency analysis for the sensitive assurance components in [PP_SAC], [PP_EAC] and [PP_BAC] section
7.3.3 “Security Assurance Requirements Rationale” together with the additional rational from section 7.3.3
show that the assurance requirements are internally consistent as all (additional) dependencies are satisfied
and no inconsistency appears.
The rationale for internal consistency between functional and assurance requirements from [PP_SAC] ,
[PP_EAC] and and [PP_BAC] section 6.3.4 “Security Requirements – Internal Consistency” are also applicable to
this chapter.




CC Document                                            56
                                                                                                        1.2
                                                                                                        2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




    8             TOE Summary Specification
This TOE summary specification described in this section relies on the security services provided by the
platform product. For a description of these services please refer to [ST_JC_ID_S_Platform].
In the following each SFR is mentioned together with an indication for the PP from which these are originating
        -   (BAC) stands for SFRs originating from [PP_BAC].
        -   (SAC) stands for SFRs originating from [PP_SAC].
        -   (EAC) stands for SFRs originating from [PP_EAC]. Note that we include here also in this group the SFRs
            related to Active Authentication.
The composite TOE provides the security functions as follows:
       SF_EAC_PACE_BAC
The TOE implements the EAC, PACE and BAC protocol (PICC side). It encompasses:
        -   ECDH key generation, FCS_CKM.1/DH_PACE (SAC) and FCS_CKM.1/CA (EAC): The TOE uses the
            platform service “Elliptic Curves EC” for EC key generation. Further for session key generation the
            application uses the hybrid physical random number generator of the platform complying to PTG.3 as
            per [AIS31]. For the key generation the TOE supports “Generic Mapping” provided by the platform.
        -   Generation of Document Basic Access Keys, FCS_CKM.1 (BAC), FCS_COP.1/SHA (BAC): The TOE uses
            the cryptographic APIs provided by the underlying Secora ID S OS.
        -   Key destruction, FCS_CKM.4: The TOE uses the platform API ‘clearKey’ service to destroy session keys.
            The platform API ‘clearKey’ uses random numbers compliant to PTG.3 as per [AIS31] to overwrite the
            session keys.
        -   Provision of random numbers, as per FCS_RND.1. Authentication failure handling, FIA_AFL.1/PACE
            (SAC), FIA_AFL.1 (BAC): The TOE implements this check in such a way, that it withstands tearing events.
            A counter for unsuccessful authentication attempts is incremented before authentication is performed
            and reset in case of successful authentication.
        -   Prevention of replay attacks, FIA_UAU.4/PACE (EAC), FIA_UAU.4/PACE (SAC), FIA_UAU.4 (BAC):
            Replay attacks are prevented by the cryptographic protocol, which relies on good quality random
            numbers as required by FCS_RND.1 of this ST and supported by the underlying RNG of the platform and
            claimed in the ST of the platform with SFR FCS_RNG.1.
        -   Multiple authentication, FIA_UAU.5/PACE (EAC), FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE
            follows the protocol as described in [ICAO_SAC].
 SF_AA
  - Signature generation for the Active Authentication mechanism covered by FIA_API.1/AA,
     FCS_COP.1/SIG_GEN
  - Injecting private cryptographic keys used for the signatures as per FMT_MTD.1/AA
 SF_AuthPersoAgent
  - FIA_UAU.5/PACE (EAC) , FIA_UAU.5/PACE (SAC), FCS_COP.1/AUTH (BAC): The TOE uses the protocol
     scp v0.3 as per [GPv2_3_1] based on AES [FIPS_197] for authenticating the personalization agent.




CC Document                                                57
                                                                                                           1.2
                                                                                                           2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



   SF_SecureMessaging
    - Secure messaging, encryption/decryption, FCS_COP.1/PACE_ENC (SAC), FCS_COP.1/ENC (BAC): The
       TOE uses the proprietary PACE API from Secora ID S OS.
    - Secure messaging integrity protection, FCS_COP.1/PACE_MAC (SAC), FCS_COP.1/MAC (BAC): The TOE
       uses the underlying platform PACE dedicated API to calculate CMAC or Retail-MAC.
    - FCS_COP.1/CA_ENC (EAC), FCS_COP.1/CA_MAC (EAC) and FCS_COP.1/SIG_VER (EAC) are satisfied by
       using the standard Java Card API supported by the platform.
    - FCS_COP.1/CA_MAC (EAC) also covers to the GP scp03 used for secure card content management
       during personalization. This aspect of secure messaging by the TOE relies on the specially tailored API
       to GP SCP from the underlying platform and described in the SFR FCS_COP.1/SCP.
    - Multiple authentication, FIA_UAU.5/PACE (SAC), FIA_UAU.5 (BAC): The TOE performs a MAC check for
       every received message before instruction is executed, if the MAC check fails secure messaging is
       aborted; every response during secure messaging is MAC’ed by the TOE.
    - Re-authentication of terminal, FIA_UAU.6/EAC (EAC), FIA_UAU.6/PACE (SAC), FIA_UAU.6 (BAC): The
       TOE checks for every incoming message, whether the message is genuine (MAC check).
    - Trusted channel, FTP_ITC.1/PACE (SAC): The TOE follows the standardized implementation of the
       trusted channel according to [ICAO_SAC].

   SF_AccessControl
    - Allow specific access before user identification, FIA_UID.1/PACE (EAC), FIA_UID.1/PACE (SAC),
       FIA_UID.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess (see
       [ICAO_9303_11]) and EF.ATR/INFO (see [ISO7816-4]) before PACE or BAC authentication is performed.
       The TOE allows to read a specific subset of initialization data.
    - Allow specific access before user authentication, FIA_UAU.1/PACE (EAC), FIA_UAU.1/PACE (SAC),
       FIA_UAU.1 (BAC): The access rights information of the TOE grant access to EF.CardAccess and
       EF.ATR/INFO before PACE or BAC authentication was performed. The TOE allows to read a specific
       subset of initialization data.
    - Subset and security attribute based access control, FDP_ACC.1/TRM (EAC), FDP_ACC.1/TRM (SAC),
       FDP_ACC.1 (BAC), FDP_ACF.1/TRM (EAC), FDP_ACF.1/TRM (SAC), FDP_ACF.1 (BAC), the TOE blocks
       access to EF.DG1, EF.DG2 and EF.DG5 to EF.DG16, EF.SOD and EF.COM, EF.DG3 and EF.DG4 in case BAC
       or PACE protocol is not successfully performed.
    - Residual information protection, FDP_RIP.1: as soon secure messaging is stopped, the whole secure
       messaging context including session keys is wiped with random numbers.
    - Data exchange confidentiality, FDP_UCT.1/TRM (SAC), FDP_UCT.1 (BAC): during secure messaging,
       responses by the ICC are always wrapped (encrypted and MAC’ed) before being sent.
    - Data exchange integrity, FDP_UIT.1/TRM (SAC), FDP_UIT.1 (BAC) : during secure messaging, responses
       by the ICC are always wrapped (encrypted and MAC’ed) before being sent. A MAC check is performed for
       each message received during secure messaging.
    - Storage of initialization and pre-personalisation data, FAU_SAS.1 (SAC), FAU_SAS.1/BAC (BAC):
       [PP_BAC] requests storage of IC Identification data, whereas [PP_SAC] requests storage of Initialisation
       and Pre-Personalisation data, whereby IC Identification data is a subset of Initialisation data. The TOE
       does not make any distinction, whether BAC or PACE is performed, i.e. stores all of the requested data.
       The TOE at its stage of delivery (Personalisation stage) contains a Personalisation key. The
       Personalisation agent has the option to calculate various checksums including software, file system,
       chip information and lifecycle information.
    - Management functions linked to different life cycle states, FMT_SMF.1 (SAC), FMT_SMF.1/BAC (BAC):
       The management functions “Initialization” and “pre-Personalisation” are part of the developer
       lifecycle.
CC Document                                           58
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



   - Access is linked to security roles, FMT_SMR.1/PACE (EAC), FMT_SMR.1/PACE (SAC), FMT_SMR.1 (BAC):
     Access rights are implemented such, that they depend on lifecycle stage and authentication stage (e.g.
     whether PACE authentication or authentication as Personalisation agent was successfully performed).
     Certain commands are blocked during specific lifecycle states, such as the command to read the
     Initialisation data or update file data in operation state. Read access to specific files is granted or
     denied depending on the authentication state. Life cycle transition from Personalisation to operation
     stage can only be performed by the Personalisation agent. A back transition is blocked.
  - Writing of initialization and pre-personalisation data restricted to manufacturer, FMT_MTD.1/INI_ENA:
     during Personalisation and operation there is no command available to write initialization data (e.g.
     create files). Card manager keys can be updated in personalization phase. Note that personalization
     keys are the card manager/ issuer security domain key and therefore are not owned by the applet.
  - Reading of initialization and pre-personalisation data restricted to Personalisation agent,
     FMT_MTD.1/INI_DIS (SAC) and Disabling of Read Access to Initialization Data to the Personalisation
     agent FMT_MTD.1/INI_DIS/BAC (BAC): Although these two SFRs have slightly different meanings, the
     TOE generally blocks reading of initialization and pre-Personalisation data in operation mode. Only the
     Personalisation agent is granted to set the lifecycle state from Personalisation to operation. A back
     transition is blocked.
  - Reading of EAC, PACE or BAC keys and Personalisation agent key not possible, FMT_MTD.1/KEY_READ
     (EAC), FMT_MTD.1/KEY_READ (SAC), FMT_MTD.1/KEY_READ/BAC (BAC): The Personalisation key,
     PACE passwords, Document Basic Access Keys for BAC, Chip Authentication Private Key for EAC are
     stored in a special key storage within the platform, which only allows to handle this key by reference;
     no read access is performed by the application.
  - Only Personalisation agent allowed to write Document Security Object (SOD), FMT_MTD.1/PA: In
     operation mode the “STORE DATA” command is blocked.
  - Only Personalisation agent allowed to write Document Basic Access Keys, FMT_MTD.1/KEY_WRITE
     (BAC): in operation stage the proprietary commdata (to prevent any possible copy,
                       modification, retention, theft or unauthorised use). This means that the Phases after TOE
                       Delivery are assumed to be protected appropriately.
                       The assets to be protected are: The information and material produced and/or processed
                       by the Security IC Embedded Software Developer in Phase 1 and by the Composite
                       Product Manufacturer can be grouped as follows:
                       1. the Security IC Embedded Software including specifications, and to write Document Basic Access Keys is blocked.
  - FMT_MTD.1.1/CVCA_INI (EAC)requires that the TSF shall restrict the ability to write the initial Country
     Verifying Certification Authority Public Key, the initial Country Verifying Certification Authority
     Certificate, and the initial Current Date to the Personalization Agent. Access over to this data is a
     subject to an access control.
  - FMT_MTD.1.1/CVCA_UPD (EAC)requires that the TSF shall restrict the ability to update the Country
     Verifying Certification Authority Public Key and the Country Verifying Certification Authority Certificate
     to the Country Verifying Certification Authority. SF_AccessControl realizes the appropriate control over
     the access rights.
  - FMT_MTD.1.1/DATE (EAC)requires that the TSF shall restrict implementation anthe ability to modify the Current date to
     the Country Verifying Certification Authority, the Document Verifier, and the Domestic Extended
     Inspection System. SF_AccessControl realizes the appropriate control over the access rights.
  - FMT_MTD.1.1/CAPK (EAC)requires that the TSF shall restrict the ability to load the Chip Authentication
     Private Key to the Personalization Agent. SF_AccessControl realizes the appropriate control over the
     access rights.
  - FMT_MTD.3 (EAC) that the TSF shall ensure that only secure values of the certificate chain are accepted
     for TSF data of the Terminal Authentication Protocol and the Access Control as described in the
     refinement of the SFR.
 SF_DataProtection
  - TSF is designed, that it has limited capability and limited availability, FMT_LIM.1 (EAC), FMT_LIM.2
     (EAC), FMT_LIM.1 (SAC), FMT_LIM.1/BAC (BAC), FMT_LIM.2 (SAC), FMT_LIM.2/BAC (BAC): in
     Personalisation stage only limited test functionality is available. CRC on the personalized data groups
     can be retrieved during personalization phase only.

CC Document                                           59
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



   -   Side channel protection, FPT_EMS.1 (EAC), FPT_EMS.1 (SAC), FPT_EMSEC.1 (BAC): The TOE uses the
       platform service “SF_Physical” which relies on its side on the hardware to reduce the side channel
       leakage.
   -   Prevention of malfunction, FPT_FLS.1 (SAC), FPT_FLS.1/BAC (BAC): The TOE uses the platform service
       “SF_Physical” which relies on its side on the hardware to detect
   -   Self-tests, FPT_TST.1: During startup of the Secora ID S OS the UMSLC (User Mode Security Life Control)
       selftest offered by the hardware platform is performed.
   -   Physical protection, FPT_PHP.3: The TOE uses the platform services “SF_Physical”.




CC Document                                          60
                                                                                                     1.2
                                                                                                     2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0




 9              References

 9.1            Literature


 [AIS31]                  Functionality classes and evaluation methodology for physical random number
                          generators
                          AIS31, Version 2.1, 2011-12-02, Bundesamt für Sicherheit in der
                          Informationstechnik.

 [CCPart2]                Common Criteria for Information Technology Security Evaluation Part 2: Security
                          Functional Requirements; Version 3.1 Revision 5 April 2017, CCMB-2017-04-002

 [CCPart3]                Common Criteria for Information Technology Security Evaluation Part 3: Security
                          Assurance Requirements; Version 3.1 Revision 5 April 2017, CCMB-2017-04-003

 [CompositeEvaluation]    Composite product evaluation for Smart Cards and similar devices, April 2012,
                          Version 1.2, CCDB-2012-04-001
                          EU – eMRTD Specification. ANNEX to the Commission Implementing Decision
 [EU-eMRTD]
                          laying down the technical specifications regarding the standards for security
                          features and biometrics in passports and travel documents issued by Member
                          States and repealing Decisions C(2006) 2909 and C(2008) 8657
 [TR_ECC]                 Federal Office for Information Security (BSI) TR-03111 Elliptic Curve Cryptography
                          Version 2.0, 2012-06-28

 [ICAO_SAC]               International Civil Aviation Organization Machine Readable Travel
                          DocumentsTechnical Report Supplemental Access Control for Machine Readable
                          Travel Documents Version 1.00, November 2010

 [ICAO_9303_01]           ICAO Doc 9303, Machine Readable Travel Documents, part 1 – Machine Readable
                          Passports, Seventh Edition, 2015, International Civil Aviation Organization

 [ICAO_9303_10]           International Civil Aviation Organization, DOC 9303 Machine Readable Travel
                          Documents Seventh Edition – 2015, Part 10: Logical Data Structure (LDS) for
                          Storage of Biometrics and Other Data in the Contactless Integrated Circuit (IC)

 [ICAO_9303_11]           International Civil Aviation Organization, DOC 9303 Machine Readable Travel
                          Documents Seventh Edition – 2015 Part 11: Security Mechanisms for MRTD's

 [ISO9797-1]              ISO/IEC International Standard 9797-1:2011-(E), Information technology – Security
                          techniques – Message Authentication Codes (MACs) – Part 1: Mechnanisms using a
                          block cipher, Second Edition 2011-03-01

 [ISO14443-3]             ISO/IEC International Standard 14443-3 Identification cards -- Contactless
                          integrated circuit(s) cards -- Proximity cards -- Part 3: Initialization and
                          anticollisionFirst edition 2001-02-01, AMENDMENT 1: Bit rates of fc/64, fc/32 and
CC Document                                          61
                                                                                                      1.2
                                                                                                      2020-05-27
Security Target
ePassport configuration of SECORA™ ID S Infineon Applet Collection - eMRTD V1.0



                          fc/16 2005-06-01, ISO/IEC Defect Report and Technical Corrigendum 1 for
                          International 2005-12-16, AMENDMENT 3: Handling of reserved fields and valud
                          related documentation,
                       2. pre-personalisation and personalisation data including specifications of formats and
                          memory areas, test related data,
                       3. the User Data and related documentation, and
                       4. material for software development support
  es
                          2006-03-15

 [ISO9796-2]              ISO/IEC International Standard ISO9796-2 Information technolo                   gy --  as long a hardware based nor SCL based). In case the crypto@2304T is blocked, no RSA and EC computation supported by
hardware is possible. The use of the SHA-2 library is also possible with both crypto coprocessors blocked. No accessibility
of the deselected cryptographic coprocessors is without impact on any other security policy of the TOE; it is exactly
equivalent to the situation where the user decides just not to use the cryptographic Coprocessors.


The TOE shall provide “Area based Memory Access Control (O.Mem-Access)” as specified below.

      O.Mem-Access               Area based Memory Access Control

                                 The TOE must provide the Smartcard Embedded Software with the capability to define
                                 restricted access memory areas. The TOE must then enforce the partitioning of such
                                 memory areas so that access of software to memory areas and privilege levels is
                                 controlled as required, for example, in a multi-application environment.


                        Table 13: Additional objectives due to TOE specific functions and augmentations

                           O.Add-Functions            Additional specific security functionality

                           O.Mem-Access               Area based Memory Access Control


5.2      Security Objectives for the Development and Operational Environment

The security objectives for the security IC Embedded Software development environment and the operational
environment is defined in PP [1] section 4.2 and 4.3. The table below lists the security objectives.
                               Table 14: Security objectives for the environment according to PP [1]

                                             OE.Plat-Appl                 Usage of Hardware Platform
                 Phase 1
                                             OE.Resp-Appl                 Treatment of User Data

                 Phase 5 – 6 optional                                     Protection during composite product
                                             OE.Process-Sec-IC
                 Phase 4                                                  manufacturing




Security Target Lite                                             43                                              2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

5.2.1         Clarification of “Usage of Hardware Platform (OE.Plat-Appl)”
Regarding the cryptographic services this objective of the environment has to be clarified. The TOE supports cipher
schemes as additional specific security functionality. If required the Smartcard Embedded Software shall use these
cryptographic services of the TOE and their interface as specified. When key-dependent functions implemented in the
Smartcard Embedded Software are just being executed, the Smartcard Embedded Software must provide protection
against disclosure of confidential data (User Data) stored and/or processed in the TOE by using the methods described
under “Inherent Information Leakage (T.Leak-Inherent)” and “Forced Information Leakage (T.Leak-Forced)“.
The objectives of the environment regarding the memory, software and firmware protection and the SFR and peripheral-
access-rights-handling have to be clarified. For the separation of different applications the Smartcard Embedded Software
(Operating System) may implement a memory management scheme based upon security functions of the TOE.


5.2.2         Clarification of “Treatment of User Data (OE.Resp-Appl)”
Regarding the cryptographic services this objective of the environment has to be clarified. By definition cipher or plain
text data and cryptographic keys are User Data. The Smartcard Embedded Software shall treat these data appropriately,
use only proper secret keys (chosen from a large key space) as input for the cryptographic function of the TOE and use
keys and functions appropriately in order to ensure the strength of cryptographic operation.
This means that keys are treated as confidential as soon as they are generated. The keys must be unique with a very high
probability, as well as cryptographically strong. For example, it must be ensured that it is beyond practicality to derive the
private key from a public key if asymmetric algorithms are used. If keys are imported into the TOE and/or derived from
other keys, quality and confidentiality must be maintained. This implies that appropriate key management has to be
realized in the environment.
Regarding the memory, software and firmware protection and the SFR and peripheral access rights handling these
objectives of the environment has to be clarified. The treatment of User Data is also required when a multi-application
operating system is implemented as part of the Smartcard Embedded Software on the TOE. In this case the multi-
application operating system should not disclose security relevant user data of one application to another application
when it is processed or stored on the TOE.


5.2.3         Clarification of “Protection during composite product manufacturing
                 (OE.Process-Sec-IC)”
The protection during packaging, finishing and personalization includes also the personalization process (Flash Loader
software) and the personalization data (TOE software components) during Phase 4, Phase 5 and Phase 6.




Security Target Lite                                         44                                                   2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

5.3      Security Objectives Rationale

The security objectives rationale of the TOE are defined and described in PP [1] section 4.4. For the additional objectives
of this ST a rational is provided below.
                                           Table 15: Security Objective Rationale
                       Assumption, Threat or Organisational
                       Security Policy                                Security Objective
                       P.Add-Functions                                O.Add-Functions
                                                                      OE.Plat-Appl
                       A.Key-Function
                                                                      OE.Resp-Appl
                       T.Mem-Access                                   O.Mem-Access


The justification related to the security objective “Additional Specific Security Functionality (O.Add-Functions)” is as
follows: Since O.Add-Functions requires the TOE to implement exactly the same specific security functionality as required
by P.Add-Functions; the organizational security policy is covered by the objective.
Nevertheless the security objectives O.Leak-Inherent, O.Phys-Probing, O.Malfunction, O.Phys-Manipulation and O.Leak-
Forced define how to implement the specific security functionality required by P.Add-Functions. (Note that these
objectives support that the specific security functionality is provided in a secure way as expected from P.Add-Functions.)
Especially O.Leak-Inherent and O.Leak-Forced refer to the protection of confidential data (User Data or TSF data) in
general. User Data are also processed by the specific security functionality required by P.Add-Functions.
Compared to PP [1] clarification has been made for the security objective “Usage of Hardware Platform (OE.Plat-Appl)”: If
required the Smartcard Embedded Software shall use these cryptographic services of the TOE and their interface as
specified. In addition, the Smartcard Embedded Software must implement functions which perform operations on keys (if
any) in such a manner that they do not disclose information about confidential data. The non-disclosure due to leakage
A.Key-Function attacks is included in this objective OE.Plat-Appl. This addition ensures that the assumption A.Plat-Appl is
still covered by the objective OE.Plat-Appl although additional functions are being supported according to O.Add-
Functions.
Compared to the PP [1] a clarification has been made for the security objective “Treatment of User Data (OE.Resp-Appl)”:
By definition cipher or plain text data and cryptographic keys are User Data. So, the Smartcard Embedded Software will
protect such data if required and use keys and functions appropriately in order to ensure the strength of cryptographic
operation. Quality and confidentiality must be maintained for keys that are imported and/or derived from other keys.
This implies that appropriate key management has to be realized in the environment. That is expressed by the
assumption A.Key-Function which is covered from OE.Resp-Appl. These measures make sure that the assumption A.Resp-
Appl is still covered by the security objective OE.Resp-Appl although additional functions are being supported according
to P.Add-Functions.
Compared to the PP [1] an enhancement regarding memory area protection has been established. The clear definition of
privilege levels for operated software establishes the clear separation of different restricted memory areas for running
the firmware, downloading and/or running the operating system and to establish a clear separation between different

Security Target Lite                                          45                                               2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

applications. Nevertheless, it is also possible to define a shared memory section where separated applications may
exchange defined data. The privilege levels clearly define by using a hierarchical model the access right from one level to
the other. These measures ensure that the threat T.Mem-Access is clearly covered by the security objective O.Mem-
Access.
The justification of the additional policy and the additional assumption show that they do not contradict to the rationale
already given in the Protection Profile for the assumptions, policy and threats defined there.




Security Target Lite                                         46                                                2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public


6          Extended Component Definition (ASE_ECD)

There are four extended components defined and described for the TOE:
          the family FCS_RNG at the class FCS Cryptographic Support
          the family FMT_LIM at the class FMT Security Management
          the family FAU_SAS at the class FAU Security Audit
          the component FPT_TST.2 at the class FPT Protection of the TSF
The extended components FCS_RNG, FMT_LIM and FAU_SAS are defined and described in PP [1] section 5. The
component FPT_TST.2 is defined in the following.


6.1       Component “Subset TOE Security Testing (FPT_TST.2)”

The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall support
that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests can be initiated
by the Smartcard Embedded Software and/or by the TOE or is done automatically and continuously.
Part 2 of the Common Criteria provides the security functional component “TSF testing (FPT_TST.1)”. The component
FPT_TST.1 provides the ability to test the TSF’s correct operation.
For the user it is important to know which security functions or mechanisms can be tested. The functional component
FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires
verification of the integrity of TSF data and of the stored TSF executable code which might violate the security policy.
Therefore, the functional component “Subset TOE security testing (FPT_TST.2)” of the family TSF self-test has been newly
created. This component allows that particular parts of the security mechanisms and functions provided by the TOE are
tested.


6.2       Definition of FPT_TST.2

The functional component “Subset TOE security testing (FPT_TST.2)” has been newly created (Common Criteria Part 2
extended). This component allows that particular parts of the security mechanisms and functions provided by the TOE can
be tested after TOE Delivery or are tested automatically and continuously during normal operation transparent for the
user.
This security functional component is used instead of the functional component FPT_TST.1 from Common Criteria Part 2.
For the user it is important to know which security functions or mechanisms can be tested. The functional component
FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires
verifying the integrity of TSF data and stored TSF executable code which might violate the security policy.
The functional component “Subset TOE testing (FPT_TST.2)” is specified as follows (Common Criteria Part 2 extended).




Security Target Lite                                            47                                            2020-10-21
                                                                                                                  M7892 B11
                                                                                                          Security Target Lite

public

6.2.1         TSF Self-Test (FPT_TST)
Family Behavior The Family Behavior is defined in [3] section 15.14 (442, 443).
Component leveling



                                                                                                          1
                                FPT_TST         TSF self test
                                                                                                          2

     FPT_TST.1         The component FPT_TST.1 is defined in [3] section 15.14 (444, 445, 446).

     FPT_TST.2         Subset TOE security testing, provides the ability to test the correct operation of particular
                       security functions or mechanisms. These tests may be performed at start-up, periodically, at the
                       request of the authorized user, or when other conditions are met. It also provides the ability to
                       verify the integrity of TSF data and executable code.
                       Management: FPT_TST.2
                       The following actions could be considered for the management functions in FMT:
                               Management of the conditions under which subset TSF self-testing occurs, such as
                                during initial start-up, regular interval or under specified conditions
                               Management of the time of the interval appropriate.
                       Audit: FPT_TST.2

                       There are no auditable events foreseen.



     FPT_TST.2                 Subset TOE Testing

     Hierarchical to           No other components.

     Dependencies:             No dependencies to other components.

     FPT_TST.2.1               The TSF shall run a suite of self-tests [selection: during initial start-up, periodically
                               during normal operation, at the request of the authorized user, and/or at the conditions
                               [assignment: conditions under which self-test should occur]] to demonstrate the correct
                               operation of [assignment: functions and/or mechanisms].




Security Target Lite                                            48                                                  2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public


7         Security Requirements (ASE_REQ)

For this section the PP [1] section 6 can be applied completely.


7.1      TOE Security Functional Requirements

The security functional requirements (SFR) for the TOE are defined and described in the PP [1] section 6.1 and in the
following description.
The Table 15 provides an overview of the functional security requirements of the TOE, defined in the in PP [1] section 6.1.
In the last column it is marked if the requirement is refined. The refinements are also valid for this ST.
                                 Table 16: Security functional requirements defined in PP [1]

                              Security Functional Requirement                                Refined in PP [1]

           FRU_FLT.2        “Limited fault tolerance“                                                Yes

           FPT_FLS.1        “Failure with preservation of secure state”                              Yes

           FMT_LIM.1        “Limited capabilities”                                                   No

           FMT_LIM.2        “Limited availability”                                                   No

           FAU_SAS.1        “Audit storage”                                                          No

           FPT_PHP.3        “Resistance to physical attack”                                          Yes

           FDP_ITT.1        “Basic internal transfer protection”                                     Yes

           FPT_ITT.1        “Basic internal TSF data transfer protection                             Yes

           FDP_IFC.1        “Subset information flow control”                                        No

           FCS_RNG.1        “Random Number Generation”                                               No


The Table 16 provides an overview about the augmented security functional requirements, which are added
supplemental to the TOE and defined in this ST. All requirements are taken from Common Criteria Part 2 [3], with the
exception of the requirement FPT_TST.2, which is defined in this ST completely.
                                   Table 17: Augmented security functional requirements

                                              Security Functional Requirement

            FPT_TST.2                                    “Subset TOE security testing“

            FDP_ACC.1                                    “Subset access control”

            FDP_ACF.1                                    “Security attribute based access control”

            FMT_MSA.1                                    “Management of security attributes”

            FMT_MSA.3                                    “Static attribute initialization”

            FMT_SMF.1                                    “Specification of Management functions”


Security Target Lite                                          49                                                 2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

                                           Security Functional Requirement

           FCS_COP.1/TDES                             “Cryptographic support -TDES”

           FCS_COP.1/AES                              “Cryptographic support - AES”

           FCS_COP.1/TDES_SCL                         “Cryptographic support TDES-SCL”

           FCS_COP.1/AES_SCL                          “Cryptographic support AES-SCL”

           FCS_COP.1/RSA-v1.02.013                    “Cryptographic support - RSA”

           FCS_COP.1/RSA-v2.07.003                    “Cryptographic support - RSA”

           FCS_CKM.1/RSA-v2.07.003                    “Cryptographic key management - EC”

           FCS_COP.1/ECDSA-v1.02.013                  “Cryptographic support - ECDSA”

           FCS_COP.1/ECDSA-v2.07.003                  “Cryptographic support - ECDSA”

           FCS_COP.1/ECDH-v1.02.013                   “Cryptographic support - ECDH”

           FCS_COP.1/ECDH-v2.07.003                   “Cryptographic support - ECDH”

           FCS_CKM.1/EC-v1.02.013                     “Cryptographic key management - EC”

           FCS_CKM.1/EC-v2.07.003                     “Cryptographic key management - EC”

           FCS_COP.1/SHA                              “Cryptographic support - SHA”

           FCS_CKM.4/TDES                             “Cryptographic key destruction - TDES”

           FCS_CKM.4/AES                              “Cryptographic key destruction - AES”

           FCS_CKM.4/TDES_SCL                         “Cryptographic key destruction –TDES-SCL”

           FCS_CKM.4/AES_SCL                          “Cryptographic key destruction - AES-SCL”

           FDP_SDI.1                                  “Stored data integrity monitoring”

           FDP_SDI.2                                  “Stored data integrity monitoring and action”


All assignments and selections of the security functional requirements of the TOE are either done in the PP [1] or in the
following description.


7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1
7.1.1.1 FCS_RNG
To define the IT security functional requirements of the TOE an additional family (FCS_RNG) of the Class FCS
(cryptographic support) is defined as an extended component in the PP [1]. This family describes the functional
requirements for random number generation used for cryptographic purposes. The PP [1] does already provide an
instance of this SFR with a completed selection and a partially completed assignment. The instance of FCS_RNG.1 that will
be used within this ST is completed according to AIS31 [5]. The element FCS_RNG.1.1 was subject of an editorial
refinement in order to provide an easy integration of the PTG.2 class from AIS31 [5]. Furthermore the element


Security Target Lite                                       50                                                2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public

FCS_RNG.1.2 was functionally refined, which is indicated by the underlined text. This refinement does specify the format
of the provided random numbers and does not mitigate the security functional requirement, as defined in the PP [1]. The
Security Target is still strict conformant to the PP [1], as the refined FCS_RNG.1 still meets the requirement as defined in
the PP [1].

 FCS_RNG.1                   Random number generation

 Hierarchical to             No other components.

 Dependencies:               No dependencies.

 FCS_RNG.1                   Random numbers generation Class PTG.2 according to [5]

 FCS_RNG.1.1                 The TSF shall provide a physical random number generator that implements:

                               PTG.2.1          A total failure test detects a total failure of entropy source
                                   immediately when the RNG has started. When a total failure is detected, no random
                                   numbers will be output.

                               PTG.2.2          If a total failure of the entropy source occurs while the RNG is being
                                   operated, the RNG prevents the output of any internal random number that
                                   depends on some raw random numbers that have been generated after the total
                                   failure of the entropy source.

                               PTG.2.3          The online test shall detect non-tolerable statistical defects of the raw
                                   random number sequence (i) immediately when the RNG has started, and (ii) while
                                   the RNG is being operated. The TSF must not output any random numbers before
                                   the power-up online test has finished successfully or when a defect has been
                                   detected.

                               PTG.2.4          The online test procedure shall be effective to detect non-tolerable
                                   weaknesses of the random numbers soon.

                               PTG.2.5 The online test procedure checks the quality of the raw random number
                                   sequence. It is triggered continuously. The online test is suitable for detecting non-
                                   tolerable statistical defects of the statistical properties of the raw random numbers
                                   within an acceptable period of time.

 FCS_RNG.1.2                 The TSF shall provide numbers in the format 8- or 16-bit that meet:

                               PTG.2.6          Test procedure A, as defined in [5] does not distinguish the internal
                                   random numbers from output sequences of an ideal RNG.

                               PTG.2.7          The average Shannon entropy per internal random bit exceeds 0.997.
Note:
The physical random number generator implements total failure test of the random source and a continuous RNG test
according to following standard:



Security Target Lite                                          51                                                   2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

National Institute of Standards and Technology, Security Requirements for Cryptographic Modules, Federal Information
Processing Standards Publication (FIPS) 140-2 [31], 2002-12-03, chapter 4.9.2.

7.1.1.2 FAU_SAS
To define the security functional requirements of the TOE an additional family (FAU_SAS) of the Class FAU (Security Audit)
is defined here. This family describes the functional requirements for the storage of audit data. It has a more general
approach than FAU_GEN, because it does not necessarily require the data to be generated by the TOE itself and because
it does not give specific details of the content of the audit records.
The TOE shall meet the requirement “Audit storage (FAU_SAS.1)” as specified below (Common Criteria Part 2 extended).

 FAU_SAS.1                    Audit Storage

 Hierarchical to              No other components.

 Dependencies:                No dependencies.

 FAU_SAS.1.1                  The TSF shall provide the test process before TOE Delivery with the capability to store
                              the Initialization Data and/or Pre-personalization Data and/or supplements of the
                              Security IC Embedded Software in the not changeable configuration page area and non-
                              volatile memory.


7.1.2          Subset of TOE Testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall support
that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests can be initiated
by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria Part 2
extended).

 FPT_TST.2                    Subset TOE testing

 Hierarchical to              No other components.

 Dependencies:                No dependencies.

 FPT_TST.2.1                  The TSF shall run a suite of self-tests at the request of the authorized user to
                              demonstrate the correct operation of the alarm lines and/or following environmental
                              sensor mechanisms:
                              Please refer to the confidential Security Target [39].


7.1.3          Memory Access Control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent that one
application can access code and/or data of another application. For this reason the TOE provides Area based Memory
Access Control. The underlying memory management unit (MMU) is documented in section 4 of the hardware reference
manual [6].


Security Target Lite                                           52                                             2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

The security service being provided is described in the Security Function Policy (SFP) Memory Access Control Policy. The
security functional requirement “Subset access control (FDP_ACC.1)” requires that this policy is in place and defines the
scope were it applies. The security functional requirement “Security attribute based access control (FDP_ACF.1)” defines
security attribute usage and characteristics of policies. It describes the rules for the function that implements the Security
Function Policy (SFP) as identified in FDP_ACC.1. The decision whether an access is permitted or not is taken based upon
attributes allocated to the software. The Smartcard Embedded Software defines the attributes and memory areas. The
corresponding permission control information is evaluated “on-the-fly” by the hardware so that access is
granted/effective or denied/inoperable.
The security functional requirement “Static attribute initialization (FMT_MSA.3)” ensures that the default values of
security attributes are appropriately either permissive or restrictive in nature. Alternative values can be specified by any
subject provided that the Memory Access Control Policy allows that. This is described by the security functional
requirement “Management of security attributes (FMT_MSA.1)”. The attributes are determined during TOE
manufacturing (FMT_MSA.3) or set at run-time (FMT_MSA.1).
From TOE’s point of view the different roles in the Smartcard Embedded Software can be distinguished according to the
memory based access control. However the definition of the roles belongs to the user software.
The following Security Function Policy (SFP) Memory Access Control Policy is defined for the requirement “Security
attribute based access control (FDP_ACF.1)”:
 Memory Access Control
 Policy

                              The TOE shall control read, write, delete and execute accesses of software running at
                              the privilege levels as defined below. Any access is controlled, regardless whether the
                              access is on code or data or a jump on any other privilege level outside the current one.

                              The memory model provides distinct, independent privilege levels separated from each
                              other in the virtual address space. More information is given in the confidential Security
                              Target [39].




The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below.

 FDP_ACC.1                    Subset access control

 Hierarchical to              No other components.

 Dependencies:                FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy on all subjects (software
                              running at the defined and assigned privilege levels), all objects (data including code
                              stored in memories) and all the operations defined in the Memory Access Control Policy,
                              i.e. privilege levels.



Security Target Lite                                         53                                                   2020-10-21
                                                                                                                          M7892 B11
                                                                                                                  Security Target Lite

public

The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below.

    FDP_ACF.1                           Security attribute based access control

    Hierarchical to                     No other components.

    Dependencies:                       FDP_ACC.1 Subset access control
                                        FMT_MSA.3 Static attribute initialization

    FDP_ACF.1.1                         The TSF shall enforce the Memory Access Control Policy to objects based on the
                                        following:
                                        Subject:
                                                  Software running at the IFX, OS1 and OS2 privilege levels required to securely
                                                   operate the chip. This includes also privilege levels running interrupt routines.
                                                  Software running at the privilege levels containing the application software
                                        Object:
                                                  Data including code stored in memories
                                        Attributes:
                                                  The memory area where the access is performed to and/or
                                                  The operation to be performed.

    FDP_ACF.1.2                         The TSF shall enforce the following rules to determine if an operation among controlled
                                        subjects and controlled objects is allowed:
                                        evaluate the corresponding permission control information of the relevant memory
                                        range before, during or after the access so that accesses to be denied can not be utilized
                                        by the subject attempting to perform the operation.

    FDP_ACF.1.3                         The TSF shall explicitly authorize access of subjects to objects based on the following
                                        additional rules: none.

    FDP_ACF.1.4                         The TSF shall explicitly deny access of subjects to objects based on the following
                                        additional rules: none.


The TOE shall meet the requirement “Static attribute initialization (FMT_MSA.3)” as specified below.

    FMT_MSA.3                           Static attribute initialization

    Hierarchical to                     No other components.

    Dependencies:                       FMT_MSA.1 Management of security attributes
                                        FMT_SMR.1 Security roles
                                                                                                                             1
    FMT_MSA.3.1                         The TSF shall enforce the Memory Access Control Policy to provide well defined default
                                        values for security attributes that are used to enforce the SFP.


1
    The static definition of the access rules is documented in [6]



Security Target Lite                                                      54                                                     2020-10-21
                                                                                                                                M7892 B11
                                                                                                                        Security Target Lite

public

    FMT_MSA.3.2                      The TSF shall allow any subject, provided that the Memory Access Control Policy is
                                                                                                          1
                                     enforced and the necessary access is therefore allowed , to specify alternative initial
                                     values to override the default values when an object or information is created.


The TOE shall meet the requirement “Management of security attributes (FMT_MSA.1)” as specified below:

    FMT_MSA.1                        Management of security attributes

    Hierarchical to                  No other components.

    Dependencies:                    [FDP_ACC.1 Subset access control or
                                     FDP_IFC.1 Subset information flow control]
                                     FMT_SMF.1 Specification of management functions
                                     FMT_SMR.1 Security roles

    FMT_MSA.1.1                      The TSF shall enforce the Memory Access Control Policy to restrict the ability to change
                                     default, modify or delete the security attributes permission control information to the
                                     software running on the privilege levels.


The TOE shall meet the requirement “Specification of management functions (FMT_SMF.1)” as specified below:

    FMT_SMF.1                        Specification of management functions

    Hierarchical to                  No other components.

    Dependencies:                    No dependencies.

    FMT_SMF.1.1                      The TSF shall be capable of performing the following security management functions:
                                     access the configuration registers of the MMU.




7.1.4              Support of Cipher Schemes
The following additional specific security functionality is implemented in the TOE:
FCS_COP.1 Cryptographic operation requires a cryptographic operation to be performed in accordance with a specified
algorithm and with a cryptographic key of specified sizes. The specified algorithm and cryptographic key sizes can be
based on an assigned standard; dependencies are discussed in Section 7.3.1.1 “Dependencies of Security Functional
Requirements”.
The following additional specific security functionality is implemented in the TOE:
                                                         2
            Advanced Encryption Standard (AES)
                                                             2
            Triple Data Encryption Standard (TDES)


1
    The Smartcard Embedded Software is intended to set the memory access control policy
2
    The TOE provides a solely hardware based AES and TDES implementation and the AES and TDES calculations provided by the SCL.



Security Target Lite                                                      55                                                      2020-10-21
                                                                                                                                    M7892 B11
                                                                                                                            Security Target Lite

public
                                                     1
            Elliptic Curve Cryptography (EC)
                                                 1
            Rivest-Shamir-Adleman (RSA)
            Secure Hash Algorithm (SHA-2)
Note that the additional function of the EC library, providing the primitive elliptic curve operations, does not add specific
security functionality.
Note:
This TOE can come with both crypto coprocessors accessible, or with a blocked SCP or with a blocked crypto@2304T, or
with both crypto coprocessors blocked. The blocking depends on the customer demands prior to the production of the
hardware. In case the SCP is blocked, no AES and TDES computation supported by hardware is possible (neither solely
hardware based nor SCL based). In case the crypto@2304T is blocked, no RSA and EC computation supported by
hardware is possible. In case of a blocked crypto@2304T the optionally delivered cryptographic and the supporting
Toolbox and Base Library cannot be used in that TOE product. The use of the SHA-2 library is also possible with both
crypto coprocessors blocked. No accessibility of the deselected cryptographic coprocessors is without impact on any
other security policy of the TOE; it is exactly equivalent to the situation where the user decides just not to use the
cryptographic coprocessors.




1
    For the case the TOE comes without RSA and/or EC library, the TOE provides basic HW-related routines for RSA and/or EC calculations. For a secure
library implementation the user has to implement additional countermeasures himself.



Security Target Lite                                                        56                                                             2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

7.1.4.1 Triple-DES Operation
The DES Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and “Cryptographic key
destruction (FCS_CKM.4)”as specified below.

 FCS_COP.1/TDES              Cryptographic operation - TDES

 Hierarchical to             No other components.

 Dependencies:               [FDP_ITC.1 Import of user data without security attributes, or
                             FDP_ITC.2 Import of user data with security attributes, or
                             FCS_CKM.1 Cryptographic key management]
                             FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/TDES            The TSF shall perform encryption and decryption in accordance with a specified
                             cryptographic algorithm Triple Data Encryption Standard (TDES) in the Electronic
                             Codebook Mode (ECB), the Cipher Block Chaining Mode (CBC), the Blinding Feedback
                             Mode (BLD), the Recrypt Mode, the Cipher Block Chaining Mode (CBC-MAC), the CBC-
                             MAC- encrypt-last-block (CBC-MAC-ELB) mode and cryptographic key sizes of 2 x 56 bit
                             or 3 x 56 bit, that meet the following standards:

                                     Triple Data Encryption Standard (TDES):
                                      National Institute of Standards and Technology (NIST) SP 800-67 Rev. 2 [22].

                                     Block Cipher Modes: ECB, CBC
                                      National Institute of Standards and Technology (NIST) SP 800-38A [28].

                                     Block Cipher Modes: BLD, Recrypt
                                      Proprietary, a description is given in the hardware reference manual HRM [6].

                                     Block Cipher Modes: CBC-MAC, CBC-MAC-ELB: [34]
Note:
This SFR applies to the solely hardware based TDES calculation and is not applicable if the TOE is delivered with a blocked
SCP.
For more information about the implementation of CBC-MAC-ELB see [15].




Security Target Lite                                        57                                                  2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/TDES                Cryptographic key destruction – TDES

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4.1/TDES              The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                               key destruction method overwriting or zeroing that meets the following:

                               None
Note:
This SFR applies to the solely hardware based TDES and is not applicable if the TOE is delivered with a blocked SCP. The
key destruction can be done by overwriting the key register interfaces or by a software reset of the SCP, which provides
immediate zeroing of all SCP key registers.



 FCS_COP.1/TDES_SCL            Cryptographic operation - TDES_SCL

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key management]
                               FCS_CKM.4 Cryptographic key destruction.

 FCS_COP.1.1/TDES_SCL          The TSF shall perform encryption and decryption in accordance with a specified
                               cryptographic algorithm Triple Data Encryption Standard (TDES) in the Electronic
                               Codebook Mode (ECB), in the Cipher Block Chaining Mode (CBC), Cipher Feedback
                               (CFB) and Counter (CTR) Modes and cryptographic key sizes of 112 bit and 168 bit that
                               meet the following standards:

                                       Triple Data Encryption Standard (TDES):
                                        National Institute of Standards and Technology (NIST) SP 800-67 Rev. 2 [22].
                                       Block Cipher Modes: ECB, CBC, CFB, CTR:
                                        National Institute of Standards and Technology (NIST) SP 800-38A [28].
Note:
This SFR refers to the TDES calculations provided by the optional symmetric cryptographic library (SCL) and is not
applicable if the TOE is delivered with a blocked TDES SCP or without SCL.




Security Target Lite                                        58                                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/TDES_SCL           Cryptographic key destruction – TDES_SCL

 Hierarchical to:             No other components.

 Dependencies:                [FDP_ITC.1 Import of user data without security attributes, or
                              FDP_ITC.2 Import of user data with security attributes, or
                              FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4/TDES_SCL           The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                              key destruction method overwriting or zeroing that meets the following:

                              None
Note:
This SFR refers to the TDES provided by the optional symmetric cryptographic library (SCL) and is not applicable if the TOE
is delivered with a blocked SCP or without SCL. The key destruction can be done by overwriting the key register interfaces
or by software reset of the SCP which provides immediate zeroing of all SCP key registers. The data object stored in the
memory of the TOE can be destroyed using the “Cipher_Close()” function of the SCL.




Security Target Lite                                        59                                                  2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

7.1.4.2 AES Operation
The AES Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and “Cryptographic key
destruction (FCS_CKM.4)” as specified below.

 FCS_COP.1/AES                   Cryptographic operation - AES

 Hierarchical to                 No other components.

 Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                 FDP_ITC.2 Import of user data with security attributes, or
                                 FCS_CKM.1 Cryptographic key generation]
                                 FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/AES                 The TSF shall perform encryption and decryption in accordance with a specified
                                 cryptographic algorithm Advanced Encryption Standard (AES) in the Electronic Codebook
                                 Mode (ECB), the Cipher Block Chaining Mode (CBC), the Blinding Feedback Mode (BLD),
                                 the Recrypt Mode, the Cipher Block Chaining Mode (CBC-MAC), the CBC-MAC- encrypt-
                                 last-block (CBC-MAC-ELB) mode and cryptographic key sizes of 128 bit or 192 bit or 256
                                 bit that meet the following standards:

                                         Advanced Encryption Standard (AES)
                                          U.S. Department of Commerce, National Institute of Standards and Technology,
                                          Information Technology Laboratory (ITL),
                                          Advanced Encryption Standard (AES), FIPS 197 [23]

                                         Block Cipher Modes: CBC, ECB
                                          National Institute of Standards and Technology (NIST) SP 800-38A [28].

                                         Block Cipher Modes: BLD, Recrypt
                                          Proprietary, a description is given in the hardware reference manual HRM [6].

                                         Block Cipher Modes: CBC-MAC, CBC-MAC-ELB: [34]
Note:
This SFR refers to the solely hardware based AES calculation and is not applicable if the TOE is delivered with a blocked
SCP.
For more information about the implementation of CBC-MAC-ELB see [15].


 FCS_CKM.4/AES          Cryptographic key destruction – AES
 Hierarchical to:       No other components.
 Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or
                        FDP_ITC.2 Import of user data with security attributes, or
                        FCS_CKM.1 Cryptographic key generation]
 FCS_CKM.4.1/AES        The TSF shall destroy cryptographic keys in accordance with a specified cryptographic key



Security Target Lite                                         60                                                  2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

                        destruction method overwriting or zeroing that meets the following:
                        None
Note:
This SFR refers to the solely hardware based AES and is not applicable if the TOE is delivered with a blocked SCP. The key
destruction can be done by overwriting the key register interfaces or by a software reset of the SCP, which provides
immediate zeroing of all SCP key registers.



 FCS_COP.1/AES_SCL             Cryptographic operation – AES_SCL

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key generation]
                               FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/AES_SCL           The TSF shall perform encryption and decryption in accordance with a specified
                               cryptographic algorithm Advanced Encryption Standard (AES) in the Electronic
                               Codebook Mode (ECB), Cipher Block Chaining Mode (CBC), Counter Mode (CTR) and
                               Cipher Feedback Mode (CFB) and cryptographic key sizes of 128 bit or 192 bit or 256 bit
                               that meet the following standards:

                                      Advanced Encryption Standard (AES):
                                       U.S. Department of Commerce, National Institute of Standards and
                                       Technology, Information Technology Laboratory (ITL),
                                       Advanced Encryption Standard (AES), FIPS 197 [23]
                                      Block Cipher Modes: ECB, CBC, CTR, CFB
                                       National Institute of Standards and Technology (NIST) SP 800-38A [28]
Note:
This SFR applies to the AES calculations provided by the optional symmetric cryptographic library (SCL) and is not
applicable if the TOE is delivered with a blocked SCP or without SCL.




Security Target Lite                                         61                                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/AES_SCL           Cryptographic key destruction – AES_SCL

 Hierarchical to:            No other components.

 Dependencies:               [FDP_ITC.1 Import of user data without security attributes, or
                             FDP_ITC.2 Import of user data with security attributes, or
                             FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4.1/AES_SCL         The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                             key destruction method overwriting or zeroing that meets the following:

                             None
Note:
This SFR refers to the AES provided by the optional symmetric cryptographic library (SCL) and is not applicable if the TOE
is delivered with a blocked SCP or without SCL. The key destruction can be done by overwriting the key register interfaces
or by software reset of the SCP which provides immediate zeroing of all SCP key registers. The data object stored in the
memory of the TOE can be destroyed using the “Cipher_Close()” function of the SCL.




Security Target Lite                                        62                                                  2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public

7.1.4.3 Rivest-Shamir-Adleman (RSA) Operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” as
specified below.

                                     Valid for cryptographic library version v1.02.013:
 FCS_COP.1/RSA-        Cryptographic operation
 v1.02.013


 Hierarchical to:      No other components.


 Dependencies:         [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/RSA-      The TSF shall perform encryption and decryption in accordance with a specified cryptographic
 v1.02.013             algorithm Rivest-Shamir-Adleman (RSA) and cryptographic key sizes 1024- 4096 bits that meet the
                       following standards:

                       Encryption (for key sizes up to 2048):
                       According to section 5.1.1 RSAEP in PKCS [21] without 5.1.1.1.

                       Decryption (with or without CRT):
                       According to section 5.1.2 RSADP in PKCS [21] for u = 2, i.e., without any (r_i, d_i, t_i), i >2,
                                                                                                                      2048
  med of the signatory’s verification authenti-
cation data (VAD) required for use of the TOE in signing. If the VAD is a password or PIN, the means of
providing this information is expected to protect the confidentiality and the integrity of the corresponding
RAD.

If the use of an SCD is no longer required, then it should be destroyed (e.g. by erasing it from memory) as
well as the associated certificate info, if any exists.

1.4.5 Operation of the TOE
This paragraph presents a functional overview of the TOE in its distinct operational environments:


                                                     8 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


       The preparation environment, where the TOE interacts with a certification service provider (CSP)
        through a SCD/SVD generation application to import the signature creation data (SCD) and a certif-
        icate generation application (CGA) to obtain a certificate for the signature validation data (SVD)
        corresponding to the SCD the certification service provider has generated. The SCD/SVD generation
        application transmits the SVD to the CGA. The initialisation environment interacts further with the
        TOE to personalise it with the initial value of the reference authentication data (RAD).
       The signing environment where the TOE interacts with a signer through a signature creation appli-
        cation (SCA) to sign data after authenticating the signer as its signatory. The signature creation ap-
        plication provides the data to be signed (DTBS), or a unique representation thereof (DTBS/R) as
        input to the TOE signature creation function and obtains the resulting digital signature2.
       The management environments where the TOE interacts with the user or an SSCD-provisioning ser-
        vice provider to perform management operations, e.g. for the signatory to reset a blocked RAD. A
        single device, e.g. a smart card terminal, may provide the required secure environment for man-
        agement and signing.
The preparation environment, the signing environment and the management environment are secure and
protect data exchanged with the TOE. Figure 3 in prEN 14169-1:2011 illustrates the operational environ-
ment.
The TOE stores signature creation data (SCD) and reference authentication data (RAD). The TOE may store
multiple instances of SCD. In this case the TOE provides a function to identify each SCD and the SCA can
provide an interface to the signer to select an SCD for use in the signature creation function of the SSCD.
The TOE protects the confidentiality and integrity of the SCD and restricts its use in signature creation to its
signatory. The digital signature created by the TOE may be used to create an advanced electronic signature
as defined in Article 5.1 of the [Directive]3. Determining the state of the certificate as qualified is beyond
the scope of this standard.
The signature creation application is assumed to protect the integrity of the input it provides to the TOE
signature creation function as being consistent with the user data authorised for signing by the signatory.
Unless implicitly known to the TOE, the SCA indicates the kind of the signing input (as DTBS/R) it provides
and computes any hash value required. The TOE may augment the DTBS/R with signature parameters it
stores and then computes a hash value over the input as needed by the kind of input and the used crypto-
graphic algorithm.
The TOE stores signatory reference authentication data (RAD) to authenticate a user as its signatory. The
RAD is a password (e.g. PIN), a biometric template or a combination of these. The TOE protects the confi-
dentiality and integrity of the RAD. The TOE may provide a user interface to directly receive verification
authentication data (VAD) from the user, alternatively, the TOE receive the VAD from the signature creation
application (SCA). If the signature creation application handles, is requesting or obtaining a VAD from the
user, it is assumed to protect the confidentiality and integrity of this data.
A certification service provider and a SSCD-provisioning service provider interact with the TOE in the secure
preparation environment to perform any preparation function of the TOE required before control of the
TOE is given to the legitimate user. These functions may include:
       initialising the RAD,
       generating a key pair,

2 At a pure functional level the SSCD creates a digital signature; for an implementation of the SSCD, in that
meeting the requirements of this PP and with the key certificate created as specified in the Directive, Annex
I, the result of the signing process can be used as to create a qualified electronic signature.
3Please note that while this security target - following the according protection profile BSI-CC-PP-0075-
2012-MA-01 - references the [Directive], it also incorporates the requirements of the eIDAS regulation [Re-
gulation] and the according commission implementing regulation [Implementing].

                                                     9 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


         storing personal information of the legitimate user.
In the case at hand the TOE is a smart card or electronic ID document. In this case a smart-card terminal
may be deployed that provides the required secure environment to handle a request for signatory authori-
zation. A signature can be obtained on a document prepared by a signature-creation application component
running on personal computer connected to the card terminal. The signature creation application, after
presenting the document to the user and after obtaining the authorization PIN initiates the electronic sig-
nature creation function of the smart card through the terminal.
The RAD verification is typically performed by direct PIN verification (VERIFY PIN command); to further pro-
tect the RAD (password or PIN) – especially in a contactless application scenario – the Password Authenti-
cated Connection Establishmanet (PACE) protocol according to [TR03110] can be used.

1.4.6 Major security features of the TOE
The TOE provides the following TOE security functionalities:
         TSF_Access manages the access to objects (files, directories, data and secrets) stored in the applet’s
          file system. It also controls write access of initialization, pre-personalization and personalization
          data4.
         TSF_Admin manages the storage of manufacturing data, pre-personalization data and personaliza-
          tion data.
         TSF_Secret ensures secure management of secrets such as cryptographic keys. This covers secure
          key storage, access to keys as well as secure key deletion. These mechanisms are mainly provided
          by TSF_OS.
         TSF_Crypto performs high level cryptographic operations. The implementation is mainly based on
          the Security Functionalities provided by TSF_OS.
         TSF_SecureMessaging realizes a secure communication channel.
         TSF_Auth realizes two authentication mechanisms: PIN verification and alternatively authentication
          with the PACE protocol.
         TSF_Integrity protects the integrity of internal applet data like the Access control lists.
         TSF_OS contains all security functionalities provided by the certified platform (IC, Javacard opera-
          tion system). The cryptographic operations needed for this TOE are provided by the platform:
              o   Electronic signature-generation with RSA and key sizes of 2000 up to 4096 bit in steps of 1
                  bit, or ECDSA with key sizes of key sizes of 160 bit to 521 bit in steps of one bit.
              o   Secure messaging with AES (128, 192 or 256 bit key length).
              o   PACE authentication with key lengths of 160 bit to 521 bit in steps o Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                                                  4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................12
   3. Security Policy............................................................................................................15
   4. Assumptions and Clarification of Scope.....................................................................15
   5. Architectural Information.............................................................................................16
   6. Documentation...........................................................................................................16
   7. IT Product Testing.......................................................................................................16
   8. Evaluated Configuration.............................................................................................17
   9. Results of the Evaluation............................................................................................18
   10. Obligations and Notes for the Usage of the TOE.....................................................19
   11. Security Target..........................................................................................................20
   12. Regulation specific aspects (eIDAS, QES)..............................................................20
   13. Definitions.................................................................................................................20
   14. Bibliography..............................................................................................................23
C. Excerpts from the Criteria..............................................................................................26

D. Annexes.........................................................................................................................27




                                                                                                                                 5 / 33
Certification Report                                                               BSI-DSZ-CC-0879-V4-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carriedf one bit (ECC).

1.4.7 TOE life cycle
This paragraph is based on the protection profile [PP0075].

1.4.7.1    General



4 In the context of this security target the three categories are defined as follows: initialization comprises
the preparation of the TOE based on proprietary operations of the platform with the Java Card operation
system; pre-personalization comprises the configuration of the card manager and security domains as well
as the generation of applet instances using Global Platform commands. Personalization is carried out after-
wards using commands of the applet layer of the TOE.

                                                     10 of 82
 NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


The TOE life cycle distinguishes stages for development, production, preparation and operational use. The
development and production of the TOE (cf. CC part 1 [CC_1], para.139) together constitute the develop-
ment phase of the TOE.


   Hardware
   development
   and certifica-
                                                                                            NXP      eDoc
   tion
                                                 Javacard OS                                Suite v3.5 on
                           Guidance                                                         JCOP4 - cryp-
                                                 development
                           manuals,                                                         tovision
                                                 and certifica-
                           samples                                                          ePasslet
                                                 tion
                                                                          Guidance          Suite devel-
                                                                          manuals,          opment and
                                                                          samples           certification
                           Secure de-
                           livery     of
   Hardware                chips as cer-         Secure pro-
   production              tified in CC          duction     of
                           hardware              chips with Ja-           Secure de-
                           certification         vacard OS and            livery of ap-
                                                 NXP      eDoc            plet code as
                                                 Suite v3.5 on            certified in
                                                 JCOP4 - cryp-            CC applet
                                                 tovision                 certification
                                                 ePasslet Suite
                                                 in       Flash
                                                 memory


Figure 2: Overview of the development phase of the TOE, which contains development and production
of the TOE. After the secure production following the process certified for the Javacard OS, the chips are
delivered to the SSCD provisioning service using the delivery process already established for the OS. Gray
boxes indicate the steps which are subject to evaluation according to the assurance life cycle (ALC) class.



The development phase is subject of CC evaluation according to the assurance life cycle (ALC) class.


The development phase ends with the delivery of the TOE to an SSCD-provisioning service provider or a
card manufacturer. This is also the end of the scope of the certification according to Common Criteria.




                                                     11 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite




          CSP                                Development phase (see fig. 2)
      SCD/SVD GA
  SCD/SVD generation                                                    Delivery to SSCD provisioning service
  SCD export
  SVD export                      SSCD preparation
                                  Installation of SSCD             Personalisation for the
                                  SCD/SVD import                   signatory

                                  SVD import*                      RAD installation

                                  import of certificate info       VAD definition

          CSP
           CGA                                                         Delivery to Signatory
 Certificate generation
 Directory service                SSCD operational use

                                              Operational usage of SCD
                                              Signature creation

                                              Destruction of SCD
                                              destruction of SCD
                                              deletion of certificate info


                                                        Usage phase


Figure 3: Example of TOE lifecycle following figure 1 of [PP0075]. Note that import of certificate info during
TOE preparation and deletion of certificate info when SCD is destroyed are optional. The delivery to the
SSCD provisioning service after the development phase is also the end of the scope of the certification ac-
cording to Common Criteria.

The operational usage of the TOE comprises the preparation stage and the operational use stage. The TOE
operational use stage begins when the signatory has obtained both the VAD and the TOE. Enabling the TOE
for signing requires at least one set of SCD stored in its memory.
Figure 3 shows an example of the lifecycle where an SCD or SCD/SVD pair is imported from SSCD-
provisioning service before delivery to the signatory. The lifecycle may allow import of SCD or SCD/SVD key
pairs after delivery to the signatory as well.
The TOE life cycle ends when all keys stored in it have been rendered permanently unusable. Rendering a
key in the SSCD unusable may include deletion of any stored corresponding certificate info. The lifecycle
may allow generation of SCD or SCD/SVD key pairs after delivery to the signatory as well.

1.4.7.2   Preparation stage
The preparation phase of the TOE lifecycle is processing the TOE from the customer's acceptance of the
delivered TOE to a state ready for operation by the signatory. The customer receiving the TOE from the


                                                    12 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


manufacturer is the SSCD-provisioning service that prepares and provides the SSCD to subscribers. The
preparation includes
         Create and configure the signature application according to AGD_PRE; this step involves applet
          instanciation as well as creation of the file system (card profile).5
         The personalisation of the TOE for use by the signatory, i.e. the installation of the RAD in the TOE
          and handover of VAD to the signatory.
         The initialisation of the TOE, i.e. the CSP generates the SCD/SVD pair by means of a SCD/SVD gen-
          eration device, loads the SCD to the TOE, and sends the SVD to the CGA. The TOE may import and
          store the SCD/SVD pair.
         The generation of the (qualified) certificate containing among others (cf. [1], Annex II)
              a) the SVD which correspond to SCD under the control of the signatory;
              b) the name of the signatory or a pseudonym, which is to be identified as such,
              c) an indication of the beginning and end of the period of validity of the certificate.

         The preparation may include optional loading of the certificate info into the SSCD for signatory con-
          venience.
The CSP generates a SCD/SVD pair and imports SCD, and optionally also SVD, into the SSCD. The CSP ensures
          a) the correspondence between SCD and SVD,
          b) that algorithm and key size for the SVD are appropriate.

Please take note that verifying whether the claimed identity of the signer originates from that given SSCD
has to be done by the CSP operating the CGA.
If the TOE is used for creation of advanced electronic signatures, the certificate links the signature verifica-
tion data to the person (i.e. the signatory) and confirms the identity of that person (cf. [Directive], article 2,
Clause 9).
This security target requires the TOE to provide mechanisms for import of SCD, implementation of the SCD
and personalisation. The environment is assumed to protect all other processes for TOE preparation like
SCD transfer between the SCD/SVD generation device and the TOE, and SVD transfer between the SCD/SVD
generation device and the CGA. The CSP may export the SVD to the TOE for internal use by the TOE (e.g.,
self-test).
Before generating a (qualified) certificate, the CSP is expected to first store the SCD in a SSCD. A secure
channel with the TOE may be used to support this, by ensuring integrity of the SCD during transmission to
the TOE.

1.4.7.3    Operational use stage
In this lifecycle stage the signatory can use the TOE to create advanced electronic signatures.
The operational phase of the TOE starts when at least one SCD/SVD pair is generated by the CSP and the
SCD is imported into the SSCD and when the signatory takes control over the TOE and makes the SCD oper-
ational. The signatory uses the TOE with a trustworthy SCA in a secured environment only. The SCA is as-
sumed to protect the DTBS/R during the transmission to the TOE.




5 This preparation step has been added to the life cycle definition of the underlying Protection Profile and
is necessary to provide the basic functionality (i.e. application and file system) for the following steps. It
may be performed by the SSCD-provisioning service provider directly or by a separate entity (card manu-
facturer).

                                                    13 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


The signatory can also interact with the SSCD to perform management tasks, e.g. reset a RAD value or use
counter if the password/PIN in the reference data has been lost or blocked. Such management tasks require
a secure environment.
The signatory can render an SCD in the TOE permanently un out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BSI Schedule of Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]
●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.

1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     Schedule of Cost for Official Procedures of the Bundesamt für Sicherheit in der Informationstechnik
     (BSI-Kostenverordnung, BSI-KostV) of 3 March 2005, Bundesgesetzblatt I, p. 519



                                                                                                           6 / 33
BSI-DSZ-CC-0879-V4-2020                                                              Certification Report




●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.
This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 33
Certification Report                                                       BSI-DSZ-CC-0879-V4-2020




4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-0879-V3-2018. Specific
results from the evaluation process BSI-DSZ-CC-0879-V3-2018 were re-used.
The evaluation of the product Infineon Security Controller M7893 B11 with optional
RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
Toolbox v2.03.008 and with specific IC dedicated software (firmware), was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 11 February 2020.
TÜV Informationstechnik GmbH is an evaluation facility (ITSEF) 5 recognised by the
certification body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and in the Security Target.
For the meaning of the assurance components and assurance levels please refer to CC
itself. Detailed references are listed in part C of this report.
The Certificate issued confirms the assurance of the product claimed in the Security Target
at the date of certification. As attack methods evolve over time, the resistance of the
certified version of the product against new attack methods needs to be re-assessed.
Therefore, the sponsor should apply for the certified product being monitored within the
assurance continuity program of the BSI Certification Scheme (e.g. by a re-assessment or
re-certification). Specifically, if results of the certification are used in subsequent evaluation
and certification procedures, in a system integration process or if a user's risk
management needs regularly updated results, it is recommended to perform a re-
assessment on a regular e.g. annual basis.
In order to avoid an indefinite usage of the certificate when evolved attack methods would
require a re-assessment of the products resistance to state of the art attack methods, the
maximum validity of the certificate has been limited. The certificate issued on 12 February
2020 is valid until 11 February 2025. Validity can be re-newed by re-certification.
The owner of the certificate is obliged:

5
     Information Technology Security Evaluation Facility



                                                                                             8 / 33
BSI-DSZ-CC-0879-V4-2020                                                        Certification Report




     1. when advertising the certificate or the fact of the product's certification, to refer to
        the Certification Report as well as to provide the Certification Report, the Security
        Target and user guidance documentation mentioned herein to any customer of the
        product for the application and usage of the certified product,
     2. to inform the Certification Body at BSI immediately about vulnerabilities of the
        product that have been identified by the developer or any third party after issuance
        of the certificate,
     3. to inform the Certification Body at BSI immediately in the case that security relevant
        changes in the evaluated life cycle, e.g. related to development and production sites
        or processes, occur, or the confidentiality of documentation and information related
        to the Target of Evaluation (TOE) or resulting from the evaluation and certification
        procedure where the certification of the product has assumed this confidentiality
        being maintained, is not given any longer. In particular, prior to the dissemination of
        confidential documentation and information related to the TOE or resulting from the
        evaluation and certification procedure that do not belong to the deliverables
        according to the Certification Report part B, or for those where no dissemination
        rules have been agreed on, to third parties, the Certification Body at BSI has to be
        informed.
In case of changes to the certified version of the product, the validity can be extended to
the new versions and releases, provided the sponsor applies for assurance continuity (i.e.
re-certification or maintenance) of the modified product, in accordance with the procedural
requirements, and the evaluation does not reveal any security deficiencies.

6.      Publication
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has been included in the BSI list of
certified products, which is published regularly (see also Internet: https://www.bsi.bund.de
and [5]). Further information can be obtained from BSI-Infoline +49 228 9582-111.
Further copies of this Certification Report can be requested from the developer 6 of the
product. The Certification Report may also be obtained in electronic form at the internet
address stated above.




6
     Infineon Technologies AG
     Am Campeon 1-12
     85579 Neubiberg



                                                                                              9 / 33
Certification Report                                                    BSI-DSZ-CC-0879-V4-2020




B.      Certification Results
The following results represent a summary of
●   the Security Target of the sponsor for the Target of Evaluation,
●   the relevant evaluation results from the evaluation facility, and
●   complementary notes and stipulations of the certification body.




                                                                                         10 / 33
usable. Rendering the last SCD in the TOE per-
manently unusable ends the life of the TOE as SSCD.
The TOE may support functions to generate additional signing keys. If the TOE supports these functions it
will support further functions to securely obtain certificates for the new keys. For an additional key the
signatory may be allowed to choose the kind of certificate (qualified, or not) to obtain for the SVD of the
new key. The signatory may also be allowed to choose some of the data in the certificate request for in-
stance to use a pseudonym instead of the legal name in the certificate5. If the conditions to obtain a quali-
fied certificate are met, the new key can also be used to create advanced electronic signatures. The optional
TOE functions for additional key generation and certification may require additional security functions in
the TOE and an interaction with the SSCD-provisioning service provider in an environment that is secure.
The TOE life cycle as SSCD ends when all SCD stored in the TOE are destructed. This may include deletion of
the corresponding certificates.




                                                    14 of 82
NXP eDoc Suite v3.5 on JCOP4 P71 / SSCD with Key Import Security Target Lite


2 Conformance claims

2.1 CC conformance
This security target claims conformance6 to:
     Common Criteria for Information Technology Security Evaluation, Part 1: Introduction and General
        Model; Version 3.1, Revision 5, April 2017; CCMB-2017-04-001, [CC_1],
       NXP Secure Smart Card Controller
   P60D024/016/012yVB(Y/Z/A)/yVF
   Security Target Lite
   Rev. 4.4 — 29 October 2018                            Evaluation documentation
   BSI-DSZ-CC-0939-V3                                                    PUBLIC




Document information
Info                 Content
Keywords            CC, Security Target Lite, P60D024/016/012yVB(Y/Z/A)/yVF
Abstract            Security Target Lite of the
                    NXP Secure Smart Card Controller P60D024/016/012yVB(Y/Z/A)/yVF,
                    which is developed and provided by NXP Semiconductors according to
                    the Common Criteria for Information Technology Security Evaluation
                    Version 3.1 at Evaluation Assurance Level 6 augmented.
NXP Semiconductors                             P60D024/016/012yVB(Y/Z/A)/yVF
                                                                                                                   Security Target Lite



Revision history
Rev         Date                 Description
Rev. 4.1    23-November-2015     Derived from P60D024/016/012yVB(Y/Z/A)/yVF Security Target
Rev. 4.2    29-May-2018          Revise wording for access control policy SFRs to be consistent with datasheet MMU
                                 errata update
Rev. 4.3    21-June-2018         This ST now claims compliance to CC v3.1 Rev. 5
                                 Improve consistency in SFR wording
                                 Clarify read/write access permission
                             BSI-DSZ-CC-0879-V4-2020                                                           Certification Report




1.     Executive Summary
The Target of Evaluation (TOE) is an Infineon Security Controller M7893 B11 with optional
Software Library RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010
libraries, and Toolbox v2.03.008, as well as with speci    FCS.COP.1[HW_DES] now claims compliance to NIST SP800-67
Rev. 4.4    29-October-2018      Update access control SFRs to reflect three access permissions enforeced by MMU

Latest version is: Rev. 4.4 (29 October 2018)




Contact information
For additional information, please visit: http://www.nxp.com
For sales office addresses, please send an email to: salesaddresses@nxp.com
                                      All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2018. All rights reserved.

Evaluation documentation                          Rev. 4.4 — 29 October 2018                                                                  2 of 87
PUBLIC
NXP Semiconductors                                           P60D024/016/012yVB(Y/Z/A)/yVF
                                                                fic IC dedicated software (firmware).
The TO                                                             Security Target Lite




1. ST Introduction
             E p00005h
         IFX_CCI_000008h
         IFX_CCI_00000Ch
         IFX_CCI_000013h
         IFX_CCI_000014h
         IFX_CCI_000015h
         IFX_CCI_00001Ch
         IFX_CCI_00001Dh
         IFX_CCI_000021h
      IFX_CCI_000022h
in the design step H13 and including optional software libraries and dedicated firmware in several versions as
stated and assigned in the table below.

In order to ease the readability of this document the bunch of Common Criteria Identifiers as listed above is
shortened and simply expressed with TOE (Target of Evaluation) or IFX_CCI_000003h with options.

This document is formed according to Common Criteria CCv3.1 EAL6 augmented (EAL6+) and comprises the
Infineon Technologies AG Security Controller (Integrated Circuit IC) with the above listed Common Criteria
Identifiers and with specific IC dedicated firmware and optional software.

The target of evaluation (TOE) is described in the following.
This Public Security Target has the revision 1.8 and is dated 2020-04-22.




CC Document                                              3                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The Target of Evaluation (TOE) is the Infineon Security Controller with following optional available software
packages:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
            o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
            o All ACL libraries provide elliptic curve cryptography EC3
    the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
    the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
    the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH™ NVM to the user
    the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method
    the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
       user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
    the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).
and with further specific IC dedicated firmware in several alternative versions.

Please note that always the highest version number points to the most recent status of a library coming usually
with improvements and/or additional functionality.

Note that each of the versions of the ACL, SCL, HSL, CCL and the NRG are optional and alternatively. This means
that the TOE comes either with one of the alternative library types– depending on the user choice - or with none.
The library types can Security Target Lite
Common Criteria EAL6 augment ed / EAL6+




M7892 Design Step P11




Document version 2.2 as of 2020-04-23


Author: Infineon Technologies




CC Developer Document                     2020-04-23
                                                                                                                M7892 P11
                                                                                                        Security Target Lite
Public




Edition 2020-04-23

Published by Infineon Technologies AG,

81726 Munich, Germany.

© 2020 Infineon Technologies AG

All Rights Reserved.




Legal Disclaimer

The information given in this document shall in no event be regarded as a guarantee of conditions or characteristics. With
respect to any examples or hints given herein, any typical values stated herein and/or any information regarding the
application of the device, Infineon Technologies AG hereby disclaims any and all warranties and liabilities of any kind,
including without limitation, warranties of non-infringement of intellectual property rights of any third party.

Information

For further information on technology, delivery terms and conditions and prices, please contact the nearest Infineon
Technologies AG Office (www.infineon.com).

Warnings

Due to technical requirements, components may contain dangerous substances. For information on the types in question,
please contact the nearest Infineon Technologies AG Office.

Infineon Technologies AG components may be used in life-support devices or systems only with the express written approval
of Infineon Technologies AG, if a failure of such components can reasonably be expected to cause the failure of that life-
support device or system or to affect the safety or effectiveness of that device or system. Life support devices or systems are
intended to be implanted in the human body or to support and/or maintain and sustain and/or protect human life. If they
fail, it is reasonable to assume that the health of the user or other persons may be endangered.




CC Developer Document                                           2                                                  2020-04-23
                                                                                                              M7892 P11
                                                                                                      Security Target Lite
Public

Trademarks of Infineon Technologies AG
AURIX™, C166™, CanPAK™, CIPOS™, CoolGaN™, CoolMOS™, CoolSET™, CoolSiC™, CORECONTROL™, CROSSAVE™, DAVE™, DI-
POL™, DrBlade™, EasyPIM™, EconoBRIDGE™, EconoDUAL™, EconoPACK™, EconoPIM™, EiceDRIVER™, eupec™, FCOS™,
HITFET™, HybridPACK™, Infineon™, ISOFACE™, IsoPACK™, i-Wafer™, MIPAQ™, ModSTACK™, my-d™, NovalithIC™,
OmniTune™, OPTIGA™, OptiMOS™, ORIGA™, POWERCODE™, PRIMARION™, PrimePACK™, PrimeSTACK™, PROFET™, PRO-
SIL™, RASIC™, REAL3™, ReverSave™, SatRIC™, SIEGET™, SIPMOS™, SmartLEWIS™, SOLID FLASH™, SPOC™, TEMPFET™,
thinQ!™, TRENCHSTOP™, TriCore™.


Trademarks updated August 2015


Other Trademarks
All referenced product or service names and trademarks are the property of their respective owners.




CC Developer Document                                        3                                                  2020-04-23
                                                                                                         M7892 P11
                                                                                                 Security Target Lite
Public


Revision History

Major changes since previous revision
Date           Version     Change Description

2017-10-25     1.0         Initial version
2017-11-16     1.1         Update references in Chapter 9.
2017-11-21     1.2         Update references in Chapter 9.
2019-10-29     2.0         Updated user guidance. Introduced NRG terminology. Signatures for MAE lib is updated.
2020-03-30     2.1         Accepted final remarks and provided minor editorial update.




CC Developer Document                                        4                                               2020-04-23
                                                                                                                                                                         M7892 P11
                                                                                                                                                                 Security Target Lite
Public



Table of Contents
Revision History ................................................................................................................................................................................. 4
Table of Contents ............................................................................................................................................................................... 5
1           Security Target Introduction (ASE_INT) ............................................................................................................. 7
1.1         Security Target and Target of Evaluation Reference .......................................................................................... 7
1.2         Target of Evaluation overview ................................................................................................................................... 14
2           Target of Evaluation Description ......................................................................................................................... 19
2.1         TOE Definition................................................................................................................................................................... 19
2.2         Scope of the TOE .............................................................................................................................................................. 24
2.2.1          Hardware of the TOE ............................................................................................................................................... 25
2.2.2          Firmware and software of the TOE .................................................................................................................... 27
2.2.3          Interfaces of the TOE ............................................................................................................................................... 29
2.2.4          Guidance documentation ....................................................................................................................................... 29
2.2.5          Forms of delivery ...................................................................................................................................................... 30
2.2.6          Production sites ......................................................................................................................................................... 31
3           Conformance Claims (ASE_CCL) .......................................................................................................................... 32
3.1         CC Conformance Claim .................................................................................................................................................. 32
3.2         PP Claim ............................................................................................................................................................................... 32
3.3         Package Claim ................................................................................................................................................................... 32
3.4         Conformance Rationale ................................................................................................................................................. 33
3.4.1          Security Problem Definition ................................................................................................................................. 34
3.4.2          Security Objective ..................................................................................................................................................... 34
3.4.3          Summary ....................................................................................................................................................................... 34
3.5         Application Notes ............................................................................................................................................................ 35
4           Security Problem Definition (ASE_SPD) ............................................................................................................ 36
4.1         Threats ................................................................................................................................................................................. 36
4.1.1          Additional Threat due to Loader Package Functionality .......................................................................... 36
4.1.2          Additional Threat due to TOE specific Functionality ................................................................................. 37
4.1.3          Assets regarding the Threats................................................................................................................................ 38
4.2         Organizational Security Policies ................................................................................................................................ 38
4.2.1          Augmented Organizational Security Policy .................................................................................................... 39
4.3         Assumptions ...................................................................................................................................................................... 40
4.3.1          Augmented Assumptions ....................................................................................................................................... 41
5           Security objectives (ASE_OBJ) .............................................................................................................................. 42
5.1         Security objectives for the TOE.................................................................................................................................. 42
5.2         Security Objectives for the Development and Operational Environment ................................................ 44
5.2.1          Clarification of “Protection during Composite product manufacturing (OE.Process-Sec-IC)” . 46
5.2.2          Clarification of “Treatment of User Data (OE.Resp-Appl)” ...................................................................... 46
5.3         Security Objectives Rationale ..................................................................................................................................... 46
6           Extended Component Definition (ASE_ECD) ................................................................................................... 50
6.1         Component “Subset TOE security testing (FPT_TST.2)” ................................................................................. 50
6.2         Definition of FPT_TST.2 ................................................................................................................................................ 50
6.3         TSF self-test (FPT_TST) ................................................................................................................................................ 50
7           Security Requirements (ASE_REQ) ..................................................................................................................... 52
7.1         TOE Security Functional Requirements ................................................................................................................. 52
7.1.1          Extended Components FCS_RNG.1 and FAU_SAS.1 ..................................................................................... 54
7.1.2          Subset of TOE testing ............................................................................................................................................... 55
7.1.3          Memory access control ........................................................................................................................................... 56
7.1.4          Support of Cipher Schemes ................................................................................................................................... 58
7.1.5          Data Integrity .............................................................................................................................................................. 71


CC Developer Document                                                                             5                                                                                  2020-04-23
                                                                                                                                                                      M7892 P11
                                                                                                                                                              Security Target Lite
Public

7.1.6         Support of MAE and Flash Loader ...................................................................................................................... 72
7.2        TOE Security Assurance Requirements.................................................................................................................. 74
7.2.1         Refinements ................................................................................................................................................................. 75
7.2.2         ADV_SPM Formal Security Policy Model ......................................................................................................... 77
7.3        Security Requirements Rationale ............................................................................................................................. 78
7.3.1         Rationale for the Security Functional Requirements ................................................................................. 78
7.3.2         Rationale of the Assurance Requirements ...................................................................................................... 86
8          TOE Summary Specification (ASE_TSS) ............................................................................................................. 88
8.1        SF_DPM: Device Phase Management ....................................................................................................................... 88
8.2        SF_PS: Protection against Snooping ......................................................................................................................... 89
8.3        SF_PMA: Protection against Modifying Attacks .................................................................................................. 91
8.4        SF_PLA: Protection against Logical Attacks .......................................................................................................... 93
8.5        SF_CS: Cryptographic Support.................................................................................................................................... 93
8.5.1         Triple DES ..................................................................................................................................................................... 94
8.5.2         AES................................................................................................................................................................................... 95
8.5.3         RSA .................................................................................................................................................................................. 96
8.5.4         Elliptic Curves EC ...................................................................................................................................................... 98
8.5.5         SHA-2 ........................................................................................................................................................................... 100
8.5.6         SCL ................................................................................................................................................................................ 100
8.5.7         PTRNG respectively TRNG.................................................................................................................................. 101
8.5.8         Summary of SF_CS: Cryptographic Support ................................................................................................ 101
8.6        SF_MAE: Mutual Authentication Extension ....................................................................................................... 101
8.7        Assignment of Security Functional Requirements to TOE’s Security Functionality ......................... 102
8.8        Security Requirements are internally consistent ............................................................................................ 104
9          Literature................................................................................................................................................................. 105
10         Appendix.................................................................................................................................................................. 107
11         List of Abbreviations ............................................................................................................................................ 110
12         Glossary.................................................................................................................................................................... 113




CC Developer Document                                                                       6                                                                                      2020-04-23
                                                                                                                M7892 P11
                                                                                                        Security Target Lite
Public


1                     Security Target Introduction (ASE_INT)
1.1                 Security Target and Target of Evaluation Reference
The title of this document is Security Target Lite Common Criteria EAL6 augmented / EAL6+ M7892 Design Step P11.

This     document     comprises    the     Infineon   Technologies    AG    Security   Controller    (Integrated   Circuit   IC),
M7892 Design Step P11, with specific IC dedicated firmware and optional software:

            RSA v2.03.008 or v2.07.003,

            EC v2.03.008 or v2.07.003,

            SHA-2 v1.01

            Toolbox v2.03.008 or v2.07.003

            Symmetric Crypto Library v2.02.010

In addition, the TOE is available with alternative firmware packages as versioned in Table 1: Identification.

The target of evaluation (TOE) M7892 Design Step P11 is described in the following.

The reference to the belonging confidential Security Target is given in chapter 9.

The Target of Evaluation (TOE) is the Infineon Security Controller, M7892 Design Step P11, with the optional libraries
RSA2048/4096 v2.03.008 or v2.07.003, EC v2.03.008 or v2.07.003, SHA-2 v1.01, Toolbox v2.03.008 or v2.07.003 , and
symmetric crypto library v2.02.010, as well as with specific IC dedicated firmware, including the Flash Loader enhanced by
the Mutual Authentication Extension (MAE).

The version of ECC, RSA and Toolbox libraries cannot be chosen independently. The libraries have to be of one version.

The design step of this TOE is P11.

The Security Target is based on the Protection Profile PP-0084 “Security IC Platform Protection Profile with Augmentation
Packages” [12] as publicly available for download at https://www.bsi.bund.de and certified under BSI-CC-PP-0084-2014. MAE
and Flash Loader are regarded by the definition of “loader package1+” according to “PP0084: Interpretations” [35].

The Protection Profile and the Security Target are built in compliance with Common Criteria v3.1.

The Security Target takes into account all relevant current final interpretations.

This TOE concept is based on the architecture, family concept and principles of the Integrity Guard implemented in the
controllers by Infineon Technologies AG deemed for high security requiring applications.

This TOE is based and built from the equal design sources as already certified in the forerunner process BSI-DSZ-CC-0891-V4-
2019 and has seen further improvements.

The certification body of this process is the German BSI, whereas the abbreviation stands for Federal Office for Information
Security, in German Bundesamt für Sicherheit in der Informationstechnik.




CC Developer Document                                           7                                                   2020-04-23
                                                                                                                          M7892 P11
                                                                                                                  Security Target Lite
Public

                                                            Table 1: Identification

              Object                    Version      Date                                      Registration

                                                                 Security Target Common Criteria EAL6 augmented / EAL6+
    Security Target                      2.2      2020-04-23
                                                                 M7892 Design Step P11

                                                                 M7892 Design Step P11

                                                                            With FW-Identifier         78.015.18.2

                                                                            MAE:                       8.00.006

                                                                 And following optional alternative SW - libraries:
                                                                 either     RSA2048           v2.03.008 or v2.07.003
                                                                 or         RSA4096           v2.03.008 or v2.07.003
                                                                 and belonging User Guidance documentation (1).
    Target of Evaluation
                                                                 And further optional software:
                                                                 SHA-2                v1.01
                                                                 EC                   v2.03.008 or v2.07.003
                                                                        1
                                                                 Base                 v2.03.008 or v2.07.003
                                                                 Toolbox              v2.03.008 or v2.07.003
                                                                 SCL                  v2.02.010
                                                                 and belonging User Guidance documentation (1).

                                                                 Security IC Platform Protection Profile with Augmentation
    Protection Profile                   1.0      2014-01-13
                                                                 Packages BSI-CC-PP-0084-2014

                                                                 Common Criteria for Information Technology Security Evaluation

                                                                 Part 1: Introduction and general model
                                         3.1                     CCMB-2017-04-001
    Common Criteria                 Revision       2017-04       Part 2: Security functional requirements
                                          5                      CCMB-2017-04-002

                                                                 Part 3: Security Assurance Components CCMB-
                                                                 2017-04-003

    (1) Chapter 2.2.4 describes briefly the contents of the individual documents of the User Guidance Documentation, while
    the individual documents are versioned and entitled in chapter 9 literature and references. The listed set of user guidance
    documents belongs to the TOE.


Note that the ROM contains no user data and the user has no access.




1
    Please note that the Base Library cannot be ordered. However this library is part of the delivery if the RSA2048, the RSA4096, the EC or
      the Toolbox library is ordered.



CC Developer Document                                                   8                                    -carrier frequency used for the load modulation. More details
are given in the hardware reference manual [6].
                                     Table 4: Interface combinations excerpt of the TOE
                       Contactless Interface
                       Pads                         La / Lb (connected to antenna)
                                                                     ISO18092 NFC      NRG software
                       Protocol     ISO14443 A       ISO14443 B
                                                                     passive mode        interface
                       Contact based Interface
                       Pads                                     ISO - CB
                       Interface      ISO7816                              ACLB

                                                                                       ISO18092 NFC
                       Protocol      ISO7816         ISO14443 A        ISO14443 B
                                                                                       passive mode


Further details and options are described in the confidential Security Target [39].
The TOE provides a real 16-bit CPU-architecture. The major components of the core system are the two CPUs (Central
Processing Units), the MMU (Memory Management Unit) and MED (Memory Encryption/Decryption Unit). The two CPUs
control each other in order to detect faults and serve by this for data integrity. The TOE implements a full 16 MByte linear
addressable memory space for each privilege level, a simple scalable Memory Management concept and a scalable stack
size. The flexible memory concept consists of ROM- and Flash-memory as part of the non-volatile memory (NVM),
respectively SOLID FLASH™ NVM. For the SOLID FLASH™ NVM the Unified Channel Programming (UCP) memory
technology is used.
The RMS library providing some functionality via an API to the Smartcard Embedded Software contains for example SOLID
FLASH™ NVM service routines. The Service Algorithm provides functionality for the tearing save write into the SOLID
FLASH™ NVM. The STS firmware is used for test purposes during start-up and the Flash Loader allows downloading user
software to the SOLID FLASH™ NVM during the manufacturing process. The firmware parts are implemented in the ROM
and in access protected areas of the SOLID FLASH™ NVM. The BSI has changed names and abbreviations for Random
Number Generators, which is clarified as follows: The Physical True Random Number Generator (PTRNG), also named
True Random Number Generator (TRNG) is a physical random number generator and meets the requirements of the
functionality class AIS31 PTG.2, see [5]. It is used for provision of random number generation as a security service to the
user and for internal purposes. The produced genuine random numbers can be used directly or as seed for the
Deterministic Random Number Generator (DRNG), former named as Pseudo Random Number Generator (PRNG). The
DRNG respectively PRNG is not in the scope of the evaluation. The TRNG respectively PTRNG is specially designed for
smart cards, but can also be used in any other application where excellent physical random data are required.


Security Target Lite                                         15                                                 2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public

The two cryptographic coprocessors serve the need of modern cryptography: The symmetric coprocessor (SCP) combines
both AES and Triple-DES with dual-key or triple-key hardware acceleration. The Asymmetric Crypto Coprocessor, called
Crypto@2304T in the following, is optimized for RSA-2048 bit (4096-bit with CRT) and Elliptic Curve (EC) cryptography.
The software part of the TOE consists of the cryptographic RSA-, EC-, SCL and the SHA-2 libraries and the supporting
Toolbox and Base libraries. The Base library is used internally by the RSA, the EC and the Toolbox library, thus if one of the
aforementioned libraries is ordered, the Base library will be automatically included in the delivery. The Base library does
not provide any additional specific security functionality.
The RSA library is used to provide a high level interface to RSA (Rivest, Shamir, Adleman) cryptography implemented on
the hardware component Crypto@2304T and includes countermeasures against SPA, DPA and DFA attacks. The routines
are used for the RSA keys generation (only in v2.07.003), RSA signature verification, the RSA signature generation and the
RSA modulus recalculation. The hardware Crypto@2304T unit provides the basic long number calculations (add, subtract,
multiply, square with 1100 bit numbers) with high performance. The RSA library is delivered as object code and in this
way integrated in the user software. The RSA library can perform RSA operations from 512 to 4096 bits.
                        1
Following the BSI recommendations, key lengths below 1976 bit are not included in the certificate.
The EC library is used to provide a high level interface to Elliptic Curve cryptography implemented on the hardware
component Crypto@2304T and includes countermeasures against SPA, DPA and DFA attacks. The routines are used for
ECDSA signature generation, ECDSA signature verification, ECDSA key generation and Elliptic Curve Diffie-Hellman key
agreement. In addition, the EC library provides an additional function for calculating primitive elliptic curve operations
                                                                                                   n
like EC Add and EC Double. EC curves over prime field Fp, as well as over GF(2 ) finite field are supported too.
The EC library is delivered as object code and in this way integrated in the user software. The certification covers the
standard NIST [17] and Brainpool [18] Elliptic Curves with key lengths as defined in the SFRs. Note that there are further
uncounted side-channel-secure curve types which the user can optionally add in the composition certification process.
The SHA-library provides the calculation of a hash value of freely chosen data input in the CPU. The SHA-library is
delivered as object code and is in this way available for the user software.
This secure hash-algorithm SHA-2 is intended to be used for signature generation, verification and generic data integrity
checks. The use for keyed hash operations like HMAC or similar security critical operations involving keys, is not subject of
this TOE and requires specific security improvements and DPA analysis including the operating system, which is not part
of this TOE. Further essential information about the usage is given in the confidential user guidance [11].
The toolbox library does not provide cryptographic support or additional security functionality as it provides only the
following basic long integer arithmetic and modular functions in software, supported by the cryptographic coprocessor:
Addition, subtraction, division, multiplication, comparison, reduction, modular addition, modular subtraction, modular
multiplication, modular inversion and modular exponentiation. No security relevant policy, mechanism or function is
supported. The toolbox library is deemed for software developers as support for simplified implementation of long
integer and modular arithmetic operations.



1
    BSI Bundesamt für Sicherheit in der Informationstechnik – Federal office for information security



Security Target Lite                                                         16                                    2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

The SCL Library offers a high-level interface for performing symmetric cryptography algorithms using SCP coprocessor.
The SCL has implemented block repetitions, dummy calculations, backward calculation rounds and known-answer test
security functions using 128, 192 and 256 AES algorithm, and TDES or DES algorithms. The SCL also supports ECB, CBC,
CTR, CFB and PCBC block cipher modes, however the PCBC mode is not a part of this evaluation. The SCL provides public
API [10] containing cipher block management functions (Cipher*), block cipher mode encryption/decryption functions
(BCM*), cipher block instantiation helper functions CipAlg_*_Sec1 and CipAlg_*_Sec2, however the CipAlg_*_Sec1
functions are not a part of this evaluation.
Note that this TOE can come with both cryptographic coprocessors accessible, or with a blocked SCP or with a blocked
Crypto@2304T, or with both cryptographic coprocessors blocked. The blocking depends on the user’s choice. No
accessibility of the deselected cryptographic coprocessors is without impact on any other security policy of the TOE; it is
exactly equivalent to the situation where the user decides just not to use the cryptographic coprocessors.
If the Crypto@2304T is blocked the user will not be able to use the functionality of the EC, the RSA and the Toolbox
library, as these optional software libraries perform their basic arithmetic operations of the asymmetric cryptographic
coprocessor. If the SCP is blocked the user will not be able to use the hardware based AES and TDES calculations and
furthermore he will not be able to use the functionality of the SCL, as this optional software library is based on the
symmetric cryptographic coprocessor.
The TOE can be also delivered without a specific optional software library. In this case the TOE does not provide the
additional specific security functionality Rivest-Shamir-Adleman Cryptography (RSA) or/and Elliptic Curve Cryptography
(EC) or/and SHA-2 or/and SCL based Advanced Encryption Standard (AES) or/and SCL based Triple Data Encryption
Standard (TDES).
To fulfill the highest security standards for smartcards today and also in the future, this TOE implements a progressive
digital security concept, which already has been certified in various forerunner processes. Thereby, this TOE utilizes digital
security features to include customer friendly security, combined with a robust design overcoming the disadvantages on
analogue protection technologies. The TOE provides full on-chip encryption covering the complete core, busses,
memories and cryptographic coprocessors leaving no plaintext on the chip. Therefore the attractiveness for attackers is
extremely reduced as encrypted signals are of no use for the attacker – neither for manipulation nor for eavesdropping.
In addition, the TOE is equipped with a full error detection capability for the complete data path. The dual CPU approach
allows error detection even while processing. A comparator detects whether a calculation was performed without errors.
This approach does not leave any parts of the circuitry unprotected. The concept allows that the relevant attack scenarios
are detected, whereas other conditions that would not lead to an error would mainly be ignored. And more, the TOE is
equipped with signal protection implemented by an Infineon-specific shielding combined with secure wiring and shielding
of security critical signals.
In the confidential Security Target [39] the TOE is described and a summary specification is given. The security
environment of the TOE during its different phases of the lifecycle is defined. The assets are identified which have to be
protected through the security policy. The threats against these assets are described. The security objectives and the
security policy are defined, as well as the security requirements. These security requirements are built up of the security
functional requirements as part of the security policy and the security assurance requirements. These are the steps during


Security Target Lite                                         17                                                   2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

the evaluation and certification showing that the TOE meets the targeted requirements. In addition, the functionality of
the TOE matching the requirements is described.
The assets, threats, security objectives and the security functional requirements are defined in this Security Target and in
the Protection Profile [1] and are referenced here. These requirements build up a minimal standard common for all
Smartcards.
The security functions are defined here in the Security Target as property of this specific TOE. Here it is shown how this
specific TOE fulfills the requirements for the standard defined in the Protection Profile [1].




Security Target Lite                                          18                                                2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public


2         Target of Evaluation Description

The TOE description helps to understand the specific security environment and the security policy. In this context the
assets, threats, security objectives and security functional requirements can be employed. The following is a more
detailed description of the TOE than in the Protection Profile [1] as it belongs to the specific TOE.


2.1      TOE Definition

This TOE consists of Security Dual Interface Controllers as integrated circuits, meeting the highest requirements in terms
of performance and security. They are manufactured by Infineon Technologies AG in a 90 nm CMOS-technology (L90).
This TOE is intended to be used in smart cards for particularly security-relevant applications and for its previous use as
developing platform for smart card operating systems according to the lifecycle model from the Protection Profile [1].
The term Smartcard Embedded Software is used in the following for all operating systems and applications stored and
executed on the TOE regardless whether it is a smartcard or another application of form factor. The TOE is the platform
for the Smartcard Embedded Software. The Smartcard Embedded Software itself is not part of the TOE.
The TOE consists of a core system, memories, coprocessors, peripherals, security modules and analogue peripherals.
Following diagram provides a simplified overview upon the hardware subsystems, which are briefly described below:
                                        Figure 1: Simplified block diagram of the TOE




Security Target Lite                                          19                                                  2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

The major components of the core system are the dual CPU (Central Processing Units) including the internal encryption
leaving no plain data anywhere, the MMU (Memory Management Unit), the MED (Memory Encryption/Decryption Unit)
and the CACHE memory.
The CPU – here the two processor parts (CPU1 and CPU2) are seen from functional perspective as one - is compatible with
the instruction set of the forerunner family 66-PE. Anyhow, the dual-CPU is faster than the standard processor at the
equal clock frequency. It provides additional powerful instructions for smart card or other applications. It thus meets the
requirements for the new generation of operating systems. Despite its compatibility the CPU implementation is entirely
proprietary and not standard.
The two processor parts of the CPU control each other in order to detect faults and maintain by this the data integrity. A
comparator detects whether a calculation was performed without errors and allows error detection even while
processing. Therefore the TOE is equipped with a comprehensive error detection capability, which is designed to leave no
relevant parts of the circuitry unprotected.
The CPU accesses the memory via the integrated Memory Encryption and Decryption unit (MED), which transfer the data
from the memory encryption schema to the CPU encryption schema without decrypting into intermediate plain data. The
error detection unit (EDU) automatically manages the error detection of the individual memories and detects incorrect
transfer of data between the memories by means of error code comparison.
The access rights of the firmware, user operating system and application to the memories are controlled and enforced by
the memory management unit (MMU).
The CACHE memory – or simply, the CACHE – is a high-speed memory-buffer located between the CPU and the (external)
main memories holding a copy of some of the memory contents to enable access to the copy, which is considerably faster
than retrieving the information from the main memory. In addition to its fast access speed, the CACHE also consumes less
power than the main memories. All CACHE systems own their usefulness to the principle of locality, meaning that
programs are inclined to utilize a particular section of the address space for their processing over a short period of time.
By including most or all of such a specific area in the CACHE, system performance can be dramatically enhanced. The
implemented post failure detection identifies and manages errors if appeared during storage.
The controllers of this TOE store both code and data in a linear 16-MByte memory space, allowing direct access without
the need to swap memory segments in and out of memory using a memory management unit.
The memory block contains the ROM, RAM and the SOLID FLASH™ NVM. All data of the memory block is encrypted and
all memory types are equipped with an error detection code (EDC), the SOLID FLASH™ NVM in addition with an error
correction code (ECC). Errors in the memories are automatically detected (EDC) and in terms of the SOLID FLASH™ NVM
certain errors are also corrected (ECC). The TOE uses also Special Function Registers SFR. These SFR registers are used for
general purposes and chip configuration. These registers are located in the SOLID FLASH™ NVM as configuration area
page.
The non-volatile ROM contains the firmware parts and is accessible for Infineon only, while the RAM is a volatile memory
and used by the core.
The coprocessor block contains the two coprocessors for cryptographic operations are implemented on the TOE: The
Crypto2304T for calculation of asymmetric algorithms like RSA and Elliptic Curve (EC) and the Symmetric Cryptographic


Security Target Lite                                        20                                                  2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

Processor (SCP) for dual-key or triple-key triple-DES and AES calculations. These coprocessors are especially designed for
smart card applications with respect to the security and power consumption, but can of course be used in any other
application of form factor where suitable. The SCP module computes the complete DES algorithm within a few clock
cycles and is especially designed to counter attacks like DPA, EMA and DFA.
Note that this TOE can come with both crypto coprocessors accessible, or with a blocked SCP or with a blocked
Crypto2304T, or with both crypto coprocessors blocked. The blocking depends on the customer demands prior to the
production of the hardware. If the SCP is blocked the user will neither be able to use the solely hardware based AES and
TDES calculations of the TOE nor the SCL based AES and TDES calculations. If the Crypto@2304T is blocked the user will
not be able to use the services of the optional RSA, EC and Toolbox libraries. No accessibility of the deselected
cryptographic co-processors is without impact on any other security policy of the TOE; it is exactly equivalent to the
situation where the user decides just not to use the cryptographic coprocessors.
The security peripherals block contains the small remaining set of sensors and filters. This small set of sensors is left in
order to detect excessive deviations from the specified operational range, while not being over-sensitive. These features
do not need adjustment or calibration and makes the chip even more robust. Conditions that would not be harmful for
the operation would in most cases not influence the proper function. The small set of sensors is not necessary for the chip
security but serve for robustness. Having the integrity guard concept in place, the sensors - except a single one - are no
more required for the TOE security. The only sensor left, contributing to a security mechanism, is the frequency sensor.
All other sensors are assigned to be security supporting only.
The filters are on board to make the TOE more robust against perturbations on the supply lines.
The block control is constituted out of the modules Interrupt Controller (ITP) and Peripheral Event Channel controller
(PEC), the modules supplying clock (ICO) and Power Management / Voltage regulator, the Interface Management Module
combined with the UmSLC. The UmSLC enables for checking the proper functions of modules and subsystems and checks
the correct operation of the TOE.
The implemented clock management is optimized to reduce the overall power consumption. Contactless products
provide a low-power halt mode for operation with reduced power consumption. The Clock Unit (CLKU) supplies the clocks
for all components of the TOE. The Clock Unit can work in an internal and external clock mode. The system frequency can
be configured and this enables a programmer to choose the best-fitting frequency for an application in consideration of a
potential current limit and a demanded application performance. More details are given in the confidential Security
Target [39] and in the hardware reference manual [6].
The peripherals block is constituted out of PTRNG, DRNG, CRC, Timer & WDT, the RFI and the UART. The modules are
briefly described in the following:
The TRNG respectively PTRNG is specially designed for smart cards, but can also be used in any other application where
excellent physical random data are required. The TRNG respectively PTRNG fulfills the requirements from the
functionality class PTG.2 of the AIS31 and produces genuine random numbers which then can be used directly or as seed
for the Deterministic Random Number Generator (DRNG), former named as Pseudo Random Number Generator (PRNG).
The DRNG respectively PRNG is not in the scope of the evaluation.




Security Target Lite                                         21                                                 2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public

The cyclic redundancy check (CRC) module is a checksum generator. The checksum is a unique number associated with a
message or another block of data consisting of several bytes. The idea of the CRC method is to treat the input data as a
binary bit stream and divide that stream by a fixed binary number. The remainder of that division is the CRC checksum.
The timer enables for easy implementation of communication protocols such as T=1 and all other time-critical operations.
The timer can be programmed for particular applications, such as measuring the timing behavior of an event. Timer
events can generate interrupt requests to be used for peripheral event channel data transfers. The watchdog is
implemented to provide the user some additional control of the program flow. More details are given in the hardware
reference module HRM [6].
The timer enables for easy implementation of communication protocols such as T=1 and all other time-critical operations.
The timer can be programmed for particular applications, such as measuring the timing behavior of an event. Timer
events can generate interrupt requests to be used for peripheral event channel data transfers. The watchdog is
implemented to provide the user some additional control of the program flow. More details are given in the hardware
reference module HRM [6].
This dual interface controller is able to communicate using either the contact based or the contactless interface. The
implemented dual interface provides a maximum flexibility in using different communication protocols: ISO 7816, ISO
14443 Type A and Type B, ISO/IEC 18092 NFC passive mode, NRG software Interface, as well as further communication
modes, allowing also implementation of user defined concepts for contact based or contactless communication. The
flexibility of the communication interfaces enable for example also the use cases involving external analogue modems,
which are typically deemed for applications running in mobile devices. Please note that these external parts are of course
not part of this TOE. More details are given the confidential Security Target [39] and the hardware reference manual [6].
Supporting a NRG software Interface application requires a dedicated small space of memory. In this context and
depending on user’s choice, various memory sections of 1 up to 4 kByte each can be defined. The number and location of
these memory sections is simply limited by the available SOLID FLASH™ NVM space. Also these memory sections are
read/write protected and are defined and generated by the user. Please note that the NRG part does not provide any TOE
security functionality.
The implemented sleep mode logic (clock stop mode per ISO/IEC 7816-3) is used to reduce the overall power
consumption. Contactless products provide a low-power halt mode for operation with reduced power.
The bus system comprises two separate bus entities: a memory bus supporting high-speed communication between the
Core and Memories, and a peripheral bus for communication with the peripherals.
Subsequently, an intelligent shielding algorithm finishes the layers, finally providing the so called intelligent implicit active
           2
shielding “I -shield”. This provides physical protection against probing and forcing.
The STS (self-test software), RMS (Resource Management System), Service Algorithm Minimal (SAM) and Flash Loader
together compose the TOE firmware stored in the ROM and the patches hereof in the SOLID FLASH™ NVM. All mandatory
functions for internal testing, production usage and start-up behavior (STS), and also the RMS and SAM functions are
grouped together in a common privilege level. These privilege levels are protected by a hardwired Memory Management
Unit (MMU) setting.
The user software can be implemented in various options depending on the user’s choice as described in chapter 1.1.


Security Target Lite                                           22                                                   2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public

Thereby the user software, or parts of it, can be downloaded into the SOLID FLASH™ NVM, either during production of
the TOE or at customer side. In the latter case, the user downloads his software or the final parts of it at his own
premises, using the Flash Loader software.
The toolbox library does not provide cryptographic support or additional security functionality as it provides only the
following basic long integer arithmetic and modular functions in software, supported by the cryptographic coprocessor:
Addition, subtraction, division, multiplication, comparison, reduction, modular addition, modular subtraction, modular
multiplication, modular inversion and modular exponentiation. No security relevant policy, mechanism or function is
supported. The toolbox library is deemed for software developers as support for simplified implementation of long
integer and modular arithmetic operations. Please note that the toolbox part does not provide any TOE security
functionality.
The RSA library is used to provide a high level interface to RSA (Rivest, Shamir, Adleman) cryptography implemented on
the hardware component Crypto@2304T and includes countermeasures against SPA, DPA and DFA attacks. The routines
are used for the RSA key generation (only in v2.07.003), RSA signature verification, the RSA signature generation and the
RSA modulus recalculation. The hardware Crypto@2304T unit provides the basic long number calculations (add, subtract,
multiply, square with 1100 bit numbers) with high performance. The RSA library is delivered as object code and in this
way integrated in the user software. The RSA library can perform RSA operations from 512 to 4096 bits.
                        1
Following the BSI recommendations, key lengths below 1976 bit are not included in the certificate.
The EC library is used to provide a high level interface to Elliptic Curve cryptography implemented on the hardware
component Crypto@2304T and includes countermeasures against SPA, DPA and DFA attacks. The routines are used for
ECDSA signature generation, ECDSA signature verification, ECDSA key generation and Elliptic Curve Diffie-Hellman key
agreement. In addition, the EC library provides an additional function for calculating primitive elliptic curve operations
                                                                                                   n
like EC Add and EC Double. EC curves over prime field Fp, as well as over GF(2 ) finite field are supported too.
The EC library is delivered as object code and in this way integrated in the user software. The certification covers the
standard NIST [17] and Brainpool [18] Elliptic Curves with key lengths as defined in the SFRs. Note that there are further
uncounted side-channel-secure curve types which the user can optionally add in the composition certification process.
The Base library is used internally by the RSA, the EC and the Toolbox library, thus if one of the aforementioned libraries is
ordered, the Base library will be automatically included in the delivery. The Base library does not provide any additional
specific security functionality.
The SHA-library provides the calculation of a hash value of freely chosen data input in the CPU. The SHA-library is
delivered as object code and is in this way available for the user software.
This secure hash-algorithm SHA-2 is intended to be used for signature generation, verification and generic data integrity
checks. The use for keyed hash operations like HMAC or similar security critical operations involving keys, is not subject of
this TOE and requires specific security improvements and DPA analysis including the operating system, which is not part
of this TOE. Further essential information about the usage is given in the confidential user guidance [11].



1
    BSI Bundesamt für Sicherheit in der Informationstechnik – Federal office for information security



Security Target Lite                                                         23                                    2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

The SCL library provides public cipher API for user application. The Cipher API contains functionality on operation with the
SCL: configuration of runtime settings, encryption and decryption of multiple data blocks using one of the built-in Block
Cipher Modes: ECB, CBC, CTR, CFB and PCBC. The SCL also provides functionality of adding custom BCMs. Public AES API
provides encryption and decryption of a 128-bit block using AES standard. The following key sizes are supported: 128 bits,
192 bits, 256 bits. Public DES API provides encryption and decryption of a 64-bit block using the following algorithms: DES
and TDES with an effective key size of 56 bits (+ 8 parity bits) as well as 112 and 168 bits. Please note that the PCBC block
cipher mode and the “*_Sec1”-functions of the SCL are not part of this evaluation.
Note that the TOE can be delivered without a specific optional software library. In this case the TOE does not provide the
additional specific security functionality Rivest-Shamir-Adleman Cryptography (RSA) or/and Elliptic Curve Cryptography
(EC) or/and SHA-2 or/and SCL based Advanced Encryption Standard (AES) or/and SCL based Triple Data Encryption
Standard (TDES).
The TOE sets a new, improved standard of integrated security features, thereby meeting the requirements of all smart
card and other related applications or form factors, such as information integrity, access control, mobile telephone and
identification, as well as uses in electronic funds transfer and healthcare systems.
To sum up, the TOE is a powerful dual interface security controller with a large amount of memory and special peripheral
devices with improved performance, optimized power consumption, free to choose contact based or contactless
operation, at minimal chip size while implementing high security. It therefore constitutes the basis for future smart card
and other related applications or form factors.




Security Target Lite                                         24                                                  2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

2.2       Scope of the TOE

The TOE comprises:
          The silicon die, respectively the IC or hardware, in several versions:
               o    Each version differences from each other just by the input capacity of the RFI or by the additional metal
                    layer on top.
          The TOE is also delivered in various configurations, achieved by means of blocking.
          The user’s guidance documentation including hardware, software, Flash Loader, secure coding, and other
           reference manuals.
All product derivatives of this TOE, including all configuration possibilities, regardless whether coming with or without top
metal layer, are manufactured by Infineon Technologies AG. In the following descriptions, the term “manufacturer”
stands short for Infineon Technologies AG, the manufacturer of the TOE.
New configurations can occur at any time but in any case the user is able to clearly identify the TOE hardware, its
configuration and proof the validity of the certificate independently, meaning without involving the manufacturer.
Entirely all means of blocking and the, for the blocking involved firmware respectively software parts have been subject of
the evaluation. All resulting configurations of a TOE derivative are subject of the certificate. All resulting configurations
are either at the predefined limits or within the predefined configuration ranges.
The firmware used for the TOE internal testing and TOE operation, the firmware and software parts exclusively used for
the blocking, the parts of the firmware and software required for cryptographic support are part of the TOE and therefore
part of the certification. The documents as described in section 2.2.4 and referenced in Table 1, are supplied as user
guidance.
Not part of the TOE and not part of the certification are:
          The Smartcard Embedded Software respectively user software, and
          commercial parts the Billing-Per-Use software.


2.2.1           Hardware of the TOE
The hardware part of the TOE as defined in the Protection Profile [1] is comprised of:
Core System
           Proprietary CPU implementation of the Intel MCS251 standard architecture from functional perspective,
           represented by two CPUs from hardware perspective
           CACHE with Post Failure Detection
           Memory Encryption/Decryption Unit (MED) and Error Detection Unit (EDU)
           Memory Management Unit (MMU)
Memories
           Read-Only Memory (ROM), not user available
           Random Access Memory (RAM)
           SOLID FLASH™ NVM



Security Target Lite                                            25                                               2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

          Note: The TOE has implemented an Electrical Erasable Programmable Read Only Memory (EEPROM) module.
          This EERPOM module is configured to act for the most part as a flash memory. Therefore, the module is called
          SOLID FLASH™ NVM.
Peripherals
          True Random Number Generator (TRNG) respectively Physical True Random Number Generator (PTRNG)
          Deterministic Random Number Generator (DRNG) respectively Pseudo Random Number Generator (PRNG)
          Watchdog and Timers
          Universal Asynchronous Receiver/Transmitter (UART)
          Checksum module (CRC)
          RF interface (radio frequency power and signal interface)
Control
          Dynamic Power Management
          Internal Clock Oscillator (ICO)
          Interrupt and Peripheral Event Channel Controller (ITP and PEC)
          Interface Management Module (IMM)
          User mode Security Life Control (UmSLC)
          Voltage Regulator
Coprocessors
          Crypto@2304T for asymmetric algorithms like RSA and EC (optionally blocked)
          Symmetric Crypto Coprocessor for TDES and AES Standards (optionally blocked)
Security Peripherals
          Filters
          Sensors
Buses
          Memory Bus
          Peripheral Bus


2.2.2          Firmware and Software of the TOE
For this TOE, the user can chose between different alternative firmware packages and can also chose the optional
libraries. The exact versions of firmware respectively optional software alternatives are given in Table 1.
The entire firmware of the TOE consists of different parts:
One part comprises the RMS and SAM routines for SOLID FLASH™ NVM programming, security functions test, and random
number online testing (Resource Management System, IC Dedicated Support Software in the Protection Profile [1]).
The RMS and SAM routines are stored from Infineon Technologies AG in the ROM, while belonging patches (if any) are
located in a protected area of the SOLID FLASH™ NVM. The ROM is only available for Infineon Technologies AG, the user
has no access.




Security Target Lite                                          26                                               2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public

The second part is the STS, consisting of test and initialization routines (Self-Test Software, IC Dedicated Test Software in
PP [1]). The STS routines are stored in the ROM and the belonging patch (if any) is located in a protected area of the
SOLID FLASH™ NVM. The STS is not accessible for the user software.
The third part is the Flash Loader. This piece of software is located in the ROM, but some parts of it are also stored in the
SOLID FLASH™ NVM. It enables the download of the user software or parts of it to the SOLID FLASH™ NVM. After
completion of the download the Flash Loader shall be locked by the by the user.
The fourth part is the NRG software interface routines. Note that these routines are always present, but are deactivated,
in case that a derivative comes without RF interface. Thus the user software interface is identical in both cases and
consequently the related interface routines can be called in each of the derivatives. In case the related NRG software
interface routines are called in derivatives without RF interface, an error code is returned. In the other case the related
function is performed. Please note that the NRG software interface does not provide any specific TOE security
functionality.
All parts of the firmware above are combined together by the TOE generation process to a single file and stored then in
the data files, the TOE is produced from. This comprises the firmware files for the ROM, where only Infineon Technologies
AG has access, as well as the data to be flashed in the SOLID FLASH™ NVM.
The optional software part of the TOE consists of the SCL, RSA, EC, SHA-2, Base and Toolbox libraries.
The SCL library is used to provide a high-level interface to DES/TDES and AES symmetric cryptographic operation. It uses
the SCP of the underlying hardware and implements countermeasures against all known weaknesses of the SCP v3 (e.g.
dummy calculations, block repetitions and backward calculation). The SCL library consists of three C-library files:
Cipher.lib, AES.lib, and DES.lib. These files are not distributed separately, and, therefore, all three files are called together
Symmetric Cryptographic Library. The SCL supports the ECB, CBC, CTR CFB and PCBC block cipher modes. Please note that
the PCBC mode, as well as “*_Sec1”-functions of the SCL, are not covered by the evaluation.
The SHA-2 library provides the calculation of a hash value of freely chosen data input in the CPU. The SHA-2 library is
delivered as object code and is in this way available for the user software. This secure hash-algorithm SHA-2 is intended to
be used for signature generation, verification and generic data integrity checks. The use for keyed hash operations like
HMAC or similar security critical operations involving keys, is not subject of this TOE and requires specific security
improvements and DPA analysis including the operating system, which is not part of this TOE. Further essential
information about the usage is given in the confidential user guidance.
The RSA library is used to provide a high level interface to the RSA cryptography implemented on the hardware
component Crypto@2304T and includes countermeasures against SPA, DPA and DFA attacks. The routines are used for
the RSA signature verification, the RSA signature generation and the RSA modulus recalculation. The module provides the
basic long number calculations (add, subtract, multiply, square with 1100 bit numbers) with high performance.
The RSA library is delivered as object code and in this way integrated in the user software. The RSA library can perform
RSA operations from 512 to 4096 bits. Depending on the customer’s choice, the TOE can be delivered with the 4096 code
portion or with the 2048 code portion only. The 2048 code portion is included in both. Parts of the evaluation are the RSA




Security Target Lite                                           27                                                   2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public
                                                                                     1
straight operations with key length from 1976bits to 2048 bits, and the RSA CRT operations with key lengths of 1976Bits
to 4096 Bits.
The EC library is used to provide a high level interface to Elliptic Curve cryptography and includes countermeasures
against SPA, DPA and DFA attacks. The routines are used for ECDSA signature generation, ECDSA signature verification,
ECDSA key generation and Elliptic Curve Diffie-Hellman key agreement. In addition, the EC library provides an interface to
an addition function for primitive elliptic curve operations like ECC Add and ECC Double. ECC curves over prime field Fp,
                        n
as well as over GF(2 ) finite field are supported too.
The EC library is delivered as object code and in this way integrated in the user software. The certification covers the
standard NIST [17] and Brainpool [18] Elliptic Curves with key lengths as defined in the SFRs. Note that there are further
uncounted side-channel-secure curve types which the user can optionally add in the composition certification process.
The toolbox library does not provide cryptographic support or additional security functionality as it provides only the
following basic long integer arithmetic and modular functions in software, supported by the cryptographic coprocessor:
Addition, subtraction, division, multiplication, comparison, reduction, modular addition, modular subtraction, modular
multiplication, modular inversion and modular exponentiation. No security relevant policy, mechanism or function is
supported. No security relevant policy, mechanism or function is supported. The toolbox library is deemed for software
developers as support for simplified implementation of long integer and modular arithmetic operations.
The Base Library provides the low level interface to the asymmetric cryptographic coprocessor and is necessary in order
to use the EC, RSA or Toolbox library. Thus it is automatically included in the delivery if any of the aforementioned
libraries (EC, RSA, Toolbox) is ordered. The Base library does not provide any security functionality on its own.
Note:
The cryptographic libraries SCL, RSA, EC and SHA-2 are delivery options. The TOE may come with free combinations of or
even without these libraries. In the case of coming without one or any combination of the cryptographic libraries SCL,
RSA, EC and SHA-2, the TOE does not provide the Additional Specific Security Functionality Rivest-Shamir-Adleman
Cryptography (RSA) and/or Elliptic Curve Cryptography (EC) and/or SHA-2 and/or SCL based Advanced Encryption
Standard (AES) and/or SCL based Triple Data Encryption Standard (TDES).


2.2.3             Interfaces of the TOE
The interfaces are constituted out of:
           The physical interface of the TOE to the external environment is the entire surface of the IC.
           The electrical interface of the TOE to the external environment is constituted by the pads of the chip, particularly
            the contacted RES, I/O, CLK lines and supply lines VCC and GND, as well as by the contactless RF interface. The
            contact based communication is according to ISO 7816/ETSI/EMV.
            Further combinations involving the pads and parts of the RF interface are also possible and described in the
            confidential Security Target [39] and in the hardware reference manual [6].



1
    CRT: Chinese Remainder Theorem



Security Target Lite                                            28                                                  2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

        The RF interface (radio frequency power and signal interface) enables contactless communication between a
         PICC (proximity integration chip card, PICC) and a PCD reader/writer (proximity coupling device, PCD).
         Power supply is received and data are received or transmitted by an antenna which consists of a coil with a few
         turns directly connected to the IC. Depending on customer orders the contactless interface options are set by
         means of blocking either at Infineon premises or at the premises of the user. Note that further interface options
         are available and described in the confidential Security Target [39].
        The data-oriented I/O interface to the TOE is formed by the I/O pad and by the various RF options.
        The interface to the firmware is constituted by special registers used for hardware configuration and control
         (Special Function Registers, SFR).
        The interface of the TOE to the operating system is constituted on one hand by the RMS routine calls and on the
         other by the instruction set of the TOE.
        The interface of the TOE to the test routines is formed by the STS test routine call, i.e. entry to test mode
         (STS-TM entry).
        The interface to the RSA calculations is defined from the RSA library interface.
        The interface to the EC calculations is defined from the EC library interface
        The interface to the SHA-2 calculation is defined from the SHA-2 library interface.
        The interface to the Toolbox is defined from the Toolbox library interface.
        The interface to the symmetric crypto-operations DES/TDES/AES is defined from the SCL library interface.
Note that the interfaces to the optional software libraries (RSA, EC, Toolbox, SHA-2 and SCL) are optionally depending on
the customer order.


2.2.4         Guidance Documentation
The guidance documentation consists of the listing given in the table in chapter 9. The exact versions of these documents
are also given there, as well as the document number referenced here. The documents provide guidance as follows:
        M7892, Controller Family for Security Applications, Hardware Reference Manual [6].
        SLx 70 Family Production and Personalization [7] contains detailed information about the usage of the Flash
         Loader.
        SLE 70 Family Programmer’s Reference User’s Manual [8] describes the usage and interface of the Resource
         Management System RMS.
        SLE 70 Asymmetric Crypto Library for Crypto@2304T, RSA, ECC, Toolbox, User Interface (optional) [9], contains
         all interfaces of the cryptographic RSA- and EC libraries, as well as of the Toolbox library. This document is only
         delivered to the user in case the RSA library and/or the EC library and/or the Toolbox library is/are part of the
         delivered TOE.
        SLE 70 Asymmetric Crypto Library for Crypto@2304T, RSA, ECC, Toolbox, User Interface (optional) [35], contains
         all interfaces of the cryptographic RSA- and EC libraries, as well as of the Toolbox library. This document is only
         delivered to the user in case the RSA library and/or the EC library and/or the Toolbox library is/are part of the
         delivered TOE.

Security Target Lite                                         29                                                   2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

        SCL78 Symmetric Crypto Library for SCPv3 DES / AES 16-bit Security Controller User Interface [10]. This
         document contains the description of the user interface, general concepts and important security guidelines for
         software designers.
        SLx 70 Family, Secure Hash Algorithm SHA-2, (SHA 256/224, SHA 512/384) [11]. This document contains all
         interfaces of the SHA-2 library and is only delivered to the user in case the SHA-2 library is part of the delivered
         TOE.
        Crypto@2304T User Manual [12], describing the architecture of cryptographic coprocessor on register level. It
         also provides a functional description of the register architecture, instruction set and gives programming
         guidance.
        AMM Advanced Mode for NRG SAM [13], Addendum to M7892 Hardware Reference Manual. Additional user
         guidance how to use AMM. This documentation is provisioned to the user if the AMM option has been ordered.
         This user guidance describes the interface and how to use this communication mode. This is an addendum to the
         HRM [6].
        M7892 Security Guidelines [14]. This document discusses and provides code examples of how the user can
         consider the secure programming recommendations.
        M7892 Controller Family for Security Applications, Errata Sheet [15]. It can occur that the TOE or related
         documentation can be updated during the life cycle. This is reported to the users by the confidential Errata
         Sheet.
Finally the certification report may contain an overview of the recommendations to the software developer regarding the
secure use of the TOE. These recommendations are also included in the ordinary documentation.


2.2.5           Forms of Delivery
The TOE can be delivered:

        in form of complete modules
        with or without inlay mounting
        with or without inlay antenna mounting
        in form of plain wafers
        in any IC case (for example TSSOP28, VQFN32, VQFN40, CCS-modules, etc.)
        in no IC case or IC package, simply as bare dies
        or in whatever type of IC package
The form of delivery does not affect the TOE security and it can be delivered in any type, as long as the processes applied
and sites involved have been subject of the appropriate audit.

The delivery can therefore be at the end of phase 3 or at the end of phase 4 which can also include pre-personalization
steps according to PP [11]. Nevertheless in both cases the TOE is finished and the extended test features are removed. In
this document are always both cases mentioned to avoid incorrectness but from the security policy point of view the two
cases are identical.


Security Target Lite                                         30                                                  2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

The delivery to the software developer (phase 2  phase 1) contains the development package and is delivered in form
of documentation as described above, data carriers containing the tools and emulators as development and debugging
tool.
Part of the software delivery could also be the MAE and Flash Loader program, provided by Infineon Technologies AG,
running on the TOE and receiving the transmitted information of the user software to be loaded into the SOLID FLASH™
NVM. The download is only possible after successful authentication and the user software can also be downloaded in an
encrypted way. In addition, the user is after he finalized the download and prior deliver to third party obligated to
permanently lock further use of the Flash Loader (and MAE). Note that it depends on the procurement order, whether
the MAE and Flash Loader program is present or not.

The following table illustrates all TOE components, which may be delivered to a costumer, including the identification of
the delivered format (e.g. whether the user guidance document is delivered as a *.pdf or *.doc file) and the delivery
method (e.g. delivery courier or PGP-encrypted Email).




Security Target Lite                                        31                                                 2020-10-21
                                                                                                                                  M7892 B11
                                                                                                                          Security Target Lite

public

                                                             Table 5: Forms of Delivery

                                                                                                1
    TOE Component                                  Delivered Format        Delivery Method              Comment

    Hardware

    M7892 B11                                      Wafer, IC case,         Postal transfer in           All materials are delivered to
                                                   packages                cages                        distribution centers in cages, locked.

    Firmware

    STS                                            –                       –                            This firmware part of stored on the
                                                                                                        delivered hardware.

    RMS                                            –                       –                            This firmware part of stored on the
                                                                                                        delivered hardware

    SAM                                            –                       –                            This firmware part of stored on the
                                                                                                        delivered hardware.

    NRG software interface routines                –                       –                            This firmware part of stored on the
                                                                                                        delivered hardware.

    Flash Loader                                   –                       –                            This firmware part of stored on the
                                                                                                        delivered hardware.

    Software
                                                                                                    1
    RSA Library                                    L251 Library File       Secured download             Optional; depending on order.
                                                   (object code)
                                                                                                    1
    EC Library                                     L251 Library File       Secured download             Optional; depending on order.
                                                   (object code)
                                                                                                    1
    Toolbox Library                                L251 Library File       Secured download             Optional; depending on order.
                                                   (object code)
                                                                                                    1
    Base Library                                   L251 Library File       Secured download             Optional; depending on presence of
                                                   (object code)                                        RSA, EC and Toolbox.
                                                                                                    1
    SHA-2 Library                                  L251 Library File       Secured download             Optional; depending on order.
                                                   (object code)
                                                                                                    1
    SCL                                            L251 Library File       Secured download             Optional; depending on order.
                                                   (object code)                                        Consists of three library files.



1
    Secured download is a way of delivery of documentation and TOE related software using a secure iShare connected to Infineon customer portal. The
TOE user needs a DMZ Account to login (authenticate) via the Internet.



Security Target Lite                                                       32                                                            2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public

                                                                               1
TOE Component                          Delivered Format      Delivery Method           Comment

Guidance Documentation
                                                                                   1
Hardware Reference Manual [6]          Personalized PDF      Secured download          –
                                                                                   1
Production and Personalization         Personalized PDF      Secured download          –
User’s Manual [7]
                                                                                   1
Programmer’s Reference Manual [8]      Personalized PDF      Secured download          –
                                                                                   1
Asymmetric Crypto Library User         Personalized PDF      Secured download          Optional, delivered if at least one of
Interface for version v1.02.013 [9]                                                    the RSA, EC or Toolbox libraries is
                                                                                       ordered (v1.02.013)
                                                                                   1
Asymmetric Crypto Library User         Personalized PDF      Secured download          Optional, delivered if at least one of
Interface for version v2.07.003 [35]                                                   the RSA, EC or Toolbox libraries is
                                                                                       ordered (v2.07.003)
                                                                                   1
Secure Hash Algorithm SHA-2 [11]       Personalized PDF      Secured download          Optional; delivered if the SHA-2
                                                                                       library is ordered.
                                                                                   1
Crypto@2304T User Manual [12]          Personalized PDF      Secured download          Optional, delivered if the TOE is
                                                                                       ordered with an accessible
                                                                                       Crypto@2304T.
                                                                                   1
M7892 B11 Security Guidelines [14]     Personalized PDF      Secured download          –
                                                                                   1
M7892 B11 Errata Sheet [15]            Personalized PDF      Secured download          –
                                                                                   1
AMM Advanced Mode for NRG SAM          Personalized PDF      Secured download          Optional; delivered if the AMM is
[13]                                                                                   ordered.
                                                                                   1
Symmetric Crypto Library User          Personalized PDF      Secured download          Optional, delivered if the SCL is
Interface [10]                                                                         ordered.


2.2.6         Production Sites
The TOE may be handled in different production sites but the silicon of this TOE is produced in Dresden, Germany only, as
listed below. To distinguish the different production sites of various products in the field, the site is coded into the
Generic Chip Ident Mode (GCIM) data. The exact coding of the generic hip identification data is described in the hardware
reference manual, [6].
The delivery measures are described in the ALC_DVS aspect.
                                       Table 6: Production site in chip identification
                 Production Site             Design Step             Chip Identification
                 Dresden, Germany                 B11                          Byte number 13: 02h



Security Target Lite                                         33                                                     2020-10-21
                                                                                                                                    M7892 B11
                                                                                                                            Security Target Lite

public


3            Conformance Claims (ASE_CCL)

3.1         CC Conformance Claim

This Security Target (ST) and the TOE claim conformance to Common Criteria version v3.1 part 1 [2], part 2 [3] and part 3
[4] following the evaluation methodology will be used for this evaluation “Common Methodology for Information
Technology Security Evaluation” [33].
Furthermore conformance of this ST is claimed for:
Common Criteria part 2 extended and Common Criteria part 3 conformant.
The extended Security Functional Requirements are defined in chapter 6.


3.2         PP Claim

This Security Target is conformant to the Security IC Platform Protection Profile [1].
The Security IC Platform Protection Profile is registered and certified by the Bundesamt für Sicherheit in der
                           1
Informationstechnik (BSI) under the reference:
BSI-PP-0035, Version 1.0, dated 2007-06-15.
The Protection Profile [1] requires the strict conformance for the ST claiming conformance to this PP. This is mentioned in
chapter 2.2 of [1].


3.3         Package Claim

This Security Target does not claim conformance to a package of the PP [1].
The Security Target is EAL6 augmented with the component ALC_FLR.1.
                                           Table 7: Augmentations of the assurance level of the TOE

                   Assurance Class                          Assurance components                                      Description

                  Life-cycle support                                ALC_FLR.1                                Basic flaw remediation


Thus the targeted EAL6+ level includes already the augmentations of the PP [1] (AVA_VAN.5 and ALC_DVS.2) and includes
further augmentations compared to the predefined EAL6 assurance level (this package is defined in CC part 3).


3.4         Conformance Rationale

This Security Target claims conformance to one PP, the Security IC Platform Protection Profile [1].
The Protection Profile requires the strict conformance for the ST claiming conformance to this PP. This is mentioned in
chapter 2.2 of [1].
The Target of Evaluation (TOE) is a typical security IC as defined in PP chapter 1.2.2 comprising:
            The circuitry of the IC (hardware including the physical memories).

1
    Bundesamt für Sicherheit in der Informationstechnik (BSI) is the German Federal Office for Information Security



Security Target Lite                                                         34                                                       2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public

        Configuration data, initialization data related to the IC Dedicated Software and the behavior of the security
         functionality.
        The IC Dedicated Software with the parts.
        The IC Dedicated Test Software.
        The IC Dedicated Support Software.
        The associated user’s guidance documentation.
The TOE is designed, produced and/or generated by the TOE Manufacturer.


3.4.1         Security Problem Definition:
Compared to the PP [1], the security problem definition of this Security Target is enhanced by adding:
        Additional threats (for details refer to chapter 4.1.1).
        Additional organization security policies (for details refer to chapter 4.2.1).
        And additional assumptions (for details refer to chapter 4.3.1).
Aside these add-ons, the security problem definition of this Security Target is consistent with the statement of the
security problem definition in the PP [1], as the Protection Profile [1] demands strict conformance.
The threats and OSPs of the Security Target are a superset of the ones defined in the PP [1]. Although an additional
assumption is defined in the Security Target compared to the PP [1], the Security Target is still strict conformant to the PP
[1], as the added assumption does neither mitigate a threat, which is meant to be addressed by a security objective for
the TOE nor does it fulfils an OSP, which is meant to be addressed by the security objectives for the TOE.


3.4.2         Security Objectives
Compared to the PP [1], the security objectives of this Security Target are enhanced by adding supplemental security
objectives (for details refer to 5.1). These modifications are necessary due to the additional security functionalities, one
coming from the cryptographic libraries - O.Add-Functions, and due to the memory access control - O.Mem-Access,
additional security objectives have been introduced.
The Security Target is still strict conformant to the PP [1], as it is permissible for a Security Target to contain additional
security objectives compared to the PP.


3.4.3         Summary
Due to the rationale provided above the Security Problem Definition (refer to chapter 4) and the Security Objectives (refer
to chapter 5) are strict conformant to the PP [1].
The Security Target enhances the required assurance package EAL4+ augmented with AVA_VAN.5 and ALC_DVS.2 of the
PP [1] to EAL6+ augmented with ALC_FLR.1. Thus the Security Target contains all assurance requirements, respectively
hierarchically higher assurance requirements, of the PP [1].
Furthermore all security functional requirements defined in the PP [1] are included and completely defined in the Security
Target and the augmented security functional requirements are listed in Table 17.



Security Target Lite                                           35                                                 2020-10-21
                                                                                                        M7892 B11
                                                                                                Security Target Lite

public

The following security functional requirements are defined in the Extended Component Definition of the Security Target
(refer to chapter 6):
          FPT_TST.2        “Subset TOE security testing” (Requirements from [1])
All open assignments and selections of the security functional requirements are either done in the PP [1] or in this
Security Target (please refer to chapter 7.1).


3.5       Application Notes

The functional requirement FCS_RNG.1 is a refinement of the FCS_RNG.1 defined in the Protection Profile [1] according to
AIS31, see reference [5].




Security Target Lite                                        36                                              2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public


4         Security Problem Definition (ASE_SPD)

The content of the PP [1] applies to this chapter completely.


4.1      Threats

The threats are directed against the assets and/or the security functions of the TOE. For example, certain attacks are only
one step towards a disclosure of assets while others may directly lead to a compromise of the application security. The
more detailed description of specific attacks is given later on in the process of evaluation and certification. An overview
on attacks is given in PP [1] section 3.2.
The threats to security are defined and described in PP [1] section 3.2.
                                              Table 8: Threats according PP [1]

                       T.Phys-Manipulation          Physical Manipulation

                       T.Phys-Probing               Physical Probing

                       T.Malfunction                Malfunction due to Environmental Stress

                       T.Leak-Inherent              Inherent Information Leakage

                       T.Leak-Forced                Forced Information Leakage

                       T.Abuse-Func                 Abuse of Functionality

                       T.RND                        Deficiency of Random Numbers


4.1.1         Additional Threat due to TOE Specific Functionality
The additional functionality of introducing sophisticated privilege levels and access control allows the secure separation
between the operation system(s) and applications, the secure downloading of applications after personalization and
enables multitasking by separating memory areas and performing access controls between different applications. Due to
this additional functionality “area based memory access control” a new threat is introduced.
The Smartcard Embedded Software is responsible for its User Data according to the assumption “Treatment of User Data
(A.Resp-Appl)”. However, the Smartcard Embedded Software may comprise different parts, for instance an operating
system and one or more applications. In this case, such parts may accidentally or deliberately access data (including code)
of other parts, which may result in a security violation.
The TOE shall avert the threat “Memory Access Violation (T.Mem-Access)” as specified below.

      T.Mem-Access             Memory Access Violation

                               Parts of the Smartcard Embedded Software may cause security violations by
                               accidentally or deliberately accessing restricted data (which may include code) or
                               privilege levels. Any restrictions are defined by the security policy of the specific
                               application context and must be implemented by the Smartcard Embedded Software.




Security Target Lite                                         37                                                2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public

                        Table 9: Additional threats due to TOE specific functions and augmentations

                       T.Mem-Access                 Memory Access Violation


4.1.2         Assets Regarding the Threats
The primary assets concern the User Data which includes the user data as well as program code (Security IC Embedded
Software) stored and in operation and the provided security services. These assets have to be protected while being
executed and or processed and on the other hand, when the TOE is not in operation.
This leads to four primary assets with its related security concerns:
        SC1 Integrity of User Data and of the Security IC Embedded Software (while being executed/processed and while
         being stored in the TOE’s memories),
        SC2 Confidentiality of User Data and of the Security IC Embedded Software (while being processed and while
         being stored in the TOE’s memories)
        SC3 Correct operation of the security services provided by the TOE for the Security IC Embedded Software.
        SC4 Continuous availability of random numbers
SC4 is an additional security service provided by this TOE which is the availability of random numbers. These random
numbers are generated either by a true random number or a deterministic random number generator or by both, when a
true random number is used as seed for the deterministic random number generator. Note that the generation of
random numbers is a requirement of the PP [1].
To be able to protect the listed assets the TOE shall protect its security functionality as well. Therefore critical information
about the TOE shall be protected. Critical information includes:
        logical design data, physical design data, IC Dedicated Software, and configuration data
        Initialization Data and Pre-personalization Data, specific development aids, test and characterization related
         data, material for software development support, and reticles.
The information and material produced and/or processed by the TOE Manufacturer in the TOE development and
production environment (Phases 2 up to TOE Delivery) can be grouped as follows:
        logical design data,
        physical design data,
        IC Dedicated Software, Security IC Embedded Software, Initialization Data and Pre-personalization Data,
        specific development aids,
        test and characterization related data,
        material for software development support, and
        photomasks and products in any form,
as long as they are generated, stored, or processed by the TOE Manufacturer.
For details see PP [1] section 3.1.




Security Target Lite                                          38                                                   2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

4.2      Organizational Security Policies

The TOE has to be protected during the first phases of their lifecycle (phases 2 up to TOE delivery which can be after
phase 3 or phase 4). Later on each variant of the TOE has to protect itself. The organizational security policy covers this
aspect.

      P.Process-TOE           Protection during TOE Development and Production

                              An accurate identification must be established for the TOE. This requires that each
                              instantiation of the TOE carries this unique identification.


The organizational security policies are defined and described in PP [1] section 3.3. Due to the augmentations of PP [1] an
additional policy is introduced and described in the next chapter.
                                 Table 10: Organizational Security Policies according PP [1]

              P.Process-TOE                Protection during TOE Development and Production


4.2.1         Augmented Organizational Security Policy
Due to the augmentations compared to the PP [1] an additional policy is introduced.
The TOE provides specific security functionality, which can be used by the Smartcard Embedded Software. In the
following specific security functionality is listed which is not derived from threats identified for the TOE’s environment
because it can only be decided in the context of the smartcard application, against which threats the Smartcard
Embedded Software will use the specific security functionality.
The IC Developer / Manufacturer must apply the policy “Additional Specific Security Functionality (P.Add-Functions)” as
specified below.

      P.Add-Functions         Additional Specific Security Functionality

                              The TOE shall provide the following specific security functionality to the Smartcard
                              Embedded Software
                                      Advanced Encryption Standard (AES)
                                      Triple Data Encryption Standard (TDES)
                                      Rivest-Shamir-Adleman Cryptography (RSA)
                                      Elliptic Curve Cryptography (EC)
                                      Secure Hash Algorithm SHA-2
Note:
The cryptographic libraries SCL, RSA, EC, SHA-2 and the Toolbox library are delivery options. Therefore the TOE may come
with free combinations of or even without these libraries. In the case of coming without one or any combination of the
cryptographic libraries SCL, RSA, EC and SHA-2, the TOE does not provide the Additional Specific Security Functionality
Rivest-Shamir-Adleman Cryptography (RSA) and/or Elliptic Curve Cryptography (EC) and/or SHA-2 and/or SCL based
Advanced Encryption Standard (AES) and/or SCL based Triple Data Encryption Standard (TDES). The Toolbox library is no
cryptographic library and provides no additional specific security functionality. If RSA, EC or Toolbox are part of the


Security Target Lite                                          39                                               2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public

shipment, the Base Library is automatically included. The Base Library does not provide additional specific security
functionality.
Note:
This TOE can come with both crypto coprocessors accessible, or with a blocked SCP or with a blocked crypto@2304T, or
with both crypto coprocessors blocked. The blocking depends on the customer demands prior to the production of the
hardware. In case the SCP is blocked, no AES and TDES computation supported by hardware is possible (neither solely
hardware based nor SCL based). In case the crypto@2304T is blocked, no RSA and EC computation supported by
hardware is possible. The use of the SHA-2 library is also possible with both crypto coprocessors blocked. No accessibility
of the deselected cryptographic coprocessors is without impact on any other security policy of the TOE; it is exactly
equivalent to the situation where the user decides just not to use the cryptographic coprocessors.


4.3      Assumptions

The TOE assumptions on the operational environment are defined and described in PP [1] section 3.4.
The assumptions concern the phases where the TOE has left the chip manufacturer.

      A.Process-Sec-IC         Protection during Packaging, Finishing and Personalization

                               It is assumed that security procedures are used after delivery of the TOE by the TOE
                               Manufacturer up to delivery to the end-consumer to maintain confidentiality and
                               integrity of the TOE and of its manufacturing and test data (to prevent any possible
                               copy, modification, retention, theft or unauthorised use).



      A.Plat-Appl              Usage of Hardware Platform

                               The Security IC Embedded Software is designed so that the requirements from the
                               following documents are met: (i) TOE guidance documents (refer to the Common
                               Criteria assurance class AGD) such as the hardware data sheet, and the hardware
                               application notes, and (ii) findings of the TOE evaluation reports relevant for the
                               Security IC Embedded Software as documented in the certification report.



      A.Resp-Appl              Treatment of User Data

                               All User Data are owned by Security IC Embedded Software. Therefore, it must be
                               assumed that security relevant User Data (especially cryptographic keys) are treated by
                               the Security IC Embedded Software as defined for its specific application context.


                                           Table 11: Assumption according PP [1]
            A.Process-Sec-IC             Protection during Packaging, Finishing and Personalization
            A.Plat-Appl                  Usage of Hardware Platform
            A.Resp-Appl                  Treatment of User Data

Security Target Lite                                         40                                                     2020-10-21
                                                                                                        M7892 B11
                                                                                                Security Target Lite

public



The support of cipher schemas needs to make an additional assumption.


4.3.1         Augmented Assumptions
The developer of the Smartcard Embedded Software must ensure the appropriate “Usage of Key-dependent Functions
(A.Key-Function)” while developing this software in Phase 1 as specified below.

     A.Key-Function          Usage of Key-dependent Functions
                             Key-dependent functions (if any) shall be implemented in the Smartcard Embedded
                             Software in a way that they are not susceptible to leakage attacks (as described under
                             T.Leak-Inherent and T.Leak-Forced).



Note that here the routines which may compromise keys when being executed are part of the Smartcard Embedded
Software. In contrast to this the threats T.Leak-Inherent and T.Leak-Forced address (i) the cryptographic routines which
are part of the TOE.




Security Target Lite                                       41                                               2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public


5           Security Objectives (ASE_OBJ)

This section shows the subjects and objects, which are relevant to the TOE.
A short overview is given in the following.
The user has the following standard high-level security goals related to the assets:
            SG1 maintain the integrity of User Data and of the Security IC Embedded Software
            SG2 maintain the confidentiality of User Data and of the Security IC Embedded Software
            SG3 maintain the correct operation of the security services provided by the TOE for the Security IC Embedded
             Software
            SG4 provision of random numbers.


5.1        Security Objectives for the TOE

The security objectives of the TOE are defined and described in PP [1] section 4.1.
                                         Table 12: Objectives for the TOE according to PP [1]

          O.Phys-Manipulation              Protection against Physical Manipulation

          O.Phys-Probing                   Protection against Physical Probing

          O.Malfunction                    Protection against Malfunction

          O.Leak-Inherent                  Protection against Inherent Information Leakage

          O.Leak-Forced                    Protection against Forced Information Leakage

          O.Abuse-Func                     Protection against Abuse of Functionality

          O.Identification                 TOE Identification

          O.RND                            Random Numbers


The TOE provides “Additional Specific Security Functionality (O.Add-Functions)” as specified below.

      O.Add-Functions           Additional Specific Security Functionality
                                The TOE must provide the following specific security functionality to the Smartcard
                                Embedded Software:
                                          Advanced Encryption Standard (AES)
                                          Triple Data Encryption Standard (TDES)
                                          Rivest-Shamir-Adleman (RSA)
                                          Elliptic Curve Cryptography (EC)
                                          Secure Hash Algorithm (SHA-2)
Note:
The cryptographic libraries SCL, RSA, EC, SHA-2 and the Toolbox library are delivery options. Therefore the TOE may come
with free combinations of or even without these libraries. In the case of coming without one or any combination of the

Security Target Lite                                             42                                              2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public

cryptographic libraries SCL, RSA, EC and SHA-2, the TOE does not provide the Additional Specific Security Functionality
Rivest-Shamir-Adleman Cryptography (RSA) and/or Elliptic Curve Cryptography (EC) and/or SHA-2 and/or SCL based
Advanced Encryption Standard (AES) and/or SCL based Triple Data Encryption Standard (TDES). The Toolbox library is no
cryptographic library and provides no additional specific security functionality. If RSA, EC or Toolbox are parts of the
shipment, the Base Library is automatically included. The Base Library does not provide additional specific security
functionality.
Note:
This TOE can come with both crypto coprocessors accessible, or with a blocked SCP or with a blocked Crypto@2304T, or
with both crypto coprocessors blocked. The blocking depends on the customer demands prior to the production of the
hardware. In case the SCP is blocked, no AES and TDES computation supported by hardware is possible (neither solely
hardware based nor SCL based). In case the crypto@2304T is blocked, no RSA and EC computation supported by
hardware is possible. The use of the SHA-2 library is also possible with both crypto coprocessors blocked. No accessibility
of the deselected cryptographic coprocessors is without impact on any other security policy of the TOE; it is exactly
equivalent to the situation where the user decides just not to use the cryptographic Coprocessors.


The TOE shall provide “Area based Memory Access Control (O.Mem-Access)” as specified below.

      O.Mem-Access               Area based Memory Access Control

                                 The TOE must provide the Smartcard Embedded Software with the capability to define
                                 restricted access memory areas. The TOE must then enforce the partitioning of such
                                 memory areas so that access of software to memory areas and privilege levels is
                                 controlled as required, for example, in a multi-application environment.


                        Table 13: Additional objectives due to TOE specific functions and augmentations

                           O.Add-Functions            Additional specific security functionality

                           O.Mem-Access               Area based Memory Access Control


5.2      Security Objectives for the Development and Operational Environment

The security objectives for the security IC Embedded Software development environment and the operational
environment is defined in PP [1] section 4.2 and 4.3. The table below lists the security objectives.
                               Table 14: Security objectives for the environment according to PP [1]

                                             OE.Plat-Appl                 Usage of Hardware Platform
                 Phase 1
                                             OE.Resp-Appl                 Treatment of User Data

                 Phase 5 – 6 optional                                     Protection during composite product
                                             OE.Process-Sec-IC
                 Phase 4                                                  manufacturing




Security Target Lite                                             43                                              2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

5.2.1         Clarification of “Usage of Hardware Platform (OE.Plat-Appl)”
Regarding the cryptographic services this objective of the environment has to be clarified. The TOE supports cipher
schemes as additional specific security functionality. If required the Smartcard Embedded Software shall use these
cryptographic services of the TOE and their interface as specified. When key-dependent functions implemented in the
Smartcard Embedded Software are just being executed, the Smartcard Embedded Software must provide protection
against disclosure of confidential data (User Data) stored and/or processed in the TOE by using the methods described
under “Inherent Information Leakage (T.Leak-Inherent)” and “Forced Information Leakage (T.Leak-Forced)“.
The objectives of the environment regarding the memory, software and firmware protection and the SFR and peripheral-
access-rights-handling have to be clarified. For the separation of different applications the Smartcard Embedded Software
(Operating System) may implement a memory management scheme based upon security functions of the TOE.


5.2.2         Clarification of “Treatment of User Data (OE.Resp-Appl)”
Regarding the cryptographic services this objective of the environment has to be clarified. By definition cipher or plain
text data and cryptographic keys are User Data. The Smartcard Embedded Software shall treat these data appropriately,
use only proper secret keys (chosen from a large key space) as input for the cryptographic function of the TOE and use
keys and functions appropriately in order to ensure the strength of cryptographic operation.
This means that keys are treated as confidential as soon as they are generated. The keys must be unique with a very high
probability, as well as cryptographically strong. For example, it must be ensured that it is beyond practicality to derive the
private key from a public key if asymmetric algorithms are used. If keys are imported into the TOE and/or derived from
other keys, quality and confidentiality must be maintained. This implies that appropriate key management has to be
realized in the environment.
Regarding the memory, software and firmware protection and the SFR and peripheral access rights handling these
objectives of the environment has to be clarified. The treatment of User Data is also required when a multi-application
operating system is implemented as part of the Smartcard Embedded Software on the TOE. In this case the multi-
application operating system should not disclose security relevant user data of one application to another application
when it is processed or stored on the TOE.


5.2.3         Clarification of “Protection during composite product manufacturing
                 (OE.Process-Sec-IC)”
The protection during packaging, finishing and personalization includes also the personalization process (Flash Loader
software) and the personalization data (TOE software components) during Phase 4, Phase 5 and Phase 6.




Security Target Lite                                         44                                                   2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

5.3      Security Objectives Rationale

The security objectives rationale of the TOE are defined and described in PP [1] section 4.4. For the additional objectives
of this ST a rational is provided below.
                                           Table 15: Security Objective Rationale
                       Assumption, Threat or Organisational
                       Security Policy                                Security Objective
                       P.Add-Functions                                O.Add-Functions
                                                                      OE.Plat-Appl
                       A.Key-Function
                                                                      OE.Resp-Appl
                       T.Mem-Access                                   O.Mem-Access


The justification related to the security objective “Additional Specific Security Functionality (O.Add-Functions)” is as
follows: Since O.Add-Functions requires the TOE to implement exactly the same specific security functionality as required
by P.Add-Functions; the organizational security policy is covered by the objective.
Nevertheless the security objectives O.Leak-Inherent, O.Phys-Probing, O.Malfunction, O.Phys-Manipulation and O.Leak-
Forced define how to implement the specific security functionality required by P.Add-Functions. (Note that these
objectives support that the specific security functionality is provided in a secure way as expected from P.Add-Functions.)
Especially O.Leak-Inherent and O.Leak-Forced refer to the protection of confidential data (User Data or TSF data) in
general. User Data are also processed by the specific security functionality required by P.Add-Functions.
Compared to PP [1] clarification has been made for the security objective “Usage of Hardware Platform (OE.Plat-Appl)”: If
required the Smartcard Embedded Software shall use these cryptographic services of the TOE and their interface as
specified. In addition, the Smartcard Embedded Software must implement functions which perform operations on keys (if
any) in such a manner that they do not disclose information about confidential data. The non-disclosure due to leakage
A.Key-Function attacks is included in this objective OE.Plat-Appl. This addition ensures that the assumption A.Plat-Appl is
still covered by the objective OE.Plat-Appl although additional functions are being supported according to O.Add-
Functions.
Compared to the PP [1] a clarification has been made for the security objective “Treatment of User Data (OE.Resp-Appl)”:
By definition cipher or plain text data and cryptographic keys are User Data. So, the Smartcard Embedded Software will
protect such data if required and use keys and functions appropriately in order to ensure the strength of cryptographic
operation. Quality and confidentiality must be maintained for keys that are imported and/or derived from other keys.
This implies that appropriate key management has to be realized in the environment. That is expressed by the
assumption A.Key-Function which is covered from OE.Resp-Appl. These measures make sure that the assumption A.Resp-
Appl is still covered by the security objective OE.Resp-Appl although additional functions are being supported according
to P.Add-Functions.
Compared to the PP [1] an enhancement regarding memory area protection has been established. The clear definition of
privilege levels for operated software establishes the clear separation of different restricted memory areas for running
the firmware, downloading and/or running the operating system and to establish a clear separation between different

Security Target Lite                                          45                                               2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

applications. Nevertheless, it is also possible to define a shared memory section where separated applications may
exchange defined data. The privilege levels clearly define by using a hierarchical model the access right from one level to
the other. These measures ensure that the threat T.Mem-Access is clearly covered by the security objective O.Mem-
Access.
The justification of the additional policy and the additional assumption show that they do not contradict to the rationale
already given in the Protection Profile for the assumptions, policy and threats defined there.




Security Target Lite                                         46                                                2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public


6          Extended Component Definition (ASE_ECD)

There are four extended components defined and described for the TOE:
          the family FCS_RNG at the class FCS Cryptographic Support
          the family FMT_LIM at the class FMT Security Management
          the family FAU_SAS at the class FAU Security Audit
          the component FPT_TST.2 at the class FPT Protection of the TSF
The extended components FCS_RNG, FMT_LIM and FAU_SAS are defined and described in PP [1] section 5. The
component FPT_TST.2 is defined in the following.


6.1       Component “Subset TOE Security Testing (FPT_TST.2)”

The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall support
that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests can be initiated
by the Smartcard Embedded Software and/or by the TOE or is done automatically and continuously.
Part 2 of the Common Criteria provides the security functional component “TSF testing (FPT_TST.1)”. The component
FPT_TST.1 provides the ability to test the TSF’s correct operation.
For the user it is important to know which security functions or mechanisms can be tested. The functional component
FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires
verification of the integrity of TSF data and of the stored TSF executable code which might violate the security policy.
Therefore, the functional component “Subset TOE security testing (FPT_TST.2)” of the family TSF self-test has been newly
created. This component allows that particular parts of the security mechanisms and functions provided by the TOE are
tested.


6.2       Definition of FPT_TST.2

The functional component “Subset TOE security testing (FPT_TST.2)” has been newly created (Common Criteria Part 2
extended). This component allows that particular parts of the security mechanisms and functions provided by the TOE can
be tested after TOE Delivery or are tested automatically and continuously during normal operation transparent for the
user.
This security functional component is used instead of the functional component FPT_TST.1 from Common Criteria Part 2.
For the user it is important to know which security functions or mechanisms can be tested. The functional component
FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires
verifying the integrity of TSF data and stored TSF executable code which might violate the security policy.
The functional component “Subset TOE testing (FPT_TST.2)” is specified as follows (Common Criteria Part 2 extended).




Security Target Lite                                            47                                            2020-10-21
                                                                                                                  M7892 B11
                                                                                                          Security Target Lite

public

6.2.1         TSF Self-Test (FPT_TST)
Family Behavior The Family Behavior is defined in [3] section 15.14 (442, 443).
Component leveling



                                                                                                          1
                                FPT_TST         TSF self test
                                                                                                          2

     FPT_TST.1         The component FPT_TST.1 is defined in [3] section 15.14 (444, 445, 446).

     FPT_TST.2         Subset TOE security testing, provides the ability to test the correct operation of particular
                       security functions or mechanisms. These tests may be performed at start-up, periodically, at the
                       request of the authorized user, or when other conditions are met. It also provides the ability to
                       verify the integrity of TSF data and executable code.
                       Management: FPT_TST.2
                       The following actions could be considered for the management functions in FMT:
                               Management of the conditions under which subset TSF self-testing occurs, such as
                                during initial start-up, regular interval or under specified conditions
                               Management of the time of the interval appropriate.
                       Audit: FPT_TST.2

                       There are no auditable events foreseen.



     FPT_TST.2                 Subset TOE Testing

     Hierarchical to           No other components.

     Dependencies:             No dependencies to other components.

     FPT_TST.2.1               The TSF shall run a suite of self-tests [selection: during initial start-up, periodically
                               during normal operation, at the request of the authorized user, and/or at the conditions
                               [assignment: conditions under which self-test should occur]] to demonstrate the correct
                               operation of [assignment: functions and/or mechanisms].




Security Target Lite                                            48                                                  2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public


7         Security Requirements (ASE_REQ)

For this section the PP [1] section 6 can be applied completely.


7.1      TOE Security Functional Requirements

The security functional requirements (SFR) for the TOE are defined and described in the PP [1] section 6.1 and in the
following description.
The Table 15 provides an overview of the functional security requirements of the TOE, defined in the in PP [1] section 6.1.
In the last column it is marked if the requirement is refined. The refinements are also valid for this ST.
                                 Table 16: Security functional requirements defined in PP [1]

                              Security Functional Requirement                                Refined in PP [1]

           FRU_FLT.2        “Limited fault tolerance“                                                Yes

           FPT_FLS.1        “Failure with preservation of secure state”                              Yes

           FMT_LIM.1        “Limited capabilities”                                                   No

           FMT_LIM.2        “Limited availability”                                                   No

           FAU_SAS.1        “Audit storage”                                                          No

           FPT_PHP.3        “Resistance to physical attack”                                          Yes

           FDP_ITT.1        “Basic internal transfer protection”                                     Yes

           FPT_ITT.1        “Basic internal TSF data transfer protection                             Yes

           FDP_IFC.1        “Subset information flow control”                                        No

           FCS_RNG.1        “Random Number Generation”                                               No


The Table 16 provides an overview about the augmented security functional requirements, which are added
supplemental to the TOE and defined in this ST. All requirements are taken from Common Criteria Part 2 [3], with the
exception of the requirement FPT_TST.2, which is defined in this ST completely.
                                   Table 17: Augmented security functional requirements

                                              Security Functional Requirement

            FPT_TST.2                                    “Subset TOE security testing“

            FDP_ACC.1                                    “Subset access control”

            FDP_ACF.1                                    “Security attribute based access control”

            FMT_MSA.1                                    “Management of security attributes”

            FMT_MSA.3                                    “Static attribute initialization”

            FMT_SMF.1                                    “Specification of Management functions”


Security Target Lite                                          49                                                 2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

                                           Security Functional Requirement

           FCS_COP.1/TDES                             “Cryptographic support -TDES”

           FCS_COP.1/AES                              “Cryptographic support - AES”

           FCS_COP.1/TDES_SCL                         “Cryptographic support TDES-SCL”

           FCS_COP.1/AES_SCL                          “Cryptographic support AES-SCL”

           FCS_COP.1/RSA-v1.02.013                    “Cryptographic support - RSA”

           FCS_COP.1/RSA-v2.07.003                    “Cryptographic support - RSA”

           FCS_CKM.1/RSA-v2.07.003                    “Cryptographic key management - EC”

           FCS_COP.1/ECDSA-v1.02.013                  “Cryptographic support - ECDSA”

           FCS_COP.1/ECDSA-v2.07.003                  “Cryptographic support - ECDSA”

           FCS_COP.1/ECDH-v1.02.013                   “Cryptographic support - ECDH”

           FCS_COP.1/ECDH-v2.07.003                   “Cryptographic support - ECDH”

           FCS_CKM.1/EC-v1.02.013                     “Cryptographic key management - EC”

           FCS_CKM.1/EC-v2.07.003                     “Cryptographic key management - EC”

           FCS_COP.1/SHA                              “Cryptographic support - SHA”

           FCS_CKM.4/TDES                             “Cryptographic key destruction - TDES”

           FCS_CKM.4/AES                              “Cryptographic key destruction - AES”

           FCS_CKM.4/TDES_SCL                         “Cryptographic key destruction –TDES-SCL”

           FCS_CKM.4/AES_SCL                          “Cryptographic key destruction - AES-SCL”

           FDP_SDI.1                                  “Stored data integrity monitoring”

           FDP_SDI.2                                  “Stored data integrity monitoring and action”


All assignments and selections of the security functional requirements of the TOE are either done in the PP [1] or in the
following description.


7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1
7.1.1.1 FCS_RNG
To define the IT security functional requirements of the TOE an additional family (FCS_RNG) of the Class FCS
(cryptographic support) is defined as an extended component in the PP [1]. This family describes the functional
requirements for random number generation used for cryptographic purposes. The PP [1] does already provide an
instance of this SFR with a completed selection and a partially completed assignment. The instance of FCS_RNG.1 that will
be used within this ST is completed according to AIS31 [5]. The element FCS_RNG.1.1 was subject of an editorial
refinement in order to provide an easy integration of the PTG.2 class from AIS31 [5]. Furthermore the element


Security Target Lite                                       50                                                2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public

FCS_RNG.1.2 was functionally refined, which is indicated by the underlined text. This refinement does specify the format
of the provided random numbers and does not mitigate the security functional requirement, as defined in the PP [1]. The
Security Target is still strict conformant to the PP [1], as the refined FCS_RNG.1 still meets the requirement as defined in
the PP [1].

 FCS_RNG.1                   Random number generation

 Hierarchical to             No other components.

 Dependencies:               No dependencies.

 FCS_RNG.1                   Random numbers generation Class PTG.2 according to [5]

 FCS_RNG.1.1                 The TSF shall provide a physical random number generator that implements:

                               PTG.2.1          A total failure test detects a total failure of entropy source
                                   immediately when the RNG has started. When a total failure is detected, no random
                                   numbers will be output.

                               PTG.2.2          If a total failure of the entropy source occurs while the RNG is being
                                   operated, the RNG prevents the output of any internal random number that
                                   depends on some raw random numbers that have been generated after the total
                                   failure of the entropy source.

                               PTG.2.3          The online test shall detect non-tolerable statistical defects of the raw
                                   random number sequence (i) immediately when the RNG has started, and (ii) while
                                   the RNG is being operated. The TSF must not output any random numbers before
                                   the power-up online test has finished successfully or when a defect has been
                                   detected.

                               PTG.2.4          The online test procedure shall be effective to detect non-tolerable
                                   weaknesses of the random numbers soon.

                               PTG.2.5 The online test procedure checks the quality of the raw random number
                                   sequence. It is triggered continuously. The online test is suitable for detecting non-
                                   tolerable statistical defects of the statistical properties of the raw random numbers
                                   within an acceptable period of time.

 FCS_RNG.1.2                 The TSF shall provide numbers in the format 8- or 16-bit that meet:

                               PTG.2.6          Test procedure A, as defined in [5] does not distinguish the internal
                                   random numbers from output sequences of an ideal RNG.

                               PTG.2.7          The average Shannon entropy per internal random bit exceeds 0.997.
Note:
The physical random number generator implements total failure test of the random source and a continuous RNG test
according to following standard:



Security Target Lite                                          51                                                   2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

National Institute of Standards and Technology, Security Requirements for Cryptographic Modules, Federal Information
Processing Standards Publication (FIPS) 140-2 [31], 2002-12-03, chapter 4.9.2.

7.1.1.2 FAU_SAS
To define the security functional requirements of the TOE an additional family (FAU_SAS) of the Class FAU (Security Audit)
is defined here. This family describes the functional requirements for the storage of audit data. It has a more general
approach than FAU_GEN, because it does not necessarily require the data to be generated by the TOE itself and because
it does not give specific details of the content of the audit records.
The TOE shall meet the requirement “Audit storage (FAU_SAS.1)” as specified below (Common Criteria Part 2 extended).

 FAU_SAS.1                    Audit Storage

 Hierarchical to              No other components.

 Dependencies:                No dependencies.

 FAU_SAS.1.1                  The TSF shall provide the test process before TOE Delivery with the capability to store
                              the Initialization Data and/or Pre-personalization Data and/or supplements of the
                              Security IC Embedded Software in the not changeable configuration page area and non-
                              volatile memory.


7.1.2          Subset of TOE Testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall support
that particular security functions or mechanisms are tested in the operational phase (Phase 7). The tests can be initiated
by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria Part 2
extended).

 FPT_TST.2                    Subset TOE testing

 Hierarchical to              No other components.

 Dependencies:                No dependencies.

 FPT_TST.2.1                  The TSF shall run a suite of self-tests at the request of the authorized user to
                              demonstrate the correct operation of the alarm lines and/or following environmental
                              sensor mechanisms:
                              Please refer to the confidential Security Target [39].


7.1.3          Memory Access Control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent that one
application can access code and/or data of another application. For this reason the TOE provides Area based Memory
Access Control. The underlying memory management unit (MMU) is documented in section 4 of the hardware reference
manual [6].


Security Target Lite                                           52                                             2020-10-21
                                                                                                             M7892 B11
                                                                                                     Security Target Lite

public

The security service being provided is described in the Security Function Policy (SFP) Memory Access Control Policy. The
security functional requirement “Subset access control (FDP_ACC.1)” requires that this policy is in place and defines the
scope were it applies. The security functional requirement “Security attribute based access control (FDP_ACF.1)” defines
security attribute usage and characteristics of policies. It describes the rules for the function that implements the Security
Function Policy (SFP) as identified in FDP_ACC.1. The decision whether an access is permitted or not is taken based upon
attributes allocated to the software. The Smartcard Embedded Software defines the attributes and memory areas. The
corresponding permission control information is evaluated “on-the-fly” by the hardware so that access is
granted/effective or denied/inoperable.
The security functional requirement “Static attribute initialization (FMT_MSA.3)” ensures that the default values of
security attributes are appropriately either permissive or restrictive in nature. Alternative values can be specified by any
subject provided that the Memory Access Control Policy allows that. This is described by the security functional
requirement “Management of security attributes (FMT_MSA.1)”. The attributes are determined during TOE
manufacturing (FMT_MSA.3) or set at run-time (FMT_MSA.1).
From TOE’s point of view the different roles in the Smartcard Embedded Software can be distinguished according to the
memory based access control. However the definition of the roles belongs to the user software.
The following Security Function Policy (SFP) Memory Access Control Policy is defined for the requirement “Security
attribute based access control (FDP_ACF.1)”:
 Memory Access Control
 Policy

                              The TOE shall control read, write, delete and execute accesses of software running at
                              the privilege levels as defined below. Any access is controlled, regardless whether the
                              access is on code or data or a jump on any other privilege level outside the current one.

                              The memory model provides distinct, independent privilege levels separated from each
                              other in the virtual address space. More information is given in the confidential Security
                              Target [39].




The TOE shall meet the requirement “Subset access control (FDP_ACC.1)” as specified below.

 FDP_ACC.1                    Subset access control

 Hierarchical to              No other components.

 Dependencies:                FDP_ACF.1 Security attribute based access control

 FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy on all subjects (software
                              running at the defined and assigned privilege levels), all objects (data including code
                              stored in memories) and all the operations defined in the Memory Access Control Policy,
                              i.e. privilege levels.



Security Target Lite                                         53                                                   2020-10-21
                                                                                                                          M7892 B11
                                                                                                                  Security Target Lite

public

The TOE shall meet the requirement “Security attribute based access control (FDP_ACF.1)” as specified below.

    FDP_ACF.1                           Security attribute based access control

    Hierarchical to                     No other components.

    Dependencies:                       FDP_ACC.1 Subset access control
                                        FMT_MSA.3 Static attribute initialization

    FDP_ACF.1.1                         The TSF shall enforce the Memory Access Control Policy to objects based on the
                                        following:
                                        Subject:
                                                  Software running at the IFX, OS1 and OS2 privilege levels required to securely
                                                   operate the chip. This includes also privilege levels running interrupt routines.
                                                  Software running at the privilege levels containing the application software
                                        Object:
                                                  Data including code stored in memories
                                        Attributes:
                                                  The memory area where the access is performed to and/or
                                                  The operation to be performed.

    FDP_ACF.1.2                         The TSF shall enforce the following rules to determine if an operation among controlled
                                        subjects and controlled objects is allowed:
                                        evaluate the corresponding permission control information of the relevant memory
                                        range before, during or after the access so that accesses to be denied can not be utilized
                                        by the subject attempting to perform the operation.

    FDP_ACF.1.3                         The TSF shall explicitly authorize access of subjects to objects based on the following
                                        additional rules: none.

    FDP_ACF.1.4                         The TSF shall explicitly deny access of subjects to objects based on the following
                                        additional rules: none.


The TOE shall meet the requirement “Static attribute initialization (FMT_MSA.3)” as specified below.

    FMT_MSA.3                           Static attribute initialization

    Hierarchical to                     No other components.

    Dependencies:                       FMT_MSA.1 Management of security attributes
                                        FMT_SMR.1 Security roles
                                                                                                                             1
    FMT_MSA.3.1                         The TSF shall enforce the Memory Access Control Policy to provide well defined default
                                        values for security attributes that are used to enforce the SFP.


1
    The static definition of the access rules is documented in [6]



Security Target Lite                                                      54                                                     2020-10-21
                                                                                                                                M7892 B11
                                                                                                                        Security Target Lite

public

    FMT_MSA.3.2                      The TSF shall allow any subject, provided that the Memory Access Control Policy is
                                                                                                          1
                                     enforced and the necessary access is therefore allowed , to specify alternative initial
                                     values to override the default values when an object or information is created.


The TOE shall meet the requirement “Management of security attributes (FMT_MSA.1)” as specified below:

    FMT_MSA.1                        Management of security attributes

    Hierarchical to                  No other components.

    Dependencies:                    [FDP_ACC.1 Subset access control or
                                     FDP_IFC.1 Subset information flow control]
                                     FMT_SMF.1 Specification of management functions
                                     FMT_SMR.1 Security roles

    FMT_MSA.1.1                      The TSF shall enforce the Memory Access Control Policy to restrict the ability to change
                                     default, modify or delete the security attributes permission control information to the
                                     software running on the privilege levels.


The TOE shall meet the requirement “Specification of management functions (FMT_SMF.1)” as specified below:

    FMT_SMF.1                        Specification of management functions

    Hierarchical to                  No other components.

    Dependencies:                    No dependencies.

    FMT_SMF.1.1                      The TSF shall be capable of performing the following security management functions:
                                     access the configuration registers of the MMU.




7.1.4              Support of Cipher Schemes
The following additional specific security functionality is implemented in the TOE:
FCS_COP.1 Cryptographic operation requires a cryptographic operation to be performed in accordance with a specified
algorithm and with a cryptographic key of specified sizes. The specified algorithm and cryptographic key sizes can be
based on an assigned standard; dependencies are discussed in Section 7.3.1.1 “Dependencies of Security Functional
Requirements”.
The following additional specific security functionality is implemented in the TOE:
                                                         2
            Advanced Encryption Standard (AES)
                                                             2
            Triple Data Encryption Standard (TDES)


1
    The Smartcard Embedded Software is intended to set the memory access control policy
2
    The TOE provides a solely hardware based AES and TDES implementation and the AES and TDES calculations provided by the SCL.



Security Target Lite                                                      55                                                      2020-10-21
                                                                                                                                    M7892 B11
                                                                                                                            Security Target Lite

public
                                                     1
            Elliptic Curve Cryptography (EC)
                                                 1
            Rivest-Shamir-Adleman (RSA)
            Secure Hash Algorithm (SHA-2)
Note that the additional function of the EC library, providing the primitive elliptic curve operations, does not add specific
security functionality.
Note:
This TOE can come with both crypto coprocessors accessible, or with a blocked SCP or with a blocked crypto@2304T, or
with both crypto coprocessors blocked. The blocking depends on the customer demands prior to the production of the
hardware. In case the SCP is blocked, no AES and TDES computation supported by hardware is possible (neither solely
hardware based nor SCL based). In case the crypto@2304T is blocked, no RSA and EC computation supported by
hardware is possible. In case of a blocked crypto@2304T the optionally delivered cryptographic and the supporting
Toolbox and Base Library cannot be used in that TOE product. The use of the SHA-2 library is also possible with both
crypto coprocessors blocked. No accessibility of the deselected cryptographic coprocessors is without impact on any
other security policy of the TOE; it is exactly equivalent to the situation where the user decides just not to use the
cryptographic coprocessors.




1
    For the case the TOE comes without RSA and/or EC library, the TOE provides basic HW-related routines for RSA and/or EC calculations. For a secure
library implementation the user has to implement additional countermeasures himself.



Security Target Lite                                                        56                                                             2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

7.1.4.1 Triple-DES Operation
The DES Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and “Cryptographic key
destruction (FCS_CKM.4)”as specified below.

 FCS_COP.1/TDES              Cryptographic operation - TDES

 Hierarchical to             No other components.

 Dependencies:               [FDP_ITC.1 Import of user data without security attributes, or
                             FDP_ITC.2 Import of user data with security attributes, or
                             FCS_CKM.1 Cryptographic key management]
                             FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/TDES            The TSF shall perform encryption and decryption in accordance with a specified
                             cryptographic algorithm Triple Data Encryption Standard (TDES) in the Electronic
                             Codebook Mode (ECB), the Cipher Block Chaining Mode (CBC), the Blinding Feedback
                             Mode (BLD), the Recrypt Mode, the Cipher Block Chaining Mode (CBC-MAC), the CBC-
                             MAC- encrypt-last-block (CBC-MAC-ELB) mode and cryptographic key sizes of 2 x 56 bit
                             or 3 x 56 bit, that meet the following standards:

                                     Triple Data Encryption Standard (TDES):
                                      National Institute of Standards and Technology (NIST) SP 800-67 Rev. 2 [22].

                                     Block Cipher Modes: ECB, CBC
                                      National Institute of Standards and Technology (NIST) SP 800-38A [28].

                                     Block Cipher Modes: BLD, Recrypt
                                      Proprietary, a description is given in the hardware reference manual HRM [6].

                                     Block Cipher Modes: CBC-MAC, CBC-MAC-ELB: [34]
Note:
This SFR applies to the solely hardware based TDES calculation and is not applicable if the TOE is delivered with a blocked
SCP.
For more information about the implementation of CBC-MAC-ELB see [15].




Security Target Lite                                        57                                                  2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/TDES                Cryptographic key destruction – TDES

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4.1/TDES              The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                               key destruction method overwriting or zeroing that meets the following:

                               None
Note:
This SFR applies to the solely hardware based TDES and is not applicable if the TOE is delivered with a blocked SCP. The
key destruction can be done by overwriting the key register interfaces or by a software reset of the SCP, which provides
immediate zeroing of all SCP key registers.



 FCS_COP.1/TDES_SCL            Cryptographic operation - TDES_SCL

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key management]
                               FCS_CKM.4 Cryptographic key destruction.

 FCS_COP.1.1/TDES_SCL          The TSF shall perform encryption and decryption in accordance with a specified
                               cryptographic algorithm Triple Data Encryption Standard (TDES) in the Electronic
                               Codebook Mode (ECB), in the Cipher Block Chaining Mode (CBC), Cipher Feedback
                               (CFB) and Counter (CTR) Modes and cryptographic key sizes of 112 bit and 168 bit that
                               meet the following standards:

                                       Triple Data Encryption Standard (TDES):
                                        National Institute of Standards and Technology (NIST) SP 800-67 Rev. 2 [22].
                                       Block Cipher Modes: ECB, CBC, CFB, CTR:
                                        National Institute of Standards and Technology (NIST) SP 800-38A [28].
Note:
This SFR refers to the TDES calculations provided by the optional symmetric cryptographic library (SCL) and is not
applicable if the TOE is delivered with a blocked TDES SCP or without SCL.




Security Target Lite                                        58                                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/TDES_SCL           Cryptographic key destruction – TDES_SCL

 Hierarchical to:             No other components.

 Dependencies:                [FDP_ITC.1 Import of user data without security attributes, or
                              FDP_ITC.2 Import of user data with security attributes, or
                              FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4/TDES_SCL           The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                              key destruction method overwriting or zeroing that meets the following:

                              None
Note:
This SFR refers to the TDES provided by the optional symmetric cryptographic library (SCL) and is not applicable if the TOE
is delivered with a blocked SCP or without SCL. The key destruction can be done by overwriting the key register interfaces
or by software reset of the SCP which provides immediate zeroing of all SCP key registers. The data object stored in the
memory of the TOE can be destroyed using the “Cipher_Close()” function of the SCL.




Security Target Lite                                        59                                                  2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

7.1.4.2 AES Operation
The AES Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” and “Cryptographic key
destruction (FCS_CKM.4)” as specified below.

 FCS_COP.1/AES                   Cryptographic operation - AES

 Hierarchical to                 No other components.

 Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                 FDP_ITC.2 Import of user data with security attributes, or
                                 FCS_CKM.1 Cryptographic key generation]
                                 FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/AES                 The TSF shall perform encryption and decryption in accordance with a specified
                                 cryptographic algorithm Advanced Encryption Standard (AES) in the Electronic Codebook
                                 Mode (ECB), the Cipher Block Chaining Mode (CBC), the Blinding Feedback Mode (BLD),
                                 the Recrypt Mode, the Cipher Block Chaining Mode (CBC-MAC), the CBC-MAC- encrypt-
                                 last-block (CBC-MAC-ELB) mode and cryptographic key sizes of 128 bit or 192 bit or 256
                                 bit that meet the following standards:

                                         Advanced Encryption Standard (AES)
                                          U.S. Department of Commerce, National Institute of Standards and Technology,
                                          Information Technology Laboratory (ITL),
                                          Advanced Encryption Standard (AES), FIPS 197 [23]

                                         Block Cipher Modes: CBC, ECB
                                          National Institute of Standards and Technology (NIST) SP 800-38A [28].

                                         Block Cipher Modes: BLD, Recrypt
                                          Proprietary, a description is given in the hardware reference manual HRM [6].

                                         Block Cipher Modes: CBC-MAC, CBC-MAC-ELB: [34]
Note:
This SFR refers to the solely hardware based AES calculation and is not applicable if the TOE is delivered with a blocked
SCP.
For more information about the implementation of CBC-MAC-ELB see [15].


 FCS_CKM.4/AES          Cryptographic key destruction – AES
 Hierarchical to:       No other components.
 Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or
                        FDP_ITC.2 Import of user data with security attributes, or
                        FCS_CKM.1 Cryptographic key generation]
 FCS_CKM.4.1/AES        The TSF shall destroy cryptographic keys in accordance with a specified cryptographic key



Security Target Lite                                         60                                                  2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

                        destruction method overwriting or zeroing that meets the following:
                        None
Note:
This SFR refers to the solely hardware based AES and is not applicable if the TOE is delivered with a blocked SCP. The key
destruction can be done by overwriting the key register interfaces or by a software reset of the SCP, which provides
immediate zeroing of all SCP key registers.



 FCS_COP.1/AES_SCL             Cryptographic operation – AES_SCL

 Hierarchical to:              No other components.

 Dependencies:                 [FDP_ITC.1 Import of user data without security attributes, or
                               FDP_ITC.2 Import of user data with security attributes, or
                               FCS_CKM.1 Cryptographic key generation]
                               FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/AES_SCL           The TSF shall perform encryption and decryption in accordance with a specified
                               cryptographic algorithm Advanced Encryption Standard (AES) in the Electronic
                               Codebook Mode (ECB), Cipher Block Chaining Mode (CBC), Counter Mode (CTR) and
                               Cipher Feedback Mode (CFB) and cryptographic key sizes of 128 bit or 192 bit or 256 bit
                               that meet the following standards:

                                      Advanced Encryption Standard (AES):
                                       U.S. Department of Commerce, National Institute of Standards and
                                       Technology, Information Technology Laboratory (ITL),
                                       Advanced Encryption Standard (AES), FIPS 197 [23]
                                      Block Cipher Modes: ECB, CBC, CTR, CFB
                                       National Institute of Standards and Technology (NIST) SP 800-38A [28]
Note:
This SFR applies to the AES calculations provided by the optional symmetric cryptographic library (SCL) and is not
applicable if the TOE is delivered with a blocked SCP or without SCL.




Security Target Lite                                         61                                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 FCS_CKM.4/AES_SCL           Cryptographic key destruction – AES_SCL

 Hierarchical to:            No other components.

 Dependencies:               [FDP_ITC.1 Import of user data without security attributes, or
                             FDP_ITC.2 Import of user data with security attributes, or
                             FCS_CKM.1 Cryptographic key generation]

 FCS_CKM.4.1/AES_SCL         The TSF shall destroy cryptographic keys in accordance with a specified cryptographic
                             key destruction method overwriting or zeroing that meets the following:

                             None
Note:
This SFR refers to the AES provided by the optional symmetric cryptographic library (SCL) and is not applicable if the TOE
is delivered with a blocked SCP or without SCL. The key destruction can be done by overwriting the key register interfaces
or by software reset of the SCP which provides immediate zeroing of all SCP key registers. The data object stored in the
memory of the TOE can be destroyed using the “Cipher_Close()” function of the SCL.




Security Target Lite                                        62                                                  2020-10-21
                                                                                                              M7892 B11
                                                                                                      Security Target Lite

public

7.1.4.3 Rivest-Shamir-Adleman (RSA) Operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” as
specified below.

                                     Valid for cryptographic library version v1.02.013:
 FCS_COP.1/RSA-        Cryptographic operation
 v1.02.013


 Hierarchical to:      No other components.


 Dependencies:         [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/RSA-      The TSF shall perform encryption and decryption in accordance with a specified cryptographic
 v1.02.013             algorithm Rivest-Shamir-Adleman (RSA) and cryptographic key sizes 1024- 4096 bits that meet the
                       following standards:

                       Encryption (for key sizes up to 2048):
                       According to section 5.1.1 RSAEP in PKCS [21] without 5.1.1.1.

                       Decryption (with or without CRT):
                       According to section 5.1.2 RSADP in PKCS [21] for u = 2, i.e., without any (r_i, d_i, t_i), i >2,
                                                                                                                      2048
                       therefore without 5.1.2.2.b (ii)&(v), without 5.1.2.1. 5.1.2.2.a, only supported up to n < 2

                       Signature Generation (with or without CRT):
                       According to section 5.2.1 RSASP1 in PKCS [21] for u = 2, i.e., without any (r_i, d_i, t_i), i >2,
                       therefore without 5.2.1.2.b (ii)&(v), without 5.2.1.1.
                                                               2048
                       5.2.1.2.a, only supported up to n < 2

                       Signature Verification:
                       According to section 5.2.2 RSAVP1 in PKCS [21],
                       without 5.2.2.1.



                                     Valid for cryptographic library version v2.07.003

 FCS_COP.1/RSA-         Cryptographic operation - RSA
 v2.07.003

 Hierarchical to:       No other components.

 Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or
                        FDP_ITC.2 Import of user data with security attributes, or


Security Target Lite                                            63                                                    2020-10-21
                                                                                                       M7892 B11
                                                                                               Security Target Lite

public

                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/RSA-      The TSF shall perform encryption and decryption in accordance with a specified cryptographic
 v2.07.003             algorithm Rivest-Shamir-Adleman (RSA) and cryptographic key sizes 1976- 4096 bits that meet
                       the following standards:

                       Encryption (for key sizes up to 2048):
                       1. According to section 5.1.1 RSAEP in PKCS [21]:
                                                          2048 + 64
                                Supported for n < 2

                                5.1.1(1) not supported

                       2. According to section 8.2.2 IFEP-RSA in IEEE [27]:
                                              2048 + 64
                       Supported for n < 2

                       Decryption (with or without CRT):
                       1. According to section 5.1.2 RSADP in PKCS [21]:

                       for u = 2, i.e., without any (ri, di, ti), i > 2

                                5.1.2(1) not supported
                                                                         2048 + 64
                                5.1.2(2.a) supported for n < 2
                                                                                  4096 + 128
                                5.1.2(2.b) supported for p  q < 2

                                5.1.2(2.b) (ii)&(v) not applicable due to u = 2

                       2. According to section 8.2.3 IEEE [27]:
                                                                      2048 + 64
                                8.2.1(I) supported for n < 2
                                                                             4096 + 128
                                8.2.1(II) supported for p  q < 2

                       8.2.1(III) not supported

                       Signature Generation (with or without CRT):
                       1. According to section 5.2.1 RSASP1 in PKCS [21]:

                       for u = 2, i.e., without any (ri, di, ti), i >2

                                5.2.1(1) not supported
                                                                         2048 + 64
                                5.2.1(2.a) supported for n < 2
                                                                                  4096 + 128
                                5.2.1(2b) supported for p  q < 2

                                5.2.1(2b) (ii)&(v) not applicable due to u = 2

                       2. According to section 8.2.4 IFSP-RSA1 in IEEE [27]:
                                                                      2048 + 64
                                8.2.1(I) supported for n < 2
                                                                             4096 + 128
                                8.2.1(II) supported for p  q < 2



Security Target Lite                                                  64                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

                        8.2.1(III) not supported

                        Signature Verification:
                        1. According to section 5.2.2 RSAVP1 in PKCS [21]:
                                           4096 +128
                        supported for n < 2

                                5.2.2(1) not supported

                        2. According to section 8.2.5 IEEE [27]:
                                                       4096 +128
                                Supported for n < 2

                        8.2.5(1) not supported


Note:
This SFR is not applicable if the TOE is delivered with a blocked Crypto@2304T or without RSA library.
Please consider also the statement of chapter7.1.4.1.




Security Target Lite                                               65                                        2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

7.1.4.4 Rivest-Shamir-Adleman (RSA) Key generation
The key generation for the RSA shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”

 FCS_CKM.1/RSA-v2.07.003          Cryptographic key generation

 Hierarchical to:                 No other components.

 Dependencies:                    FCS_CKM.2 Cryptographic key distribution, or
                                  FCS_COP.1 Cryptographic operation]
                                  FCS_CKM.4 Cryptographic key destruction

 FCS_CKM.1.1/ RSA-v2.07.003       The TSF shall generate cryptographic keys in accordance with a specified cryptographic
                                  key generation algorithm implemented by following functions:
                                           CryptoRSAKeyGen

                                           CryptoRSAKeyGenMask_CRT plus CryptoGeneratePrime or
                                            CryptoGeneratePrimeMask

                                           CryptoRSAKeyGenMask_D plus CryptoGeneratePrime or
                                            CryptoGeneratePrimeMask

                                           CryptoRSAKeyGenMask_N plus CryptoGeneratePrime or
                                            CryptoGeneratePrimeMask

                                  And specified cryptographic key sizes of 512 up to (4096+128) bits that meet the
                                  following:

                                  1. According to section 3.1 and 3.2 in PKCS [21]:
                                  for u=2, i.e., without any (ri, di, ti), i > 2
                                                                       4096 + 128
                                           3.1 supported for n < 2
                                                                          2048 + 64
                                           3.2(1) supported for n< 2
                                                                               4096 + 128
                                           3.2(2) supported for p x q < 2

                                  2. According to section 8.1.3.1 in IEEE [27]:
                                                                                2048 + 64
                                           8.1.3.1(1) supported for n < 2
                                                                                      4096 + 128
                                           8.1.3.1(2) supported for p x q < 2
                                                                                      2048 + 64
                                           8.1.3.1(3) supported for p x q < 2



Note:
This SFR is not applicable if the TOE is delivered with a blocked Crypto@2304T or without RSA library. Please consider the
statement of chapter 7.1.4.1.

Note:
     The function CryptoGeneratePrime has been assigned to the appropriate security level by BSI. The proprietary
     CryptoGeneratePrimeMask function has not been cryptographic-analytically evaluated and certified by BSI.

Security Target Lite                                            66                                            2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

Note:
     The minimum key length follows the national recommendations by the BSI which means that RSA key length below
     1976 bits are not included in the certificate. The key length requirements can differ between the countries. Please
     note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage times key
     lengths of 3000 bits or higher.

Note:
     For easy integration of RSA functions into the user’s operating system and/or application, the library contains single
     cryptographic functions respectively primitives which are compliant to the standard. The primitives are referenced
     above. Therefore, the library supports the user to develop an application representing the standard if required.




Security Target Lite                                        67                                                 2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

7.1.4.5 Generally with Regard to Elliptic Curves
The EC library is delivered as object code and in this way integrated in the user software. The certification covers the
standard NIST [17] and Brainpool [18] Elliptic Curves with key lengths as defined in the SFRs. Note that there are further
uncounted side-channel secure curve types, which the user can optionally add in the composition certification process.




Security Target Lite                                       68                                                 2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

7.1.4.6 Elliptic Curve DSA (ECDSA) Operation
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” as
specified below.

                                    Valid for cryptographic library version v1.02.013

 FCS_COP.1/ECDSA-          Cryptographic operation - ECDSA
 v1.02.013

 Hierarchical to           No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or
                           FDP_ITC.2 Import of user data with security attributes, or
                           FCS_CKM.1 Cryptographic key generation]
                           FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ECDSA-        The TSF shall perform signature generation and signature verification in accordance with a
 v1.02.013                 specified cryptographic algorithm ECDSA and cryptographic key sizes of 192, 224, 233, 256,
                           283, 320, 384, 409, 512 or 521 bits that meet the following standard:

                           Signature Generation:

                               1.    According to section 7.3 in ANSI X9.62 - 2005
                                     Not implemented are steps d) and e) thereof.
                                     The output of step e) has to be provided as input to our function by the caller.
                                     Deviation of steps c) and f):
                                     The jumps to step a) were substituted by a return of the function with an error
                                     code, the jumps are emulated by another call to our function.

                               2.    According to sections 6.2(6.2.2+6.2.3) in ISO/IEC 15946-2:2002.
                                     Not implemented is section 6.2.1: the output of 5.4.2 has to be provided by the
                                     caller as input to our function.

                               Standard ISO/IEC 15946-2:2002 is withdrawn.

                           Signature Verification:

                               1.    According to section 7.4.1 in ANSI X9.62–2005
                                     Not implemented are steps b) and c) thereof.
                                     The output of step c) has to be provided as input to our function by the caller.
                                     Deviation of step d):
                                     Beside noted calculation, our algorithm adds a random multiple of
                                     BasepointerOrder n to the calculated values u1 and u2.

                               2.    According to sections 6.4(6.4.1+6.4.3+6.4.4) in ISO/IEC 15946-2:2002.
                                     Not implemented is section 6.4.2: the output of 5.4.2 has to be provided by the
                                     caller as input to our function.


Security Target Lite                                         69                                                 2020-10-21
                                                                                                            M7892 B11
                                                                                                    Security Target Lite

public

                               Standard ISO/IEC 15946-2:2002 is withdrawn.



                                    Valid for cryptographic library version v2.07.003

 FCS_COP.1/ECDSA-      Cryptographic operation - ECDSA
 v2.07.003

 Hierarchical to:      No other components.

 Dependencies:         [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ECDSA-    The TSF shall perform signature generation and signature verification in accordance with a
 v2.07.003             specified cryptographic algorithm ECDSA and cryptographic key sizes 160, 163, 192, 224, 233,
                       256, 283, 320, 384, 409, 512 or 521 bit that meet the following standard:

                       ECDSA Signature Generation:
                       1.   According to section"7.3 Signing Process” in ANSI X9.62–- 2005:
                                o     Step d) and e) not supported.
                                o     The output of step e) has to be provided as input to our function by the caller.
                                o     Deviation of step c) and f):
                                              The jumps to step a) were substituted by a return of the function with an
                                               error code, the jumps are emulated by another call to our function.
                       2.   According to section"6.6.4 Signature process” in ISO/IEC 14888-3:2018:
                                o     6.6.4.3 Not supported.
                                o     6.6.4.5 Not supported:
                                              The hash-code H of the message has to be provided by the caller as input
                                               to our function.
                                o     6.6.4.7 Not supported.
                                o     6.6.4.8 Not supported.
                       3.   According to section"7.2.7 ECSP-DSA” in IEEE Std 1363-2000:
                                o     Deviation of step (3) and (4):


                       The jumps to step 1, were substituted by a return of the function with an error code, the jumps
                       are emulated by another call to our function.

                       ECDSA Signature Verification:
                       1.   According to section"7.4.1 Verification with the Public Key” in ANSI X9.62–- 2005:
                                o     Step b) and c) not supported.
                                o     The output of step c) has to be provided as input to our function by the caller.


Security Target Lite                                        70                                                   2020-10-21
                                                                                                                M7892 B11
                                                                                                        Security Target Lite

public

                                    o     Deviation of step d):
                                                  Beside noted calculation, our algorithm adds a random multiple of
                                                   BasepointOrder n to the calculated values u1 and u2.
                          2.   According to section"6.6.5 Signature Verification Process” in ISO/IEC 14888-3:2018:
                                    o     6.6.5.2 Not supported.
                                    o     6.6.5.3 Not supported:
                                                  the hash-code H of the message has to be provided by the caller as input
                                                   to our function.
                          3.   According to section"7.2.8 ECVP-DSA” in IEEE Std 1363-2000.


Note:
This SFR is not applicable if the TOE is delivered with a blocked Crypto@2304T or without the EC library.
Note:
For easy integration of EC functions into the user’s operating system and/or application, the library contains single
cryptographic functions respectively primitives which are compliant to the standard. The primitives are referenced above.
Therefore, the library supports the user to develop an application representing the standard if required.

7.1.4.7 Elliptic Curve (EC) Key Generation
The key generation for the EC shall meet the requirement “Cryptographic key generation (FCS_CKM.1)”

                                        Valid for cryptographic library version v1.02.013

 FCS_CKM.1/EC-                 Cryptographic key generation - EC
 v1.02.013

 Hierarchical to               No other components.

 Dependencies:                 FCS_CKM.2 Cryptographic key distribution, or
                               FCS_COP.1 Cryptographic operation]
                               FCS_CKM.4 Cryptographic key destruction

 FCS_CKM.1.1/EC-               The TSF shall generate cryptographic keys in accordance with a specified cryptographic key
 v1.02.013                     generation algorithm Elliptic Curve EC and specified cryptographic key sizes of 192, 224,
                               233, 256, 283, 320, 384, 409, 512 or 521 bits that meet the following standard:

                               ECDSA Key Generation:

                                        According to the appendix A4.3 in ANSI X9.62-2005 [25]: The cofactor h is not
                                         supported.

                                        According to section 6.1 (not 6.1.1) in ISO/IEC 15946-1:2002


                                        Valid for cryptographic library version v2.07.003

 FCS_CKM.1/EC-         Cryptographic key generation - EC



Security Target Lite                                              71                                              2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

 v2.07.003

 Hierarchical to:      No other components.

 Dependencies:         FCS_CKM.2 Cryptographic key distribution, or
                       FCS_COP.1 Cryptographic operation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_CKM.1.1/EC-       The TSF shall generate cryptographic keys in accordance with a specified cryptographic key
 v2.07.003             generation algorithm Elliptic Curve EC and specified cryptographic key sizes 160, 163, 192, 224,
                       233, 256, 283, 320, 384, 409, 512 or 521 bit that meet the following standard:

                       ECDSA Key Generation:

                           1.   According to the appendix A4.3 Elliptic Curve Key Pair Generation in ANSI X9.62-2005
                                [25]: The optional cofactor h is not supported.

                           2.   According to section 6.6.3 Generation of signature key and verification key in ISO/IEC
                                14888-3 [36]

                           3.   According to appendix A.16.9 An algorithm for generating EC keys in IEEE Std. 1363-2000
                                [27]




Note:
This SFR is not applicable if the TOE is delivered with a blocked Crypto@2304T or without EC library.
Note:
For easy integration of EC functions into the user’s operating system and/or application, the library contains single
cryptographic functions respectively primitives which are compliant to the standard. The primitives are referenced above.
Therefore, the library supports the user to develop an application representing the standard if required.




Security Target Lite                                         72                                              2020-10-21
                                                                                                           M7892 B11
                                                                                                   Security Target Lite

public

7.1.4.8 Elliptic Curve Diffie-Hellman (ECDH) Key Agreement
The Modular Arithmetic Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” as
specified below.

                                   Valid for cryptographic library version v1.02.013

 FCS_COP.1/ECDH-           Cryptographic operation - ECDH
 v1.02.013

 Hierarchical to           No other components.

 Dependencies:             [FDP_ITC.1 Import of user data without security attributes, or
                           FDP_ITC.2 Import of user data with security attributes, or
                           FCS_CKM.1 Cryptographic key generation]
                           FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ECDH-         The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance with a
 v1.02.013                 specified cryptographic algorithm ECDH and cryptographic key sizes 192, 224, 233, 256,
                           283, 320, 384, 409, 512 or 521 bits that meet the following standard:

                           1. According to section 5.4.1 in ANSI X9.63 [20]
                           Unlike section 5.4.1.3 our implementation not only returns the x-coordinate of the shared
                           secret, but rather the x-coordinate and y-coordinate.

                           2. According to sections 8.4.2.1, 8.4.2.2, 8.4.2.3, 8.4.2.4 in ISO/IEC 15946-3:2002.



                                   Valid for cryptographic library version v2.07.003

 FCS_COP.1/ECDH-       Cryptographic operation - ECDH
 v2.07.003

 Hierarchical to:      No other components.

 Dependencies:         [FDP_ITC.1 Import of user data without security attributes, or
                       FDP_ITC.2 Import of user data with security attributes, or
                       FCS_CKM.1 Cryptographic key generation]
                       FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/ECDH-     The TSF shall perform elliptic curve Diffie-Hellman key agreement in accordance with a specified
 v2.07.003             cryptographic algorithm ECDH and cryptographic key sizes 160, 163, 192, 224, 233, 256, 283,
                       320, 384, 409, 512 or 521 bit that meet the following standard:

                           1.   According to section 5.4.1 Standard Diffie-Hellman Primitive in ANSI X9.63 [20]
                                Unlike section 5.4.1(3) our implementation not only returns the x-coordinate of the
                                shared secret, but rather the x-coordinate and the y-coordinate.

                           2.   According to section Appendix D.6 Key agreement of Diffie-Hellman type in ISO/IEC
                                11770-3 [38] the function enables the operations described in appendix D.6.

Security Target Lite                                      73                                                      2020-10-21
                                                                                                               M7892 B11
                                                                                                       Security Target Lite

public

                              3.   According    to   section    7.2.1   ECSVHDP-DP     in      IEEE   Std.   1363:2000   [27]
                                   Unlike section 7.2.1 our implementation not only returns the x-coordinate of the shared
                                   secret, but rather the x-coordinate and the y-coordinate.
Note:
This SFR is not applicable if the TOE is delivered with a blocked Crypto@2304T or without EC library.
Note:
The certification covers the standard NIST [17] and Brainpool [18] Elliptic Curves with key lengths as defined in the SFRs.
Note that there are further uncounted side-channel secure curve types, which the user can optionally add in the
composition certification process.
Note:
For easy integration of EC functions into the user’s operating system and/or application, the library contains single
cryptographic functions respectively primitives which are compliant to the standard. The primitives are referenced above.
Therefore, the library supports the user to develop an application representing the standard if required.
Note:
The EC primitives allow the selection of various curves. The selection of the curves depends to the user.

7.1.4.9 SHA-2 Operation
The SHA-2 Operation of the TOE shall meet the requirement “Cryptographic operation (FCS_COP.1)” as specified below.

 FCS_COP.1/SHA                Cryptographic Operation - SHA

 Hierarchical to              No other components.

 Dependencies:                [FDP_ITC.1 Import of user data without security attributes, or
                              FDP_ITC.2 Import of user data with security attributes, or
                              FCS_CKM.1 Cryptographic key generation]
                              FCS_CKM.4 Cryptographic key destruction

 FCS_COP.1.1/SHA              The TSF shall perform hash-value calculation of user chosen data in accordance with a
                              specified cryptographic algorithm SHA-2 and with cryptographic key sizes of none that
                              meet the following standards:

                              FIPS 180-4 as of 2015-08 [19]
Note:
This SFR is not applicable if the TOE is delivered without the SHA-2 library.
Note:
The SHA-2 cryptographic operation is a keyless operation.
Note:    The SHA-2 implementation is not intended to be used on confidential input data. For such use cases specific
security improvements and side channel analysis are recommended.


7.1.5         Data Integrity
The TOE shall meet the requirement “Stored data integrity monitoring (FDP_SDI.1)” as specified below:

Security Target Lite                                           74                                                 2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

 FDP_SDI.1                  Stored data integrity monitoring

 Hierarchical to            No other components.

 Dependencies:              No dependencies.

 FDP_SDI.1.1                The TSF shall monitor user data stored in containers controlled by the TSF for
                            inconsistencies between stored data and corresponding EDC on all objects, based on the
                            following attributes: EDC value for the RAM, ROM and SOLID FLASH™ NVM.


The TOE shall meet the requirement “Stored data integrity monitoring and action (FDP_SDI.2)” as specified below:

 FDP_SDI.2                  Stored data integrity monitoring and action

 Hierarchical to            FDP_SDI.1 stored data integrity monitoring

 Dependencies:              No dependencies.

 FDP_SDI.2.1                The TSF shall monitor user data stored in containers controlled by the TSF for data
                            integrity and one- and/or more-bit-errors on all objects, based on the following
                            attributes: corresponding EDC value for RAM, ROM and SOLID FLASH™ NVM and error
                            correction ECC for the SOLID FLASH™ NVM.

 FDP_SDI.2.2                Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                            FLASH™ NVM automatically and inform the user about more bit errors.




Security Target Lite                                      75                                                  2020-10-21
                                                                                                         M7892 B11
                                                                                                 Security Target Lite

public

7.2      TOE Security Assurance Requirements

The evaluation assurance level is EAL6 augmented with ALC_FLR.1.
In the following table, the security assurance requirements are given. The augmentation of the assurance components
compared to the Protection Profile [1] is expressed with bold letters.
                                              Table 18: Assurance components

           Aspect                   Acronym                              Description                    Refinement

Development                    ADV_ARC.1             Security Architecture Description               In PP [1]

                               ADV_FSP.5             Complete semi-formal functional specification   in ST
                                                     with additional error information

                               ADV_IMP.2             Complete mapping of the implementation          in ST
                                                     representation of the TSF

                               ADV_INT.3             Minimally complex internals

                               ADV_TDS.5             Complete semi-formal modular design

                               ADV_SPM.1             Formal TOE security policy model

Guidance Documents             AGD_OPE.1             Operational user guidance                       in PP [1]

                               AGD_PRE.1             Preparative procedures                          in PP [1]

Life-Cycle Support             ALC_CMC.5             Advanced support                                in ST

                               ALC_CMS.5             Development tools CM coverage                   in ST

                               ALC_DEL.1             Delivery procedures                             in PP [1]

                               ALC_DVS.2             Sufficiency of security measures                in PP [1]

                               ALC_LCD.1             Developer defined life-cycle model

                               ALC_TAT.3             Compliance with implementation standards –
                                                     all parts

                               ALC_FLR.1             Basic Flaw Remediation

Security Target Evaluation     ASE_CCL.1             Conformance claims

                               ASE_ECD.1             Extended components definition

                               ASE_INT.1             ST introduction

                               ASE_OBJ.2             Security objectives

                               ASE_REQ.2             Derived security requirements

                               ASE_SPD.1             Security problem definition

                               ASE_TSS.1             TOE summary specification

Tests                          ATE_COV.3             Rigorous analysis of coverage                   In ST


Security Target Lite                                         76                                              2020-10-21
                                                                                                          M7892 B11
                                                                                                  Security Target Lite

public

           Aspect                   Acronym                            Description                       Refinement

                              ATE_DPT.3             Testing: modular design

                              ATE_FUN.2             Ordered functional testing

                              ATE_IND.2             Independent testing - sample

Vulnerability Assessment      AVA_VAN.5             Advanced methodical vulnerability analysis        in PP [1]


7.2.1         Refinements
Some refinements are taken unchanged from the PP [1]. In some cases a clarification is necessary. In the table above an
overview is given where the refinement is done.
The refinements from the PP [1] have to be discussed here in the Security Target, as the assurance level is increased. The
refinements from the PP [1] are included in the chosen assurance level EAL 6 augmented with  unauthorized copy or reproduction of the genuine travel document's chip. This
  attack is thwarted by chip an identification and authenticity proof required by
  OT.Chip_Auth_Proof 'Proof of travel document's chip authentication' using an
  authentication key pair to be generated by the issuing State or Organisation.
  The Public Chip Authentication Key has to be written into EF.DG14 and signed
  by    means     of  Documents       Security    Objects    as   demanded     by
  OE.Auth_Key_Travel_Document 'Travel document Authentication Key'.
  According to OE.Exam_Travel_Document 'Examination of the physical part of
  the travel document' the General Inspection system has to perform the Chip
  Authentication Protocol Version 1 to verify the authenticity of the travel
  document's chip. Moreover, the Active Authentication Public Key has to be
  written into EF.DG15 as demanded by OE.Auth_Key_MRTD 'MRTD
  Authentication Key'. According to OE.AA_MRTD 'Active Authentication -
  Inspection Systems' the Inspection system has to perform the Active
  Authentication Protocol to verify the authenticity of the MRTD’s chip.




4.3.1.3 Threats related to Polymorphic eMRTD

T.Sensitive_Polymorphic_Data The threat T.Sensitive_Polymorphic_Data
  is countered by the following TOE-objectives:
      o OT.Polymorphic_Data_Confidentiality requiring the confidentiality
         of the static sensitive polymorphic eMRTD PI, PP and CPI user data
         stored inside the TOE. Furthermore the confidentiality of the eMRTD
         polymorphic the randomized PI, PP and optional CPI User Data during
         their exchange is also required.
      o OT.Polymorphic_Data_Authenticity requiring the authenticity of the
         polymorphic eMRTD randomized PI, PP and optional CPI user data
         during their exchange between the TOE and Terminal/Authentication
         Service.
      o OT.Polymorphic_Data_Privacy requiring the privacy of the PI, PP
         and optional CPI user data during the polymorphic authentication
         process steps, including during the randomisation performed by the
         TOE as part of the PMA protocol.
      o OE.Authoriz_Polymorphic_Data requiring the authorization for the
         use of Polymorphic eMRTD user data based on CVCA/DV/IS certificates
         issued by the issuing State, the Polymorphic eMRTD document issuer or
         Organisation.
                        Security Target Lite
                                                                 Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                             Page: 66/150
                       eMRTD Configuration)

T.Forgery_Polymorphic The threat T.Forgery_Polymorphic addresses the
  fraudulent, complete or partial alteration of the Polymorpphic eMRTD User
  Data stored on the TOE. It is countered by the following TOE-objectives:
      o OT.Polymorphic_Data_Integrity requiring the integrity of the
         sensitive polymorphic eMRTD PI, PP and CPI data.
      o OT.AC_Pers_Polymorphic requiring that the Polymorphic eMRTD
         data PI/PP/CPI and PIN/PUK data can only be written by authorized
         Personalisation Agents only.
      o OT.Prot_Phys-Tamper and OT.Prot_Abuse-Func contribute to
         protecting integrity of the polymorphic eMRTD user data stored on the
         TOE.

T.Compromise_Privacy_Poly The threat T.Compromise_Privacy_Poly is
  countered by the following TOE-objectives:
     o OT.Polymorphic_Data_Privacy requiring the privacy of the PI, PP
        and optional CPI user data during the polymorphic authentication
        process steps, including during the randomisation performed by the
        TOE as part of the PMA protocol.
     o OT.Polymorphic_Data_Confidentiality requiring the confidentiality
        of the static sensitive polymorphic eMRTD PI, PP and CPI user data
        stored inside the TOE. Furthermore the confidentiality of the eMRTD
        polymorphic the randomized PI, PP and optional CPI User Data during
        their exchange is also required.

T.Eavesdropping_Polymorphic The threat T.Eavesdropping_Polymorphic is
  countered by the following TOE-objective:
     o OT.Polymorphic_Data_Confidentiality requiring the confidentiality
        of the static sensitive polymorphic eMRTD PI, PP and CPI user data
        stored inside the TOE. Furthermore the confidentiality of the eMRTD
        polymorphic the randomized PI, PP and optional CPI User Data during
        their exchange is also required.

T.DoS The threat T.DoS is countered by the following TOE-objective:
     o OT.DoS requiring the TOE to control the authentication process and
        the number of authentication attempts executed by attackers on the
        PACE PIN and PUK passwords in order to prevent a denial of service.
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 67/150
                       eMRTD Configuration)

4.3.2 Organisational Security Policies

4.3.2.1 OSP listed in PP PACE

P.Manufact requires a unique identification of the IC by means of the
  Initialization Data and the writing of the Pre-personalisation Data as being
  fulfilled by OT.Identification.

P.Pre-Operational is enforced by the following security objectives:
  OT.Identification is affine to the OSP's property 'traceability before the
  operational phase; OT.AC_Pers and OE.Personalisation together enforce the
  OSP's properties 'correctness of the User and the TSF-data stored' and
  'authorisation of Personalisation Agents'; OE.Legislative_Compliance is affine
  to the OSP's property 'compliance with laws and regulations'.

P.Card_PKI is enforced by establishing the issuing PKI branch as aimed by the
  objectives OE.Passive_Auth_Sign (for the Document Security Object).

P.Trustworthy_PKI is enforced by OE.Passive_Auth_Sign (for CSCA, issuing
  PKI branch).

P.Terminal 'Abilities and trustworthiness of terminals' is countered by the
  security objective OE.Exam_Travel_Document additionally to the security
  objectives from PACE PP [PACE-PP]. OE.Exam_Travel_Document enforces the
  terminals to perform the terminal part of the PACE protocol.
  The OSP P.Terminal is obviously enforced by the objective OE.Terminal,
  whereby the one-to-one mapping between the related properties is applicable.



4.3.2.2 Additional OSPs from PP EAC

P.Sensitive_Data 'Privacy of sensitive biometric reference data' is fulfilled and
  the threat T.Read_Sensitive_Data 'Read the sensitive biometric reference data'
  is countered by the TOE-objective OT.Sens_Data_Conf 'Confidentiality of
  sensitive biometric reference data' requiring that read access to EF.DG3 and
  EF.DG4 (containing the sensitive biometric reference data) is only granted to
  authorized inspection systems. Furthermore it is required that the
  transmission of these data ensures the data's confidentiality. The authorization
  bases on Document Verifier certificates issued by the issuing State or
  Organisation as required by OE.Authoriz_Sens_Data 'Authorization for use of
  sensitive biometric reference data'. The Document Verifier of the receiving
  State has to authorize Extended Inspection Systems by creating appropriate
  Inspection System certificates for access to the sensitive biometric reference
  data as demanded by OE.Ext_Insp_Systems 'Authorization of Extended
  Inspection Systems'.
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 68/150
                       eMRTD Configuration)

P.Personalisation 'Personalisation of the travel document by issuing State or
  Organisation only' addresses the (i) the enrolment of the logical travel
  document by the Personalisation Agent as described in the security objective
  for the TOE environment OE.Personalisation 'Personalisation of logical travel
  document', and (ii) the access control for the user data and TSF data as
  described by the security objective OT.AC_Pers 'Access Control for
  Personalisation of logical travel document'. Note the manufacturer equips the
  TOE with the Personalisation Agent Key(s) according to OT.Identification
  'Identification and Authentication of the TOE'. The security objective
  OT.AC_Pers limits the management of TSF data and the management of TSF
  to the Personalisation Agent.




4.3.2.3 OSPs related to Polymorphic eMRTD

P.Polymorphic_Data The OSP P.Polymorphic_Data is fulfilled by the following
  Objectives:
      o OT.Polymorphic_Data_Confidentiality requiring the confidentiality
         of the static sensitive polymorphic eMRTD PI, PP and CPI user data
         stored inside the TOE. Furthermore the confidentiality of the eMRTD
         polymorphic the randomized PI, PP and optional CPI User Data during
         their exchange is also required.
      o OT.Polymorphic_Data_Privacy requiring the privacy of the PI, PP
         and optional CPI user data during the polymorphic authentication
         process steps, including during the randomisation performed by the
         TOE as part of the PMA protocol.
      o OE.Authoriz_Polymorphic_Data requiring the authorization for the
         use of Polymorphic eMRTD User Data bases on CVCA/DV/IS certificates
         issued by the issuing State, the Polymorphic eMRTD document issuer or
         Organisation.

P.Pre-Operational_Polymorphic The OSP P.Pre-Operational_Polymorphic is
  fulfilled by the following Objectives:
       o OT.AC_Pers_Polymorphic requiring that the Polymorphic eMRTD
           data PI/PP/CPI and PIN/PUK data can be written by authorized
           Personalisation Agents only.
       o OE.Insp_Sys_Polymorphic requiring the Polymorphic inspection
           systems (Terminals) or authentication services to perform the terminal
           part of PACE with PIN, PA, CAv1, TAv1 and PMA protocols.
       o OE.Authoriz_Polymorphic_Data requiring the authorization for the
           use of Polymorphic eMRTD User Data bases on CVCA/DV/IS certificates
           issued by the issuing State, the Polymorphic eMRTD document issuer or
           Organisation.
       o OE.Polymorphic_Auth requiring the secure generation and storage of
           the authentication infrastructure keys and PP/PI/CPI data.
                         Security Target Lite
                                                                    Ref.:
                  IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                  Protection (SAC/EAC/Polymorphic
                                                                Page: 69/150
                        eMRTD Configuration)

      o   OE.Personalisation_Polymorphic requiring that the Polymorphic
          Personalisation Agent guarantees the correctness and the privacy of the
          PI/PP/CPI data during the personalisation phase.

P.Polymorphic_Authentication_Terminal The OSP P.Polymorphic_Data is
  fulfilled by the following Objective:
       o OE.Insp_Sys_Polymorphic requiring the Polymorphic inspection
           systems (Terminals) or authentication services to perform the terminal
           part of PACE with PIN, PA, CAv1, TAv1 and PMA.

P.Personalisation_Polymorphic The OSP P.Personalisation_Polymorphic is
  fulfilled by the following Objectives:
       o OT.AC_Pers_Polymorphic requiring that the Polymorphic eMRTD
           data PI/PP/CPI and PIN/PUK data can be written by authorized
           Personalisation Agents only.
       o OE.Personalisation_Polymorphic requiring that the Polymorphic
           Personalisation Agent guarantees the correctness and the privacy of the
           PI/PP/CPI data during the personalisation phase.




4.3.3 Assumptions

4.3.3.1 Assumptions listed in PP PACE

A.Passive_Auth The assumption A.Passive_Auth 'PKI for Passive Authentication'
  is directly covered by the security objective for the TOE environment
  OE.Passive_Auth_Sign 'Authentication of travel document by Signature' from
  PACE PP [PACE-PP] covering the necessary procedures for the Country Signing
  CA Key Pair and the Document Signer Key Pairs. The implementation of the
  signature verification procedures is covered by OE.Exam_Travel_Document
  'Examination of the physical part of the travel document'.

4.3.3.2 Assumptions listed in PP EAC

A.Insp_Sys The examination of the travel document addressed by the
  assumption A.Insp_Sys 'Inspection Systems for global interoperability' is
  covered    by   the    security  objectives    for  the    TOE     environment
  OE.Exam_Travel_Document 'Examination of the physical part of the travel
  document' and OE.AA_MRTD 'Active Authentication - Inspection Systems'
  which requires the inspection system to examine physically the travel
  document, the Basic Inspection System to implement the Basic Access
  Control, the General Inspection Systems and the Extended Inspection Systems
  to implement and to perform the Chip Authentication Protocol Version 1 and
  the Active Authentication Protocol to verify the Authenticity of the presented
  travel document's chip. The security objectives for the TOE environment
                        Security Target Lite
                                                                    Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                              2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                                Page: 70/150
                       eMRTD Configuration)

  OE.Prot_Logical_Travel_Document 'Protection of data from the logical travel
  document' require the Inspection System to protect the logical travel
  document data during the transmission and the internal handling.

A.Auth_PKI 'PKI for Inspection Systems' is covered by the security objective for
  the TOE environment OE.Authoriz_Sens_Data 'Authorization for use of
  sensitive biometric reference data' requires the CVCA to limit the read access
  to sensitive biometrics by issuing Document Verifier certificates for authorized
  receiving States or Organisations only. The Document Verifier of the receiving
  State is required by OE.Ext_Insp_Systems 'Authorization of Extended
  Inspection Systems' to authorize Extended Inspection Systems by creating
  Inspection System Certificates. Therefore, the receiving issuing State or
  Organisation has to establish the necessary public key infrastructure.

4.3.3.3 Assumptions related to Active Authentication

A.Pers_Agent_AA The assumption A.Pers_Agent_AA is directly covered by
the security objective for the TOE environment OE.Personalization including
the enrolment, the protection with digital signature and the storage of the MRTD
holder personal data.

4.3.3.4 Assumptions related to Polymorphic eMRTD

A.Polymorphic_Auth The assumption A.Polymorphic_Auth is directly covered
  by the following objective:
      o OE.Polymorphic_Auth requiring the secure generation and storage of
         the authentication infrastructure keys and PP/PI/CPI data.

A.Auth_PKI_Polymorphic The assumption A.Auth_PKI_Polymorphic is directly
  covered by the following objective:
     o OE.Authoriz_Polymorphic_Data requiring the authorization for the
        use of Polymorphic eMRTD User Data bases on CVCA/DV/IS certificates
        issued by the issuing State, the Polymorphic eMRTD document issuer or
        Organisation.

A.Insp_Sys_Polymorphic The assumption A.Insp_Sys_Polymorphic is directly
  covered by the following objective:
     o OE.Insp_Sys_Polymorphic requiring the Polymorphic inspection
        systems (Terminals) or authentication services to perform the terminal
        part of PACE with PIN, PA, CAv1, TAv1 and PMA.
                          Security Target Lite
                                                                   Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                               Page: 71/150
                         eMRTD Configuration)

 4.3.4 SPD and Security Objectives
Threats                        Security Objectives                        Rationale
                               OT.Data_Integrity, OT.Data_Authenticity,
                                                                          Section
T.Skimming                     OT.Data_Confidentiality,
                                                                          4.3.1
                               OE.Travel_Document_Holder
                                                                          Section
T.Eavesdropping                OT.Data_Confidentiality
                                                                          4.3.1
                                                                          Section
T.Tracing                      OT.Tracing, OE.Travel_Document_Holder
                                                                          4.3.1
                               OT.AC_Pers, OT.Data_Integrity,
                               OT.Data_Authenticity, OT.Prot_Abuse-
                               Func, OT.Prot_Phys-Tamper,                 Section
T.Forgery
                               OE.Personalisation,                        4.3.1
                               OE.Passive_Auth_Sign, OE.Terminal,
                               OE.Exam_Travel_Document
                                                                          Section
T.Abuse-Func                   OT.Prot_Abuse-Func
                                                                          4.3.1
                                                                          Section
T.Information_Leakage          OT.Prot_Inf_Leak
                                                                          4.3.1
                                                                          Section
T.Phys-Tamper                  OT.Prot_Phys-Tamper
                                                                          4.3.1
                                                                          Section
T.Malfunction                  OT.Prot_Malfunction
                                                                          4.3.1
                             OT.Sens_Data_Conf,
                                                                          Section
T.Read_Sensitive_Data        OE.Authoriz_Sens_Data,
                                                                          4.3.1
                             OE.Ext_Insp_Systems
                             OT.Chip_Auth_Proof,
                             OE.Auth_Key_Travel_Document,
                                                                          Section
T.Counterfeit                OE.Exam_Travel_Document,
                                                                          4.3.1
                             OE.Auth_Key_MRTD,
                             OE.AA_MRTD
T.Sensitive_Polymorphic_Data OT.Polymorphic_Data_Confidentiality,         Section
                             OT.Polymorphic_Data_Authenticity,            4.3.1
                             OT.Polymorphic_Data_Privacy,
                             OE.Authoriz_Polymorphic_Data
T.Forgery_Polymorphic        OT.Polymorphic_Data_Integrity,               Section
                             OT.AC_Pers_Polymorphic,OT.Prot_Abuse-        4.3.1
                             Func, OT.Prot_Phys-Tamper
T.Compromise_Privacy_Poly    OT.Polymorphic_Data_Privacy,                 Section
                             OT.Polymorphic_Data_Confidentiality          4.3.1
T.Eavesdropping_Polymorphic OT.Polymorphic_Data_Confidentiality           Section
                                                                          4.3.1
T.DoS                          OT.DoS                                     Section
                                                                          4.3.1
                Table 1 Threats and Security Objectives - Coverage
                  Security Target Lite
                                                             Ref.:
           IDeal Pass v2.3-n JC with Privacy
                                                       2018_2000036361
           Protection (SAC/EAC/Polymorphic
                                                         Page: 72/150
                 eMRTD Configuration)

Security Objectives                   Threats
OT.Data_Integrity                     T.Skimming, T.Forgery
OT.Data_Authenticity                  T.Skimming, T.Forgery
OT.Data_Confidentiality               T.Skimming, T.Eavesdropping
OT.Tracing                            T.Tracing
                                      T.Forgery, T.Abuse-Func,
OT.Prot_Abuse-Func
                                      T.Forgery_Polymorphic
OT.Prot_Inf_Leak                      T.Information_Leakage
                                      T.Forgery, T.Phys-Tamper,
OT.Prot_Phys-Tamper
                                      T.Forgery_Polymorphic
OT.Prot_Malfunction                   T.Malfunction
OT.Identification
OT.AC_Pers                            T.Forgery
OT.Sens_Data_Conf                     T.Read_Sensitive_Data
OT.Chip_Auth_Proof                    T.Counterfeit
OT.Polymorphic_Data_Confidentiality   T.Sensitive_Polymorphic_Data,
                                      T.Compromise_Privacy_Poly,
                                      T.Eavesdropping_Polymorphic
OT.Polymorphic_Data_Integrity         T.Forgery_Polymorphic
OT.Polymorphic_Data_Authenticity      T.Sensitive_Polymorphic_Data
OT.Polymorphic_Data_Privacy           T.Sensitive_Polymorphic_Data,
                                      T.Compromise_Privacy_Poly
OT.AC_Pers_Polymorphic                T.Forgery_Polymorphic
OT.DoS                                T.DoS
OE.Legislative_Compliance
OE.Auth_Key_Travel_Document           T.Counterfeit
OE.Auth_Key_MRTD                      T.Counterfeit
OE.AA_MRTD                            T.Counterfeit
OE.Authoriz_Sens_Data                 T.Read_Sensitive_Data
OE.Passive_Auth_Sign                  T.Forgery
OE.Personalisation                    T.Forgery
OE.Terminal                           T.Forgery
OE.Travel_Document_Holder             T.Skimming, T.Tracing
OE.Exam_Travel_Document               T.Forgery, T.Counterfeit
OE.Ext_Insp_Systems                   T.Read_Sensitive_Data
OE.Prot_Logical_Travel_Document
OE.Polymorphic_Auth
OE.Authoriz_Polymorphic_Data          T.Sensitive_Polymorphic_Data
OE.Insp_Sys_Polymorphic
OE.Personalisation_Polymorphic
        Table 2 Security Objectives and Threats - Coverage
                              Security Target Lite
                                                                       Ref.:
                       IDeal Pass v2.3-n JC with Privacy
                                                                 2018_2000036361
                       Protection (SAC/EAC/Polymorphic
                                                                   Page: 73/150
                             eMRTD Configuration)

Organisational Security Policies        Security Objectives                  Rationale
                                                                             Section
P.Manufact                              OT.Identification
                                                                             4.3.2
                                        OT.Identification, OT.AC_Pers,
                                                                             Section
P.Pre-Operational                       OE.Personalisation,
                                                                             4.3.2
                                        OE.Legislative_Compliance
                                                                             Section
P.Card_PKI                              OE.Passive_Auth_Sign
                                                                             4.3.2
                                                                             Section
P.Trustworthy_PKI                       OE.Passive_Auth_Sign
                                                                             4.3.2
                                      OE.Terminal,                           Section
P.Terminal
                                      OE.Exam_Travel_Document                4.3.2
                                      OT.Sens_Data_Conf,
                                                                             Section
P.Sensitive_Data                      OE.Authoriz_Sens_Data,
                                                                             4.3.2
                                      OE.Ext_Insp_Systems
                                      OT.AC_Pers, OT.Identification,         Section
P.Personalisation
                                      OE.Personalisation                     4.3.2
P.Polymorphic_Data                    OT.Polymorphic_Data_Confidentiality,
                                                                             Section
                                      OT.Polymorphic_Data_Privacy,
                                                                             4.3.2
                                      OE.Authoriz_Polymorphic_Data
P.Pre-Operational_Polymorphic         OT.AC_Pers_Polymorphic,
                                      OE.Polymorphic_Auth,
                                                                             Section
                                      OE.Authoriz_Polymorphic_Data,
                                                                             4.3.2
                                      OE.Insp_Sys_Polymorphic,
                                      OE.Personalisation_Polymorphic
P.Polymorphic_Authentication_Terminal OE.Insp_Sys_Polymorphic                Section
                                                                             4.3.2
P.Personalisation_Polymorphic           OT.AC_Pers_Polymorphic,              Section
                                        OE.Personalisation_Polymorphic       4.3.2
                    Table 3 OSPs and Security Objectives - Coverage
                       Security Target Lite
                                                                 Ref.:
                IDeal Pass v2.3-n JC with Privacy
                                                           2018_2000036361
                Protection (SAC/EAC/Polymorphic
                                                             Page: 74/150
                      eMRTD Configuration)

Security Objectives                  Organisational Security Policies
OT.Data_Integrity
OT.Data_Authenticity
OT.Data_Confidentiality
OT.Tracing
OT.Prot_Abuse-Func
OT.Prot_Inf_Leak
OT.Prot_Phys-Tamper
OT.Prot_Malfunction
                                     P.Manufact, P.Pre-Operational,
OT.Identification
                                     P.Personalisation
OT.AC_Pers                           P.Pre-Operational, P.Personalisation
OT.Sens_Data_Conf                    P.Sensitive_Data
OT.Chip_Auth_Proof
OT.Polymorphic_Data_Confidentiality P.Polymorphic_Data
OT.Polymorphic_Data_Integrity
OT.Polymorphic_Data_Authenticity
OT.Polymorphic_Data_Privacy         P.Polymorphic_Data
OT.AC_Pers_Polymorphic              P.Pre-Operational_Polymorphic,
                                    P.Personalisation_Polymorphic
OT.DoS
OE.Legislative_Compliance           P.Pre-Operational
OE.Auth_Key_Travel_Document
OE.Auth_Key_MRTD
OE.AA_MRTD
OE.Authoriz_Sens_Data               P.Sensitive_Data
OE.Passive_Auth_Sign                P.Card_PKI, P.Trustworthy_PKI
OE.Personalisation                  P.Pre-Operational, P.Personalisation
OE.Terminal                         P.Terminal
OE.Travel_Document_Holder
OE.Exam_Travel_Document             P.Terminal
OE.Prot_Logical_Travel_Document
OE.Ext_Insp_Systems                 P.Sensitive_Data
OE.Polymorphic_Auth                 P.Pre-Operational_Polymorphic
OE.Authoriz_Polymorphic_Data        P.Polymorphic_Data, P.Pre-
                                    Operational_Polymorphic
OE.Insp_Sys_Polymorphic             P.Pre-Operational_Polymorphic,
                                    P.Polymorphic_Authentication_Terminal
OE.Personalisation_Polymorphic      P.Pre-Operational_Polymorphic,
                                    P.Personalisation_Polymorphic
              Table 4 Security Objectives and OSPs - Coverage
                        Security Target Lite
                                                                   Ref.:
                 IDeal Pass v2.3-n JC with Privacy
                                                             2018_2000036361
                 Protection (SAC/EAC/Polymorphic
                                                               Page: 75/150
                       eMRTD Configuration)

                          Security Objectives for the Operational
Assumptions                                                         Rationale
                          Environment
                          OE.Passive_Auth_Sign,                     Section
A.Passive_Auth
                          OE.Exam_Travel_Document                   4.3.3
                          OE.Exam_Travel_Document,
                                                                    Section
A.Insp_Sys                OE.Prot_Logical_Travel_Document,
                                                                    4.3.3
                          OE.AA_MRTD
                          OE.Authoriz_Sens_Data,                    Section
A.Auth_PKI
                          OE.Ext_Insp_Systems                       4.3.3
A.Polymorphic_Auth        OE.Polymorphic_Auth                       Section
                                                                    4.3.3
A.Auth_PKI_Polymorphic OE.Authoriz_Polymorphic_Data                 Section
                                                                    4.3.3
A.Insp_Sys_Polymorphic    OE.Insp_Sys_Polymorphic                   Section
                                                                    4.3.3
A.Pers_Agent_AA           OE.Personalisation                        Section
                                                                    4.3.3
Table 5 Assumptions and Security Objectives for the Operational Environment -
                                 Coverage

        Security Objectives for the
                                               Assumptions
        Operational Environment
        OE.Legislative_Compliance
        OE.Auth_Key_Travel_Document
        OE.Auth_Key_MRTD
        OE.Authoriz_Sens_Data                  A.Auth_PKI
        OE.Passive_Auth_Sign                   A.Passive_Auth
        OE.Personalisation                     A.Pers_Agent_AA
        OE.Terminal
        OE.Travel_Document_Holder
                                               A.Passive_Auth,
        OE.Exam_Travel_Document
                                               A.Insp_Sys
        OE.AA_MRTD                             A.Insp_Sys
        OE.Prot_Logical_Travel_Document        A.Insp_Sys
        OE.Ext_Insp_Systems                    A.Auth_PKI
        OE.Polymorphic_Auth                    A.Polymorphic_Auth
        OE.Authoriz_Polymorphic_Data           A.Auth_PKI_Polymorphic
        OE.Insp_Sys_Polymorphic                A.Insp_Sys_Polymorphic
        OE.Personalisation_Polymorphic
Table 6 Security Objectives for the Operational Environment and Assumptions -
                                   Coverage
                          Security Target Lite
                                                                     Ref.:
                   IDeal Pass v2.3-n JC with Privacy
                                                               2018_2000036361
                   Protection (SAC/EAC/Polymorphic
                                                                 Page: 76/150
                         eMRTD Configuration)


5 Extended Requirements


5.1 Definition of the Family FAU_SAS
To describe the security functional requirements of the TOE, the family FAU_SAS
of the class FAU (Security Audit) is defined here. This family describes the
functional requirements for the storage of audit data. It has a more general
approach than FAU_GEN, because it does not necessarily require the data to be
generated by the TOE itself and because it does not give specific details of the
content of the audit records.

The family “Audit data storage (FAU_SAS)” is specified as follows:

Family behavior:

This family defines functional requirements for the storage of audit data.

Component leveling:




FAU_SAS.1          Requires the TOE to provide the possibility to store audit data.

Management:        FAU_SAS.1
                   There are no management activities foreseen.

Audit:             FAU_SAS.1
                   There are no actions defined to be auditable.

FAU_SAS.1 Audit Storage


Hierarchical to:   No other components.

Dependencies:      No de                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    duct data sheet addendum   1.0
                                                                                                 Page: 10/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                               P73 Family Chip Health Mode, Application note                                1.0
                                                                                                               P73 Family Code Signature Watchdog, Application note                         1.1
                                                                                                               ARM®v7-M Architecture Reference Manual                                       ID120114
                                                                                                                                                                                            (ARM website)
                                                                                                 Table 3 Manuals common for all SN200_SE B1.1



                                                                                                   Item            Identifier                                                                 Version
                                                                                                  Manuals         SN200_SE Information on Guidance and Operation                             1.1
                                                                                                                  SN200 Services User Manual – API and Operational Guidance                  4.13
                                                                                                                  SN200 Services Addendum - Additional API and Operational Guidance          0.5
                                                                                                                  SN200x Crypto Library Information on Guidance and Operation                1.4
                                                                                                                  SN200x Crypto Library: User Manual – RNG Library                           1.1
                                                                                                                  SN200x Crypto Library: User Manual – SHA Library                           1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA Library                    1.0
                                                                                                                  SN200x Crypto Library: User Manual – SHA-3 Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Secure SHA-3 Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – HMAC Library                          1.0
                                                                                                                  SN200x Crypto Library: User Manual – Rsa Library (Rsa)                     1.1
                                                                                                                  SN200x Crypto Library: User Manual – RSA Key Generation Library (RsaKg)    1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECC over GF(p) Library                1.0
                                                                                                                  SN200x Crypto Library: User Manual – ECDAA                                 1.0
                                                                                                                  SN200x Crypto Library: User Manual – TwdEdMontGfp Library                  1.0
                                                                                                                  SN200x Crypto Library: User Manual – eUICC Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – Symmetric Cipher Library (SymCfg)     1.1
                                                                                                                  SN200x Crypto Library: User Manual – Utils Library                         1.0
                                                                                                                  SN200x Crypto Library: User Manual – HASH Library                          1.0
                                                                                                                  SN200x Crypto Library: Errata sheet                                        1.0


                                                                                                 Table 4 Manuals of SN200_SE B1.1 specific for C04
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                 2.6      IT Product Testing
                                                                                                 Testing (depth, coverage, functional tests, independent testing): The evaluators examined the
                                                                                                 developer’s testing activities documentation and verified that the developer has met their testing
                                                                                                 responsibilities.

                                                                                                 2.6.1      Testing approach and depth
                                                                                                 The developer has performed extensive testing on functional specification, subsystem and modules
                                                                                                 (according to EAL6 requirements). The testing was largely automated using industry standard and
                                                                                                 proprietary test suites. Test scripts were extensively used to verify that the functions return the
                                                                                                 expected values.
                                                                                                 For the testing performed by the evaluators, the developer has provided samples and a test
                                                                                                 environment. The evaluators have reproduced a selection of the developer tests, as well as a small
                                                                                                 number of test cases designed by the evaluator. For the evaluator defined tests the developer
                                                                                                 delivered samples (and support in writing scripts). However, Riscure’s test environment was used for
                                                                                                 these ATE_IND tests.
                                                                                                 The underlying hardware and crypto-library test results are extendable to composite evaluations, as
                                                                                                 the underlying platform is operated according to its guidance and the composite evaluation
                                                                                                 requirements are met.
                                                                                                 Page: 11/14 of report number: NSCIB-CC-217812-CR2, dated 14 December 2020




                                                                                                 2.6.2    Independent Penetration Testing
                                                                                                 The evaluator independent penetration tests were conducted according to the following testing
                                                                                                 approach:
                                                                                                     • During evaluation of the ADV, ATE and ALC classes the evaluators hypothesized possible
                                                                                                        vulnerabilities. This resulted in a shortlist of possible vulnerabilities to be further analysed in
                                                                                                        AVA using the design knowledge gained in particular from the source code analysis in IMP.
                                                                                                        This resulted in a shortlist of potential vulnerabilities to be tested.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       