 ˇˇˇˇˇˇˇ-[22] FMT_SMR.1 for BAC
FMT_MTD.1.1/INI_ENA The TSF shall restrict the ability to write the Initialisation Data and Pre-personalisation
                    Data to the Manufacturer.
Application Note: The application note 42 of [PP_BAC] applies. This application note provides a definition, what
is meant by ‚ÄúPre-personalization Data‚Äù. This definition is also applicable to FMT_MTD.1/INI_ENA from
[PP_SAC]. Therefore FMT_MTD.1/INI_ENA from [PP_BAC] and [PP_SAC] can be combined.



CC Document                                            15                                                     3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

6.2.3              Class FPT Protection of the Security Functions
FPT_TST.1               TSF testing
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_TST.1.1             The TSF shall run a suite of self tests during initial start-up, to demonstrate the correct
                        operation of the TSF.
FPT_TST.1.2             The TSF shall provide authorised users with the capability to verify the integrity of the
                        TSF data.
FPT_TST.1.3             The TSF shall provide authorised users with the capability to verify the integrity of
                        stored TSF executable code.
Application Note: There is no contradiction between application note 46 of [PP_BAC] and application note 52 of
[PP_SAC]. In fact, although the wording is slightly different, the meaning of these application notes is identical.
Therefore either of these application notes applies and FPT_TST.1 from [PP_BAC] and [PP_SAC] can be
combined.


FPT_PHP.3               Resistance to physical attack
Hierarchical to:        No other components.
Dependencies:           No dependencies.
FPT_PHP.3.1             The TSF shall resist physical manipulation and physical probing to the TSF by
                        responding automatically such that the SFRs are always enforced.
Application Note: Application note 47 of [PP_BAC] and 53 of [PP_SAC] are equivalent. Application note 48 of
[PP_BAC] is only informative to the reader in the sense, that it provides a context to an older CC standard, but
not relevant for the interpretation of FPT_PHP.3. Therefore either application note 47 of [PP_BAC] or
application note 53 of [PP_SAC] applies and FPT_PHP.3 from [PP_BAC] and [PP_SAC] can be combined.


6.3                SFRs specifically from [PP_SAC]

6.3.1              Class FCS: Cryptographic Support
FCS_CKM.1/DH_PACE Cryptographic key generation ‚Äì Diffie-Hellman for PACE session keys
Hierarchical to:        No other components.
Dependencies:           [FCS_CKM.2 Cryptographic key distribution or FCS_COP.1 Cryptographic operation]
                        Justification: A Diffie-Hellman key agreement is used in order to have no key
                        distribution, therefore FCS_CKM.2 makes no sense in this case. FCS_CKM.4
                        Cryptographic key destruction: fulfilled by FCS_CKM.4
FCS_CKM.1.1/DH_PACE       The TSF shall generate cryptographic keys in accordance with a specified
                   cryptographic key generation algorithm Diffie-Hellman-Protocol compliant to
                   [PKCS#3], ECDH compliant to [TR_ECC] and specified cryptographic key size Table 6
                   column key size that meet the following: [ICAO_SAC].


CC Document                                              16                                                       3.5
                                                                                                           2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Table 6       FCS_CKM/DH_PACE Key Sizes
 algorithm                                                                Key size
 ECDH key agreement algorithm                                             192, 224, 256, 320, 384, 512, 521
 DH key agreement algorithm                                               1024, 1280, 1536, 2048
 AES session keys                                                         128, 192, 256
 TDES session keys                                                        112



FCS_COP.1/PACE_ENC Cryptographic operation ‚Äì Encryption / Decryption AES / 3DES
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_ENC      The TSF shall perform secure messaging ‚Äì encryption and decryption in
                   accordance with a specified cryptographic algorithm AES and 3DES in CBC mode and
                   cryptographic key sizes 112, 128, 192 and 256 bit that meet the following: compliant to
                   [ICAO_SAC]
Application Note: 3DES in CBC mode is used with key size of 112 bit. AES in CBC mode is used with key size of
128, 192 or 256 bit. The TOE implements the cryptographic primitives (i.e. Triple-DES and AES) for secure
messaging with encryption of the transmitted data and encrypting the nonce in the first step of PACE. The keys
are agreed between the TOE and the terminal as part of the PACE protocol according to FCS_CKM.1/DH_PACE.


FCS_COP.1/PACE_MAC             MAC Cryptographic operation ‚Äì MAC
Hierarchical to:       No other components.
Dependencies:          [FDP_ITC.1 Import of user data without security attributes, or FDP_ITC.2 Import of user
                       data with security attributes, or FCS_CKM.1 Cryptographic key generation]: fulfilled by
                       FCS_CKM.1/DH_PACE
                       FCS_CKM.4 Cryptographic key destruction: fulfilled by FCS_CKM.4.
FCS_COP.1.1/PACE_MAC      The TSFshall perform secure messaging ‚Äì message authentication code in
                   accordance with a specified cryptographic algorithm CMAC and Retail-MAC and
                   cryptographic key sizes 112, 128, 192, 256 bit that meet the following: compliant to
                   [ICAO_SAC] .
Application Note: In accordance with [ICAO_SAC] the (two-key) Triple-DES (112 Bit) could be used in Retail
mode for secure messaging.


6.3.2               Class FIA Identification and Authentication


FIA_AFL.1/PACE         Authentication failure handling ‚Äì PACE authentication using non-blocking
authorisation data

CC Document                                           17                                                      3.5
                                                                                                       2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchicalto:    No other components.
Dependencies:      FIA_UAU.1 Timing of authentication: fulfilled by FIA_UAU.1/PACE
FIA_AFL.1.1/PACE   The TSF shall detect when one unsuccessful authentication attempt occurs related to
                   authentication attempts using the PACE password as shared password
FIA_AFL.1.2/PACE   When the defined number of unsuccessful authentication attempts has been met, the
                   TSF shall increasingly slow down the performance up to a maximum not higher than 7
                   seconds verifying the authentication token.


FIA_UID.1/PACE     Timing of identification
Hierarchical to:   No other components.
Dependencies:      No dependencies.
FIA_UID.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carry out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS
                   4. none
                   on behalf of the user to be performed before the user is identified.
FIA_UID.1.2/PACE   The TSF shall require each user to be successfully identified before allowing any other
                   TSF-mediated actions on behalf of that user.


FIA_UAU.1/PACE     Timing of authentication
Hierarchical to:   No other components.
Dependencies:      FIA_UID.1 Timing of identification: fulfilled by FIA_UID.1/PACE
FIA_UAU.1.1/PACE   The TSF shall allow
                   1. to establish a communication channel,
                   2. carrying out the PACE Protocol according to [ICAO_SAC]
                   3. to read the Initialization Data if it is not disabled by TSF according to
                      FMT_MTD.1/INI_DIS,
                   4. none
                   on behalf of the user to be performed before the user is authenticated.
FIA_UAU.1.2/PACE           The TSF shall require each user to be successfully authenticated before allowing
                           any other TSF-mediated actions on behalf of that user.




FIA_UAU.4/PACE     Single-use authentication of the Terminals by the TOE


CC Document                                         18                                                    3.5
                                                                                                   2020-07-15
Security Target Mercury ePassport v2.20

Security Requirements (ASE_REQ)

Hierarchical to:      No other components.
Dependencies:         No dependencies.
FIA_UAU.4.1/PACE      The TSF shall prevent reuse of authentication data related to
                      1. PACE Protocol according to [ICAO_SAC]
                      2. Authentication Mechanism based on Triple-DES
                      3. none


FIA_UAU.5/PACE        Multiple authentication mechanisms
Hierarchi                                    type

                                                                                                  Hardware
                                                                                                                    SN100x IC Package (as part of SN100 certificate)              B2.1 C58
                                                                                                  (platform)

                                                                                                                    Factory Page                                                  18652
                                                                                                  Data
                                                                                                                    System Page Common                                            18468
                                                                                                  configuration
                                                                                                  (platform)                                                                      4.2.0 PL5
                                                                                                                    BootOS Patch (part of SN100 certificate)
                                                                                                                                                                                  v16

                                                                                                                    Factory OS (part of SN100 certificate)                        4.2.0

                                                                                                                    Boot OS (part of SN100 certificate)                           4.2.0

                                                                                                  Software          Flash Driver Software (part of SN100 certificate)             4.0.8
                                                                                                  (Platform)
                                                                                                                    Services Software (part of SN100 certificate, specific to
                                                                                                                                                                              4.14.0.1
                                                                                                                    C58)

                                                                                                                    Crypto Library (part of SN100 certificate, specific to C58)   2.0.0

                                                                                                                    JCOP5.2                                                       R1.01.1

                                                                                                                             Platform ID: N5C2M00261A70600
¬Æ T√úV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                             Platform Build ID: 0261A7

                                                                                                                             eUICC plug-in                                        1.5.129

                                                                                                                    JCOP5.2                                 ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????                      R2.01.1

                                                                                                                             Platform ID: N5C2M0029E7D0600
                                                                                                  Software
                                                                                                  TOE
                                                                                                                             Platform Build ID: 029E7D

                                                                                                                             eUICC plug-in                                        1.5.146

                                                                                                                    JCOP5.2                                                       R2.02.1

                                                                                                                             Platform ID: N5C2M002A62D0600

                                                                                                                             Platform Build ID: 02A62D

                                                                                                                             eUICC plug-in                                        1.5.148


                                                                                                 To ensure secure usage a set of guidance documents is provided together with the NXP JCOP 5.2 on
                                                                                                 SN100.C58 Secure Element. Details cqn be found in section ‚ÄúDocumentation‚Äù of this report.
                                                                                                 For a detailed and precise description of the TOE lifecycle refer to the [ST], chapter 1.3.3.
                                                                                                 Page: 7/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.2       Security Policy
                                                                                                 The TOE is a composite product on top of CC certified Hardware, Firmware and Crypto Library. The
                                                                                                 overall product consists of a Secure Micro-Controller and a software stack. The Micro-Controller
                                                                                                 provides an Integrated NFC controller and an embedded Secure Element core. The software stack
                                                                                                 creates 2 separate domains to provide a converged product consisting of a familiar Java Card Secure
                                                                                                 Element domain and an eUICC domain providing UICC functionality and external ISO-7816
                                                                                                 connectivity.
                                                                                                 The TOE has the following features:
                                                                                                       ÔÇ∑    Cryptographic algorithms and functionality:
                                                                                                                o 3DES for en-/decryption (CBC and ECB) and MAC generation and verification (2-
                                                                                                                     key3DES, 3-key 3DES, Retail-MAC, CMAC and CBC-MAC).
                                                                                                                o AES (Advanced Encryption Standard) for en-/decryption (GCM, CBC and ECB) and
                                                                                                                     MAC generation and verification (CMAC, CBC-MAC).
                                                                                                                o RSA and RSA CRT for en-/decryption and signature generation and verification.
                                                                                                                o RSA and RSA CRT key generation.
                                                                                                                o SHA-1, SHA-224, SHA-256, SHA-384, SHA-512 hash algorithm.
                                                                                                                o Secure SHA-1, Secure SHA-224, Secure SHA-256, Secure SHA-384, Secure SHA-
                                                                       NXP Secure Sm                                                512 hash algorithm.
                                                                                                                o HMAC.
                                                                                                                o ECC over GF(p) for signature generation and verification (ECDSA).
                                                                                                                o ECC over GF(p) key generation for key agreement.
                                                                                                                o Random number generation according to class DRG.3 of AIS 20.
                                                                                                       ÔÇ∑    Java Card 3.0.5 functionality.
                                                                                                       ÔÇ∑    GlobalPlatform 2.3 functionality including Amendments A,B,C,D,E,F,H and I and is compliant
                                                                                                            with the Common Implementation Configuration.
                                                                                                       ÔÇ∑    GSMA ‚ÄôRemote SIM Provisioning Architecture for consumer Devices‚Äô.
                                                                                                       ÔÇ∑    Cryptographic Service Provider (CSP) features.
                                                                                                       ÔÇ∑    NXP Proprietary Functionality:
                                                                                                                o MiFare functionality accessible via Applets using the MiFare API ‚Äì no security
                                                                                                                     functionality is claimed.
                                                                                                                o OSSCA (Chinese Crypto) functionality accessible via Applets using the OSSCA API ‚Äì
                                                                                                                     No security functionality is claimed.
                                                                                                                o Felica functionality accessible via Applets using the Felica API - no security
                                                                                                                     functionality is claimed for this functionality.
¬Æ T√úV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                o Config Applet: JCOP5.2 OS includes a Config Applet that can be used for
                                                                                                                     configuration of the TOE.
                                                                                                                o OS Update Component: Proprietary functionality that can update JCOP5.2 OS or
                                                                                                                     UpdaterOS.
                                                                                                                o UAI update component: Proprietary functionality that is can update JCOP5.2 OS- no
                                                                                                                     security functionality is claimed.
                                                                                                                o Restricted Mode: In Restricted Mode only very limited functionality of the TOE is
                                                                                                                     available such as, e.g.: reading logging information or resetting the Attack Counter.
                                                                                                                o Error Detection Code (EDC) API.
                                                                                                       ÔÇ∑    Functionality introduced in R2, for which there are no specific additional security claims:
                                                                                                                o CAT-TP, with limitations as described in the [AGD_UGM] Section 8.1.
                                                                                                                o 5G features as per SIM Alliance 2.3, as in [AGD_UGM] Section 2.4.4 and 8.1.
                                                                                                                o Extension to Global Platform Amendment H, as in [AGD_UGM] Section 3.5.7.
                                                                                                                o CPLC data made available through SystemInfo, as in [AGD_UGM] Section 2.1.3.22.

                                                                                                 2.3       Assumptions and Clarification of Scope

                                                                                                 2.3.1      Assumptions
                                                                                                 The assumptions defined in the Security Target are not covered by the TOE itself. These aspects lead
                                                                                                 to specific Security Objectives to be fulfilled by the TOE-Environment. Detailed information on these
                                                                                                 security objectives that must be fulfilled by the TOE environment can be found in section 5.2 of the
                                                                                                 [ST].
                                                                                                 Page: 8/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.3.2    Clarification of scope
                                                                                                 The evaluation did not reveal any threats to the TOE that are not countered by the evaluated security
                                                                                                 functions of the product.
                                                                                                 Note that proprietary applications have been included in the TOE, but as there are no security claims
                                                                                                 on these functionalities, these application functionality has not been assessed, only the self-protection
                                                                                                 of the TSF.

                                                                                                 2.4     Architectural Information
                                                                                                 The TOE consists of a certified Hardware IC, with Micro Controller Firmware (Boot OS, Factory OS
                                                         art Card
  Controller P6022y VB
  Security Targe                                        and Flash driver software) and certified security software library consisting of a crypto library and
                                                                                                 services software. All these parts are depicted in the figure below with the shaded box marked
                                                                                                 SE100_SE. Since, this TOE is a composite on top of this certified platform, this block is not depicted
                                                                                                 in more detail.
                                                                                                 The Software stack consists of the JCOP Core parts marked with salmon coloured blocks
                                                                                                 implementing the Native OS, Global platform functionality and the Java Card 3.05 functionality. The
                                                                                                 TOE also implements a Cryptographic Service Provider marked with an orange coloured block. It
                                                                                                 implements a number of NXP proprietary features like the JCOP extension APIs for MiFare, Felica,
                                                                                                 Updater O/S and Config applet (note there are no security claims relating to MiFare and Felica).
                                                                                                 Furthermore the TOE implements GSMA ‚ÄòRemote SIM Provisioning Architecture for consumer
                                                                                                 Devices‚Äô, referred to as eUICC. The JCOP O/S supports the eUICC APIs and uses the Broker API to
                                                                                                 forward to the eSIM/SIM/UICC/ISIM commands to the eUICC Plugin Library.
                                                                                                 The TOE supports two domains, the eSE for the Java Card Secure Element domain and an eUICC
                                                                                                 domain providing UICC functionality in accordance with the GSMA Specification.
¬Æ T√úV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 9/14 of report number: NSCIB-CC-0023577-CR2, dated 09 July 2020




                                                                                                 2.5     Documentation
                                                                                                 The following documentation is provided with the product by the developer to the customer:

                                                                                                  JCOP Version       Identifier                                                        Version
                                                                                                  JCOP 5.2 R1        [AGD_UGM52R1] JCOP 5.2 R1.01.1 User Guidance Manual               1.8, 2019-10-30
                                                                                                                     [AGD_UGMSEMS52R1] JCOP 5.2 R1.01.1 User Guidance
                                                                                                                                                                                       1.1, 2019-10-17
                                                                                                                     Manual Addendum for SEMS API
                                                                                                                     [AGD_CSP52R1] JCOP 5.2 R1.01.1 User Guidance Manual
                                                                                                                                                                                       1.6, 2019-10-15
                                                                                                                     Addendum for CSPAPI
                                                                                                  JCOP 5.2 R2        [AGD_UGM52R2] JCOP 5.2 R2, User Guidance Manual,
                                                                                                                                                                                       1.3, 2020-06-08
           *                                                                                                         doc. no. 608813
                                                                                                                     [AGD_UGMSEMS52R2] JCOP 5.2 R2, User Guidance
                                                                                                                                        t Lite
  Rev. 2.1 ‚Äî 6 April 2018                                        Evaluation document
  BSI-DSZ-CC-1059                                                             PUBLIC




Document inf                                               1.2, 2020-06-08
                                                                              ormation
Informat            