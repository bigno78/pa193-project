 Recognition Arrangement
evidence adduced.                                                                                       recognition for components
                                                                                                        up to EAL 2 and ALC_FLR
This certificate is not an endorsement of the IT Product by the Federal Office for                                  only
Information Security or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT Product by the Federal Office for Information
Security or any other organisation that recognises or gives effect to this certificate, is
either expressed or implied.
Bonn, 12 February 2020
For the Federal Office for Information Security




Bernd Kowalski                              L.S.
Head of Division

                                   Bundesamt für Sicherheit in der Informationstechnik
                       Godesberger Allee 185-189 - D-53175 Bonn -    Postfach 20 03 63 - D-53133 Bonn
                   Phone +49 (0)228 99 9582-0 - Fax +49 (0)228 9582-5477 - Infoline +49 (0)228 99 9582-111
Certification Report                                            BSI-DSZ-CC-0879-V4-2020




                       This page is intentionally left blank.




                                                                                  4 / 33
BSI-DSZ-CC-0879-V4-2020                                                                                        Certification Report




Contents
A. Certification......................................................................................................................6
   1.   Preliminary Remarks....................................................................................................6
   2.   Specifications of the Certification Procedure...............................................................6
   3.   Recognition Agreements..............................................................................................7
   4.   Performance of Evaluation and Certification................................................................8
   5.   Validity of the Certification Result.................................................................................8
   6.   Publication....................................................................................................................9
B. Certification Results.......................................................................................................10
   1. Executive Summary....................................................................................................11
   2. Identification of the TOE.............................................................................................12
   3. Security Policy............................................................................................................15
   4. Assumptions and Clarification of Scope.....................................................................15
   5. Architectural Information.............................................................................................16
   6. Documentation...........................................................................................................16
   7. IT Product Testing.......................................................................................................16
   8. Evaluated Configuration.............................................................................................17
   9. Results of the Evaluation............................................................................................18
   10. Obligations and Notes for the Usage of the TOE.....................................................19
   11. Security Target..........................................................................................................20
   12. Regulation specific aspects (eIDAS, QES)..............................................................20
   13. Definitions.................................................................................................................20
   14. Bibliography..............................................................................................................23
C. Excerpts from the Criteria..............................................................................................26

D. Annexes.........................................................................................................................27




                                                                                                                                 5 / 33
Certification Report                                                               BSI-DSZ-CC-0879-V4-2020




A.      Certification

1.      Preliminary Remarks
Under the BSIG1 Act, the Federal Office for Information Security (BSI) has the task of
issuing certificates for information technology products.
Certification of a product is carried out on the instigation of the vendor or a distributor,
hereinafter called the sponsor.
A part of the procedure is the technical examination (evaluation) of the product according
to the security criteria published by the BSI or generally recognised security criteria.
The evaluation is normally carried out by an evaluation facility recognised by the BSI or by
BSI itself.
The result of the certification procedure is the present Certification Report. This report
contains among others the certificate (summarised assessment) and the detailed
Certification Results.
The Certification Results contain the technical description of the security functionality of
the certified product, the details of the evaluation (strength and weaknesses) and
instructions for the user.

2.      Specifications of the Certification Procedure
The certification body conducts the procedure according to the criteria laid down in the
following:
●   Act on the Federal Office for Information Security 1
●   BSI Certification and Approval Ordinance2
●   BSI Schedule of Costs 3
●   Special decrees issued by the Bundesministerium des Innern (Federal Ministry of the
    Interior)
●   DIN EN ISO/IEC 17065 standard
●   BSI certification: Scheme documentation describing the certification process (CC-
    Produkte) [3]
●   BSI certification: Scheme documentation on requirements for the Evaluation Facility, its
    approval and licencing process (CC-Stellen) [3]
●   Common Criteria for IT Security Evaluation (CC), Version 3.1 4 [1] also published as
    ISO/IEC 15408.

1
     Act on the Federal Office for Information Security (BSI-Gesetz - BSIG) of 14 August 2009,
     Bundesgesetzblatt I p. 2821
2
     Ordinance on the Procedure for Issuance of Security Certificates and approval by the Federal Office for
     Information Security (BSI-Zertifizierungs- und -Anerkennungsverordnung - BSIZertV) of 17 December
     2014, Bundesgesetzblatt 2014, part I, no. 61, p. 2231
3
     Schedule of Cost for Official Procedures of the Bundesamt für Sicherheit in der Informationstechnik
     (BSI-Kostenverordnung, BSI-KostV) of 3 March 2005, Bundesgesetzblatt I, p. 519



                                                                                                           6 / 33
BSI-DSZ-CC-0879-V4-2020                                                              Certification Report




●   Common Methodology for IT Security Evaluation (CEM), Version 3.1 [2] also published
    as ISO/IEC 18045
●   BSI certification: Application Notes and Interpretation of the Scheme (AIS) [4]

3.      Recognition Agreements
In order to avoid multiple certification of the same product in different countries a mutual
recognition of IT security certificates - as far as such certificates are based on ITSEC or
CC - under certain conditions was agreed.

3.1.    European Recognition of CC – Certificates (SOGIS-MRA)
The SOGIS-Mutual Recognition Agreement (SOGIS-MRA) Version 3 became effective in
April 2010. It defines the recognition of certificates for IT-Products at a basic recognition
level and, in addition, at higher recognition levels for IT-Products related to certain SOGIS
Technical Domains only.
The basic recognition level includes Common Criteria (CC) Evaluation Assurance Levels
EAL 1 to EAL 4. For "Smartcards and similar devices" a SOGIS Technical Domain is in
place. For "HW Devices with Security Boxes" a SOGIS Technical Domains is in place, too.
In addition, certificates issued for Protection Profiles based on Common Criteria are part of
the recognition agreement.
The current list of signatory nations and approved certification schemes, details on
recognition, and the history of the agreement can be seen on the website at
https://www.sogis.eu.
The SOGIS-MRA logo printed on the certificate indicates that it is recognised under the
terms of this agreement by the related bodies of the signatory nations. A disclaimer
beneath the logo indicates the specific scope of recognition.
This certificate is recognized under SOGIS-MRA for all assurance components selected.

3.2.    International Recognition of CC – Certificates (CCRA)
The international arrangement on the mutual recognition of certificates based on the CC
(Common Criteria Recognition Arrangement, CCRA-2014) has been ratified on 08
September 2014. It covers CC certificates based on collaborative Protection Profiles (cPP)
(exact use), CC certificates based on assurance components up to and including EAL 2 or
the assurance family Flaw Remediation (ALC_FLR) and CC certificates for Protection
Profiles and for collaborative Protection Profiles (cPP).
The current list of signatory nations and approved certification schemes can be seen on
the website: https://www.commoncriteriaportal.org.
The Common Criteria Recognition Arrangement logo printed on the certificate indicates
that this certification is recognised under the terms of this agreement by the related bodies
of the signatory nations. A disclaimer beneath the logo indicates the specific scope of
recognition.
This certificate is recognized according to the rules of CCRA-2014, i. e. up to and including
CC part 3 EAL 2+ ALC_FLR components.

4
     Proclamation of the Bundesministerium des Innern of 12 February 2007 in the Bundesanzeiger dated
     23 February 2007, p. 3730



                                                                                                    7 / 33
Certification Report                                                       BSI-DSZ-CC-0879-V4-2020




4.      Performance of Evaluation and Certification
The certification body monitors each individual evaluation to ensure a uniform procedure, a
uniform interpretation of the criteria and uniform ratings.
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has undergone the certification
procedure at BSI. This is a re-certification based on BSI-DSZ-CC-0879-V3-2018. Specific
results from the evaluation process BSI-DSZ-CC-0879-V3-2018 were re-used.
The evaluation of the product Infineon Security Controller M7893 B11 with optional
RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and
Toolbox v2.03.008 and with specific IC dedicated software (firmware), was conducted by
TÜV Informationstechnik GmbH. The evaluation was completed on 11 February 2020.
TÜV Informationstechnik GmbH is an evaluation facility (ITSEF) 5 recognised by the
certification body of BSI.
For this certification procedure the sponsor and applicant is: Infineon Technologies AG.
The product was developed by: Infineon Technologies AG.
The certification is concluded with the comparability check and the production of this
Certification Report. This work was completed by the BSI.

5.      Validity of the Certification Result
This Certification Report applies only to the version of the product as indicated. The
confirmed assurance package is valid on the condition that
●   all stipulations regarding generation, configuration and operation, as given in the
    following report, are observed,
●   the product is operated in the environment described, as specified in the following report
    and in the Security Target.
For the meaning of the assurance components and assurance levels please refer to CC
itself. Detailed references are listed in part C of this report.
The Certificate issued confirms the assurance of the product claimed in the Security Target
at the date of certification. As attack methods evolve over time, the resistance of the
certified version of the product against new attack methods needs to be re-assessed.
Therefore, the sponsor should apply for the certified product being monitored within the
assurance continuity program of the BSI Certification Scheme (e.g. by a re-assessment or
re-certification). Specifically, if results of the certification are used in subsequent evaluation
and certification procedures, in a system integration process or if a user's risk
management needs regularly updated results, it is recommended to perform a re-
assessment on a regular e.g. annual basis.
In order to avoid an indefinite usage of the certificate when evolved attack methods would
require a re-assessment of the products resistance to state of the art attack methods, the
maximum validity of the certificate has been limited. The certificate issued on 12 February
2020 is valid until 11 February 2025. Validity can be re-newed by re-certification.
The owner of the certificate is obliged:

5
     Information Technology Security Evaluation Facility



                                                                                             8 / 33
BSI-DSZ-CC-0879-V4-2020                                                        Certification Report




     1. when advertising the certificate or the fact of the product's certification, to refer to
        the Certification Report as well as to provide the Certification Report, the Security
        Target and user guidance documentation mentioned herein to any customer of the
        product for the application and usage of the certified product,
     2. to inform the Certification Body at BSI immediately about vulnerabilities of the
        product that have been identified by the developer or any third party after issuance
        of the certificate,
     3. to inform the Certification Body at BSI immediately in the case that security relevant
        changes in the evaluated life cycle, e.g. related to development and production sites
        or processes, occur, or the confidentiality of documentation and information related
        to the Target of Evaluation (TOE) or resulting from the evaluation and certification
        procedure where the certification of the product has assumed this confidentiality
        being maintained, is not given any longer. In particular, prior to the dissemination of
        confidential documentation and information related to the TOE or resulting from the
        evaluation and certification procedure that do not belong to the deliverables
        according to the Certification Report part B, or for those where no dissemination
        rules have been agreed on, to third parties, the Certification Body at BSI has to be
        informed.
In case of changes to the certified version of the product, the validity can be extended to
the new versions and releases, provided the sponsor applies for assurance continuity (i.e.
re-certification or maintenance) of the modified product, in accordance with the procedural
requirements, and the evaluation does not reveal any security deficiencies.

6.      Publication
The product Infineon Security Controller M7893 B11 with optional RSA2048/4096
v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008
and with specific IC dedicated software (firmware), has been included in the BSI list of
certified products, which is published regularly (see also Internet: https://www.bsi.bund.de
and [5]). Further information can be obtained from BSI-Infoline +49 228 9582-111.
Further copies of this Certification Report can be requested from the developer 6 of the
product. The Certification Report may also be obtained in electronic form at the internet
address stated above.




6
     Infineon Technologies AG
     Am Campeon 1-12
     85579 Neubiberg



                                                                                              9 / 33
Certification Report                                                    BSI-DSZ-CC-0879-V4-2020




B.      Certification Results
The following results represent a summary of
●   the Security Target of the sponsor for the Target of Evaluation,
●   the relevant evaluation results from the evaluation facility, and
●   complementary notes and stipulations of the certification body.




                                                                                         10 / 33
BSI-DSZ-CC-0879-V4-2020                                                           Certification Report




1.     Executive Summary
The Target of Evaluation (TOE) is an Infineon Security Controller M7893 B11 with optional
Software Library RSA2048/4096 v2.03.008, EC v2.03.008, SHA-2 v1.01, SCL v2.02.010
libraries, and Toolbox v2.03.008, as well as with specific IC dedicated software (firmware).
The TOE provides a real 16-bit CPU-architecture and is compatible to the 80251
microcontroller architecture. The major components of the core system are the two CPUs
(Central Processing Units), acting as one, the MMU (Memory Management Unit) and MED
(Memory Encryption/Decryption Unit). The dual interface controller is able to communicate
using either the contact based or the contactless interface.
The TOE consists of the hardware part, the firmware parts and the software parts.
The software parts are differentiated into the cryptographic libraries RSA, EC, and SHA-2,
symmetric cryptographic libraries and the supporting libraries Toolbox and Base. The Base
Library does not provide any specific security functionality on its own. However it is a
necessary perquisite in order to use the RSA, EC and Toolbox libraries.
This TOE is intended to be used in smart cards and other form factors for particularly
security-relevant applications and for its prevalent use as developing platform for smart
card operating systems. The term Smartcard Embedded Software is used in the following
for all operating systems and applications stored and executed on the TOE. The TOE is
the platform for the Smartcard Embedded Software.
The Security Target [6] is the basis for this certification. It is based on the certified
Protection Profile Security IC Platform Protection Profile, Version 1.0, 15 June 2007, BSI-
CC-PP-0035-2007 [8]. The TOE Security Functional Requirements are implemented by
the following TOE Security Functionality:
  TOE Security Functionality         Addressed issue
  SF_DPM                             Device Phase Management:
                                     The life cycle of the TOE is split up into several
                                     phases. Different operation modes help to protect
                                     the TOE during each phase of its lifecycle.
  SF_PS                              Protection against Snooping:
                                     The TOE uses various means to protect from
                                     snooping of memories and busses and prevents
                                     single stepping.
  SF_PMA                             Protection against Modifying Attacks:
                                     This TOE implements protection against
                                     modifying attacks of memories, alarm lines and
                                     sensors.
  SF_PLA                             Protection against Logical Attacks:
                                     The memory access control of the TOE uses a
                                     memory management unit (MMU) to control the
                                     access to the available physical memory by using
                                     virtual memory addresses and to segregate the
                                     code and data to a privilege level model. The
                                     MMU controls the address permissions of up
                                     seven privileged levels and gives the software the
                                     possibility to define different access rights. The
                                     address permissions of the privilege levels are




                                                                                                11 / 33
Certification Report                                                         BSI-DSZ-CC-0879-V4-2020




  TOE Security Functionality           Addressed issue
                                       controlled by the MMU. In case of an access
                                       violation the MMU will trigger a reset and then a
                                       trap service routine can react on the access
                                       violation.
  SF_CS                                Cryptographic Support:
                                       The TOE is equipped with several hardware
                                       accelerators and software modules to support the
                                       standard      symmetric     and       asymmetric
                                       cryptographic operations. The components are a
                                       coprocessor supporting the DES and AES
                                       algorithms and a combination of a coprocessor
                                       and software modules to support RSA
                                       cryptography, RSA key generation, ECDSA
                                       signature generation and verification, ECDH key
                                       agreement and EC public key calculation and
                                       public key testing. Furthermore, the TOE is
                                       equipped with an optional SHA-2 library and
                                       HASH module as well as well as an AIS31
                                       conformant TRNG that meets the functionality
                                       class PTG.2. In addition the optional Symmetric
                                       library (SCL) provides a high-level interface to
                                       3DES and AES symmetric cryptographic
                                       operation implemented on the symmetric
                                       hardware coprocessor.

                               Table 1: TOE Security Functionalities
For more details please refer to the Security Target [6] and [9], chapter 8.
The assets to be protected by the TOE are defined in the Security Target [6] and [9],
chapter 4.1.2. Based on these assets the TOE Security Problem is defined in terms of
Assumptions, Threats and Organisational Security Policies. This is outlined in the Security
Target [6] and [9], chapter 4.
This certification covers the configurations of the TOE as outlined in chapter 8.
The vulnerability assessment results as stated within this certificate do not include a rating
for those cryptographic algorithms and their implementation suitable for encryption and
decryption (see BSIG Section 9, Para. 4, Clause 2).
The certification results only apply to the version of the product indicated in the certificate
and on the condition that all the stipulations are kept as detailed in this Certification
Report. This certificate is not an endorsement of the IT product by the Federal Office for
Information Security (BSI) or any other organisation that recognises or gives effect to this
certificate, and no warranty of the IT product by BSI or any other organisation that
recognises or gives effect to this certificate, is either expressed or implied.

2.      Identification of the TOE
The Target of Evaluation (TOE) is called:
 Infineon Security Controller M7893 B11 with optional RSA2048/4096 v2.03.008, EC
   v2.03.008, SHA-2 v1.01, SCL v2.02.010 libraries and Toolbox v2.03.008 and with
                     specific IC dedicated software (firmware),
The following table outlines the TOE deliverables:



                                                                                              12 / 33
BSI-DSZ-CC-0879-V4-2020                                                                 Certification Report




           No Type        Identifier                    Release           Form of Delivery
           1    HW        M7893 Smart Card IC           B11 (produced in Complete modules, with or
                                                        Dresden)         without inlay mounting, with or
                                                                         without inlay antenna mounting,
                                                                         in form of plain wafers, in an IC
                                                                         case or in bare dies
           2    SW        RSA library (optional)        RSA2048           Object code in electronic form
                                                        v2.03.008
                                                        RSA4096
                                                        v2.03.008
           3    SW        EC library (optional)         EC v2.03.008      Object code in electronic form
           4    SW        SHA-2 library (optional)      SHA-2 v1.01       Object code in electronic form
           5    SW        Toolbox library (optional)    Toolbox           Object code in electronic form
                                                        v2.03.008
           6    SW        SCL library (optional)        v2.02.010         Object code in electronic form
           7    FW        STS Self Test Software (the   FW-identifier     Stored in test ROM on the IC
                          IC Dedicated Test Software)   78.019.03.4       (patch in SOLID FLASH)
           8    FW        RMS Resource              FW-identifier         Stored in reserved area of user
                          Management System (the IC 78.019.03.4           ROM on the IC (patch in SOLID
                          Dedicated Support                               FLASH)
                          Software)
           9    FW        Service Algorithm (SA)        FW-identifier     Stored in reserved area of user
                                                        78.019.03.4       ROM on the IC (patch in SOLID
                                                                          FLASH)
           10   FW        Flash Loader                  FW-identifier     Stored in reserved area of user
                                                        78.019.03.4       ROM and parts of it in SOLID
                                                                          FLASH on the IC (patch in
                                                                          SOLID FLASH)
           11   SW        ROM code (including           --                Stored in User ROM on the IC.
                          Embedded Software and
                                                                          Only in case the IC Embedded
                          crypto libraries)
                                                                          Software Developer provides
                                                                          Infineon with code for ROM.
           12   SW        NVM image (including          --                Stored in Flash memory on the
                          Embedded Software and                           IC.
                          crypto libraries)
                                                                          Only in case the IC Embedded
                                                                          Software Developer provides
                                                                          Infineon with code for Flash
                                                                          memory.
           13   DOC       SLx 70 Family Production      2015-04-01        Personalized pdf-file
                          and Personalization User’
                          Manual
           14   DOC       M7893 Hardware Reference 19-06-24               Personalized pdf-file
                          Manual 3.0
           15   DOC       M7893 Errata Sheet 4.2        2019-08-07        Personalized pdf-file
           16   DOC       M7893 Security Guidelines     2019-09-25        Personalized pdf-file
           17   DOC       16-bit Security Controller    2019-02-19        Personalized pdf-file
                          Family SLE 70
                          Programmer’s Reference
                          Manual 9.10




                                                                                                     13 / 33
Certification Report                                                            BSI-DSZ-CC-0879-V4-2020




             No Type    Identifier                    Release           Form of Delivery
             18   DOC   SLE70 Asymmetric Crypto       2019-07-15        Personalized pdf-file (optional)
                        Library for Crypto@2304T
                        RSA / ECC / Toolbox User
                        Interface (2.03.008)
             19   DOC   SCL78 Symmetric Crypto        2016-12-09        Personalized pdf-file (optional)
                        Library for SCP v3,
                        DES/AES, 16-bit Security
                        Controller, User Interface
                        (2.02.010)
             20   DOC   Crypto@2304T User Manual 2010-03-23             Personalized pdf-file
             21   DOC   SLx70 Family Secure Hash      2009-11-06        Personalized pdf-file (optional)
                        Algorithm SHA-2 (SHA
                        256/224, SHA 512/384)
                        Library Version V1.01
             22   DOC   AMM Advanced Mode NRG         2019-10-22        Personalized pdf-file (optional)
                        SAM Addendum 2.0

                                     Table 2: Deliverables of the TOE

The delivery documentation describes all procedures that are necessary to maintain
security when distributing versions of the TOE or parts of it to the user’s site including the
necessary intermediate delivery procedures.
Furthermore, the delivery documentation describes in a sufficient manner how the various
procedures and technical measures provide for the detection of modifications and any
discrepancies between the TOE respective parts of it send by the TOE Manufacturer and
the version received by the Composite Product Manufacturer.
Three different delivery procedures have to be taken into consideration:
    ●   Delivery of the IC dedicated software components (IC dedicated SW, guidance)
        from the TOE Manufacturer to the IC Embedded Software Developer.
    ●   Delivery of the IC Embedded Software (ROM / Flash data, initialisation and pre-
        personalisation data) from the IC Embedded Software Developer to the TOE
        Manufacturer.
    ●   Delivery of the final TOE from the TOE Manufacturer to the Composite Product
        Manufacturer. After phase 3 the TOE is delivered in form of wafers or sawn wafers,
        after phase 4 in form of modules (with or without inlay antenna).
Respective distribution centers are listed in Appendix B (see below).
The individuaific
configured, not flashed and not personalized TOE products to the user warehouse.
Extra authentication means applied in the PIN-Letter status of the Flash Loader preserve that only the intended
user with the intended PIN-Letter can configure with user specific information and enable the normal Flash
Loader functions in a second step. By that the user orders the products and receives - in a protected way - the
belonging PIN-Letter. PIN-Letter and delivered chips must match.
By delivery the user warehouse gets filled and depending on market demands the user can immediate apply the
authentication means of the PIN-letter. If passing, the TOE products become user specific configured and the
Flash Loader can be used for this specific user in a second step.
The following table outlines the different ways how the user can input his software on this TOE – a TOE without
user available ROM. User software comprises usually the operating system and applications, which are for
Infineon Technologies simply a user data package which is handled as a fixed data package during production.
This provides high process flexibility for the user of which an overview is given in the following table:


                         Table 2        Options to implement user software on the chip
 Case                          Option                                          Flash Loader Status
         The user or/and a subcontractor downloads the
         software into the SOLID FLASH™ NVM on his             The Flash Loader can be activated or reactivated
 1.      own. Infineon Technologies has not received user      by the user or subcontractor to download his
         software and there are no user data of the            software in the SOLID FLASH™ NVM.
         Composite TOE in the ROM.
         The user provides his complete software for the
         download into the SOLID FLASH™ NVM to
                                                               The Flash Loader is permanently disabled prior
 2       Infineon Technologies AG. The software is
                                                               delivery.
         downloaded to the SOLID FLASH™ NVM during
         chip production.
                                                               When leaving the Infineon Technologies
                                                               production facility, the Flash Loader is blocked,
         The user provides software for the download into      but can be activated or reactivated by the user or
         the SOLID FLASH™ NVM to Infineon                      subcontractor to complete the previously stored
 3       Technologies AG. The software is downloaded to        software parts in the SOLID FLASH™ NVM.
         the SOLID FLASH™ NVM during chip
         production.                                           Precondition is that the user has provided an own
                                                               reactivation procedure in software prior chip
                                                               production to Infineon Technologies AG.

For the cases with active Flash Loader on board and whenever the user has finalized his SW-download,
respectively the TOE is in the final state and about to be delivered to the end-user, the user is obligated to lock
the Flash Loader. This locking is the final step and results in a permanent deactivation of the Flash Loader. This
means that once being in the locked status, the Flash Loader cannot be reactivated anymore.
Note that whenever a TOE comes without active Flash Loader, BPU and PIN-Letter process are not possible.
All in all various delivery combinations are given and for example, a product can come with a fix configuration
and with Flash Loader, to enable the user to download software, but without BPU option and with PIN-Letter.
The following cases can occur:

                         Table 3        Options with Flash Loader, BPU and PIN-Letter
CC Document                                              10                                                       1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


 Case           Order                                              Option
   1     Fix configuration,            Infineon Technologies configures and flashes all software as ordered.
         Flash Loader is               The entire user software must be delivered to Infineon Technologies
         locked (permanent)             prior production.
   2     Flash Loader                  Infineon configures the chip as ordered and
         functional, BPU               the user flashes his software at his own premises.
         feature blocked               If requested, Infineon Technologies can optionally download also
                                        shares of the user software during production. These user software
                                        shares must be delivered to Infineon Technologies prior production.
                                        The user can finalize his software package at his premises.
   3     Flash Loader           The user:
         functional                 Activates the Flash Loader,
         and active BPU             configures the chip applying the BPU feature and
         feature
                                    flashes his software at his own premises.
                                    If requested, Infineon Technologies can optionally download also
                                       shares of the user software during production. These user software
                                       shares must be delivered to Infineon Technologies prior production.
                                       The user can finalize his software package at his premises.
   4     Flash Loader           Infineon cugfoerins the chip as ordered. The user receives his PIN-letter and
         functional             fills his warehouse. As required the user:
         and PIN-Letter                applies the PIN-Letter on the chips taken from his warehouse, gets the
                                          chips user specific configured,
                                       activates the Flash Loader and
                                       the user flashes his software at his own premises.
                                If requested, Infineon Technologies can optionally download also shares of the
                                user software during production. These user software shares must be delivered
                                to Infineon Technologies prior production. The user can finalize his software
                                package at his premises.
   5     Flash Loader           Infineon configures the chip as ordered. The user receives his PIN-letter and
         functional,            fills his warehouse. As required the user:
         active BPU and                applies the PIN-Letter on the chips taken from his warehouse, gets the
         PIN-Letter                       chips user specific configured,
                                       activates the Flash Loader,
                                       applies his user specific chip configuration with the BPU feature and
                                       flashes his software at his own premises.
                                If requested, Infineon Technologies can optionally download also shares of the
                                user software during production. These user software shares must be delivered
                                to Infineon Technologies prior production. The user can finalize his software
                                package at his premises.

The listing provided in the confidential security target [8] contains the memory size ranges and other blocking
options, focusing on the maximum respectively minimum user available limitations. Within those limitations the
TOE configurations can vary under only one identical IC-hardware, regardless whether the configurations are set
by Infineon or within further limitations by the user. All configurations throughout all different mask sets the
TOE is made off and all thereof resulting derivatives have no impact on security and are covered by the
certificate.

CC Document                                            11                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


Note that this TOE has no user available ROM. The user software and data are entirely located in a dedicated and
protected part of the SOLID FLASH™ NVM. The long life storage endurance together with the means for error
detection and correction serves for excellent reliability and endurance.
In addition to the above listed flexible ranges, the user guidance contains a number of predefined configurations
for those customers not making use of the BPU option. All of these configurations belong to the TOE as well and
are of course made of the equal hardware and are inside the above declared ranges.
Today’s predefined configurations of the TOE are listed in the hardware reference manual HRM [1] and is
completed with the list of identification data of the derivatives. These predefined products come with the most
requested configurations and enables to produce volumes on stock in order to simplify logistic processes.
According to the BPU option, a non-limited number of configurations of the TOE may occur in the field. The
number of various configurations depends on the user and order contract only.
This TOE provides dedicated identification means and outputs the platform identifier, the design step and
further configuration information. The hardware reference manual HRM [1] is part of the user guidance and
enables for the clear interpretation of the read out identification data. More information is given in the
confidential Security Target [8].
These output data enable the user for clear identification of the TOE and also of one of the different mask sets
and therewith for examination of the validity of the certificate.
In addition, a dedicated RMS function allows reading out the present configuration in detail. The output RMS
data together with the hardware reference manual HRM [1] enables for clear identification of a product and its
configuration. All these steps for gathering identification and detailed configuration information can be done by
the user without involving the vendor, Infineon Technologies AG.

The TOE consists of the hardware part, the firmware parts in the alternative versions and the optional software
parts. The Smartcard Embedded Software, i.e. the operating system and applications are not part of the TOE.

The firmware comes with several alternative versions and consists of:
    the Boot Software (BOS) firmware conducting configuration and testing task (see chapter 2.2.2) at start-
        up of the TOE
    the Resource Management System (RMS) library providing essential basis functions for the management
        of the RAM, the branch table, the Memory Management Unit (MMU) and other resources
    the optional Flash Loader enabling for the download of user software to the SOLID FLASH™ NVM and
        required for the optional Bill per Use (BPU) feature and the PIN-letter feature
    the Radio Frequency Application Interface (RFAPI) supporting functions located in the ROM.
        The RFAPI functions are not part of the TOE Security Functionality (TSF)
    the NRG ROM part implementing some basic routines and used by the NRG if ordered.
        The NRG ROM part is not part of the TSF functionality.

The firmware parts BOS, RFAPI and NRG are implemented in a separated Test-ROM also being part of the TOE
but not available for the user. Completing firmware components are located in the SOLID FLASH™ NVM.

The optional software parts are differentiated into following libraries:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
           o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI1.



1
    Rivest-Shamir-Adleman asymmetric cryptographic algorithm


CC Document                                                    12                                                1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


             o All ACL libraries provide elliptic curve cryptography EC2
        the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
         functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
         Security Functionality (TSF).
        the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
         version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
        the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
         interface and utilizes the full services of the SOLID FLASH™ NVM to the user
        the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
         a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
         use of an additional advanced reading respectively writing method
        the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
         user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
        the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).

The RSA, EC and Toolbox libraries provide certain functionality via an API to the Smartcard Embedded Software.
The private parts of the cryptographic libraries are only used internally and have no user interface. If neither the
RSA- nor the EC library is delivered, also the belonging private parts are not on board. The Toolbox library does
not have private library parts.
Each of the libraries ACL, SCL, HSL and NRG is independent from the other libraries and also independent of the
alternative library version of the equal type. This means for example that the HSL-1 runs alone and does not need
parts of HSL-2.
A combination respectively mix up of the two alternative libraries of equal type has not been considered in the
design and is not allowed: The user can select either one or the other of the same library type or none of it.
If the user considers the optional software libraries, the TOE can be delivered including – in free combinations –
or not including any of the optional libraries.

If the user decides not to use any of the offered asymmetric cryptographic libraries, regardless of the version
chosen, none of the cryptographic libraries is consequently delivered and the accompanying Additional Specific
Security Functionality (O.Add-Functions) Rivest-Shamir-Adleman (RSA) and/ or EC is/are not provided by the
TOE. Else it depends of the chosen library whether the Additional Specific Security Functionality
(O.Add-Functions) Rivest-Shamir-Adleman (RSA) and/ or EC is/are supported.

The Toolbox library, regardless of the version chosen, provides the user optionally basic arithmetic and modular
arithmetic operations, in order to support user software development using long integer operations. These basic
arithmetic operations do not provide security functionality, implement no security mechanism, and do not
proved additional specific security functionality – as defined for the cryptographic libraries.
The user developed software using the Toolbox basic operations is not part of the TOE.
The Toolbox library is not part of the TOE Security Functionality (TSF).

The symmetric cryptographic library SCL – in both versions – offers a high level interface to perform the
cryptographic operations DES, TDES and AES with different key lengths on the symmetric cryptographic
coprocessor (SCP) for this TOE. In addition, the SCL in version v2.04.002 implements computation of a CMAC
using AES and 3DES algorithms.

1
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
2 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                          13                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The SCL implements already several block cipher modes as declared in this document and covering a wide range
of applications, the SCL offers in addition the flexibility to implement additional block cipher modes defined by
the user.
This library provides a simplified interface to the hardware Symmetric Cryptographic Coprocessor (SCP) and
preserves the security and performance requirements as required by the user.
Note that the definition of the key lengths follows the national AIS32 regulation regarding the 100 bit security
level by the BSI. This excludes the single DES operation from the certification.

Beside the inclusion and support of cryptographic libraries this TOE comes with the optional Hardware Support
Library (HSL) in different versions significantly simplifying the management of the SOLID FLASH™ NVM
functionality. The HSL constitutes an application interface (API) accessing the HSL state machine and
abstracting low level properties like special function registers and settings of specific hardware features. In short
the HSL provides a user friendly also use case oriented interface considering endurance, reliability and
performance requirements.
In certain configurations each of the HSL versions provide also functions implementing tearing safe behaviour of
the SOLID FLASH™ NVM. If applied the user has no need to care about cases where the TOE is unintentionally
removed from the power supply or the radio frequency field even during managing the SOLID FLASH™ NVM.
Anyhow, the HSL – regardless of the version – remains as an optional library, as even sudden power off situations
do not lead to exploitable conditions of the TOE. In the worse, the TOE ends operation in case of a faulty
programmed SOLID FLASH™ NVM location.
In addition to the above, the HSL in version 03.12.8812 and 03.11.8339 provide an advanced additional method
called Incremental Write (IWR). This method provides enhanced endurance of the SOLID FLASH NVM even
beyond the erase endurance limits for often written objects. Thus this method serves applications with a demand
for high endurance and fast writing times. On the other hand, the read times using this method are slower than
the other methods provided.

The order option CIPURSE™ Cryptographic Library (CIPURSE™ CL) provides cryptographic functionality to
implement a CIPURSE™ V2 conformant protocol.
This protocol provides a secure mutual authentication of two entities, namely the terminal (denoted as PCD =
Proximity Coupling Device (CIPURSE™-compliant terminal)) and a smart card or a token in other form factors
which is called PICC. PICC stands for Proximity Integrated Circuit Card (CIPURSE™-compliant card).
Beside the mutual authentication, the protocol implements measures to maintain the integrity of the transferred
data and preserves in parallel the confidentiality of the transferred data.
By that the CIPURSE™ CL supports the user to implement systems conformant to the CIPURSE™ open standard
implementing a secured, interoperable and flexible transit fare collection solution, including ISO 7816, ISO/IEC
14443-4 communication and AES-128 bit cryptography for multiple payment types.

The NRG Software is a further order option and implements the routines for a NRG interface. The NRG provides
an operating system handling the emulation of a NRG card together with the RF interface. One part of the NRG
is permanently stored in the ROM and the second part consisting of patch and API is located in the SOLID
FLASH™ NVM. The second part is only present if the NRG is part of the delivery. If the NRG is not part of the
delivery the ROM part is present but not used. The NRG implements tearing safe behaviour in context with the
SOLID FLASH™ NVM management and is therefore independent from the HSL. The NRG is not part of the TOE
Security Functionality (TSF).

Deselecting one of the optional libraries does not include the code implementing functionality, which the user
decided not to use. Not including the code of the deselected functionality has no impact of any other security
policy of the TOE; it is exactly equivalent to the situation where the user decides just not to use the functionality.

All optional software libraries are stored respectively can be loaded into the SOLID FLASH™ NVM.
All other Smartcard Embedded Software loaded into the SOLID FLASH™ NVM does not belong to the TOE and
is not subject of the evaluation.
CC Document                                               14                                                       1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


1.2            Target of Evaluation overview
The TOE comprises the Infineon Technologies Dual Interface Security Controller IFX_CCI_000003h with options
with specific IC dedicated software, optional cryptographic- and further services libraries.
The TOE is a member of the Infineon Technologies AG high security controller-family meeting the highest
requirements in terms of performance and security. A summary product description is given in this Security
TargePublic




   Common Criteria Public Security Target
   EAL6 augmented / EAL6+
   IFX_CCI_000003h
   IFX_CCI_000005h
   IFX_CCI_000008h
   IFX_CCI_00000Ch
   IFX_CCI_000013h
   IFX_CCI_000014h
   IFX_CCI_000015h
   IFX_CCI_00001Ch
   IFX_CCI_00001Dh
   IFX_CCI_000021h
   IFX_CCI_000022h

   H13

   Resistance to attackers with HIGH attack potential
                                    Including optional Software Libraries
                            Flash Loader – 3x ACL – 4x HSL – 2x SCL – NRG – CCL




 Author: Infineon Technologies
 Revision: 1.8




CC Document            Please read the Important Notice and Warnings at the end of this document          1.8
www.infineon.com                                                                                   2020-04-22
Public




Table of Contents
2.2.1         Hardware of the TOE ...................................................................................................................26
2.2.2         Firmware and software of the TOE .............................................................................................. 27
2.2.3         Interfaces of the TOE................................................................................................................... 32
2.2.4         Guidance documentation ............................................................................................................ 33
2.2.5         Forms of delivery ......................................................................................................................... 35
2.2.6         Production sites ........................................................................................................................... 37
3.1.1         Adding Objectives ....................................................................................................................... 39
3.1.2         AES and TDES .............................................................................................................................40
3.1.3         Loader .........................................................................................................................................40
3.1.4         CIPURSE Cryptographic Library (CCL) ......................................................................................... 41
3.1.5         Summary .....................................................................................................................................42
4.1.1         Additional Threat due to TOE specific Functionality .................................................................... 43
4.1.2         Assets regarding the Threats .......................................................................................................44
4.2.1         Augmented Organizational Security Policy .................................................................................46
4.3.1         Augmented Assumptions ............................................................................................................ 47
4.3.2         Note regarding CIPURSE™ CL .....................................................................................................48
5.3.1         Clarification of “Treatment of User Data (OE.Resp-Appl)” .......................................................... 54
5.3.2         Clarification of “Protection during Composite product Manufacturing (OE.Process-Sec-IC)” ...... 54
6.1.1         Definition of FPT_TST.2 ..............................................................................................................60
6.1.2         TSF self-test (FPT_TST) ............................................................................................................... 61
7.1.1         Extended Components FCS_RNG.1 and FAU_SAS.1 ................................................................... 65
7.1.2         Subset of TOE testing.................................................................................................................. 70
7.1.3         Memory access control ................................................................................................................ 71
7.1.4         Support of Cipher Schemes ......................................................................................................... 74
7.1.5         Data Integrity FDP_SDI.2 and FDP_SDC.1 ................................................................................. 103
7.1.6         Application Note to FPT_FLS.1 Failure with preservation of secure state .................................. 104
7.3.1         Refinements .............................................................................................................................. 109
7.4.1         Rationale for the Security Functional Requirements .................................................................. 113
7.4.2         Rationale of the Assurance Requirements ................................................................................. 124
8.1.1         Listing of SFRs implemented by SF_DPM Device Phase Management ...................................... 126
8.2.1         Listing of SFRs implemented by SF_PS Protection against Snooping........................................ 129
8.3.1         Listing of SFRs implemented by SF_PMA Protection against Modifying Attacks ...................... 131
8.4.1         Listing of SFRs implemented by SF_PLA Protection against Logical Attacks ............................ 132
8.5.1         Implementation of AES and TDES by the Symmetric Cryptographic Coprocessor SCP ............. 133
8.5.2         Implementation of TDES, AES and CMAC by the Symmetric Cryptographic Library SCL .......... 135
8.5.3         RSA Cryptographic Library for all versions................................................................................. 137
8.5.4         Elliptic Curves Cryptographic Library for all versions ................................................................. 139
8.5.5         Toolbox Library for all versions .................................................................................................. 140
8.5.6         CIPURSE™ Cryptographic Library ............................................................................................. 141
8.5.7         Hybrid PTRNG ........................................................................................................................... 141
8.5.8         Listing of SFRs implemented by SF_CS “Cryptographic Support” ............................................. 142




CC Document                 Please read the Important Notice and Warnings at the end of this document                                                   1.8
www.infineon.com                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



1              Security Target Introduction (ASE_INT)

1.1            Security Target and Target of Evaluation Reference
The title of this document is Confidential Security Target as given on the front page and it covers and describes
one hardware platform respectively one IC representing the Target of Evaluation (TOE) with following Common
Criteria Identifiers:
     IFX_CCI_000003h
         IFX_CCI_000005h
         IFX_CCI_000008h
         IFX_CCI_00000Ch
         IFX_CCI_000013h
         IFX_CCI_000014h
         IFX_CCI_000015h
         IFX_CCI_00001Ch
         IFX_CCI_00001Dh
         IFX_CCI_000021h
      IFX_CCI_000022h
in the design step H13 and including optional software libraries and dedicated firmware in several versions as
stated and assigned in the table below.

In order to ease the readability of this document the bunch of Common Criteria Identifiers as listed above is
shortened and simply expressed with TOE (Target of Evaluation) or IFX_CCI_000003h with options.

This document is formed according to Common Criteria CCv3.1 EAL6 augmented (EAL6+) and comprises the
Infineon Technologies AG Security Controller (Integrated Circuit IC) with the above listed Common Criteria
Identifiers and with specific IC dedicated firmware and optional software.

The target of evaluation (TOE) is described in the following.
This Public Security Target has the revision 1.8 and is dated 2020-04-22.




CC Document                                              3                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The Target of Evaluation (TOE) is the Infineon Security Controller with following optional available software
packages:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
            o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
            o All ACL libraries provide elliptic curve cryptography EC3
    the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
    the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
    the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH™ NVM to the user
    the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method
    the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
       user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
    the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).
and with further specific IC dedicated firmware in several alternative versions.

Please note that always the highest version number points to the most recent status of a library coming usually
with improvements and/or additional functionality.

Note that each of the versions of the ACL, SCL, HSL, CCL and the NRG are optional and alternatively. This means
that the TOE comes either with one of the alternative library types– depending on the user choice - or with none.
The library types can freely be combined but not two versions of the equal type. For examples ACL with SCL with
HSL with NRG is welcome but a combination of HSL in version 03.11.8339 and at the same time with HSL in
version 01.22.4346 would not work. The library types are entirely independent from each other.
The security relevant differences in the versions - if any - are detailed in chapter 8. The claims of this Security
Target take the corresponding versions into account and thus the wording in the following refers to the library
type which is cited or else the claim includes always all named versions.

The design step of this TOE is H13.

The Security Target is based on the Protection Profile PP-0084 Security IC Platform Protection Profile with
Augmentation Packages [9] as publicly available for download at https://www.bsi.bund.de and certified under
BSI-CC-PP-0084-2014.
The Security Target is built in compliance with Common Criteria v3.1 Revision 5.

The Security Target takes into account all relevant current final interpretations.

1
 Rivest-Shamir-Adleman asymmetric cryptographic algorithm
2
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
3 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                           4                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)



This TOE concept is based on the architecture, family concept and principles of the Integrity Guard implemented
in the controllers by Infineon Technologies AG deemed for high security requiring applications.

The certification body of this process is the German BSI, whereas the abbreviation stands for Federal Office for
Information Security, in German language Bundesamt für Sicherheit in der Informationstechnik.




CC Document                                             5                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                                          Table 1     Identification
                         Version           Date                            Registration
Security Target             1.8          2020-04-22                       This document
Target of Evaluation                                      The hardware controller with following identifiers:
                                                                          IFX_CCI_000003h
                                                                          IFX_CCI_000005h
                                                                          IFX_CCI_000008h
                                                                          IFX_CCI_00000Ch
                                                                          IFX_CCI_000013h
                                                                          IFX_CCI_000014h
                                                                          IFX_CCI_000015h
                                                                          IFX_CCI_00001Ch
                                                                          IFX_CCI_00001Dh
                                                                          IFX_CCI_000021h
                                                                          IFX_CCI_000022h
                                                      In the Design Step      H13
                                                           With following alternative FW-Identifiers
                                                                             v80.100.17.3
                                                                             v80.100.17.2
                                                                             v80.100.17.1
                                                                             v80.100.17.0
                                                      And following optional SW – libraries:
                                                      ACL-1 to -3 RSA2048 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 RSA4096 v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to -3 EC          v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      ACL-1 to 3 Toolbox      v2.08.007, v2.07.003, or
                                                      v2.06.003
                                                      HSL-1                   03.12.8812
                                                      HSL-2                   03.11.8339
                                                      HSL-3                   02.01.6634
                                                      HSL-4                   01.22.4346
                                                      SCL-1                   v2.04.002
                                                      SCL-2                   v2.02.010
                                                      NRG                     v02.04.3957
                                                      CIPURSE™ CL             v02.00.0004
                                                      Each of the above named libraries comes with a specific
                                                      user guidance document
                                                      Security IC Platform Protection Profile with
Protection Profile          1.0          2014-01-13
                                                      Augmentation Packages BSI-CC-PP-0084-2014



CC Document                                           6                                                     1.8
                                                                                                     2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


                             Version         Date                              Registration
                                                         Common Criteria for
                                                         Information Technology Security Evaluation
                                                         Part 1: Introduction and general model
                                3.1
                                                         CCMB-2017-04-001
Common Criteria                             2017-04
                                                         Part 2: Security functional requirements
                             Revision 5                  CCMB-2017-04-002
                                                         Part 3: Security Assurance Components
                                                         CCMB-2017-04-003
User Guidance Documentation Set
Chapter describes briefly the contents of the individual documents of the User Guidance Documentation,
while the individual documents are versioned and entitled in chapter 9 literature and references. The in this
chapter listed set of user guidance documents belongs to the TOE.

This TOE is represented by a number of various products which are all based on the equal design sources. The
TOE hardware remains entirely equal throughout all derivatives, but the usage for example in form of available
memory sizes, availability of the various interfaces, or other functions varies by means of blocking and chip
configuration. The firmware identifier on board depends on the order.
All TOE derivatives are derived from the equal hardware design results.

The TOE can be identified with the Generic Chip Identification Mode (GCIM). The IFX_CCI_000003h with options
hardware platform is identified by defined bytes of the GCIM as detailed in the HRM [1].
The unique hexadecimal values as stated in the title are:
                         IFX_CCI_000003h
                             IFX_CCI_000005h
                             IFX_CCI_000008h
                             IFX_CCI_00000Ch
                             IFX_CCI_000013h
                             IFX_CCI_000014h
                             IFX_CCI_000015h
                             IFX_CCI_00001Ch
                             IFX_CCI_00001Dh
                             IFX_CCI_000021h
                          IFX_CCI_000022h
The user can easily identify from which production line a certain IC is coming. The corresponding identifier is
given in chapter 2.2.6

These bytes clearly identify the hardware platform, or, in other words, the therein possible values for
IFX_CCI_000003h with options (without prefix IFX_CCI_) represent the equal hardware platform of this TOE. This
means that the hardware entirely equals throughout all derivatives and that the differences are achieved by
configuration and blocking means only. These values are unique for this hardware platform. This means that
these values will not be used in any other platform or product.
The interpretation of the output GCIM data is clearly explained in the user guidance, Hardware Reference Manual
HRM [1].
Although the TOE is represented by a number of various products, all based on the equal design sources, the
hardware is constituted out of few slightly different mask sets enabling to adapt to various external contactless
and contact based devices not being part of this TOE. Except this external adapt capability the TOE hardware
CC Document                                              7                                                       1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


and firmware – depending on the order option – remains entirely equal throughout all derivatives, but the usage
for example in form of available memory sizes, availability of the various interfaces, or other functions varies by
means of blocking and chip configuration. This blocking is applied by Infineon settings during the production
only. Again, all TOE derivatives are derived from the equal hardware design results, the IFX_CCI_000003h with
options.
The differences between the derivatives are achieved by blocking only and have no impact on the TOEs security
policies and related functions. Details are explained in the user guidance hardware reference manual HRM [1].
All product derivatives are identically from module design, layout and footprint, but are made different in their
possibilities to connect to different types of external antennas or to a contact based interface only. Therefore,
the TOE is represented and made out of different mask sets with following TOE internal and security irrelevant
differences:
The differences between the mask sets implement different input capacitances in the analogue part of the radio
frequency interface (RFI). This differentiation in the input capacitances enable for the connection of a wider
range of various antenna types. Note that external antennas or interfaces are not part of the TOE.
To each of the mask sets, an individual value is assigned, which is part of the data output of the Generic Chip
Identification Mode (GCIM). This number is located in the GCIM part individual length byte to clearly
differentiate between the mask sets related to the different input capacitances. Details are explained in the user
guidance hardware reference manual (HRM) and in the errata sheet.
There are no other differences between the mask sets the TOE is produced with.
The IFX_CCI_000003h with options products enable for a maximum of configuration possibilities defined by the
customer order following the market needs. For example, a TOE product can come in one project with the fully
available SOLID FLASH™ NVM1 or in another project with any other SOLID FLASH™ NVM –size below the
physical implementation size, or with a different RAM size. And more, the user has the free choice, whether he
needs the symmetric co-processor SCP, or the asymmetric co-processor Crypto2304T, or both, or none of them.
In addition, the user decides, whether the TOE comes with a free combination of software libraries or without
any. And, to be even more flexible, various interface options can be chosen as well.

To sum up the major selections, the user defines by his order:
      the firmware identifier in several alternatives
      the available memory sizes of the SOLID FLASH™ NVM and RAM
      the availability of the cryptographic coprocessors SCP and Crypto@2304T
      the availability and free combinations of the cryptographic libraries
         ACL-1, ACL-2, ACL-3, SCL-1 and SCL-2
      the availability of the CIPURSE™ Cryptographic Library
      the availability of the Flash Loader
      the availability of the alternative libraries HSL-1 or HSL-2 or HSL-3 or HSL-4
      the availability of the library NRG
      the availability of various interface options
      the possibility to tailor the product by blocking on his own premises (BPU)
      the possibility to apply the PIN letter in combination with the Flash Loader
The degree of freedom of the chip configuration is predefined by Infineon Technologies AG and made available
via the order tool.

Beside fix TOE configurations, which can be ordered as usual, this TOE implements optionally the so called
Billing-Per-Use (BPU) ability. This solution enables our customer to tailor the product on his own to the required


   1
       SOLID FLASH™ is an Infineon Trade Mark and stands for the Infineon Flash NVM. The abbreviation NVM is short for Non Volatile
                                Memory. The information remains stored even the power has been removed.


CC Document                                                        8                                                              1.8
                                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


configuration – project by project. By that BPU allows for significant reduction of logistic cost at all participating
parties and serves for acceleration of delivery of tailored product to the end-user.
BPU enables our customers to block the chip on demand into the final configuration at his own premises, without
further delivery or involving support by Infineon Technology.
The realization of it requires the presence of the Flash Loader software, enhanced with the BPU blocking
software part. The presence of the BPU ability defines the customer with his order.
The user then receives this TOE in a predefined starting configuration, for example entirely unblocked. Again,
the delivered starting configuration depends on the user order. After delivery, the user can put the TOE in
volume on his stock and can block it down to the required sizes and features, whenever a certain configuration is
required by a certain project.
Depending on the number of TOE products delivered, and their individual final blocked configuration, the
customer receives a balancing payment. By that our customers are charged only for the true configurations
required in their projects.
As written above, the software realizing the user allowed blocking, is implemented and delivered in the TOE –
depending on the order - and is part of the evaluation and certificate. This software is an additional part of the
Flash Loader software but also the other firmware – in all alternative versions - has seen a small enhancement to
enable for BPU.
If BPU is available, the blocking is done by the user at user premises, usually by taking an enhancement of the
user own personalization flow and applying the according APDUs. These APDUs are predefined by Infineon
Technologies and can also depend on the customer order. Only these APDUs can block the chip according to the
user demands.
Infineon Technologies AG provides special software, running in parallel when doing the blocking. This software
summarizes all devices and final configurations allowing for the later commercial balancing. The balancing
depends on the number of chips and their individual final blockings the user has made over a defined time span.
This special software can be used only for the commercial balancing, is not present on the TOE, not security
relevant and therefore not part of this certificate.
All blockings are done by setting the according value in the chip configuration page, where certain parts are left
available to the blocking software. Strong means of authentication are in place. The blocking software
respectively BPU software is an additional part of the Flash Loader software and the only piece of software, able
to manage the blocking APDUs. Therefore, the presence of the Flash Loader software is essential for the BPU
ability.
The user can only apply a predefined and checksum protected set of allowed APDU configuration commands
provided by Infineon Technologies AG. For this, the Flash Loader BPU software part, together with the firmware
– regardless of the version used -, executes one of those APDUs. After the final blocking is done and the user
additionally may have downloaded his software, the entire Flash Loader including the BPU software part is
permanently deactivated. This is called locking of the Flash Loader.
Of course, exclusively all security relevant settings are contained in the IFX-only part. The Flash Loader BPU
software does not access and has no access to the IFX-only part.
Once the user blocking by applying the APDU has been finalized, the configuration page is no more accessible
for changes. After the locking of the Flash Loader, the product is permanently fixed regarding its configurations
and software. A reactivation of the Flash Loader is not possible. At the next start-up, the Boot-Up-Software
(BOS) applies the made settings, and, if called, a Resource Management System (RMS)-function can output the
finally made chip configuration for verification and information purposes.
The entire configuration storage area is protected against manipulation, perturbation and false access. Note that
the IFX-only part of the configuration page is already access protected prior delivery to the user and the TOE
leaves the Infineon Technology premises only locked into User Mode.
The BPU software part is only active on the products which have been ordered with the BPU option. In all other
cases this software is disabled on the product. If a product is ordered without Flash Loader, also the Flash Loader
software is disabled and the BPU configuration changes are blocked in the IFX-configuration, which renders BPU
functionality unusable. Therefore, the BPU feature is only possible if the Flash Loader is active.


CC Document                                               9                                                        1.8
                                                                                                            2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


If the user decides to use the Flash Loader, regardless whether it is ordered with or without BPU, an additional
process option can be ordered which results in an additional status of the Flash Loader. This process is called PIN-
Letter and enables for simplified logistics and thereby for faster delivery of the ordered TOE products to the user.
The PIN-Letter feature enabling for the PIN-Letter process is an implemented part of the Flash Loader. The
resulting logistical acceleration is possible since the PIN-Letter enables for delivery of not user-specific
configured, not flashed and not personalized TOE products to the user warehouse.
Extra authentication means applied in the PIN-Letter status of the Flash Loader preserve that only the intended
user with the intended PIN-Letter can configure with user specific information and enable the normal Flash
Loader functions in a second step. By that the user orders the products and receives - in a protected way - the
belonging PIN-Letter. PIN-Letter and delivered chips must match.
By delivery the user warehouse gets filled and depending on market demands the user can immediate apply the
authentication means of the PIN-letter. If passing, the TOE products become user specific configured and the
Flash Loader can be used for this specific user in a second step.
The following table outlines the different ways how the user can input his software on this TOE – a TOE without
user available ROM. User software comprises usually the operating system and applications, which are for
Infineon Technologies simply a user data package which is handled as a fixed data package during production.
This provides high process flexibility for the user of which an overview is given in the following table:


                         Table 2        Options to implement user software on the chip
 Case                          Option                                          Flash Loader Status
         The user or/and a subcontractor downloads the
         software into the SOLID FLASH™ NVM on his             The Flash Loader can be activated or reactivated
 1.      own. Infineon Technologies has not received user      by the user or subcontractor to download his
         software and there are no user data of the            software in the SOLID FLASH™ NVM.
         Composite TOE in the ROM.
         The user provides his complete software for the
         download into the SOLID FLASH™ NVM to
                                                               The Flash Loader is permanently disabled prior
 2       Infineon Technologies AG. The software is
                                                               delivery.
         downloaded to the SOLID FLASH™ NVM during
         chip production.
                                                               When leaving the Infineon Technologies
                                                               production facility, the Flash Loader is blocked,
         The user provides software for the download into      but can be activated or reactivated by the user or
         the SOLID FLASH™ NVM to Infineon                      subcontractor to complete the previously stored
 3       Technologies AG. The software is downloaded to        software parts in the SOLID FLASH™ NVM.
         the SOLID FLASH™ NVM during chip
         production.                                           Precondition is that the user has provided an own
                                                               reactivation procedure in software prior chip
                                                               production to Infineon Technologies AG.

For the cases with active Flash Loader on board and whenever the user has finalized his SW-download,
respectively the TOE is in the final state and about to be delivered to the end-user, the user is obligated to lock
the Flash Loader. This locking is the final step and results in a permanent deactivation of the Flash Loader. This
means that once being in the locked status, the Flash Loader cannot be reactivated anymore.
Note that whenever a TOE comes without active Flash Loader, BPU and PIN-Letter process are not possible.
All in all various delivery combinations are given and for example, a product can come with a fix configuration
and with Flash Loader, to enable the user to download software, but without BPU option and with PIN-Letter.
The following cases can occur:

                         Table 3        Options with Flash Loader, BPU and PIN-Letter
CC Document                                              10                                                       1.8
                                                                                                           2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


 Case           Order                                              Option
   1     Fix configuration,            Infineon Technologies configures and flashes all software as ordered.
         Flash Loader is               The entire user software must be delivered to Infineon Technologies
         locked (permanent)             prior production.
   2     Flash Loader                  Infineon configures the chip as ordered and
         functional, BPU               the user flashes his software at his own premises.
         feature blocked               If requested, Infineon Technologies can optionally download also
                                        shares of the user software during production. These user software
                                        shares must be delivered to Infineon Technologies prior production.
                                        The user can finalize his software package at his premises.
   3     Flash Loader           The user:
         functional                 Activates the Flash Loader,
         and active BPU             configures the chip applying the BPU feature and
         feature
                                    flashes his software at his own premises.
                                    If requested, Infineon Technologies can optionally download also
                                       shares of the user software during production. These user software
                                       shares must be delivered to Infineon Technologies prior production.
                                       The user can finalize his software package at his premises.
   4     Flash Loader           Infineon configures the chip as ordered. The user receives his PIN-letter and
         functional             fills his warehouse. As required the user:
         and PIN-Letter                applies the PIN-Letter on the chips taken from his warehouse, gets the
                                          chips user specific configured,
                                       activates the Flash Loader and
                                       the user flashes his software at his own premises.
                                If requested, Infineon Technologies can optionally download also shares of the
                                user software during production. These user software shares must be delivered
                                to Infineon Technologies prior production. The user can finalize his software
                                package at his premises.
   5     Flash Loader           Infineon configures the chip as ordered. The user receives his PIN-letter and
         functional,            fills his warehouse. As required the user:
         active BPU and                applies the PIN-Letter on the chips taken from his warehouse, gets the
         PIN-Letter                       chips user specific configured,
                                       activates the Flash Loader,
                                       applies his user specific chip configuration with the BPU feature and
                                       flashes his software at his own premises.
                                If requested, Infineon Technologies can optionally download also shares of the
                                user software during production. These user software shares must be delivered
                                to Infineon Technologies prior production. The user can finalize his software
                                package at his premises.

The listing provided in the confidential security target [8] contains the memory size ranges and other blocking
options, focusing on the maximum respectively minimum user available limitations. Within those limitations the
TOE configurations can vary under only one identical IC-hardware, regardless whether the configurations are set
by Infineon or within further limitations by the user. All configurations throughout all different mask sets the
TOE is made off and all thereof resulting derivatives have no impact on security and are covered by the
certificate.

CC Document                                            11                                                     1.8
                                                                                                       2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


Note that this TOE has no user available ROM. The user software and data are entirely located in a dedicated and
protected part of the SOLID FLASH™ NVM. The long life storage endurance together with the means for error
detection and correction serves for excellent reliability and endurance.
In addition to the above listed flexible ranges, the user guidance contains a number of predefined configurations
for those customers not making use of the BPU option. All of these configurations belong to the TOE as well and
are of course made of the equal hardware and are inside the above declared ranges.
Today’s predefined configurations of the TOE are listed in the hardware reference manual HRM [1] and is
completed with the list of identification data of the derivatives. These predefined products come with the most
requested configurations and enables to produce volumes on stock in order to simplify logistic processes.
According to the BPU option, a non-limited number of configurations of the TOE may occur in the field. The
number of various configurations depends on the user and order contract only.
This TOE provides dedicated identification means and outputs the platform identifier, the design step and
further configuration information. The hardware reference manual HRM [1] is part of the user guidance and
enables for the clear interpretation of the read out identification data. More information is given in the
confidential Security Target [8].
These output data enable the user for clear identification of the TOE and also of one of the different mask sets
and therewith for examination of the validity of the certificate.
In addition, a dedicated RMS function allows reading out the present configuration in detail. The output RMS
data together with the hardware reference manual HRM [1] enables for clear identification of a product and its
configuration. All these steps for gathering identification and detailed configuration information can be done by
the user without involving the vendor, Infineon Technologies AG.

The TOE consists of the hardware part, the firmware parts in the alternative versions and the optional software
parts. The Smartcard Embedded Software, i.e. the operating system and applications are not part of the TOE.

The firmware comes with several alternative versions and consists of:
    the Boot Software (BOS) firmware conducting configuration and testing task (see chapter 2.2.2) at start-
        up of the TOE
    the Resource Management System (RMS) library providing essential basis functions for the management
        of the RAM, the branch table, the Memory Management Unit (MMU) and other resources
    the optional Flash Loader enabling for the download of user software to the SOLID FLASH™ NVM and
        required for the optional Bill per Use (BPU) feature and the PIN-letter feature
    the Radio Frequency Application Interface (RFAPI) supporting functions located in the ROM.
        The RFAPI functions are not part of the TOE Security Functionality (TSF)
    the NRG ROM part implementing some basic routines and used by the NRG if ordered.
        The NRG ROM part is not part of the TSF functionality.

The firmware parts BOS, RFAPI and NRG are implemented in a separated Test-ROM also being part of the TOE
but not available for the user. Completing firmware components are located in the SOLID FLASH™ NVM.

The optional software parts are differentiated into following libraries:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
           o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI1.



1
    Rivest-Shamir-Adleman asymmetric cryptographic algorithm


CC Document                                                    12                                                1.8
                                                                                                          2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


             o All ACL libraries provide elliptic curve cryptography EC2
        the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
         functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
         Security Functionality (TSF).
        the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
         version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
        the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
         interface and utilizes the full services of the SOLID FLASH™ NVM to the user
        the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
         a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
         use of an additional advanced reading respectively writing method
        the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
         user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
        the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).

The RSA, EC and Toolbox libraries provide certain functionality via an API to the Smartcard Embedded Software.
The private parts of the cryptographic libraries are only used internally and have no user interface. If neither the
RSA- nor the EC library is delivered, also the belonging private parts are not on board. The Toolbox library does
not have private library parts.
Each of the libraries ACL, SCL, HSL and NRG is independent from the other libraries and also independent of the
alternative library version of the equal type. This means for example that the HSL-1 runs alone and does not need
parts of HSL-2.
A combination respectively mix up of the two alternative libraries of equal type has not been considered in the
design and is not allowed: The user can select either one or the other of the same library type or none of it.
If the user considers the optional software libraries, the TOE can be delivered including – in free combinations –
or not including any of the optional libraries.

If the user decides not.
This TOE is intended to be used in any application and device requiring the highest level of security, for example
as secure element in various devices with various form factors.
This member of the high security controller family features a security philosophy focusing on data integrity
instead of numerous sensors. By that two main principles combined in close synergy are utilized in the security
concept called the Integrity Guard. These main principles are the comprehensive error detection, including the
double CPU, and the full encrypted data path, leaving no plain data on the chip. These principles proved that
they provide excellent protection against invasive and non-invasive attacks known today.
The intelligent shielding algorithm finishes the upper layers, finally providing the so called intelligent implicit
active shielding I2-shield. This provides physical protection against probing and forcing.
This TOE provides multiple contact based and contactless interface options for various applications and markets.
Due to the interface flexibility the product can be used in almost any application, within any device and almost
any form factor. Due to these multiple communication possibilities, the TOE can be seen as a stand-alone
security device being capable to maintain the various communication interfaces simultaneously. Therefore this
TOE is able to run multiple applications, using multiple interfaces independently at the same time.
Again these multiple communication and application independency capabilities enable the usage to almost
everywhere, where highly secure applications are in use and of course in any other application as well. This TOE
is deemed for governmental, corporate, transport and payment markets, or wherever a secure root of trust is
required. Various types of applications can use this TOE, for example in closed loop logical access controls,
physical access controls, secure internet access control and internet authentication, or as multi-application token
or simply as encrypted storage.
This dual interface controller is able to communicate using either the contact based or the contactless interface.
The implemented dual interface provides a maximum flexibility in using following communication protocols
respectively methods:

Contactless Interfaces Options:
    ISO 14443 Type A and Type B
       These are ISO defined proximity contactless protocols using an external antenna and the TOE
       implemented analogue and digital radio frequency interface.
    Advance Framing Mode (AFM)
       This feature implements a frame format with means of error detection and correction applicable for ISO
       14443 Type A and Type B according to the standard ISO/IEC 14443-4AMX
    ISO/IEC 18092
       This is an ISO defined proximity contactless protocol using an external antenna and the TOE
       implemented analogue and digital radio frequency interface.
    NRG Interface
       This is implemented by the options NRG providing a proprietary proximity contactless protocol using an
       external antenna and the TOE implemented analogue and digital radio frequency interface, as well as
       the memory part reserved for NRG use. This interface comprises also the ability to implement the
       Advanced Mode for NRG SAM communication.
    And further advanced high-speed communication modes. More information is given in the confidential
       Security Target [8].

Contact based Interface Options:

CC Document                                             15                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


      ISO 7816
       This is the ISO defined standard contact based communication protocol, using the UART and the pads.
      Analogue Contactless Bridge mode (ACLB)
       The ACLB mode provides the possibility to leave the analogue communication to the external device.
       More information is given in the confidential Secut to use any of the offered asymmetric cryptographic libraries, regardless of the version
chosen, none of the cryptographic libraries is consequently delivered and the accompanying Additional Specific
Security Functionality (O.Add-Functions) Rivest-Shamir-Adleman (RSA) and/ or EC is/are not provided by the
TOE. Erity Target [8].
      Inter Integrated Circuit Interface (I2C)
       The Inter-Integrated Circuit (IIC) module is able to be connected to an external multi-master-serial-bus-
       system. The IIC protocol software is not part of the TOE. More information is given in the confidential
       Security Target [8].
      General Purpose Input/Output (GPIO)
       The GPIO module supports a number of general purpose I/O signals in parallel and independent of each
       other. Each of the I/O signals can be configured. More information is given in the confidential Security
       Target [8].

Further interface operational modes in contact based and contactless communication are available and outlined
in the confidential Security Target [8].

The TOE provides a real 16-bit CPU-architecture and is compatible to the MCS®251 instruction set with an
execution time faster than a standard MCS®251 microcontroller at the same clock frequency. The major
components of the core system are the two CPUs (Central Processing Units), acting as one, the MMU (Memory
Management Unit) and the MED (Memory Encryption/Decryption Unit). The Core implements also the Post
Failure Detection (PFD) covering CPU, Cache and MED. The two CPUs control each other in order to detect faults
and serve by this for data integrity. The TOE implements a full 16 MByte linear addressable memory space for
each privilege level, a simple scalable Memory Management concept and a scalable stack size. The flexible
memory concept consists of a ROM, RAM and the non-volatile memory (NVM), which we call SOLID FLASH™
NVM. The ROM is not available for the user.
The ROM is not available for the user and contains the main parts of firmware components only.

The firmware comes in several alternative versions and is composed out of the:
    Boot-up software (BOS), the Resource Management System (RMS), the Flash Loader (FL), the NRG code
        part located in the ROM and the RFI supporting functions. The BOS applies the essential configuration,
        internal testing and the start-up.
        The NRG ROM part and the RFI supporting functions are not part of the TOE Security Functionality
        (TSF).
    The RMS implements a low level application interface (API) to the Smartcard Embedded Software and
        provides handling and managing routines for RAM, MMU, Branch table, configuration and further
        functions.
    The Flash Loader allows downloading user software to the SOLID FLASH™ NVM during the
        manufacturing process and also at user premises – if ordered.
    The Radio Frequency Interface Application Interface (RFAPI) functions consist of executable code in the
        ROM which is part of the TOE and a SOLID FLASH™ NVM code part which is delivered separately to the
        user and which is not part of the TOE. The RFAPI is not part of the TOE Security Functionality (TSF).
    The NRG software part located in the ROM. These routines are only called if the NRG library is executed;
        else these routines are not used. The NRG is not part of the TOE Security Functionality (TSF).

With regard to the RFAPI part, this means that the TOE products are delivered without the code part located in
the SOLID FLASH™ NVM. This RFAPI part is a piece of software delivered separated from the chip in order to be
implemented by the user together with his software. Only the RFAPI SOLID FLASH™ NVM code part can call the
RFAPI ROM functions and optimize the contactless communication. Therefore, the RFAPI ROM functions do not
implement a user interface. In general the RFAPI implements a fast TOE startup and simplifies the user settings
CC Document                                            16                                                      1.8
                                                                                                        2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


for optimized contactless communication. The ROM and SOLID FLASH™ NVM areas storing the RFAPI functions
are access protected and only the SOLID FLASH™ NVM part, which is not part of the TOE, implements the user
interface. The RFAPI is not part of the TOE Security Functionality (TSF).

This TOE implements a Hybrid Random Number Generator (HRNG). This HRNG equals to the expression Hybrid
Physical True Random Number Generator (hybrid PTRNG) as defined by the BSI. In the following, the BSI
expression hybrid PTRNG is used. The hybrid PTRNG implements a true physical random source and has
evidenced its conformance to the classes of AIS31 [13] as declared in chapter 7.1.1.1.
The produced genuine random numbers are available as a security service for the user and are also used for
internal purposes. Together with the guidelines in [6] the hybrid PTRNG operates in the following modes of
operation and is conformant to the named classes:
     True Random Number Generation, meeting AIS31 PTG.2
     Hybrid Random Number Generation, meeting AIS31 PTG.3
     Deterministic Random Number Generation (DRNG) AIS31 DRG.3
     Key Stream Generation (KSG), stream cipher generation AIS31 DRG.2
The hybrid PTRNG is deemed for any application requiring excellent physical random data entropy.

The two cryptographic coprocessors serve the need of modern cryptography:
    The symmetric co-processor (SCP) combines both AES and DES with one, two or triple-key hardware
       acceleration. Please note that the single DES algorithm is not in the scope of evaluation due to national
       regulation by BSI.
    And, the Asymmetric Crypto Co-processor, called Crypto@2304T, provides optimized high performance
       calculations for the user software executing cryptographic operations and is also used by the optional
       cryptographic libraries for Rivest-Shamir-Adleman (RSA) and Elliptic Curve (EC) cryptography.

The optional software parts are differentiated into following libraries:
    The asymmetric cryptographic libraries (ACL) in following alternative versions:
       v2.08.007, v2.07.003 and v2.06.003.
           o All ACL libraries provide RSA1 2048/4096 cryptography.
                The library supports also smaller key lengths, but the certification follows the national regulation
                by the BSI2.
           o All ACL libraries provide elliptic curve cryptography EC3
    the Toolbox library in the versions v2.08.007, v2.07.003 and v2.06.003 provides basic mathematical
       functions for a simplified user interface to the Crypto@2304T. The Toolbox library is not part of the TOE
       Security Functionality (TSF).
    the symmetric cryptographic libraries (SCL) in the improved and enhanced version v2.04.002 and the
       version v2.02.010 provide simplified interfaces and utilize the full services of the SCP to the user
    the hardware support library (HSL) in the versions 01.22.4346 and 02.01.6634 provides a simplified
       interface and utilizes the full services of the SOLID FLASH™ NVM to the user
    the hardware support library (HSL) in the versions 03.11.8339 and 03.12.8812 provide equal to the above
       a simplified interface, utilizes the full services of the SOLID FLASH™ NVM to the user, and enables the
       use of an additional advanced reading respectively writing method

1
 Rivest-Shamir-Adleman asymmetric cryptographic algorithm
2
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
3 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                          17                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


       the CIPURSE™ Cryptographic Library (CIPURSE™ CL and CCL) in the version v02.00.0004 provides the
        user OSPT alliance CIPURSE™ V2 conformant communication functionality between a PICC and a PCD
       the NRG Software. The NRG is not part of the TOE Security Functionality (TSF).

The RSA cryptographic library, regardless of the version chosen:
     provides a high level interface to the hardware component Crypto2304T and includes countermeasures
        against fault injection and side channel attacks.
     implements the generation of RSA Key Pairs (RsaKeyGen), the RSA signature verification (RsaVerify),
        the RSA signature generation (RsaSign) and the RSA modulus recalculation (RsaModulus). This RSA
        library can perform RSA operations from 512 to 4096 bits.
     implements the high level interface to hardware cryptographic coprocessor Crypto2304T which runs the
        basic long number calculations (add, subtract, multiply, square) with high performance.
The RSA library is delivered as object code and in this way integrated in the user software.
Following the national BSI recommendations, RSA key lengths below 1976 bits are not included in the certificate.
Please note that the BSI expects this key length as appropriate until 2022 and recommends for longer usage
times key lengths of 3000 bits or higher.

The EC library, regardless of the version chosen:
     provides a high level interface to Elliptic Curve Cryptography computed on the hardware component
        Crypto2304T and includes countermeasures against fault injection and side channel attacks.
     implements routines for ECDSA signature generation, for ECDSA signature verification, ECDSA key
        generation and for the Elliptic Curve Diffie-Hellman key agreement.
     In addition, the EC library provides an additional function for calculating primitive elliptic curve
        operations like ECC Add and ECC Double.
     EC curves over prime field Fp, as well as over GF(2n) finite field are supported too.
The EC library is delivered as object code and in this way integrated in the user software.
The security functional requirement covers the standard Brainpool [19] and NIST [26] Elliptic Curves with key
lengths of 160, 163, 192, 224, 233, 256, 283, 320, 384, 409, 512 or 521 bits.
The definition of the key lengths follows the national AIS32 regulation regarding the 100 bit security level by the
BSI.
Numerous other curve types, being also secure in terms of side channel attacks on this TOE, exist, which the user
optionally can add in the composition certification process.

If the user decides not to use any of the offered cryptographic library(s), regardless of the version, none of the
cryptographic libraries is consequently delivered and the accompanying Additional Specific Security
Functionality (O.Add-Functions) Rivest-Shamir-Adleman (RSA) and/ or EC is/are not provided by the TOE. Else it
depends of the chosen library whether the Additional Specific Security Functionality (O.Add-Functions) Rivest-
Shamir-Adleman (RSA) and/ or EC is/are supported.

The Toolbox library, regardless of the version chosen, does not provide cryptographic support or additional
security functionality as it provides only the following basic long integer arithmetic and modular functions in
software, supported by the cryptographic coprocessor: Addition, subtraction, division, multiplication,
comparison, reduction, modular addition, modular subtraction, modular multiplication, modular inversion and
modular exponentiation. No security relevant policy, mechanism or function is supported. The Toolbox library is
deemed for software developers as support for simplified implementation of long integer and modular
arithmetic operations. The Toolbox library is not part of the TOE Security Functionality (TSF).

The symmetric cryptographic library SCL offers a high level interface to perform the cryptographic operations
DES, TDES and AES with different key lengths on the symmetric cryptographic coprocessor (SCP) for this TOE.

CC Document                                             18                                                      1.8
                                                                                                         2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


In addition, the SCL implements MAC computation of a CMAC, using AES and 3DES algorithms, respectively a
RetailMAC using the DES algorithm.
The SCL implements already several block cipher modes as declared in this document and covers a wide range of
applications, but the SCL offers in addition the flexibility to implement additional user defined block cipher
modes.
Both library versions provide a simplified interface to the hardware Symmetric Cryptographic Coprocessor (SCP)
and preserve the security and performance requirements as required by the user.
Even in the basic configuration the SCL meets the tarlse it depends of the chosen library whether the Additional Specific Security Functionality
(O.Add-Functions) Rivest-Shamir-Adleman (RSA) and/ or EC is/are supported.

The Toolbox library, regardless of the version chosen, provides the user optionally basic arithmetic and modular
arithmetic operations, in order to support user software development using long integer operations. These basic
arithmetic operations do not provide security functionality, implement no security mechanism, and do not
proved additional specific security functionality – as defined for the cryptographic libraries.
The user developed software using the Toolbox basic operations is not part of the TOE.
The Toolbox library is not part of the TOE Security Functionality (TSF).

The symmetric cryptographic library SCL – in both versions – offers a high level interface to perform the
cryptographic operations DES, TDES and AES with different key lengths on the symmetric cryptographic
coprocessor (SCP) for this TOE. In addition, the SCL in version v2.04.002 implements computation of a CMAC
using AES and 3DES algorithms.

1
 BSI – Bundesamt für Sicherheit in der Informationstechnik – Federal Office for Information Security: Following the national BSI
    recommendations, RSA key lengths below 1976 bits are not included in the certificate. Please note that the BSI expects this key length
    as appropriate until 2022 and recommends for longer usage times key lengths of 3000 bits or higher.
2 The Elliptic Curve Cryptography is abbreviated with EC only in the further, in order to avoid conflicts with the abbreviation for the Error
    Correction Code ECC.


CC Document                                                          13                                                                 1.8
                                                                                                                                 2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


The SCL implements already several bgeted security level, which can be further increased by
simple means of configuration options.
The key lengths used for the AES and DES functionality follow the national AIS32 regulation regarding the 100
bit security level issued by the BSI1. This regulation excludes the single DES operation from the certification as it
is considered to be not sufficiently secure from algorithm perspective.
For both versions, the certification covers the SCL cryptographic functionality of the AES algorithm with key
lengths of 128, 192, 256 bits and the TDEA or TripleDES (TDES) algorithm with an effective key size of 112 and
168 bits. For the version v2.04.002 the certification covers the CMAC functionality too.

Note that this TOE can come with both cryptographic co-processors accessible, or with a blocked SCP or with a
blocked Crypto2304T, or with both cryptographic co-processors blocked. The blocking depends on the user’s
choice. No accessibility of the deselected cryptographic co-processors is without impact on any other security
policy of the TOE; it is exactly equivalent to the situation where the user decides just not to use the cryptographic
co-processors.

Beside the inclusion and support of cryptographic libraries this TOE comes with the optional Hardware Support
Library (HSL) in different alternative versions, significantly simplifying the management of the SOLID FLASH™
NVM functionality. The HSL constitutes an application interface (API) accessing the HSL state machine and
abstracting low level properties like special function registers and settings of specific hardware features. In short
the HSL provides a user friendly also use case oriented interface considering endurance, reliability and
performance. In certain configurations the HSL provides also functions implementing tearing safe behaviour of
the SOLID FLASH™ NVM. If used the user has no need to care about cases where the TOE is suddenly cut off the
power supply even during managing the SOLID FLASH™ NVM.
Anyhow, the HSL remains as an optional library as even sudden power off situations does never lead to
exploitable conditions of the TOE. In the worse the TOE ends operation in case of a faulty programmed SOLID
FLASH™ NVM location due to the Integrity Guard.
In addition to the above, the HSL in version 03.12.8812 and 03.11.8339 provide an advanced additional method
called Incremental Write (IWR). This method provides enhanced endurance of the SOLID FLASH NVM even
beyond the erase endurance limits for often written objects. Thus this method serves applications with a demand
for high endurance and fast writing times. On the other hand, the read times using this method are slower than
the other methods provided.

The order option CIPURSE™ Cryptographic Library (CIPURSE™ CL) provides cryptographic functionality to
implement a CIPURSE™ V2 conformant protocol.
This protocol provides a secure mutual authentication of two entities, namely the terminal (denoted as PCD =
Proximity Coupling Device (CIPURSE™-compliant terminal)) and a smart card or a token in other form factors
which is called PICC. PICC stands for Proximity Integrated Circuit Card (CIPURSE™-compliant card).
Beside the mutual authentication, the protocol implements measures to maintain the integrity of the transferred
data and preserves in parallel the confidentiality of the transferred data.
By that the CIPURSE™ CL supports the user to implement systems conformant to the CIPURSE™ open standard
implementing a secured, interoperable and flexible transit fare collection solution, including ISO 7816, ISO/IEC
14443-4 communication and AES-128 bit cryptography for multiple payment types.

           1
               German: Bundesamt für Sicherheit in der Informationstechnik, English: Federal Office for Information Security


CC Document                                                        19                                                                 1.8
                                                                                                                               2020-04-22
Public Security Target
Common Criteria v3.1 - EAL6 augmented / EAL6+
Security Target Introduction (ASE_INT)


By that the CIPURSE™ CL supports the user to implement systems conformant to the CIPURSE™ open standard
implementing a secured, interoperable and flexible transit fare collection solution, including ISO 7816, ISO/IEC
14443-4 communication and AES-128 bit cryptography for multiple payment types.
The order option of the CIPURSE™ CL is conformant to the CIPURSE™ open standard [18] for both, the PICC and
then PCD software parts. It implements the by the OSPT alliance standardized application interface for the card
and the terminal side.
The scope of this certification of this TOE covers all parts of the CIPURSE™ CL which are later implemented by
the user on the user card respectively token based on this TOE and the functionality of the PCD software part
which is implemented in the terminal side. The PCD software operates also on the hardware of this TOE which is
implemented in the terminal.
The CIPURSE™ CL implements the by the OSPT alliance standardized application interface for the card and the
terminal side.

The NRG Software is a further order option and implements the routines for a NRG interface. The NRG
implements an operating system handling the emulation of an NRG card together with the RF interface. One
part of the NRG is permanently stored in the ROM and the second part consisting of patch and API is located in
the SOLID FLASH™ NVM. The second part is only present if the NRG is part of the delivery. If the NRG is not part
of the delivery the ROM part is present but not used. The NRG implements tearing safe behaviour in context with
the SOLID FLASH™ NVM management and is therefore independent from the HSL. The NRG is not part of the
TOE Security Functionality (TSF).

To fulfill the highest security requirements for smartcards today and also in the future, this TOE implements a
progressive digital security concept, which already has been certified in various forerunner processes. This TOE
utilizes digital security features to include customer friendly security, combined with a robust design overcoming
the disadvantages on analogue protection technologies. The TOE provides full on-chip encryption covering the
complete core, busses, memories and cryptographic co-processors leaving no plain data on the chip. A further
security feature has been implemented for this TOE protecting also the involved addresses transferred over the
memory bus. Therefore the attractiveness for attackers is a step further extremely reduced as encrypted signals
are of no use for the attacker – neither for manipulation nor for eavesdropping.
In addition, the TOE is equipped with a comprehensive error detection capability for the complete data path. The
dual CPU approach allows error detection even while processing. A comparator detects whether a calculation
was performed without errors. This approach does not leave any parts of the core circuitry unprotected. The
concept allows that the relevant attack scenarios are detected, whereas other conditions that would not lead to
an error would mainly be ignored. That renders the TOE robust against environmental influences.
Furthermore, the TOE implements what we call intelligent implicit shielding (I2). These measures constitute a
shield on sensitive and security critical signals which is not recognizable or obvious as a shield. This provides
excellent protection against invasive physical attacks, such as probing, forcing or similar.
In this Security Target the TOE is briefly described and a summary specification is given. The security
environment of the TOE durlock cipher modes as declared in this document and covering a wide range
of applications, the SCL offers in addition the flexibility to implement additional block cipher modes defined by
the user.
This library provides a simplified interface to the hardware Symmetric Cryptographic Coprocessor (SCP) and
preserves the security and performance requirements as required by the user.
Note that the definition of the key lengths follows the national AIS32 regulation regarding the 100 bit security
level by the BSI. This excludes the single DES operation from the certification.

Beside the inclusion and support of cryptographic libraries this TOE comes with the optional Hardware Support
Library (HSL) in different versions significantly simplifying the management of the SOLID FLASH™ NVM
functionality. The HSL constitutes an application interface (API) accessing the HSL state machine and
abstracting low level properties like special function registers and settings of specific hardware features. In short
the HSL provides a user friendly also useing its different phases of the lifecycle is defined. The assets are identified which
have to be protected through the security policy. The threats against these assets are described. The security
objectives and the security policy are defined, as well as the security requirements. These security requirements
are built out of the security functional requirements as part of the security policy and the security assurance
requirements. These are the formal steps applied during the evaluation and certification showing that the TOE
meets the targeted requirements. In additi case oriented interface considering endurance, reliability and
performance requirements.
In certain configurations each of the HSL versions provide also functions implementing tearing safe behavon, simplified functionality of the TOE matching the requirements is
described.

The assets, threats, security objectives and the security functional requirements are defiiour of
the SOLID FLASHned i facturer may
                                                                                     implement IC Security IC Embedded Software delivered
                                                                                     by the Security IC Embedded Software Developer
                                                                                     before TOE delivery (e.g. if the IC Security IC Embedded
                                                                                     Software is implemented in ROM or is stored in the
                                                                                     non-volatile memory as service provided by the IC
                                                                                     Manufacturer or IC Packaging Manufacturer).
                                    Composite Product                                The Composite Product Manufacturer has the following
                                    Manufacturer                                     roles (i) the Security IC Embedded Software Developer
                                                                                     (Phase 1), (ii) the Composite Product Integrator (Phase
                                                                                     5) and (iii) the Personalizer (Phase 6). If the TOE is
                                                                                     delivered after Phase 3 in form of wafers or sawn
                                                                                     wafers (dice) he has the role of the IC Packaging
                                                                                     Manufacturer (Phase 4) in addition. The customer of the
                                                                                     TOE Manufacturer who receives the TOE during TOE
                                                                                     Delivery. The Composite Product Manufacturer includes
                                                                                     the Security IC Embedded Software developer and all
                                                                                     roles after TOE Delivery up to Phase 6 (refer to Figure 2
                                                                                     on page 10 and Section 7.1.1).
                                    End-consumer                                     User of the Composite Product in Phase 7.
                                    IC Dedicated Software                            IC proprietary software embedded in a Security IC
                                                                                     (also known as IC firmware) and developed by the IC
                                                                                     Developer. Such software is required for testing purpose
                                                                                     (IC Dedicated Test Software) but may provide additional
Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       27 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                                                                                                                                Security Target Lite



                                                                                    services to facilitate usage of the hardware and/or
                                                                                    to provide additional services (IC Dedicated Support
                                                                                    Software).
                                    IC Dedicated Test Software That part of the IC Dedicated Software (refer to above)
                                                               which is used to test the TOE before TOE Delivery but
                                                               which does not provide any functionality thereafter.
                                    IC Dedicated Support                            That part of the IC Dedicated Software (refer to above)
                                    Software                                        which provides functions after TOE Delivery. The usage
                                                                                    of parts of the IC Dedicated Software might be restricted
                                                                                    to certain phases.
                                    Initialization Data                             Initialization Data defined by the TOE Manufacturer to
                                                                                    identify the TOE and to keep track of the Security IC’s
                                                                                    production and further life-cycle phases are considered
                                                                                    as belonging to the TSF data. These data are for
                                                                                    instance used for traceability and for TOE identification
                                                                                    (identification data).
                                    Integrated Circuit (IC)                         Electronic component(s) designed to perform processing
                                                                                    and/or memory functions.
                                    Memory                                          The memory comprises of the RAM, ROM and the Flash
                                                                                    of the TOE.
                                    Memory Management Unit                          The MMU maps the virtual addresses used by the CPU
                                                                                    into the physical addresses of RAM, ROM and Flash.
                                                                                    This mapping is done based on memory partitioning.
                                                                                    Memory partitioning is fixed.
                                    Pre-personalization Data                        Any data supplied by the Card Manufacturer that is
                                                                                    injected into the non-volatile memory by the Integrated
                                                                                    Circuits manufacturer (Phase 3). These data are for
                                                                                    instance used for traceability and/or to secure shipment
                                                                                    between phases.
                                    Security IC                                     (as used in this Protection Profile) Composition of the
                                                                                    TOE, the Security IC Embedded Software, user data of
                                                                                    the Composite TOE and the package (the Security IC
                                                                                    carrier).
                                    Security IC Embedded                            Software embedded in a Security IC and normally not
                                    Software                                        being developed by the IC Designer. The Security
                                                                                    IC Embedded Software is designed in Phase 1 and
                                                                                    embedded into the Security IC in Phase 3 or in later
                                                                                    phases of the Security IC product life-cycle. Some part
                                                                                    of that software may actually implement a Security
                                                                                    IC application others may provide standard services.
                                                                                    Nevertheless, this distinction doesn’t matter here
                                                                                    so that the Security IC Embedded Software can be
                                                                                    considered as being application dependent whereas the
                                                                                    IC Dedicated Software is definitely not.
                                    Security IC Product                             Composite product which includes the Security
                                                                                    Integrated Circuit (i.e. the TOE) and the Security IC
                                                                                    Embedded Software and is evaluated as composite

Crypto Library Cobalt on N7021 VA                  All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                        Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                      28 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



                                                                                     target of evaluation in the sense of the Supporting
                                                                                     Document
                                    Secured Environment                              Operational environment maintains the confidentiality
                                                                                     and integrity of the TOE as addressed by OE.Process-
                                                                                     Sec-IC and the confidentiality and integrity of the IC
                                                                                     Security IC Embedded Software, TSF data or user data
                                                                                     associated with the product by security procedures of
                                                                                     the product manufacturer, personaliser and other actors
                                                                                     before delivery to the end-user depending on the life-
                                                                                     cycle.
                                    Test Features                                    All features and functions (implemented by the IC
                                                                                     Dedicated Test Software and/or hardware) which are
                                                                                     designed to be used before TOE Delivery only and
                                                                                     delivered as part of the TOE.
                                    TOE Delivery                                     The period when the TOE is delivered which is (refer to
                                                                                     Figure 2 on page 10) either (i) after Phase 3 (or before
                                                                                     Phase 4) if the TOE is delivered in form of wafers or
                                                                                     sawn wafers (dice) or (ii) after Phase 4 (or before Phase
                                                                                     5) if the TOE is delivered in form of packaged products.
                                    TOE Manufacturer                                 The TOE Manufacturer must ensure that all
                                                                                     requirements for the TOE (as defined in Section 1.2.2)
                                                                                     and its development and production environment
                                                                                     are fulfilled (refer to Figure 2 on page 10). The TOE
                                                                                     Manufacturer has the following roles: (i) IC Developer
                                                                                     (Phase 2) and (ii) IC Manufacturer (Phase 3). If the TOE
                                                                                     is delivered after Phase 4 in form of packaged products,
                                                                                     he has the role of the (iii) IC Packaging Manufacturer
                                                                                     (Phase 4) in addition.
                                    TSF data                                         DataData for the operation of the TOE upon which the
                                                                                     enforcement of the SFR relies. They are created by and
                                                                                     for the TOE, that might affect the operation of the TOE.
                                                                                     This includes information about the TOE’s configuration,
                                                                                     if any is coded in non-volatile non-programmable
                                                                                     memories (ROM), in non-volatile programmable
                                                                                     memories (for instance E2PROM or flash memory), in
                                                                                     specific circuitry or a combination thereof.
                                    User data of the Composite All data managed by the Security IC Embedded
                                    TOE                        Software in the application context.
                                    User data of the TOE                             Data for the user of the TOE, that does not affect
                                                                                     the operation of the TSF. From the point of view of
                                                                                     TOE defined in this PP the user data comprises the
                                                                                     Security IC Embedded Software and the user data of the
                                                                                     Composite TOE.




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       29 / 35
NXP Semiconductors                                                                                              Crypto Library Cobalt on N7021 VA
                                                                                                                                  Security Target Lite



9         Bibliography

                              9.1 Evaluation documents
                                    [1]    Common Criteria for Information Technology Security Evaluation, Part
                                           1: Introduction and general model, Version 3.1, Revision 5, April 2017,
                                           CCMB-2017-04-001
                                    [2]    Common Criteria for Information Technology Security Evaluation, Part 2: Security
                                           functional components, Version 3.1, Revision 5, April 2017, CCMB-2017-04-002
                                    [3]    Common Criteria for Information Technology Security Evaluation, Part 3: Security
                                           assurance components, Version 3.1, Revision 5, April 2017, CCMB-2017-04-003
                                    [4]    Common Methodology for Information Technology Security Evaluation, Evaluation
                                           Methodology, Version 3.1, Revision 5, April 2017, CCMB-2017-04-004
                                    [5]    Security IC Platform Protection Profile with Augmentation Packages, Version 1.0,
                                           registered and certified by Bundesamt fuer Sicherheit in der Informationstechnik
                                           (BSI) under the reference BSI-PP-0084-2014

                              9.2 Developer documents
                                    [6]    N7021 Crypto Library: User Guidance – N7021 Crypto Library
                                    [7]    N7021 Crypto Library: User Manual – Hash
                                    [8]    N7021 Crypto Library: User Manual – SHA
                                    [9]    N7021 Crypto Library: User Manual – RSA
                                    [10]   N7021 Crypto Library: User Manual – RSA Key Generation
                                    [11]   N7021 Crypto Library: User Manual – ECC over GF(p)
                                    [12]   N7021 Crypto Library: User Manual – UtilsAsym
                                    [13]   NXP Secure Smart Card Controller N7021 VA: Security Target, NXP
                                           Semiconductors

                              9.3 Standards
                                    [14] ISO 11568-4-2007: Banking – Key management (retail) – Part 4: Asymmetric
                                         cryptosystems – Key management and life cycle, 2007
                                    [15] ISO/IEC 11770-3-2015: Information technology - Security techniques - Key
                                         management - Part 3: Mechanisms using asymmetric techniques, 2015
                                    [16] FIPS PUB 180-4: Secure Hash Standard, Federal Information Processing
                                         Standards Publication, February 2011, US Department of Commerce/National
                                         Institute of Standards and Technology
                                    [17] FIPS PUB 186-4: Digital Signature Standard, Federal Information Processing
                                         Standards Publication, 2013, July, National Institute of Standards and Technology
                                    [18] ISO/IEC 14888-3:2015: Information technology – Security techniques – Digital
                                         signatures with appendix - Part 3: Discrete logarithm based mechanisms, 2016.
                                    [19] JIL-ATT-SC: Attack Methods for Smartcards and Similar Devices, Joint
                                         Interpretation Library, Version 2.2, January 2013
                                    [20] IEEE Std 1363™-2000: IEEE Standard Specifications for Public-Key Cryptography,
                                         IEEE Computer Society, 2005-12-12
                                    [21] ANSI X9.62: Public Key Cryptography for the Financial Services Industry, The
                                         Elliptic Curve Digital Signature Standard (ECDSA), American National Standard,
                                         November 16th, 2005


Crypto Library Cobalt on N7021 VA                    All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                          Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                        30 / 35
NXP Semiconductors                                                                                           Crypto Library Cobalt on N7021 VA
                                                                                                                               Security Target Lite



                                    [22] ANSI X9.63: Public Key Cryptography for the Financial Services Industry, Key
                                         Agreement and Key Transport Using Elliptic Curve cryptography, American National
                                         Standard, January 2011
                                    [23] RFC 5639: Elliptic Curve Cryptography (ECC) Brainpool Standard - Curves and
                                         Curve Generation, IETF, March 2010
                                    [24] ANSSI 2011:http://www.legifrance.gouv.fr/affichTexte.do;jsessionid=?
                                         cidTexte=JORFTEXT000024668816




Crypto Library Cobalt on N7021 VA                 All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                       Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                     31 / 35
NXP Semiconductors                                                                                             Crypto Library Cobalt on N7021 VA
                                                                                                                                 Security Target Lite



10 Legal information

                            10.1 Definitions
                                    Draft — The document is a draft version only. The content is still under internal review
                                    and subject to formal approval, which may result in modifications or additions. NXP
                                    Semiconductors does not give any representations or warranties as to the accuracy
                                    or completeness of information included herein and shall have no liability for the
                                    consequences of use of such information.

                            10.2 Disclaimers
                                    Limited warranty and liability — Information in this document is believed to be accurate
                                    and reliable. However, NXP Semiconductors does not give any representations or
                                    warranties, expressed or implied, as to the accuracy or completeness of such information
                                    and shall have no liability for the consequences of use of such information. NXP
                                    Semiconductors takes no responsibility for the content in this document if provided by an
                                    information source outside of NXP Semiconductors.
                                    In no event shall NXP Semiconductors be liable for any indirect, incidental, punitive,
                                    special or consequential damages (including - without limitation - lost profits,        Support of Authentication of the Security IC ..................................................................................45
6.2           TOE Security Assurance Requirements ................................................................................................45
6.2.1            Refinements .....................................................................................................................................46
6.2.2            Security policy model details ..........................................................................................................47
6.3           Security Requirements Rationale .........................................................................................................48
6.3.1            Rationale for the Security Functional Requirements .....................................................................48
6.3.2            Rationale of the Assurance Requirements......................................................................................52
7             TOE Summary Specification (ASE_TSS) ...........................................................................53
7.1           SF_DPM: Device Phase Management ...................................................................................................53
7.2           SF_PS: Protection against Snooping....................................................................................................53
7.3           SF_PMA: Protection against Modifying Attacks ...................................................................................53
7.4           SF_PLA: Protection against Logical Attacks.........................................................................................53
7.5           SF_CS: Cryptographic Support .............................................................................................................53
7.6           Assignment of Security Functional Requirements to TOE’s Security Functionality...........................53
7.7           Security Requirements are internally consistent.................................................................................55
8             References ...................................................................................................................56
9             Appendix: hash signatures of NRGҹ SW ...........................................................................58
9.1           Hash Digests of the NrgOS.lib ...............................................................................................................58
9.2           Hash Digests of the NrgManagement.lib..............................................................................................58
10            Appendix: hash signatures of the HSL .............................................................................59
11            Appendix: hash signatures of UMSLC lib ..........................................................................60
12            Appendix: hash signatures of SCL ...................................................................................61
13            Appendix: hash signatures of ACL ...................................................................................62
14            List of Abbreviations .....................................................................................................63
15            Glossary.......................................................................................................................66
16            Revision History ...........................................................................................................68




Security Target                                                               3                                                                             v4.0
                                                                                                                                                      2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)


1                 Security Target Introduction (ASE_INT)
1.1               ST reference
The ST has the revision v4.0 and is dated 2020-10-15. The title of this document IFX_CCI_00002Dh,
IFX_CCI_000039h, IFX_CCI_00003Ah, IFX_CCI_000044h, IFX_CCI_000045h, IFX_CCI_000046h, IFX_CCI_000047h,
IFX_CCI_000048h, IFX_CCI_000049h, IFX_CCI_00004Ah, IFX_CCI_00004Bh, IFX_CCI_00004Ch, IFX_CCI_00004Dh,
IFX_CCI_00004Eh T11 Security Target Lite.

1.2               TOE Reference
The ST comprises an Infineon Technologies Security Controller named IFX_CCI_00002Dh, IFX_CCI_000039h,
IFX_CCI_00003Ah, IFX_CCI_000044h, IFX_CCI_000045h, IFX_CCI_000046h, IFX_CCI_000047h, IFX_CCI_000048h,
IFX_CCI_000049h, IFX_CCI_00004Ah, IFX_CCI_00004Bh, IFX_CCI_00004Ch, IFX_CCI_00004Dh, IFX_CCI_00004Eh
design step T11 with firmware 80.306.16.0, optional NRGҹ SW 05.03.4097, optional HSL v3.52.9708, UMSLC lib
v01.30.0564, optional SCL v2.11.003, optional ACL v3.02.000and user guidance in the following called TOE
(Target of evaluation).
The ST is based on the Protection Profile [PP0084].
The Protection Profile and the ST are built in compliance to Common Criteria v3.1.
The targeted assurance level is EAL6+.




Security Target                                        4                                                v4.0
                                                                                                  2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)



Table 1       Identification
 Hardware                            Version                   Method of identification
 IFX_CCI_00002Dh,                    T11 (design step)         Non-ISO ATR
 IFX_CCI_000039h,
 IFX_CCI_00003Ah,
 IFX_CCI_000044h,
 IFX_CCI_000045h,
 IFX_CCI_000046h,
 IFX_CCI_000047h,
 IFX_CCI_000048h,
 IFX_CCI_000049h,
 IFX_CCI_00004Ah,
 IFX_CCI_00004Bh,
 IFX_CCI_00004Ch,
 IFX_CCI_00004Dh,
 IFX_CCI_00004Eh (each of the
 comma separated term is a
 Common Criteria Certification
 Identifier)
 firmware
 BOS & POWS                          80.306.16.0               Non-ISO ATR: firmware identifier
 Flash-loader                        09.12.0005                Flash-loader function
 Software
 NRGҹ SW (optional)                  05.03.4097                NRGҹ SW function
 HSL (optional)                      v3.52.9708                HSL function
 UMSLC                               v01.30.0564               UMSLC function
 SCL (optional)                      v2.11.003                 SCL function
 ACL (optional)                      v3.02.000                 ACL function
 User Guidance
 32-bit Security Controller – V11,                             document
 Hardware Reference Manual           V5.2, 2020-02-05
 32-bit Security Controllers,        V4.5, 2020-06-22          document
 SLx1/SLx3 Controller Family,
 Programmer’s Reference Manual
 32-bit Security Controller – V11,   v1.00-2661, 2020-10-05    document
 Security Guidelines
 Production and personalization      v.09.12, 2020-07-03       document
 32-bit ARM-based security
 controller
 32-bit Security Controller          V2.0, 2019-04-24          document
 Crypto2304T V3, User Manual
 HSL SLCx7 V11, Hardware Support     v3.52.9708, 2020-02-03    document
 Library (optional)
 UMSLC library for SLCx7 in 40nm,    v01.30.0564, 2019-06-19   document

Security Target                                         5                                       v4.0
                                                                                          2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

 Hardware                             Version                               Method of identification
 SCL37-SCP-v440-C40                   v2.11.003, 2020-02-10                 document
 Symmetric Crypto Library for SCP-
 v440 AES/DES/MAC (optional)
 ACL37-Crypto2304T-C40                v3.02.000, 2020-02-07                 document
 Asymmetric Crypto Library for
 Crypto2304T RSA/ECC/Toolbox
 (optional)


A customer can identify the TOE hardware and its configuration (for details see chapter 1.4.7) using the Non-ISO
ATR. The Non-ISO ATR outputs a Common Criteria Certification Identifier and firmware identifier, which links
the TOE to this ST. Specific firmware functions can be used to determine the exact configuration of a device
from the certified range defined in Table 3.
The TOE can be ordered with a preloaded image. This image contains NVM loader functionality and is called
PFL (Performance Flash Loader) with version v09.10.90.9. The PFL is intended to be used in a secured
environment only and is not part of the TOE.

1.3               TOE Overview

1.3.1             TOE Definition and Usage
The TOE consists of smart card ICs (Security Controllers), firmware and user guidance meeting high
requirements in terms of performance and security designed by Infineon Technologies AG. This TOE is intended
to be used in smart cards for security-relevant applications and as developing platform for smart card
operating systems according to the lifecycle model from [PP0084]
The term Smartcard Embedded Software is used in the following for all operating systems and applications
stored and executed on the TOE. The TOE is the platform for the Smartcard Embedded Software. The
Smartcard Embedded Software itself is not part of the TOE. The TOE does not require any non-TOE
hardware/software/firmware.

1.3.2             TOE major security features
   Cryptographic support: TDES, AES, RSA, ECDSA, ECC, ECDH, RNG (Hybrid Random Number Generator PTG.3,
    True Random Number Generator PTG.2, Deterministic Random Number generator DRG.3 and DRG.4
    according to [BSI_RNGs])
   Memory protection unit supporting different memory access levels
   Memory encryption
   Robust set of sensors and detectors for the purpose of monitoring proper chip operating conditions
   Redundant alarm propagation and system deactivation principle
   Register protection
   Security life control
   Program flow integrity protection
   Peripheral access control
   Bus encryption for security peripherals
   Tearing safe NVM programming
   Security optimized wiring
   Leakage control of data dependent code execution

Security Target                                        6                                                     v4.0
                                                                                                       2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

 Device phase management supporting isolation of test features and Flash Loader accessibility
 Detection of NVM single and multi bit errors



1.4                  TOE description

1.4.1                TOE components

1.4.1.1              Hardware components
Figure 1 shows a block diagram of the TOE hardware:
Figure 1      Block diagram of TOE hardware


                                                                Memory System

             Core:                                                     Solid FlashTM NVM     IFX ROM

                 CPU
                 NVIC             CPAU          Cache        ICS           Memory Bus (32 Bit)
                 MPU
                 ISS
                                                   ICS        Memory Bus (32 Bit)           RAM




                                                             Peripherals
                                                                           3x timer        Filters/
                                          SCP         RNG       µSM4                                    CRC
                                                                           & WDT           Sensors

                          SPAU                               Peripheral Bus (16 Bit)
                                                                              UART/            RF
                                     Crypto2304T      UMSLC         CLKU                                I2C
                                                                              GPIO          interface




The TOE hardware consists of a core, a memory system and peripherals.
The major components of the core system are a 32-bit CPU (Central Processing Unit), an MPU (Memory
Protection Unit), a Nested Vectored Interrupt Controller (NVIC) and an Instruction Stream Signature Checking
(ISS).
The MPU of the core stores code and data in a linear 4-GByte memory space (32-bit range), allowing direct
access without the need to swap memory segments in and out of memory using a memory protection unit.
There are two separate bus entities: a memory bus and a peripheral bus for high-speed communication with
the peripherals.
The SPAU can be configured by the user to block or allow peripheral access. It can also be used to block RAM
areas (For keeping Figure 1 simple, the connection between SPAU and RAM is not shown). The CPAU enables
the user to block or allow unprivileged level access to NVM and specific registers of ICS and NVM.
Security Target                                          7                                                    v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

The CPU accesses memory via the Internal Ciphering System (ICS), which encrypts/decrypts memory content.
All data of the memory block is encrypted. The NVM is equipped with an error correction code (ECC). Security
modules manage the alarms. Alarms may be triggered when the environmental conditions are outside the
specified operational range.
A set of sensors (temperature sensor, backside light detector, glitch sensor, low frequency sensor) is used to
detect excessive deviations from the specified operational range and serve for robustness of the TOE. The
UMSLC function can be used to test the alarm lines.
A Random Number Generator (RNG) consist of a physical Random Number Generator with a cryptographically
strong post processing unit. It can be operated in the modes as follows:
 True Random Number Generation, meeting AIS31 PTG.2
 Hybrid Random Number Generation, meeting AIS31 PTG.3
 Deterministic Random Number Generation (DRNG) AIS31 DRG.3 and DRG.4

The Symmetric Cryptographic Processor (SCP) implements calculation of dual-key or triple-key triple-DES and
AES.
The µSM4 supports the Chinese standard encryption algorithm SM4.
The Crypto2304T co-processor provides basic means optimized for the implementation of fast and secure
software of many asymmetric or public key cryptographic schemes like RSA or elliptic curve based ones. The
user accessibility of the Crypto2304T is a customer ordering option
The implemented sleep mode logic (clock stop mode per ISO/IEC 7816-3) is used to reduce overall power
consumption.
The TOE is able to communicate using either its contact based or contactless interface (RF interface). The
contact based interface allows to use the ISO 7816 protocol via the UART. Further it offers a GPIO and an I2C
slave interface. The contactless interface can be configured to RFI or ACLB mode. Both interface types support
the signaling modes as follows:
 Signalling mode ISO/IEC 14443, Type A and Type B
 Signalling mode ISO/IEC 18092 passive mode, Type F
 NRGҹ interface

The UMSLC enables the user software to check the activity and proper function of the system’s security
features.
The Clock Unit (CLKU) supplies the clocks for all components of the TOE. The Clock Unit can work in internal
and external clock mode. When operating the internal clock mode the system frequency is derived from an
oscillator, whereas in external clock mode, the system clock is derived from an externally supplied interface
clock.
The watchdog timer triggers an event in case of a counter overflow. The timers are general purpose up-
counting timers.
A CRC (Cyclic Redundancy Check) module computes a checksum value from a message or any other block of
data.
The ROM is used by IFX only. The user software has to be implemented in SOLID FLASHҹ memory. The user can
choose, whether the software is loaded into the SOLID FLASHҹ memory by Infineon Technologies AG or by the
user.
The TOE uses Special Function Registers (SFRs). These SFRs are used for general purposes and chip
configuration; they are located in SOLID FLASHҹ memory in a configuration area page. The Online

Security Target                                         8                                                     v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

Configuration Check (OCC) function is used for register protection, i.e. controls the modification of relevant
SFR settings.
In case a security violation is detected, secure state is entered by the hardware.

1.4.1.2            Firmware and software components
The TOE provides low-level firmware components: the Boot Software (BOS), the Performance Optimized Write
Scheme (POWS) and the Flash Loader (FL).
The BOS firmware is used for test purposes during start-up and the FL allows downloading of user software to
the NVM during the manufacturing process. All mandatory functions for start-up and internal testing are
protected by a dedicated hardware firewall with two levels “BOS” and “user”.
The POWS library is an internal firmware library, i.e. not accessible by the user. It is used by the BOS and FL to
store data in NVM in a tearing safe manner.
The Flash Loader allows downloading of User Software into the NVM during the manufacturing process.
The software of the TOE consists of optional packages:
   NRGҹ SW: The optional NRGҹ SW supports Card and Reader Mode, e.g. card creation, personalization and
    deletion. The NRGҹ SW does not implement any security functionality
   HSL: The optional HSL provides functionality via APIs to the Smartcard Embedded Software . which
    contains SOLID FLASHҹ NVM service routines and functionality for tearing safe programming of SOLID
    FLASHҹ NVM.
   UMSLC lib: this library provides a wrapper around the UMSLC hardware functionality with measures to
    counter fault attacks.
   Symmetric Crypto Library (SCL): The optional SCL is used to provide a high level interface to the TDES and
    AES cryptography, which is partly implemented on the hardware component SCP and includes
    countermeasures against SPA, DPA and DFA attacks. The SCL is delivered as object code and in this way
    integrated into the user software.
   Asymmetric Crypto Library (ACL): The optional ACL implements RSA and elliptic curve based cryptographic
    schemes

1.4.1.3            User Guidance components
The user guidance consists of the components as follows:
   32-bit Security Controller – V11, Hardware Reference Manual: description of hardware features and user
    interfaces
   32-bit ARM-based Securtity Controller, SLC 37/(40-nm Technology), Programmer’s Reference Manual:
    description of firmware principles (including NRGҹ SW) relevant for IC embedded software.
   Production and personalization 32-bit ARM-based security cvontroller in 40 nm:contains detailed
    information about the usage of the Flash Loader
   32-bit Security Controller – V11, Security Guidelines: provides the guidance and recommendations to
    develop secure software for and secure usage of this TOE.
   32-bit Security Controller Crypto2304T V3, User Manual: This manual describes the functionality of the
    Crypto2304T module and is intended for experienced crypto library developers
   HSL SLCx7 V11, Hardware Support Library: provides an application interface (API) description and security
    guidelines for the optional HSL software part.
   UMSLC library for SLCx7 in 40nm User Mode Security Life Control, Version 01.00.0234: provides some
    guidelines, how to use the UMSLC library

Security Target                                          9                                                       v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

 SCL37-SCP-v440-C40 Symmetric Crypto Library for SCP-v440 AES/DES/MAC: User Interface, contains all
  interfaces of the SCL. This document is only delivered to the user in case the SCL is part of the delivered
  TOE.
 ACL37-Crypto2304T-C40 Asymmetric Crypto Library for Crypto2304T RSA/ECC/Toolbox: provides an
  application interface (API) description and security guidelines for the optional ACL software part.

1.4.2              Physical scope of the TOE
The physical scope of the TOE is defined by the TOE components described in chapter 1.4.1

1.4.3              Logical scope of the TOE
The logical scope of the TOE consists of the logical security features provided by the TOE. These features are
listed in chapter 1.3.2. More details are provided in this chapter:
   Cryptographic support: TDES, AES (block cipher modes ECB, CBC, CFB, CTR and CMAC), RNG (Hybrid
    Random Number Generator PTG.3, True Random Number Generator PTG.2, Deterministic Random Number
    generator DRG.3 and DRG.4 according to [BSI_RNGs]), RSA, ECC, ECDSA, ECDH.
   Memory protection unit supporting up to eight memory regions with different access rights and two
    privilege levels “privileged” and “user”. “User” level is more restricted in using TOE resources compared to
    “privileged”
   Memory encryption: all data of memories ROM, RAM and NVM are encrypted. Addresses are scrambled to
    disguise the location of data
   Robust set of sensors and detectors for the purpose of monitoring proper chip operating conditions
    consisting of a temperature sensor, backside light detector, glitch sensor and low frequency sensor.
   Redundant alarm propagation and system deactivation principle, which decreases the risk of manipulation
    and tampering.
   Register protection: protection of security relevant registers against fault attacks using OCC.
   Security life control: a life test on specific security features can be used by the IC embedded software to
    detect manipulation of these security features
   Program flow integrity protection: The Instruction Stream Signature Checking (ISS) can be employed by the
    IC embedded software to detect illegal program flows and trigger an alarm. The TOE also contains a
    watchdog, which may be used to detect program flow manipulations.
   Peripheral access control: The TOE allows the IC embedded software to lock certain peripherals
    dynamically.
   Bus encryption for security peripherals: All data transfers to and from dedicated peripherals are encrypted
    dynamically.
   Tearing safe NVM programming: the HSL provides specific routines provided for tearing safe programming.
    These routines prevent an unspecified interim state by either propagating the pre- or post-programming
    condition.
   Security optimized wiring: shield lines in combination with layout measures reduce the risk of successful
    manipulative attacks.
   Leakage control of data dependant code execution: dedicated measures allow the user to reduce such
    leakage.
   Device phase management supporting isolation of test features and Flash Loader accessibility: dedicated
    test features employed during production are switched off before customer delivery. The Flash Loader
    usage to download flash data requires either a mutual authentication or a one way user authentication
    depending on the order option EA. The Flash Loader supports permanent deactivation.



Security Target                                         10                                                    v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

  Detection of NVM single and multi bit errors: Single bit errors are detected and corrected and multi bit errors
   detected.
Features, which are not mentioned here do not directly contribute to the SFRs.

1.4.4              Interfaces of the TOE
   The physical interface of the TOE to the external environment is the entire surface of the IC.
   The electrical interface of the TOE to the external environment is constituted by the pads of the chip:
             o The five ISO 7816 pads consist particularly of the contacted RES, I/O, CLK lines and supply lines
                 VCC and GND. The contact based communication is according to ISO 7816/ETSI/EMV.
             o The I2C communication can be driven via the ISO 7816 pads. In this case no other
                 communication using the ISO 7816 pads is possible.
   The RF interface (radio frequency power and signal interface) enables contactless communication between
    a PICC (proximity integration chip card) and a PCD reader/writer (proximity coupling device). Power supply
    is received and data are received or transmitted by an antenna which consists of a coil with a few turns
    directly connected to the IC.
   The data-oriented I/O interface of the TOE is represented by the I/O pad.
   The interface between firmware and hardware consists of special registers used for hardware configuration
    and control (Special Function Registers, SFR).
   Optional: The interface of the TOE to the operating system is covered by the optional HSL routines and by
    the instruction set of the TOE.
   Optional: The interface of the NRGҹ SW defined by the NRGҹ SW
   The interface of the UMSLC lib defined by the UMSLC lib
   Optional: The interface to the SCL calculations is defined by the SCL
   Optional: The interface to the ACL calculations is defined by the ACL

1.4.5              Forms of Delivery
The TOE can be delivered in the form of complete modules, as plain wafers in an IC case (e.g. DSO20) or in bare
dies. The delivery can therefore be at the end of phase 3 or at the end of phase 4 which may also include pre-
personalization steps according to [PP0084]. This means phase 4 is also part of the evaluation process. In any
case the testing of the TOE is finished and the extended test features are removed. From a security policy point
of view the different forms of delivery do not have any impact.
The delivery to the software developer (phase 2  phase 1) contains the documents as described above.
Part of the software delivery is the Flash Loader program, provided by Infineon Technologies AG, running on
the TOE and controlling the download of user software onto the TOE via the UART or RF interface. The
download is only possible after successful authentication. The user software and data must be encrypted
before download. In addition, the user can permanently block further use of the Flash Loader.
The table as follows provides an overview about form and method of TOE deliveries:

Table 2       TOE deliveries: forms and methods
TOE Component                       Delivered         Delivery Method      Comment
                                    Format
Hardware




Security Target                                         11                                                    v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

TOE Component                               Delivered             Delivery Method         Comment
                                            Format
IFX_CCI_00002Dh,                            Wafer, IC case,       Postal transfer in      All materials are delivered to
IFX_CCI_000039h,                            packages              cages                   distribution centers in cages,
IFX_CCI_00003Ah,                                                                          locked.
IFX_CCI_000044h,
IFX_CCI_000045h,
IFX_CCI_000046h,
IFX_CCI_000047h,
IFX_CCI_000048h,
IFX_CCI_000049h,
IFX_CCI_00004Ah,
IFX_CCI_00004Bh,
IFX_CCI_00004Ch,
IFX_CCI_00004Dh,
IFX_CCI_00004Eh T11
Firmware
All                                         –                     –                       stored on the delivered hardware.
Software
All software libraries                      L251 Library          Secured                 –
                                            File (object          download1
                                            code)
PFL (not part of the TOE)                       Preloaded         Part of IC              –
                                                  image
Guidance Documentation
All User Guidance documents                 Personalized          Secured                 –
                                            PDF                   download1

1.4.6                   Production sites
The TOE may be handled at different production sites but the silicon is produced at Global Foundries fab 7 in
Singapore only. The production site can be determined by the non-ISO ATR.
The delivery measures are described in the ALC_DVS aspect.

1.4.7                   TOE Configuration
This TOE is represented by various configurations called products.
The module design, layout and footprint, of all products are identical.
The degree of freedom for configuring the TOE is predefined by Infineon Technologies AG. Table 3 shows the
TOE hardware/firmware configurations:

Table 3          TOE hardware/firmware configuration options
    Memory                                         Values                                     Identification
    SOLID FLASHҹ                                   up to 512 kBytes                           IFX-Mailbox

1
    Secured download is a way of delivery of documentation and TOE related software using a secure ishare connected to Infineon
      customer portal. The TOE user needs a DMZ Account to login (authenticate) via the Internet.

Security Target                                                       12                                                          v4.0
                                                                                                                            2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

 Memory                                  Values                              Identification
 RAM                                     up to 16 kBytes                     IFX-Mailbox
 Peripherals                             Values                              Identification
 Crypto2304T                             Available/unavailable               Hardware register
 µSM4                                    Available/unavailable               Hardware register
 NRGҹ Crypto Module                      Available/unavailable               Hardware register
 Interface and protocol                  Values                              Identification
 I2C                                     Available/unavailable               Hardware register
 RFI                                     Available/unavailable               Hardware register
 ACLB                                    Available/unavailable               Hardware register
 Signaling mode ISO/IEC 14443 Type A     Available/unavailable               Hardware register
 Signaling mode ISO/IEC 14443 Type B     Available/unavailable               Hardware register
 Signaling mode ISO/IEC 18092            Available/unavailable               Hardware register
 passive mode, Type F
 ACM                                     Available/unavailable               Hardware register
 AMM                                     Available/unavailable               Hardware register
 AFM                                     Available/unavailable               Hardware register
 Input capacitance [pF]                  (27/56/78)                          GCIM
 BPU                                     Available/unavailable               IFX-Mailbox
 EA                                      Available/unavailable               Flash loader function

Further the Flash Loader can be configured in different ways as explained in the following section.

1.4.8              TOE initialization with Customer Software
This TOE is equipped with Flash Loader software (FL) to download user software, i.e. an operating system and
applications. Various options can be chosen by the user to store software onto the SOLID FLASHҹ NVM:

Table 4       Order Options to initialize the TOE with customer software
 Case              Option                              Flash loader status
 1                 The user or/and a subcontractor     The Flash Loader can be activated or reactivated by
                   downloads the software into the     the user or subcontractor to download software into
                   SOLID FLASHҹ memory. Infineon       the SOLID FLASHҹ memory. In case the Flash Loader is
                   Technologies does not receive any   active, it may be either in life cycle stage “Pinletter” or
                   user software.                      “Activated”. When “Activated” a mutual
                                                       authentication needs to be performed or if TOE is
                                                       ordered with EA available a one-way authentication
                                                       from user towards Flash Loader, before download can
                                                       be started. In “Pinletter” a valid Pinletter provided by
                                                       Infineon Technologies AG needs to be presented to
                                                       enter “Activated” stage.
 2                 The user provides software to       There is no Flash Loader present.
                   download into the SOLID FLASHҹ
                   memory to Infineon Technologies
                   AG. The software is loaded into
                   the SOLID FLASHҹ memory during

Security Target                                        13                                                       v4.0
                                                                                                          2020-10-15
Security Target Lite

Security Target Introduction (ASE_INT)

 Case             Option                             Flash loader status
                  chip production.
 3                The user provides software to      The Flash Loader is blocked by Infineon but can be
                  download into the SOLID FLASHҹ     activated or reactivated by the user or subcontractor
                  memory to Infineon Technologies    to download software into the SOLID FLASHҹ
                  AG. The software is loaded into    memory. The user is required to provide a reactivation
                  the NVM memory during chip         procedure as part of the software to Infineon
                  production.                        Technologies AG.
 4                The user provides software to      The Flash Loader is active. The user can either
                  download into the SOLID FLASHҹ     download software or activate the software already
                  memory to Infineon Technologies    present in SOLID FLASHҹ memory.
                  AG. The software is loaded into
                  the NVM memory during chip
                  production.
 5                Infineon Technologies AG           The Flash Loader is active. The user can either
                  preloades PFL into SOLID FLASHҹ.   download software and erase the PFL or activate the
                                                     PFL present in SOLID FLASHҹ memory. Note, that PFL
                                                     is not part of the TOE., i.e. activating the PFL is outside
                                                     of the scope of this certification.




Security Target                                      14                                                       v4.0
                                                                                                        2020-10-15
Security Target Lite

Conformance Claims (ASE_CCL)


2                        Conformance Claims (ASE_CCL)
2.1                      Conformance Claims (ASE CCL)
This ST and TOE claim conformance to CC v3.1 revision 5. The ST claims conformance to [CCBook3]. It is
[CCBook2] extended.

2.1.1                    PP Claim
This ST is strictly conformant to [PP0084]. The assurance level is EAL6+. The augmentation is achieved - with
regard to [CCBook3]: Security assurance components by including:

Table 5          Augmentations of the assurance level of the TOE
    Assurance Class                              Assurance Family                             Description
    Life-cycle support                           ALC_FLR.1                                    Basic flaw remediation

The Security IC Platform Protection Profile with Augmentation Packages is registered and certified by the
Bundesamt für Sicherheit in der Informationstechnik1 (BSI) under the reference [PP0084].
The security assurance requirements of the TOE are according to [PP0084 and [CCBook3].

2.1.2                    Package Claim
This ST claims conformance to the following additional packages taken from [PP0084]:
 Package Authentication of the Security IC, section 7.2, conformant.
      This package is only claimed in case TOE is ordered with configuration option EA unavailable.
     Package Loader, Package 1: Loader dedicated for usage in secured environment only, section 7.3.1,
      conformant
      This package is optional and fulfilled only by TOE products with Flash Loader.
     Package Loader, Package 2: Loader dedicated for usage by authorized users only,
      section 7.3.2, augmented
      This package is optional and fulfilled only by TOE products with Flash Loader and configuration option EA
      unavailable.
     Package TDES ; section 7.4.1, augmented
     Package AES ; section 7.4.2, augmented
The assurance level for the TOE is EAL6 augmented with the component ALC_FLR.1.Therefore this ST is
package-augmented to the packages in [PP0084].

2.1.3                    Conformance Rationale
The TOE is a typical security IC as defined in [PP0084] chapter 1.2.2 comprising:
 the circuitry of the IC (hardware including the physical memories),
 configuration data, initialization data related to the IC Dedicated Software and the behaviour of the security
  functionality
 the IC Dedicated Software with the parts


1
    Bundesamt für Sicherheit in der Informationstechnik (BSI) is the German Federal Office for Information Security


Security Target                                                      15                                                      v4.0
                                                                                                                       2020-10-15
Security Target Lite

Conformance Claims (ASE_CCL)

 the IC Dedicated Test Software,
 the IC Dedicated Support Software.

The TOE is designed, produced and/or generated by the TOE Manufacturer.
The security problem definition of [PP0084] is enhanced by adding additional threats and an environmental
objective. Including these add-ons, the security problem definition of this ST is consistent with the statement of
the security problem definition in [PP0084], as the ST claims strict conformance to [PP0084].
The threat memory access violation T.Mem-Access has been added, due to specific TOE memory access control
functionality. This add-on has no impact on the conformance statements regarding [CCbook1] and [PP0084]
with following rational:
   The security target remains conformant to [CCbook1], claim 576 as the possibility to introduce additional
    restrictions is given.
 The security target fulfils the strict conformance claim of [PP0084] due to the application notes 5, 6 and 7
    which apply here. By those notes the addition of further security functions and security services are
    covered, even without deriving particular security functionality from a threat but from a policy.
The threat T.Open_Samples_Diffusion is added in case physical protection during TOE delivery to customers is
omitted. This threat increases the scope of threats and does not contradict to any of the defined threats of
[PP0084].
The environmental objective OE.Prevent_Masquerade is added to require the environment to add additional
measures in case EA is available in order to prevent masquerading attacks. The strict conformance to [PP0084]
is still met, because the ability of the TOE to prevent masquerading attacks is met by an optional package , i.e.
“Package Authentication of the Security IC”. In case this package is not claimed, the TOE does not provide
sufficient measures to prevent masquerading. Requesting the environment to fill this gap is an important
requirement, if masquerading attacks are considered relevant. [PP0084] does not add any considerations in
case the TOE does not claim this package.




Security Target                                         16                                                    v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Problem Definition (ASE_SPD)


3                  Security Problem Definition (ASE_SPD)
The content of [PP0084] applies to this chapter completely.

3.1                Threats
The threats are directed against the assets and/or the security functions of the TOE. For example, certain
attacks are only one step towards a disclosure of assets while others may directly lead to a compromise of the
application security. The more detailed description of specific attacks is given later on in the process of
evaluation and certification. An overview on attacks is given in [PP0084] section 3.2.
The threats to security are defined and described in [PP0084] sections 3.2 and 7.2.1.

Table 6       Threats according to [PP0084]
 T.Phys-Manipulation         Physical Manipulation
 T.Phys-Probing              Physical Probing
 T.Malfunction               Malfunction due to Environmental Stress
 T.Leak-Inherent             Inherent Information Leakage
 T.Leak-Forced               Forced Information Leakage
 T.Abuse-Func                Abuse of Functionality
 T.RND                       Deficiency of Random Numbers
 T.Masquerade_TOE            Masquerade the TOE

3.1.1              Additional Threat due to TOE specific Functionality
The additional functionality of introducing sophisticated privilege levels and access control allows the secure
separation between the operation system(s) and applications, the secure downloading of applications after
personalization and enables multitasking by separating memory areas and performing access controls
between different applications. Due to this additional functionality “area based memory access control” a new
threat is introduced.
The TOE shall avert the threat “Memory Access Violation (T.Mem-Access)” as specified below:
T.Mem-Access           Memory Access Violation
                       Parts of the Smartcard Embedded Software may cause security violations by
                       accidentally or deliberately accessing restricted data (which may include code) or
                       privilege levels. Any restrictions are defined by the security policy of the specific
                       application context and must be implemented by the Smartcard Embedded Software.
“Diffusion of open samples” threat:
T.Open_Samples_Diffusion Diffusion of Open Samples
                       An attacker may get access to open samples of the TOE and use them to gain
                       information about the TSF (loader, memory management unit, ROM code …). He may
                       also use the open samples to characterize the behavior of the IC and its security
                       functionalities (for example: characterization of side channel profiles, perturbation
                       cartography …). The execution of a dedicated security features (for example: execution
                       of a DES computation without countermeasures or by de-activating countermeasures)



Security Target                                        17                                                    v4.0
                                                                                                       2020-10-15
Security Target Lite

Security Problem Definition (ASE_SPD)

                        through the loading of an adequate code would allow this kind of characterization and
                        the execution of enhanced attacks on the IC.

Table 7       Additional threats due to TOE specific functions and augmentations
 T.Mem-Access                         Memory Access Violation
 T.Open_Samples_Diffusion             Diffusion of Open Samples

3.1.2               Assets regarding the Threats
The asset description from [PP0084] section 3.1 applies.

3.2                 Organizational Security Policies
The organizational policies from [PP0084] sections 3.3, 7.3.1, 7.3.2 and 7.4 are applicable.

Table 8       Organizational Security Policies according [PP0084]
 P.Process-TOE                        Protection during TOE Development and Production
 P.Crypto-Service                     Cryptographic services of the TOE
 P.Lim_Block_Loader                   Limiting and Blocking the Loader Functionality
 P.Ctrl_Loader (only available , if   Controlled usage to Loader Functionality
 Flash Loader active)

3.3                 Assumptions
The TOE assumptions about the operational environment are defined and described in [PP0084] section 3.4.

Table 9       Assumption according [PP0084]
 A.Process-Sec-IC                              Protection during Packaging, Finishing and Personalization
 A.Resp-Appl                                   Treatment of User Data




Security Target                                         18                                                  v4.0
                                                                                                      2020-10-15
Security Target Lite

Security objectives (ASE_OBJ)


4                   Security objectives (ASE_OBJ)
This section shows the security objectives, which are relevant to the TOE.

4.1                 Security objectives of the TOE
The security objectives of the TOE are defined and described in[PP0084] sections 4.1, 7.2.1, 7.3.1, 7.3.2, 7.4.1
and 7.4.2

Table 10      Objectives for the TOE according to [PP0084]
 O.Phys-Manipulation          Protection against Physical Manipulation
 O.Phys-Probing               Protection against Physical Probing
 O.Malfunction                Protection against Malfunction
 O.Leak-Inherent              Protection against Inherent Information Leakage

 O.Leak-Forced                Protection against Forced Information Leakage

 O.Abuse-Func                 Protection against Abuse of Functionality

 O.Identification             TOE Identification
 O.RND                        Random Numbers
 O.Cap_Avail_Loader           Capability and availability of the Loader
 O.Ctrl_Auth_Loader           Access control and authenticity for the Loader
 (only available , if Flash
 Loader active)
 O.Authentication             Authentication to external entities
 (only available , if Flash
 Loader active and TOE is
 ordered with
 configuration option EA
 unavailable)
 O.TDES                       Cryptographic service Triple-DES
 O.AES                        Cryptographic service AES

The TOE shall provide “Area based Memory Access Control (O.Mem-Access)” as specified below.
O.Mem-Access                    Area based Memory Access Control
                                The TOE must provide the Smartcard Embedded Software with the capability to
                                define restricted access memory areas. The TOE must then enforce the
                                partitioning of such memory areas so that access of software to memory areas
                                and privilege levels is controlled as required, for example, in a multi-application
                                environment.
The TOE shall provide TSF confidentiality protection as specified below:
O.Prot_TSF_Confidentiality Protection of confidentiality of TSF




Security Target                                          19                                                     v4.0
                                                                                                          2020-10-15
Security Target Lite

Security objectives (ASE_OBJ)

                                 The TOE must provide protection against disclosure of confidential operations
                                 of the security IC (loader, memory management unit, …) through the use of a
                                 dedicated code loaded on open samples.
The TOE shall provide “RSA cryprographic services (O.RSA)” and “Elliptic Curve cryptographic services (O.ECC)”
as specified below.
O.RSA                         RSA cryptographic services
                              The TOE shall provide the following specific security functionality to the
                              Smartcard Embedded Software: Rivest-Shamir-Adleman Cryptography (RSA)
O.ECC                         Elliptic Curve cryptographic services
                              The TOE shall provide the following specific security functionality to the
                              Smartcard Embedded Software: Elliptic Curve Cryptography (ECC)



The TOE shall provide “Cryptographic service AES-TDES-MAC (O.AES-TDES-MAC)” as specified below.
O.AES-TDES-MAC                           Cryptographic service AES-TDES-MAC
The TOE provides secure cryptographic services for AES and TDES MAC generation and verification.




Table 11      Additional objectives due to TOE specific functions and augmentations
 O.Mem-Access                                   Area based Memory Access Control
 O.Prot_TSF_Confidentiality                     Protection of confidentiality of TSF
 O.RSA (only available, if ACL is part of the   RSA cryptographic services
 TOE and Crypto2304T user accessible)
 O.ECC (only available, if ACL is part of the   Elliptic Curve cryptographic services
 TOE and Crypto2304T user accessible)
 O.AES-TDES-MAC (only available, if SCL is      AES-TDES-MAC cryptographic services
 part of the TOE)

4.2                Security Objectives for the development and operational
                   Environment
The security objectives from [PP0084] section 4.2, 4.3, 7.2.1, 7.3.1, 7.3.2, 7.4.1 and section 7.4.2 are applicable
for this TOE.
The table below lists the environmental security objectives.

Table 12      Security objectives for the environment according to [PP0084]
 Environmental objective       description
 OE.Resp-Appl                   Treatment of User Data
 OE.Process-Sec-IC              Protection during composite product manufacturing
 OE.Lim_Block_Loader            Limitation of capability and blocking the Loader
 OE.Loader_Usage (only          Secure communication and usage of the Loader
 applicable , if Flash
 Loader active and TOE is

Security Target                                          20                                                       v4.0
                                                                                                            2020-10-15
Security Target Lite

Security objectives (ASE_OBJ)

 Environmental objective       description
 ordered with
 configuration option EA
 unavailable)
 OE.TOE_Auth (applicable ,     External entities authenticating of the TOE
 if Flash Loader active and
 TOE is ordered with
 configuration option EA
 unavailable)



Table 13      Additional Security objectives for the environment
 Environmental objective       description
 OE.Prevent_Masquerade         User is required to provide mechanisms to prevent masquerading attacks in
 (only applicable, if Flash    case the TOE does not claim the package “Authentication of the Security IC”.
 Loade active and              The authorized user must further support trusted communication with the TOE
 configuration option EA       by confidentiality protection and authenticity proof of data to be loaded and
 available)                    fulfilling the access conditions required by the Loader.



4.3                Security Objectives Rationale
The security objectives rationale of the TOE is defined and described in [PP0084] section 4.4, 7.3.1, 7.3.2, 7.4.1
and section 7.4.2.
Compared to [PP0084] an enhancement regarding memory area protection has been established. The clear
definition of privilege levels for operated software establishes the clear separation of different restricted
memory areas for running the firmware, downloading and/or running the operating system and to establish a
clear separation between different applications. Nevertheless, it is also possible to define a shared memory
section where separated applications may exchange defined data. The privilege levels clearly define by using a
hierarchical model the access right from one level to the other. These measures ensure that the threat T.Mem-
Access is clearly covered by the security objective O.Mem-Access.
The objectives O.Authentication, O.Ctrl_Auth_Loader and the organizational policiy P.Ctrl_Loader and the
environmental objective OE.TOE_Auth as described in [PP0084] chapter 7.2 and 7.3.2 apply only to TOE
products with Flash Loader enabled for software or data download by the user. In other cases the Flash Loader
is not available anymore and the user software or data download is completed. If TOE is ordered with
configuration option EA available the objectives O.Authentication and the environmental objective
OE.TOE_Auth are not applicable for the TOE. In this case, the TOE implements a one-way authentication of
users instead of a mutual authentication.
The objective OE.Prevent_Masquerade requires measures by customers to ensure the authenticity of the TOE.
Due to the combination of these measures with the one-way authentication enforced by the Flash Loader with
EA, both communication end points are considered to be authentic. Therefore, O.Ctrl_Auth_Loader is still
applicable while the objective OE.Loader_Usage is replaced by the objective OE.Prevent_Masquerade.
The objectives O.RSA, O.ECC, O.AES-TDES-MAC cover the policy P.Crypto_Services. This policy intends to allow
adding various cryptographic services to the TSF.




Security Target                                          21                                                      v4.0
                                                                                                           2020-10-15
Security Target Lite

Security objectives (ASE_OBJ)

The objective O.Prot_TSF_Confidentiality counters the threat T.Open_Samples_Diffusion. In addition
T.Open_Samples_Diffusion is countered by O.Leak-Inherent and O.Leak-Forced.
The environmental objective OE. Prevent_Masquerade is introduced because the availability of package
“Authentication of the Security IC” depends on specific order options. In case the chosen order options exclude
this package, the user has to provide measures to neutralize the threat T.Masquerade_TOE.




Security Target                                       22                                                    v4.0
                                                                                                      2020-10-15
Security Target Lite

Extended Component Definition (ASE_ECD)


5                  Extended Component Definition (ASE_ECD)
There are several extended components defined and described for the TOE:
   the family FCS_RNG at the class FCS Cryptographic Support
   the family FMT_LIM at the class FMT Security Management
   the family FAU_SAS at the class FAU Security Audit
   the family FDP_SDC at the class FDP User Data Protection
   the family FIA_API at the class FIA Identification and Authentication
   the component FPT_TST.2 at the class FPT Protection of the TSF
The extended families FCS_RNG, FMT_LIM, FAU_SAS, FDP_SDC and FIA_API are defined and described in
[PP0084] section 5. The component FPT_TST.2 is defined in the following sections.

5.1                Component “Subset TOE security testing (FPT_TST.2)”
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE or is done automatically and
continuously.
Part 2 of the Common Criteria provides the security functional component “TSF testing (FPT_TST.1)”. The
component FPT_TST.1 provides the ability to test the TSF’s correct operation.
For the user it is important to know which security functions or mechanisms can be tested. The functional
component FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In addition,
FPT_TST.1 requires verification of the integrity of TSF data and of the stored TSF executable code which might
violate the security policy. Therefore, the functional component ”Subset TOE security testing (FPT_TST.2)”
of the family TSF self test has been newly created. This component allows that particular parts of the security
mechanisms and functions provided by the TOE are tested.

5.2                Definition of FPT_TST.2
The functional component “Subset TOE security testing (FPT_TST.2)” has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and
functions provided by the TOE can be tested after TOE Delivery or are tested automatically and continuously
during normal operation transparent for the user.
This security functional component is used instead of the functional component FPT_TST.1 from Common
Criteria Part 2. For the user it is important to know which security functions or mechanisms can be tested. The
functional component FPT_TST.1 does not mandate to explicitly specify the security functions being tested. In
addition, FPT_TST.1 requires verifying the integrity of TSF data and stored TSF executable code which might
violate the security policy.
The functional component “Subset TOE testing (FPT_TST.2)” is specified as follows (Common Criteria Part 2
extended).




Security Target                                         23                                                    v4.0
                                                                                                        2020-10-15
Security Target Lite

Extended Component Definition (ASE_ECD)

5.3                   TSF self test (FPT_TST)
Family Behavior           The Family Behavior is defined in [CCBook3] section 15.14 (442,443).
Component levelling

                                                                             1
           FPT_TST        TSF self test
                                                                             2

FPT_TST.1:         The component FPT_TST.1 is defined in [CCBook3] section 15.14 (444, 445,446).
FPT_TST.2:         Subset TOE security testing, provides the ability to test the correct operation of particular
                   security functions or mechanisms. These tests may be performed at start-up, periodically, at the
                   request of the authorized user, or when other conditions are met. It also provides the ability to
                   verify the integrity of TSF data and executable code.
Management: FPT_TST.2
The following actions could be considered for the management functions in FMT:
 management of the conditions under which subset TSF self testing occurs, such as during initial start-up,
  regular interval or under specified conditions
 management of the time of the interval appropriate.

Audit: FPT_TST.2
There are no auditable events foreseen.

FPT_TST.2                      Subset TOE testing
Hierarchical to:               No other components.
Dependencies:                  No dependencies
FPT_TST.2.1:                   The TSF shall run a suite of self tests [selection: during initial start-up, periodically
                               during normal operation, at the request of the authorized user, and/or at the
                               conditions [assignment: conditions under which self test should occur]] to
                               demonstrate the correct operation of [assignment: functions and/or mechanisms].




Security Target                                             24                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)


6                   Security Requirements (ASE_REQ)
For this section [PP0084] section 6 can be applied completely.

6.1                 TOE Security Functional Requirements
The security functional requirements (SFR) for the TOE are defined and described in [PP0084] and in the
following description.
Table 14 provides an overview of the functional security requirements of the TOE, defined in [PP0084] section
6.1, 7.2.3, 7.3.1, 7.3.2, 7.4.1 and 7.4.2.

Table 14      Security functional requirements of the TOE defined in [PP0084]
 Security Functional Requirement
 FRU_FLT.2        “Limited fault tolerance“
 FPT_FLS.1        “Failure with preservation of secure state”
 FMT_LIM.1        “Limited capabilities”
 FMT_LIM.2        “Limited availability”
 FAU_SAS.1        “Audit storage”
 FDP_SDC.1        “Stored data confidentiality
 FDP_SDI.2        “Stored data integrity monitoring and action”
 FPT_PHP.3        “Resistance to physical attack”
 FDP_ITT.1        “Basic internal transfer protection”
 FPT_ITT.1        “Basic internal TSF data transfer protection
 FDP_IFC.1        “Subset information flow control”
 FCS_RNG.1/TRNG           “Random number generation - TRNG”
 FCS_RNG.1/DRNG           “Random number generation – DRG”
 FCS_RNG.1/DRNG4          “Random number generation – DRG”
 FCS_RNG.1/HPRG           “Random number generation – HPRG”
 FCS_COP.1/SCP/TDES “Cryptographic operation - TDES”
 FCS_COP.1/SCP/AES        “Cryptographic operation - AES”
 FCS_CKM.4/SCP            “Cryptographic key destruction”
 FCS_COP.1/SCL/TDES “Cryptographic operation – TDES by SCL”
 FCS_COP.1/SCL/AES        “Cryptographic operation – AES by SCL”
 FCS_CKM.4/SCL            “Cryptographic key destruction”
 FMT_LIM.1/Loader “Limited Capabilities – Loader”
 FMT_LIM.2/Loader “Limited availability – Loader”
 FTP_ITC.1 “Inter-TSF trusted channel”
 FDP_UCT.1 “Basic data exchange confidentiality”
 FDP_UIT.1 “Data exchange integrity”
 FDP_ACC.1/Loader “Subset access control – Loader”
 FDP_ACF.1/Loader “Security attribute based access control – Loader”
 FIA_API.1 “Authentication Proof of Identity”


Security Target                                          25                                                 v4.0
                                                                                                      2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Table 15 provides an overview about security functional requirements, which are added to the TOE. All
requirements are taken from [CCbook3] Part 2, with the exception of requirement FPT_TST.2, which is defined
in this ST completely.

Table 15      Additional security functional requirements of the TOE
 Security Functional Requirement
 FPT_TST.2        “Subset TOE security testing“
 FDP_ACC.1        “Subset access control”
 FDP_ACF.1        “Security attribute based access control”
 FMT_MSA.1        “Management of security attributes”
 FMT_MSA.3        “Static attribute initialisation”
 FMT_SMF.1        “Specification of Management functions”
 FMT_SMR.1        “Security Roles”
 FCS_COP.1/SCP/TDES-MAC           “Cryptographic operation – TDES MAC”
 FCS_COP.1/SCP/AES-MAC            “Cryptographic operation – AES-MAC”
 FCS_COP.1/RSA/<iteration> “Cryptographic Operation – RSA
 FCS_CKM.1/RSA/<iteration> “Cryptographic key management - RSA”
 FCS_CKM.4/RSA “Cryptographic key destruction - RSA”
 FCS_COP.1/ECC/<iteration> “Cryptographic Operation – ECC”
 FCS_CKM.1/ECC “Cryptographic key management - ECC”
 FCS_CKM.4/ECC “Cryptographic key destruction - ECC”
 FMT_MTD.1/Loader         “Management of TSF data”
 FMT_SMR.1/Loader         “Security roles”
 FMT_SMF.1/Loader         “Specification of Management Functions”
 FIA_UID.2/Loader         “User Identification before any action”

6.1.1               Definition required by [PP0084]
According to [PP0084] Application Note 14 the term “secure state” used by FPT_FLS.1 shall be described and a
definition should be provided.
Definition of secure state:
Secure state describes three different conditions of the TOE:
1. the controller ceases operation. This condition can only be resolved by a cold or warm start of the
   controller. It is triggered by a security reset.
2. the controller enters a security trap. The trap handler can be defined by the user. In case no trap handler is
   provided the first condition is entered.
3. in case of a sudden power loss of the TOE during NVM programming (tearing): the TOE is in a condition to
   either restore the old NVM content or to start with the new programmed value. This condition of security
   state is only provided in case the HSL is part of the TOE and one of the tearing-safe functions of the HSL is
   used.

Note:         a security reset invalidates the RAM content.



Security Target                                           26                                                   v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

According to [PP0084] Application Note 15, “The Common Criteria suggest that the TOE generates audit data
for the security functional requirements Limited fault tolerance (FRU_FLT.2) and Failure with preservation of
secure state (FPT_FLS.1).” In case of the first two conditions no Audit data are collected, because the effect
entering the secure state is immediately visible. For the third condition indirect audit data is available, i.e. the
user can check, whether new or old NVM data is available.

6.1.2                  Extended Components
An additional family (FCS_RNG) of the Class FCS (cryptographic support) is defined in [PP0084]. This family
describes the functional requirements for random number generation used for cryptographic purposes.
The functional requirements FCS_RNG.1/TRNG, FCS_RNG.1/HPRG, FCS_RNG.1/DRNG, FCS_RNG.1/DRNG4 are
iterations of the FCS_RNG.1 defined in [PP0084] refined in [BSI_RNGs].

6.1.2.1                True Random Number Generation, meeting AIS31 PTG.2
FCS_RNG.1/TRNG                     Random Number Generation
Hierarchical to                    No other components.
Dependencies                       No dependencies
FCS_RNG.1/TRNG                     Random numbers generation Class PTG.2 according to [BSI_RNGs]
FCS_RNG.1.1/TRNG                   The TSF shall provide a physical1 random number generator that implements:
PTG.2.1                            A total failure test detects a total failure of entropy source immediately when the
                                   RNG has started. When a total failure is detected, no random numbers will be
                                   output.
PTG.2.2                            If a total failure of the entropy source occurs while the RNG is being operated, the
                                   RNG prevents the output of any internal random number that depends on some
                                   raw random numbers that have been generated after the total failure of the
                                   entropy source.
PTG.2.3                            The online test shall detect non-tolerable statistical defects of the raw random
                                   number sequence (i) immediately when the RNG has started, and (ii) while the
                                   RNG is being operated. The TSF must not output any random numbers before the
                                   power-up online test has finished successfully or when a defect has been detected.
PTG.2.4                            The online test procedure shall be effective to detect non-tolerable weaknesses of
                                   the random numbers soon.2
PTG.2.5                            The online test procedure checks the quality of the raw random number sequence.
                                   It is triggered continuously. The online test is suitable for detecting non-tolerable
                                   statistical defects of the statistical properties of the raw random numbers within
                                   an acceptable period of time.
FCS_RNG.1.2/TRNG                   The TSF shall provide numbers in the format 8- or 16-bit3 that meet
PTG.2.6                            Test procedure A, as defined in [BSI_AIS31] does not distinguish the internal
                                   random numbers from output sequences of an ideal RNG.
PTG.2.7                            The average Shannon entropy per internal random bit exceeds 0.997.4



1
  [selection: physical, non-physical true, deterministic, hybrid physical, hybrid deterministic]
2
  [assignment: list of security capabilities]
3
  [assignment: format of the numbers]
4
  [assignment: a defined quality metric]

Security Target                                                      27                                               v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.1.2.2                Hybrid Random Number Generation, meeting AIS31 PTG.3
FCS_RNG.1/HPRG                     Random Number Generation
Hierarchical to                    No other components.
Dependencies                       No dependencies
FCS_RNG.1/HPRG                     Random numbers generation Class PTG.3 according to [BSI_RNGs]
FCS_RNG.1.1/HPRG                   The TSF shall provide a hybrid physical1 random number generator that
                                   implements:
PTG.3.1                            A total failure test detects a total failure of entropy source immediately when the
                                   RNG has started. When a total failure has been detected no random numbers will
                                   be output.
PTG.3.2                            If a total failure of the entropy source occurs while the RNG is being operated, the
                                   RNG prevents the output of any internal random number that depends on some
                                   raw random numbers that have been generated after the total failure of the
                                   entropy source.
PTG.3.3                            The online test shall detect non-tolerable statistical defects of the raw random
                                   number sequence (i) immediately when the RNG has started, and (ii) while the
                                   RNG is being operated. The TSF must not output any random numbers before the
                                   power-up online test and the seeding of the DRG.3 post-processing algorithm have
                                   been finished successfully or when a defect has been detected.
PTG.3.4                            The online test procedure shall be effective to detect non-tolerable weaknesses of
                                   the random numbers soon.
PTG.3.5                            The online test procedure checks the raw random number sequence. It is triggered
                                   continuously. The online test is suitable for detecting non-tolerable statistical
                                   defects of the statistical properties of the raw random numbers within an
                                   acceptable period of time.
                                   Note:
                                   Continuously means that the raw random bits are scanned continuously.
                                   The algorithmic post-processing belongs to Class DRG.3 with cryptographic state
                                   transition function and cryptographic output function. The output data rate of the
                                   post-processing algorithm shall not exceed its input data rate.
                                   End of note.
PTG.3.6                            The algorithmic post-processing algorithm belongs to Class DRG.3 with
                                   cryptographic state transition function and cryptographic output function, and
                                   the output data rate of the post-processing algorithm shall not exceed its input
                                   data rate.2
FCS_RNG.1.2/HPRG                   The TSF shall provide numbers in the format 8- or 16-bit3 that meet
PTG.3.7                            Statistical test suites cannot practically distinguish the internal random numbers
                                   from output sequences of an ideal RNG. The internal random numbers must pass
                                   test procedure A.4
PTG.3.8                            The internal random numbers shall use the PTRNG of class PTG.2 as random
                                   source for the post processing.

1
  [selection: physical, non-physical true, deterministic, hybrid physical, hybrid deterministic]
2
  [assignment: list of security capabilities]
3
  [assignment: format of the numbers]
4
  [assignment: a defined quality metric]

Security Target                                                      28                                               v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Note:          The internal random numbers produced by the employed PTG.2-conform PTRNG are adaptively
               compressed raw bits, where the compression rate is controlled by a so-called entropy estimator. The
               concept ensures that the random numbers provided by the PTRNG have high entropy, i.e., each
               delivered random byte will have more the 7.976 bit of entropy. In addition, the PTRNG produced
               random numbers have been tested against test procedures A and B under varying environment
               conditions.

6.1.2.3                Deterministic Random Number Generation (DRNG) AIS31 DRG.3
FCS_RNG.1/DRNG                     Random Number Generation
Hierarchical to                    No other components.
Dependencies                       No dependencies
FCS_RNG.1/DRNG                     Random numbers generation Class DRG.3 according to [BSI_RNGs]
FCS_RNG.1.1/DRNG                   The TSF shall provide a deterministic1 random number generator that
                                   implements:
DRG.3.1                            If initialized with a random seed using a PTRNG of class PTG.2 as random source
                                   the internal state of the RNG shall have at least 100 bit of entropy.
                                   Note:
                                   Furthermore, the length of the internal state shall have at least 200 bit. (For the
                                   DRG.3 under consideration, the internal state has 351 bit.). The seed is provided by
                                   a certified PTG.2 physical TRNG with guaranteed 7,976 bit of entropy per byte.
                                   End of note.
DRG.3.2                            The RNG provides forward secrecy.
DRG.3.3                            The RNG provides backward secrecy even if the current internal state is known.2
FCS_RNG.1.2/DRNG                   The TSF shall provide numbers in the format 8- or 16-bit3 that meet
DRG.3.4                            The RNG, initialized with a random seed, where the seed has at least 100 bit of
                                   entropy and is derived by a PTG.2 certified PTRNG. The RNG generates output for
                                   which any consecutive 234 strings of bit length 128 are mutually different with a
                                   probability that is greater than 1 – 2(-16).
DRG3.5                             Statistical test suites cannot practically distinguish the random numbers from the
                                   output sequences of an ideal RNG. The random numbers must pass test procedure
                                   A and the U.S. National Institute of Standards and Technology (NIST) test suite for
                                   RNGs used for cryptographic purposes [N800-22]containing following 16 tests:
                                   Frequency (Monobit) Test, Frequency Test within a Block, Runs Tests, Test for the
                                   Longest-Run-of-Ones in a Block, Binary Matrix Rank Test, Discrete Fourier
                                   Transform (Spectral) Test, Non-overlapping (Aperiodic) Template Matching Test,
                                   Overlapping (Periodic) Template Matching Test, Maurer´s “Universal Statistical”
                                   Test, Liner Complexity Test, Serial Test, Approximate Entropy Test, Cumulative
                                   Sums (Cusums) Test, Random Excursions Test and Random Excursions Variant
                                   Test.4




1
  [selection: physical, non-physical true, deterministic, hybrid physical, hybrid deterministic]
2
  [assignment: list of security capabilities]
3
  [assignment: format of the numbers]
4
  [assignment: a defined quality metric]

Security Target                                                      29                                              v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.1.2.4                Deterministic Random Number Generation (DRNG) AIS31 DRG.4
FCS_RNG.1/DRNG4                    Random Number Generation
Hierarchical to                    No other components.
Dependencies                       No dependencies
FCS_RNG.1/DRNG4                    Random numbers generation Class DRG.4 according to [BSI_RNGs]
FCS_RNG.1.1/DRNG4                  The TSF shall provide a hybrid deterministic 1 random number generator that
                                   implements:
DRG.4.1                            The internal state of the RNG shall use PTRNG of class PTG.2 as random source
DRG.4.2                            The RNG provides forward secrecy.
DRG.4.3                            The RNG provides backward secrecy even if the current internal state is known.2
DRG.4.4                            The RNG provides enhanced forward secrecy on demand.
DRG.4.5                            The internal state of the RNG is seeded by an PTRNG of class PTG.2.
FCS_RNG.1.2/DRNG4                  The TSF shall provide numbers in the format 32-bit3 that meet
DRG.4.6                            The RNG generates output for which any consecutive 234 strings of bit length 128
                                   are mutually different with a probability that is greater than 1 – 2(-16).
DRG4.7                             Statistical test suites cannot practically distinguish the random numbers from the
                                   output sequences of an ideal RNG. The random numbers must pass test procedure
                                   A.

Note:          The enhanced forward secrecy is assured by reseeding the internal state, which may be initiated on
               user demand (at any time).

6.1.2.5                FAU_SAS
The [PP0084] defines additional security functional requirements with the family FAU_SAS of the class FAU
(Security Audit). This family describes the functional requirements for the storage of audit data. It has a more
general approach than FAU_GEN, because it does not necessarily require the data to be generated by the TOE
itself and because it does not give specific details of the content of the audit records.
The TOE shall meet the requirement “Audit storage (FAU_SAS.1)” as specified below (Common Criteria Part 2
extended).

FAU_SAS.1                          Audit Storage
Hierarchical to:                   No other components.
Dependencies:                      No dependencies
FAU_SAS.1.1                        The TSF shall provide the test process before TOE Delivery4 with the capability to
                                   store the Initialization Data and/or Pre-personalization Data and/or supplements
                                   of the Security IC Embedded Software5 in the access protected and not
                                   changeable configuration page area and non-volatile memory6.



1
  [selection: physical, non-physical true, deterministic, hybrid physical, hybrid deterministic]
2
  [assignment: list of security capabilities]
3
  [assignment: format of the numbers]
4
  [assignment: list of subjects]
5
  [assignment: list of audit information]
6
  [assignment: type of persistent memory]

Security Target                                                      30                                             v4.0
                                                                                                              2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.1.3                   Support of Cipher Schemes

6.1.3.1                 Cipher schemes provided by the SCP
FCS_COP.1/<iteration>              Cryptographic operation
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                                   or
                                   FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                                   FCS_CKM.1 Cryptographic key management]
                                   FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/<iteration>            The TSF shall perform [assignment: list of cryptographic operations] in accordance
                                   with a specified cryptographic algorithm [assignment: cryptographic algorithm]
                                   and cryptographic key sizes of [assignment: cryptographic key sizes]that meet
                                   the following standards: [assignment: list of standards]

The operations performed in this SFR are defined in the following table. Please note that <iteration> is a
placeholder for different SFR iterations defined in the first column.

Table 16         Cryptographic table for FCS_COP.1
    <iteration>       [assignment:       [assignment:       [assignment:                [assignment: list of standards]
                      list of            cryptographic      cryptographic key sizes]
                      cryptographic      algorithm]
                      operations]
    SCP/TDES          encryption and     TDES in ECB        112 bit, 168 bit            [N800-67B], [N800-38A],
                      decryption         mode, CBC mode                                 [ISO18033_3]
    SCP/AES           encryption and     AES in ECB mode,   128 bit, 192 bit, 256 bit   [N197], [N800-38A],
                      decryption         CBC mode                                       [ISO18033_3]



FCS_CKM.4/SCP                      Cryptographic key destruction
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/SCP                    The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method overwriting or zeroing1 that meets the
                                   following: None2



6.1.3.2                 Cipher schemes provided by the SCL
FCS_COP.1/<iteration>              Cryptographic operation
Hierarchical to:                   No other components.


1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               31                                                     v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Dependencies:                      [FDP_ITC.1 Import of user data of the Composite TOE without security attributes,
                                   or
                                   FDP_ITC.2 Import of user data of the Composite TOE with security attributes, or
                                   FCS_CKM.1 Cryptographic key management]
                                   FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/<iteration>            The TSF shall perform [assignment: list of cryptographic operations] in accordance
                                   with a specified cryptographic algorithm [assignment: cryptographic algorithm]
                                   and cryptographic key sizes of [assignment: cryptographic key sizes]that meet
                                   the following standards: [assignment: list of standards]

The operations performed in this SFR are defined in the following table. Please note that <iteration> is a
placeholder for different SFR iterations defined in the first column.

Table 17         Cryptographic table for FCS_COP.1
    <iteration>       [assignment:       [assignment:       [assignment:                [assignment: list of standards]
                      list of            cryptographic      cryptographic key sizes]
                      cryptographic      algorithm]
                      operations]
    SCL/TDES          encryption and     TDES in ECB        112 bit, 168 bit            [N800-67B], [N800-38A]
                      decryption         mode, CBC mode,
                                         CTR mode, CFB
                                         mode
    SCL/AES           encryption and     TDES in ECB        128 bit, 192 bit, 256 bit   [N197], [N800-38A]
                      decryption         mode, CBC mode,
                                         CTR mode, CFB
                                         mode
    SCL/TDES-         MAC                TDES in CMAC       112 Bit, 168 Bit            [N800-67B] (TDES), [N800-38B]
    MAC               generation and     mode and Retail                                (MAC), [ISO9797B] (Retail MAC)
                      verification       MAC mode
                                         (Algorithm 3)
    SCL/AES-          MAC                AES in CMAC        128 Bit, 192 Bit, 256 Bit   [N197] (AES), [N800-38B] (MAC)
    MAC               generation and     mode
                      verification



FCS_CKM.4/SCL                             Cryptographic key destruction
Hierarchical to:                          No other components.
Dependencies:                             [FDP_ITC.1 Import of user data without security attributes, or
                                          FDP_ITC.2 Import of user data with security attributes, or
                                          FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/SCL                           The TSF shall destroy cryptographic keys in accordance with a specified
                                          cryptographic key destruction method overwriting or zeroing1 that meets
                                          the following:
                                          None2

Note:            The TOE can be delivered with or without the SCL. If the user decides not to use the SCL, the SFRs in
                 this chapter are not part of the TOE.

1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               32                                                      v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)



6.1.3.3             Rivest-Shamir-Adleman (RSA)
For cryptographic RSA functionality, the TOE shall meet the requirement cryptographic operation (FCS_COP.1)
and cryptographic key construction (FCS_CKM .1) as specified below:

FCS_COP.1/RSA/<iteration>           Cryptographic operation
Hierarchical to:                    No other components.
Dependencies:                       [FDP_ITC.1 Import of user data of the Composite TOE without security
                                    attributes, or
                                    FDP_ITC.2 Import of user data of the Composite TOE with security
                                    attributes, or
                                    FCS_CKM.1 Cryptographic key management]
                                    FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/RSA/<iteration>         The TSF shall perform [assignment: list of cryptographic operations] in
                                    accordance with a specified cryptographic algorithm [assignment:
                                    cryptographic algorithm]
                                    and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                    meet the following standards: [assignment: list of standards]




Table 18      Cryptographic table for FCS_COP.1/RSA
 <iteration>       [assignment:     [assignment:        [assignment:          [assignment: list of standards]
                   list of          cryptographic       cryptographic key
                   cryptographic    algorithm]          sizes]
                   operations]
 ENC               RSA              RSAEP,              512 – 2112 Bits       [RSA-PKCSB], ch. 5.1.1
                   encryption       IFEP-RSA                                  [IEEE1363], ch. 8.2.2
 DEC               RSA              RSADP,              512 – 2112 Bits       [RSA-PKCSB], ch. 5.1.2
                   decryption       IFDP-RSA                                  [IEEE1363], ch. 8.2.1(I) and 8.2.3
 DEC_CRT           RSA              RSADP (CRT),        512 – 4224 Bits       [RSA-PKCSB], ch. 5.1.2
                   decryption       IFDP-RSA (CRT)                            [IEEE1363], ch. 8.2.1(II) and 8.2.3
 SIG               RSA signature    RSASP1              512 – 2112 Bits       [RSA-PKCSB], ch. 5.2.1
                   generation       IFSP-RSA1                                 [IEEE1363], ch. 8.2.1(I) and 8.2.4
 SIG_CRT           RSA signature    RSASP1 (CRT)        512 – 4224 Bits       [RSA-PKCSB], ch. 5.2.1
                   generation       IFSP-RSA1 (CRT)                           [IEEE1363], ch. 8.2.1(II) and 8.2.4
 VER               RSA              RSAVP1              512 – 4224 Bits       [RSA-PKCSB], ch. 5.2.2
                   signature        IFVP-RSA1                                 [IEEE1363], ch. 8.2.5
                   verification

Note:         RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.1/RSA/<iteration>           Cryptographic key generation
Hierarchical to:                    No other components.
Dependencies:                       FCS_CKM.2 Cryptographic key distribution, or

Security Target                                           33                                                       v4.0
                                                                                                             2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                          FCS_COP.1 Cryptographic operation]
                                          FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/RSA/<iteration>               The TSF shall generate cryptographic keys in accordance with a specified
                                          cryptographic key generation algorithm [assignment: list of cryptographic
                                          operations]and specified cryptographic key sizes of [assignment:
                                          cryptographic key sizes that meet the following: [assignment: list of
                                          standards]



Table 19         Cryptographic table for FCS_CKM.1/RSA/
<iteration> Operation                                        Key size (bits)                Standards
CRT               IFX RSA CRT key generation                 512 – 4224 Bits                [RSA-PKCSB], ch. 3.1 and
                                                                                            3.2 (2)
                                                                                            [IEEE1363], ch. 8.1.3.1(2)
n_d               IFX RSA key generation (i.e. without       512 - 2112 Bits                [RSA-PKCSB] , ch. 3.1 and
                  CRT) and return of (n, d)                                                 3.2 (1)
                                                                                            [IEEE1363] , ch. 8.1.3.1(1)
p_q_d             IFX RSA key generation (i.e. without       512 – 2112 Bits                [IEEE1363] , ch. 8.1.3.1(3)
                  CRT) and return of (p , q, d)

Note:            RSA CRT is with 2 primes only, i.e. always with u = 2 in [RSA-PKCSB]

FCS_CKM.4/RSA                      Cryptographic key destruction
Hierarchical to:                   No other components.
Dependencies:                      [FDP_ITC.1 Import of user data without security attributes, or
                                   FDP_ITC.2 Import of user data with security attributes, or
                                   FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/RSA                    The TSF shall destroy cryptographic keys in accordance with a specified
                                   cryptographic key destruction method destruction of RAM key during system or
                                   power on reset1 that meets the following: None2

Note:            The TOE can be delivered with or without the optional RSA library. If the RSA library is not deliverd, the
                 TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
                 delivered cryptographic RSA library cannot be used and therefore the SFRs of this chapter are also not
                 applicable.

6.1.3.4                 Elliptic Curve Cryptography (ECC)
For cryptographic ECC functionality, the TOE shall meet the requirement cryptographic operation (FCS_COP.1)
and cryptographic key construction (FCS_CKM .1) as specified below:

FCS_COP.1/ECC/<iteration>                 Cryptographic operation
Hierarchical to:                          No other components.
Dependencies:                             [FDP_ITC.1 Import of user data of the Composite TOE without security
                                          attributes, or

1
    [assignment: cryptographic key destruction method]
2
    [assignment: list of standards]

Security Target                                               34                                                       v4.0
                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                     FDP_ITC.2 Import of user data of the Composite TOE with security
                                     attributes, or
                                     FCS_CKM.1 Cryptographic key management]
                                     FCS_CKM.4 Cryptographic key destruction.
FCS_COP.1.1/ECC/<iteration>          The TSF shall perform [assignment: list of cryptographic operations] in
                                     accordance with a specified cryptographic algorithm [assignment:
                                     cryptographic algorithm]
                                     and cryptographic key sizes of [assignment: cryptographic key sizes]that
                                     meet the following standards: [assignment: list of standards]

Table 20      Cryptographic table for FCS_COP.1/ECC
 <iteration>      [assignment: list of     [assignment: [assignment:             [assignment: list of standards]
                  cryptographic            cryptographic cryptographic
                  operations]              algorithm]    key sizes]

 SIG              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.3
                  generation               ECSP-DSA                              [IEEE1363], ch. 7.2.7
 VER              EC signature             ECDSA             160 – 521 Bits      [ANSX9.62], ch. 7.4.1
                  verification             ECVP-DSA                              [IEEE1363], ch. 7.2.8
 DH               ECDH key agreement ECDH                    160 – 521 Bits      [ANSX9.63], ch. 5.4.1
                                     ECSVHDP-DH                                  [ISO11770_3], appendix D.6
                                                                                 [IEEE1363], ch. 7.2.1
 ADD              EC point addition        C = A+B           160 – 521 Bits      n.a.

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

Note:         For the /SIG iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step d) is not supported

Note:         For the /VER iteration, the following deviations from the standards apply:
              In [ANSX9.62]:
              Step b) is not supported.
              Beside noted calculation, our algorithm adds a random multiple of order of the basepoint to the
              calculated values u1 and u2.

Note:         For the/ DH iteration, the implementation always returns the y-coordinate in addition to the x-
              coordinate.

Note:         For the /ADD iteration, the elliptic curve points A, B and C are considered as secrets.

Note:         Cofactor multiplication is not supported

FCS_CKM.1/ECC                 Cryptographic key generation
Hierarchical to               No other components.
Dependencies                  FCS_CKM.2 Cryptographic key distribution, or
                              FCS_COP.1 Cryptographic operation]

Security Target                                            35                                                    v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                FCS_CKM.4 Cryptographic key destruction
FCS_CKM.1.1/ECC                 The TSF shall generate cryptographic keys in accordance with a specified
                                cryptographic key generation algorithm EC key generation1 and specified
                                cryptographic key sizes of 160-521 bits2 that meet the following: [ANSX9.62], ch.
                                A4.3 and [IEEE1363], ch. A.16.9.3

Note:         The following ECC curves are in scope of this evaluation:
              - all Brainpool curves from [IETF5639]
              - all NIST curves from [N186-4]

FCS_CKM.4/ECC                   Cryptographic key destruction
Hierarchical to:                No other components.
Dependencies:                   [FDP_ITC.1 Import of user data without security attributes, or
                                FDP_ITC.2 Import of user data with security attributes, or
                                FCS_CKM.1 Cryptographic key generation]
FCS_CKM.4.1/ECC                 The TSF shall destroy cryptographic keys in accordance with a specified
                                cryptographic key destruction method destruction of RAM key during system or
                                power on reset4 that meets the following: None5


Note:         The TOE can be delivered with or without the optional ECC library. If the ECC library is not deliverd, the
              TOE does not provide the SFRs of this chapter. In case of a blocked Crypto@2304T the optionally
              delivered cryptographic ECClibrary cannot be used and therefore this SFR is also not applicable. .




6.1.4                Subset of TOE testing
The security is strongly dependent on the correct operation of the security functions. Therefore, the TOE shall
support that particular security functions or mechanisms are tested in the operational phase (Phase 7). The
tests can be initiated by the Smartcard Embedded Software and/or by the TOE.
The TOE shall meet the requirement “Subset TOE testing (FPT_TST.2)” as specified below (Common Criteria
Part 2 extended).

FPT_TST.2                       Subset TOE testing
Hierarchical to:                No other components.
Dependencies:                   No dependencies
FPT_TST.2.1                     The TSF shall run a suite of self tests at the conditions request of the Security IC
                                Embedded Software1 to demonstrate the correct operation of the alarm lines
                                and/or the environmental sensor mechanisms:


1
  [assignment: list of cryptographic operations]
2
  [assignment: cryptographic key sizes
3
  [assignment: list of standards]
4
  [assignment: cryptographic key destruction method]
5
  [assignment: list of standards]

Security Target                                             36                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

                                       Please refer to the confidential Security Target2


6.1.5                  Memory access control
Usage of multiple applications in one Smartcard often requires code and data separation in order to prevent
that one application can access code and/or data of another application. For this reason the TOE provides Area
based Memory Access Control. The underlying Memory Protection Unit (MPU) is documented in Appendix B3.5
of the ARMv7 M architecture reference manual [ARMv7M].
In particular, the MPU provides full support for:
 Protection regions.
 Overlapping protection regions, with ascending region priority:
  − Region 7 = highest priority.
  − Region 0 = lowest priority.
 Access permissions.
   MPU mismatches and permission violations invoke the programmable-priority MemManage fault handler.

The MPU can be used to:
   Enforce privilege rules, preventing user applications from corrupting operating system data.
   Separate processes, blocking the active task from accessing other tasks’ data.
   Enforce access rules, allowing memory regions to be defined as read-only or detecting unexpected memory
    accesses.

The SFRs are provided by the Memory Access Control Policy (FDP_ACC.1 and dependencies).


6.1.5.1                Subjects, objects and operations of the Memory Access Control Policy
Subjects:
 MPU

Objects:
 memory/code addresses

Operations:
 Read a/o write a/o execute access


6.1.5.2                Security attributes of the Memory Access Control Policy
Security Attribute which define the roles for Subject MPU:
 Npriv flag defining privilege/non-privilege mode


Security Attribute which control the behavior of the Subject MPU:



1
  [selection: during initial start-up, periodically during normal operation, at the request of the authorized user, and/or at the conditions
     [assignment: conditions under which self test should occur]]
2
  [assignment: functions and/or mechanisms]

Security Target                                                      37                                                                 v4.0
                                                                                                                                  2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 MPU enable/disable bit.
 8 regions with the following attributes
    − a unique priority
    − the enable bit
    − the xn (execute never) bit
    − the start address and size
    − an access matrix which defines if an Operation of the MPU (Subject) to a memory/code address (Object)
     lying in the region is allowed or denied
 A bit defining the acces behavior of the default region, i.e. memory/code addresses not covered by one of the
  8 MPU regions.


Security Attributes for objects:
There are no security attributes for objects.


6.1.5.3            Access control rules of the Memory Access Control Policy
The following generic rules shall apply in case the MPU is enabled. In case the MPU is disabled, a privileged and
unprivileged code has full read/write/execute rights to all addresses.
 If an address is contained in multiple enabled regions, then the region with the highest priority defines the
    access rights.
   If an address is contained in no region then the default region defines the access rights.
   The region defining the access rights checks if the Subject has access to the Object with respect to the desired
    Operation. In case the access is denied the MPU throws an access violation exception. The checks are done
    according to the access matrix inTable 21.
   overlapping regions, have access to other regions with ascending region priority:
    region 7 = highest priority, region 0 = lowest priority
   execution of code is bound to the read access of Table 21 and the xn bit. If the xn bit is cleared and read
    access is enabled then execution of code is defined by Table 21. If the xn bit is set then execution is never
    allowed.

Table 21      Access matrix for read(execute)/write access
 Privileged Mode Permissions            User Mode                             Description
                                        Permissions
 No access                              No access                             All accesses in user mode and
                                                                              privileged mode generate a
                                                                              permission fault
 Read/write                             No access                             Privilege mode has full access
                                                                              while any access from user mode
                                                                              leads to a permission fault.
 Read/write                             Read(execute) only                    Privileged mode has full access
                                                                              while the user mode has no write
                                                                              access rights. Execute access in
                                                                              User mode further depends on the
                                                                              xn bit.
 Read/write                             Read(execute)/write                   Privileged mode has read and
                                                                              execute access rights. Write

Security Target                                         38                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Privileged Mode Permissions                 User Mode                                      Description
                                                Permissions
                                                                                               accesses from privileged mode
                                                                                               lead to a permission fault.
                                                                                               Any access of the user mode leads
                                                                                               to a permission fault.
    Read only                                   No access                                      Privileged mode has read and
                                                                                               execute access rights. Write
                                                                                               accesses lead to a permission
                                                                                               fault.
                                                                                               The same holds for the user mode,
                                                                                               except execute access further
                                                                                               depends on the xn bit.
    Read only                                   Read(execute) only                             All accesses in user mode and
                                                                                               privileged mode generate a
                                                                                               permission fault


6.1.5.4                SFRs of the Memory Access Control Policy
FDP_ACC.1                    Subset access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACF.1 Security attribute based access control
FDP_ACC.1.1                  The TSF shall enforce the Memory Access Control Policy as1 defined in section 6.1.5.12.


FDP_ACF.1                    Security attribute based access control
Hierarchical to:             No other components.
Dependencies:                FDP_ACC.1 Subset access control
                             FMT_MSA.3 Static attribute initialization
FDP_ACF.1.1                  The TSF shall enforce the Memory Access Control Policy3 to objects based on the
                             following: Attributes as specified in section 6.1.5.24 .
FDP_ACF.1.2                  The TSF shall enforce the following rules to determine if an operation among
                             controlled subjects and controlled objects is allowed: As specified in the section
                             6.1.5.35.
FDP_ACF.1.3                  The TSF shall explicitly authorize access of subjects to objects based on the following
                             additional rules: none6.
FDP_ACF.1.4                  The TSF shall explicitly deny access of subjects to objects based on the following
                             additional rules: none1.


1
  editorially refined
2
  [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]
3
  [assignment: access control SFP]
4
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
5
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
6
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]

Security Target                                                      39                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)


FMT_MSA.3                    Static attribute initialization
Hierarchical to:             No other components.
Dependencies:                FMT_MSA.1 Management of security attributes
                             FMT_SMR.1 security roles
FMT_MSA.3.1                  The TSF shall enforce the Memory Access Control Policy2 to provide restrictive3 default
                             values for security attributes that are used to enforce the SFP.
FMT_MSA.3.2                  The TSF shall allow the privilege mode4 to specify alternative initial values to override
                             the default values when an object or information is created.


FMT_MSA.1                    Management of security attributes
Hierarchical to:             No other components.
Dependencies:                [FDP_ACC.1 Subset access control or FDP_IFC.1 Subset information flow control]
                             FMT_SMF.1 Specification of management functions
                             FMT_SMR.1 Security roles
FMT_MSA.1.1                  The TSF shall enforce the Memory Access Control Policy5 to restrict the ability to
                             modify6 the security attributes Security Attribute which control the behavior of the
                             Subject MPU7 to the privilege mode8.


FMT_SMF.1                    Specification of management functions
Hierarchical to:             No other components
Dependencies:                No dependencies
FMT_SMF.1.1                  The TSF shall be capable of performing the following security management functions:
                             modifying the security attributes9.


FMT_SMR.1                    Security roles
Hierarchical to:             No other components.
Dependencies:                FIA_UID.1 Timing of identification
FMT_SMR.1.1                  The TSF shall maintain the roles privilege mode and non-privilege mode10.
FMT_SMR.1.2                  The TSF shall be able to associate users with roles.

6.1.6                  Data Integrity
FDP_SDI.2                    Stored data integrity monitoring and action


1
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
2
  [assignment: access control SFP, information flow control SFP]
3
  [selection, choose one of: restrictive, permissive, [assignment: other property]]
4
  [assignment: the authorised identified roles]
5
  [assignment: access control SFP(s), information flow control SFP(s)]
6
  [selection: change_default, query, modify, delete, [assignment: other operations]]
7
  [assignment: list of security attributes]
8
  [assignment: the authorised identified roles]
9
  [assignment: list of management functions to be provided by the TSF]
10
   [assignment: the authorised identified roles]

Security Target                                                       40                                             v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Hierarchical to:             FDP_SDI.1 stored data integrity monitoring
Dependencies:                No dependencies
FDP_SDI.2.1                  The TSF shall monitor user data stored in containers controlled by the TSF for data
                             integrity and one- and/or more-bit-errors1 on all objects, based on the following
                             attributes: error correction ECC for the SOLID FLASHҹ NVM2.
FDP_SDI.2.2                  Upon detection of a data integrity error, the TSF shall correct 1 bit errors in the SOLID
                             FLASHҹ NVM automatically and inform the user about other bit errors3.



FDP_SDC.1                    Stored data confidentiality
Hierarchical to:             No other components
Dependencies:                No dependencies
FDP_SDC.1.1                  The TSF shall ensure the confidentiality of the information of the user data while it is
                             stored in the RAM and SOLID FLASHҹ NVM4.




6.1.7                  Support of Flash Loader
The TOE provides a Flash Loader to download user data into the SOLID FLASHҹ NVM, either during production
of the TOE or at customer site. Depending on the configuration option EA the Flash Loader claims different sets
of SFRs. [PP0084] section 7.3.1 “Package 1: Loader dedicated for usage in secured environment only” is claimed
for both options. [PP0084] section 7.2 Package “Authentication of the Security IC” and [PP0084] section 7.3.2
“Package 2: Loader dedicated for usage by authorized users only” is only claimed in case TOE is ordered with
EA unavailable, however a subset of SFRs from loader package 2 is also claimed, if TOE is ordered with EA
available.




6.1.8                  Flash Loader Policy
The table as follows shows the Flash Loader SFR claims in dependency of the order option EA.

Table 22       Flash loader SFR claims
EA unavailable                                                  EA available
Limited capabilities (FMT_LIM.1/Loader)                         Limited capabilities (FMT_LIM.1/Loader)
Limited availability – Loader (FMT_LIM.2/Loader)                Limited availability – Loader (FMT_LIM.2/Loader)
Authentication Proof of Identity (FIA_API.1)                    -
Inter-TSF trusted channel (FTP_ITC.1)                           -
Basic data exchange confidentiality (FDP_UCT.1)                 Basic data exchange confidentiality (FDP_UCT.1)
Data exchange integrity (FDP_UIT.1)                             Data exchange integrity (FDP_UIT.1)

1
  [assignment: integrity errors]
2
  [assignment: user data attributes]
3
  [assignment: action to be taken]
4
  [assignment: memory area]

Security Target                                               41                                                      v4.0
                                                                                                                2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

EA unavailable                                                EA available
Subset access control – Loader (FDP_ACC.1/Loader)             Subset access control – Loader (FDP_ACC.1/Loader)
Security attribute based access control – Loader              Security attribute based access control – Loader
(FDP_ACF.1/Loader)                                            (FDP_ACF.1/Loader)
Management of TSF data – Loader                               Management of TSF data – Loader
(FMT_MTD.1/Loader)                                            (FMT_MTD.1/Loader)
Security Roles – Loader (FMT_SMR.1/Loader)                    Security Roles – Loader (FMT_SMR.1/Loader)
Specification of Management Functions – Loader                Specification of Management Functions – Loader
(FMT_SMF.1/Loader)                                            (FMT_SMF.1/Loader)
User Identification before any action – Loader                User Identification before any action – Loader
(FIA_UID.2/Loader)                                            (FIA_UID.2/Loader)



The TOE shall meet the loader SFRs as specified below:

FMT_LIM.1/Loader            Limited Capabilities
    Hierarchical to:         No other components.
    Dependencies:            No other components
    FMT_LIM.1.1/Loader       The TSF shall be designed and implemented in a manner that limits its capabilities so
                             that in conjunction with “Limited availability (FMT_LIM.2)” the following policy is
                             enforced: Deploying Loader functionality after permanent deactivation does not
                             allow stored user data to be disclosed or manipulated by unauthorized user1.



FMT_LIM.2/Loader            Limited availability - Loader
    Hierarchical to:         No other components.
Dependencies:               FMT_LIM.1 Limited capabilities.
    FMT_LIM.2.1/Loader       The TSF shall be designed in a manner that limits its availability so that in conjunction
                             with “Limited capabilities (FMT_LIM.1)” the following policy is enforced: The TSF
                             prevents deploying the Loader functionality after permanent deactivation2.

Regarding FMT_LIM.1.1/Loader the User Guidance requires the Flash Loader to be permanently deactivated
prior delivery to the end user (Phase 7).
 FTP_ITC.1               Inter-TSF trusted channel
    Hierarchical to:         No other components.
    Dependencies:            No dependencies.
    FTP_ITC.1.1              The TSF shall provide a communication channel between itself and administrator
                             user, or Download operator user3, that is logically distinct from other communication
                             channels and provides assured identification of its end points and protection of the
                             channel data from modification or disclosure.




1
  [assignment: Limited capability policy]
2
  [assignment: Limited availability policy]
3
  [assignment: users authorized for using the Loader]

Security Target                                             42                                                       v4.0
                                                                                                               2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    FTP_ITC.1.2              The TSF shall permit another trusted IT product1 to initiate communication via the
                             trusted channel.
    FTP_ITC.1.3              The TSF shall initiate communication via the trusted channel for deploying Loader for
                             downloading user data2.

    FDP_UCT.1                Basic data exchange confidentiality
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP3 to receive4 user data in a manner protected
                             from unauthorised disclosure.

    FDP_UIT.1                Data exchange integrity
    Hierarchical to:         No other components.
    Dependencies:            [FTP_ITC.1 Inter-TSF trusted channel, or FTP_TRP.1 Trusted path]
                             [FDP_ACC.1 Subset access control, or FDP_IFC.1 Subset information flow control]
    FDP_UCT.1.1              The TSF shall enforce the Loader SFP5 to receive6 user data in a manner protected
                             from modification, deletion, insertion7 errors.
FDP_UIT.1.2                 The TSF shall be able to determine on receipt of user data, whether modification,
                            deletion, insertion8 has occurred.



FDP_ACC.1/Loader            Subset access control - Loader
    Hierarchical to:         No other components.
    Dependencies:            FDP_ACF.1 Security attribute based access control.
    FDP_ACC.1.1/Loader       The TSF shall enforce the Loader SFP9 on
                              the subjects Administrator User, Download Operator User and Image Provider,
                              the objects user data in SOLID FLASHҹ NVM memory of the TOE,
                              the operation deployment of Loader10




    FDP_ACF.1/Loader         Security attribute based access control - Loader
    Hierarchical to:         No other components.


1
  [selection: the TSF, another trusted IT product]
2
  [assignment: list of functions for which a trusted channel is required][assignment: rules]
3
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
4
  [selection: transmit, receive]
5
  [assignment: access control SFP(s) and/or information flow control SFP(s)]
6
  [selection: transmit, receive]
7
  [selection: modification, deletion, insertion, replay]
8
  [selection: modification, deletion, insertion, replay]
9
  [assignment: access control SFP]
10
   [assignment: list of subjects, objects, and operations among subjects and objects covered by the SFP]

Security Target                                                    43                                            v4.0
                                                                                                           2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:             FMT_MSA.3 Static attribute initialisation
    FDP_ACF.1.1/Loader        FDP_ACF.1.1 The TSF shall enforce the Loader SFP1 to objects based on the following:
                              the subjects and objects of FDP_ACC.1.1/Loader without security attributes2
    FDP_ACF.1.2/Loader        FDP_ACF.1.2 The TSF shall enforce the following rules to determine if an operation
                              among controlled subjects and controlled objects is allowed:
                              The authenticated Administrator User or authenticated Download Operator User can
                              modify the user data by new user data when the new user data is authorized by the
                              Image Provider3
    FDP_ACF.1.3/Loader        FDP_ACF.1.3 The TSF shall explicitly authorise access of subjects to objects based on
                              the following additional rules: none4.
    FDP_ACF.1.4/Loader        The TSF shall explicitly deny access of subjects to objects based on the following
                              additional rules: none5.

Note:          The security functional requirements FIA_API.1, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1, FDP_ACC.1/Loader
               and FDP_ACF.1/Loader apply only to TOE products with activated Flash Loader. In other cases the
               Flash Loader is not available anymore and the user data download is completed.

The following SFRs have been added to the SFRs from Flash Loader package 2 of [PP0084] in order to describe
the management of the various Flash Loader authentication keys.



FMT_MTD.1/Loader               Management of TSF data
    Hierarchical to:           No other components.
    Dependencies:              FMT_SMR.1 Security roles
                               FMT_SMF.1 Specification of Management Functions
    FMT_MTD.1.1/Loader         The TSF shall restrict the ability to change_default, modify, delete6 the Authentication
                               keys for Administrator User, Download Operator User and Image Provider7 to
                               Administrator User, Download Operator User8.

Note:          The Administrator User can manage the keys for Administration User, Download Operator User and
               Image Provider. The Download Operator User can delete the key for Image Provider and Download
               Operator, otherwise manage the keys for the Download Operator User only. The image provider cannot
               modify any keys or perform authentication with the Flash Loader. It can simply built authentic
               loadable images.

FMT_SMR.1/Loader               Security roles
    Hierarchical to:           No other components.


1
  [assignment: access control SFP]
2
  [assignment: list of subjects and objects controlled under the indicated SFP, and for each, the SFP-relevant security attributes, or
     named groups of SFP-relevant security attributes]
3
  [assignment: rules governing access among controlled subjects and controlled objects using controlled operations on controlled
     objects]
4
  [assignment: rules, based on security attributes, that explicitly authorise access of subjects to objects]
5
  [assignment: rules, based on security attributes, that explicitly deny access of subjects to objects]
6
  [selection: change_default, query, modify, delete, clear, [assignment: other operations]]
7
  [assignment: list of TSF data]
8
  [assignment: the authorised identified roles]

Security Target                                                      44                                                                v4.0
                                                                                                                                 2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMR.1.1/Loader       The TSF shall maintain the roles Administrator User, Download Operator User, Image
                             provider1.
    FMT_SMR.1.2/Loader       The TSF shall be able to associate users with roles.



FMT_SMF.1/Loader             Specification of Management Functions
    Hierarchical to:         No other components.
    Dependencies:            FIA_UID.1 Timing of identification
    FMT_SMF.1.1/Loader       The TSF shall be capable of performing the following management functions: Change
                             Key, Invalidate Key2.

Note:          “Change Key” of this SFR combines the “Change default” and “modify” operations from SFR
               FMT_MTD.1/Loader. “Invalidate Key” of this SFR is equivalent to the “delete” operation from SFR
               FMT_MTD.1/Loader.

    FIA_UID.2/Loader         User Identification before any action
    Hierarchical to:         FIA_UID.1
    Dependencies:            No dependencies.
    FIA_UID.2.1/Loader       The TSF shall require each user to be successfully identified before allowing any other
                             TSF-mediated actions on behalf of that user.


6.1.9                  Support of Authentication of the Security IC
The Flash Loader provides a security IC authentication service.



FIA_API.1                   Authentication Proof of Identity
Hierarchical to:            No other components.
Dependencies:               No dependencies.
FIA_API.1.1                 The TSF shall provide a authentication mechanism according to [ISO9798_2] section
                            6.2.2 Mechanism 4: Three-pass authentication3 to prove the identity of the TOE4 to an
                            external entity.

This security functional requirement applies only to TOE products with Flash Loader activated and TOE is
ordered with EA unavailable.

6.2                    TOE Security Assurance Requirements
The evaluation assurance level is EAL6 augmented with ALC_FLR.1. In the following table, the security
assurance requirements are given.


1
  [assignment: the authorised identified roles]
2
  [assignment: list of management functions to be provided by the TSF]
3
  [assignment: authentication mechanism]
4
  [selection: TOE, [assignment: object, authorized user or role]]

Security Target                                                   45                                              v4.0
                                                                                                            2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Table 23      Assurance components
 Aspect                    Acronym          Description                                Refinement
 Development               ADV_ARC.1        Security Architecture Description          [PP0084]
                           ADV_FSP.5        Complete semi-formal functional            [PP0084]
                                            specification with additional error
                                            information
                           ADV_IMP.2        Complete mapping of the                    [PP0084]
                                            implementation representation of the
                                            TSF
                           ADV_INT.3        Minimally complex internals
                           ADV_TDS.5        Complete semi-formal modular design
                           ADV_SPM.1        Formal TOE security policy model
 Guidance Documents        AGD_OPE.1        Operational user guidance                  [PP0084]
                           AGD_PRE.1        Preparative procedures                     [PP0084]
 Life-Cycle Support        ALC_CMC.5        Advanced support                           [PP0084]
                           ALC_CMS.5        Development tools CM coverage              [PP0084]
                           ALC_DEL.1        Delivery procedures                        [PP0084]
                           ALC_DVS.2        Sufficiency of security measures           [PP0084]
                           ALC_LCD.1        Developer defined life-cycle model
                           ALC_TAT.3        Compliance with implementation
                                            standards – all parts
 ST Evaluation             ASE_CCL.1        Conformance claims
                           ASE_ECD.1        Extended components definition
                           ASE_INT.1        ST introduction
                           ASE_OBJ.2        Security objectives
                           ASE_REQ.2        Derived security requirements
                           ASE_SPD.1        Security problem definition
                           ASE_TSS.1        TOE summary specification
 Tests                     ATE_COV.3        Rigorous analysis of coverage              [PP0084]
                           ATE_DPT.3        Testing: modular design
                           ATE_FUN.2        Ordered functional testing
                           ATE_IND.2        Independent testing - sample
 Vulnerability             AVA_VAN.5        Advanced methodical vulnerability          [PP0084]
 Assessment                                 analysis

6.2.1              Refinements
Some refinements are taken unchanged from [PP0084]. Table 23 provides an overview.
Some refinements from [PP0084] have to be discussed here in the ST, as the assurance level is increased.




Security Target                                       46                                                   v4.0
                                                                                                     2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

6.2.1.1              Implementation representation (ADV_IMP)
The refinement of [PP0084] requires the evaluator to check for completeness. In case of ADV_IMP.2 the entire
implementation representation has to be provided anyhow. A check for completeness is also applicable in case
the entire implementation representation is provided.

6.2.1.2              Life cycle support (ALC_CMS)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ALC_CMS.5.
The assurance package ALC_CMS.4 is extended to ALC_CMS.5 with aspects regarding the configuration control
system for the TOE. The refinement is still valid.

6.2.1.3              Configuration management capabilities (ALC_CMC)
The refinement from [PP0084] details, how configuration management has to be also applied to production.
This is also applicable for ALC_CMC.5. ALC_CMC.5 is not specifically focused on production.

6.2.1.4              Test Coverage (ATE_COV)
The refinement in [PP0084] clarifies, how to deal with testing of security mechanisms for physical protection. It
further requests the TOE to be tested under different operating conditions. These refinements are also
applicable for ATE_COV.3, which requires complete TSFI coverage.

6.2.1.5              Functional Specification (ADV_FSP)
The refinement from [PP0084] can also be applied to the assurance level EAL 6 augmented with ADV_FSP.5. The
assurance package ADV_FSP.4 is extended to ADV_FSP.5 with aspects regarding the level of description.
ADV_FSP.5 requires a semi-formal description in addition. The refinement is still valid.
For refinement details see [PP0084].

6.2.2                Security policy model details
EAL6 requires the development of a formal security policy model of the TSF, and establishing a correspondence
between the functional specification and this security policy model. Preserving internal consistency the
security policy model is expected to formally establish the security principles from its characteristics by means
of a mathematical proof.
ADV_SPM.1          Formal TOE security policy model
Hierarchical to:          No other components
Dependencies:             ADV_FSP.4 Complete function description
ADV_SPM.1.1D              The developer shall provide a formal security policy model for the
Memory Access Control Policy and the corresponding SFRs
              o    FDP_ACC.1 Subset Access Control
              o    FDP_ACF.1 Security attribute based access control
              o    FMT_MSA.1 Management of Security Attributes
              o    FMT_MSA.3 Static Attribute Initialization.
              o    FMT_SMF.1 Specification of management functions
              o    FMT_SMR.1 Security roles


Security Target                                          47                                                   v4.0
                                                                                                        2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

Support of Flash Loader SFRs
            o FMT_LIM.1/Loader Limited Capabilities
            o FMT_LIM.2/Loader Limited availability – Loader
            o FTP_ITC.1 Inter-TSF trusted channel
            o FDP_UCT.1 Basic data exchange confidentiality
            o FDP_UIT.1 Data exchange integrity
            o FDP_ACC.1/Loader Subset access control – Loader
            o FDP_ACF.1/Loader Security attribute based access control – Loader
            o FMT_MTD.1/Loader Management of TSF data – Loader
            o FMT_SMR.1/Loader Security roles – Loader
            o FMT_SMF.1/Loader Specification of Management Functions – Loader
            o FIA_UID.2/Loader Use identification before any action – Loader
Support of Authentication of the Security IC SFR
            o FIA_API.1 Authentication Proof of Identity
Moreover, the following SFRs shall be addressed by the formal security policy model:
              o   FDP_SDI.2 Stored data integrity monitoring and action
              o   FDP_SDC.1 Stored data confidentiality
              o   FDP_ITT.1 Basic  Transfer Protection
              o   FDP_IFC.1 Information Flow Control
              o   FPT_ITT.1 Basic internal TSF data transfer protection
              o   FPT_PHP.3 Resistance to physical attack
              o   FPT_FLS.1 Failure with preservation of secure state
              o   FRU_FLT.2 Limited fault tolerance
              o   FMT_LIM.1 Limited capabilities
              o   FMT_LIM.2 Limited availability
              o   FAU_SAS.1 Audit storage
ADV_SPM.1.2D For each policy covered by the formal security policy model, the model shall identify the
          relevant portions of the statement of SFRs that make up that policy.
ADV_SPM.1.3D The developer shall provide a formal proof of correspondence between the model and any
          formal functional specification.
ADV_SPM.1.4D The developer shall provide a demonstration of correspondence between the model and the
          functional specification.

6.3                 Security Requirements Rationale

6.3.1               Rationale for the Security Functional Requirements
While the security functional requirements rationale of the TOE are defined and described in [PP0084] section
6.3.1, 7.2.3, 7.3.1, 7.3.2, 7.4.1 and 7.4.2, the additional introduced SFRs are discussed below:

Table 24      Rational for additional SFR in the ST
 Objective                            TOE Security Functional Requirements
 O.Phys-Manipulation                  -       FPT_TST.2 „ Subset TOE security testing “
 O.Mem-Access                         -       FDP_ACC.1 “Subset access control”

Security Target                                        48                                                   v4.0
                                                                                                      2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Objective                            TOE Security Functional Requirements
                                      -     FDP_ACF.1 “Security attribute based access control”
                                      -     FMT_MSA.3 “Static attribute initialisation”
                                      -     FMT_MSA.1 “Management of security attributes”
                                      -     FMT_SMF.1 “Specification of Management Functions”
                                      -     FMT_SMR.1 “Security Roles”
 O.AES-TDES-MAC                       FCS_COP.1/SCL/TDES, FCS_COP.1/SCL/TDES-MAC, FCS_CKM.4/SCL,
                                      FCS_COP.1/SCL/AES, FCS_COP.1/SCL/AES-MAC,
 O.AES                                FCS_CKM.4/SCL, FCS_COP.1/SCL/AES
 O.TDES                               FCS_COP.1/SCL/TDES, FCS_CKM.4/SCL
 O.RSA                                FCS_COP.1/RSA/<iteration>, FCS_CKM.1/RSA/<iteration>,
                                      FCS_CKM.4/RSA
 O.ECC                                FCS_COP.1/ECC/<iteration>, FCS_CKM.1/ECC, FCS_CKM.4/ECC
 O.Prot_TSF_Confidentiality           -      FTP_ITC.1 Inter-trusted-TSF channel
                                      -      FDP_ACC.1/Loader Subset access control –Loader
                                      -      FDP_ACF.1/Loader Security attribute based access control –
                                      Loader
 O.Ctrl_Auth_Loader                   FMT_MTD.1/Loader, FMT_SMR.1/Loader, FMT_SMF.1/Loader,
                                      FIA_UID.2/Loader

The table above gives an overview how the security functional requirements are combined to meet the security
objectives. This table has to be read in addition to [PP0084] table 2 “Security Requirements versus Security
Objectives”. The detailed justification is given in the following:
The security functional component Subset TOE security testing (FPT_TST.2) has been newly created (Common
Criteria Part 2 extended). This component allows that particular parts of the security mechanisms and
functions provided by the TOE can be tested after TOE Delivery. This security functional component is used
instead of the functional component FPT_TST.1 from Common Criteria Part 2. For the user it is important to
know which security functions or mechanisms can be tested. The functional component FPT_TST.1 does not
mandate to explicitly specify the security functions being tested. In addition, FPT_TST.1 requires verification of
the integrity of TSF data and stored TSF executable code which might violate the security policy.
The security functional requirement FPT_TST.2 detects attempts to conduce a physical manipulation on the
monitoring functions of the TOE. The objective of FPT_TST.2 is O.Phys-Manipulation.
The security functional requirement “Subset access control (FDP_ACC.1)” with the related Security Function
Policy (SFP) “Memory Access Control Policy” exactly require the implementation of an area based memory
access control as required by O.Mem-Access. The related TOE security functional requirements FDP_ACC.1,
FDP_ACF.1, FMT_MSA.3, FMT_MSA.1, FMT_SMF.1 and FMT_SMR.1 cover this security objective. The
implementation of these functional requirements is represented by the dedicated privilege level concept.
The additional SCL related SFRs support standard TDES and AES encryption and decryption. It also offers MAC
services based on these cryptographic primitives.
The additional cryptographic SFRs related to RSA and ECC are mapped to the respective RSA and ECC
objectives.
The additional loader SFRs describe the Flash Loader roles and the access rules. Therefore these additional
SFRs are mapped to O.Ctrl_Auth_Loader contributing to the aspect “access control for usage of the loader
functionality” as described in [PP0084]. In case EA is chosen, FTP_ITC.1 is not part of the TOE and therefore not


Security Target                                         49                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

mapped to O.Ctrl_Auth_Loader. However due to the confidentiality and integrity protection of downloaded
user data andone-way authentication from user towards Flash Loader, the loader can still be controlled in an
effective way and prevent misuse of unauthorized usage.
The loader SFR FTP_ITC.1, FDP_ACC.1/Loader and FDP_ACF.1/Loader describe the requirement of a trusted
channel with role based access control in order to use the loader functionality. This prevents loading of
unauthorized software by unauthorized subjects and maps to O.Prot_TSF_Confidentiality. In case EA is chosen,
the Flash Loader requests a one-way authentication instead of a mutual authentication. FTP_ITC.1 is not part
of the TOE. However the objective is still met, because the one-way authentication and role based access
control together with the environmental objective OE.Prevent_Masquerade prevent unauthorized and
manipulative usage.
The justification of the security objective and the additional requirements show that they do not contradict the
rationale already given in [PP0084] for the assumptions, policy and threats defined there.
Nevertheless, the developer of the Smartcard Embedded Software must ensure that the additional functions
are used as specified and that the User Data processed by these functions are protected as defined for the
application context. The TOE only provides the tool to implement the policy defined in the context of the
application.

6.3.1.1            Dependencies of Security Functional Requirements
The dependencies of security functional requirements are defined and described in [PP0084] section 6.3.2,
7.2.3, 7.3.1, 7.3.2, 7.4.1 and section 7.4.2 for the following security functional requirements: FDP_SDC.1,
FDP_SDI.2, FDP_ITT.1, FDP_IFC.1, FPT_ITT.1, FPT_PHP.3, FPT_FLS.1, FRU_FLT.2, FMT_LIM.1, FMT_LIM.2,
FCS_RNG.1. FAU_SAS.1, FIA_API.1, FMT_LIM.1/Loader, FMT_LIM.2/Loader, FTP_ITC.1, FDP_UCT.1, FDP_UIT.1,
FDP_ACC.1/Loader, FDP_ACF.1/Loader.
The dependencies of the additional security functional requirements (the functional requirements in addition
to the ones defined in [PP0084]) are analysed in the following description.

Table 25      Dependency for cryptographic operation requirement
 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
 FPT_TST.2                           None                        n.a.
 FDP_ACC.1                           FDP_ACF.1                   Yes
                                     FDP_ACC.1                   Yes
 FDP_ACF.1
                                     FMT_MSA.3                   Yes
                                     FMT_MSA.1                   Yes
 FMT_MSA.3
                                     FMT_SMR.1                   Yes
                                     FDP_ACC.1 or FDP_IFC.1      Yes
 FMT_MSA.1                           FMT_SMR.1                   Yes
                                     FMT_SMF.1                   Yes
 FMT_SMF.1                           None                        n.a.
 FMT_SMR.1                           FIA_UID.1                   No, see comment 1
 FCS_COP.1                           FCS_CKM.4                   Yes
                                     [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]
 FCS_CKM.4                           [FDP_ITC.1 or FDP_ITC.2     No, see comment 2
                                     or FCS_CKM.1]

Security Target                                        50                                                    v4.0
                                                                                                       2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

 Security Functional
                                     Dependencies                Fulfilled by security requirements
 Requirement
                                     [FCS_CKM.2,
 FCS_CKM.1                                                       Yes, FCS_CKM.4
                                     FCS_COP.1, FCS_CKM.4]
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UCT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
                                     [FTP_ITC.1 or               Yes in case EA unavailable
 FDP_UIT.1
                                     FTP_TRP.1]                  No in case EA available, see comment 4
 FDP_ACF.1/Loader                    FMT_MSA.3                   No, see comment 3
 FMT_MTD.1/Loader                    FMT_SMR.1, FMT_SMF.1        Yes
 FMT_SMR.1/Loader                    FIA_UID.2                   Yes
 FMT_SMF.1/Loader                    FIA_UID.2                   Yes

Comment 1:
As the privileged mode and the non-privileged mode identified in FMT_SMR.1 are implicitly identified by the
MPU, the dependency to FIA_UID.1 is not applicable.
End of comment.
Comment 2:
The security functional requirement “Cryptographic operation (FCS_COP.1)” met by the TOE has the following
dependencies:
    [FDP_ITC.1 Import of user data without security attributes, or
    FDP_ITC.2 Import of user data with security attributes or
    FCS_CKM.1 Cryptographic key generation]
    FCS_CKM.4 Cryptographic key destruction.
These requirements all address the appropriate management of cryptographic keys used by the specified
cryptographic function. Most requirements concerning key management shall be fulfilled by the environment
since the Smartcard Embedded Software is designed for a specific application context and uses the
cryptographic functions provided by the TOE.
For the security functional requirement FCS_COP.1/SCP/<iteration> and FCS_COP.1/SCL/<iteration> the
respective dependency [FCS_CKM.1 or FDP_ITC.1 or FDP_ITC.2] has to be fulfilled by the environment.
For the security functional requirement FCS_COP.1/RSA/<iteration>, FCS_COP.1/ECC/<iteration> key
generation is also supported by the ACL, therefore the dependency [FCS_CKM.1 or FDP_ITC.1 or FDP_ITC.2] is
met.




The security functional requirement “Cryptographic key destruction (FCS_CKM.4)” met by the TOE has the
following dependencies:
    [FDP_ITC.1 Import of user data without security attributes, or
    FDP_ITC.2 Import of user data with security attributes or
    FCS_CKM.1 Cryptographic key generation]



Security Target                                        51                                                   v4.0
                                                                                                      2020-10-15
Security Target Lite

Security Requirements (ASE_REQ)

For the security functional requirement FCS_COP.1/SCP/<iteration> and FCS_COP.1/SCL/<iteration> the
respective dependency [FCS_CKM.1 or FDP_ITC.1 or FDP_ITC.2] has to be fulfilled by the environment.
For the security functional requirement FCS_COP.1/RSA/<iteration>, FCS_COP.1/ECC/<iteration> the
dependenvy is met by FCS_CKM.1.
End of comment.
Comment 3:
There are no security attributes defined for the loader. Access is purely role based.
End of comment.
Comment 4:
The user data to be downloaded are encrypted and integrity protected with the image provider key. Only an
authentic TOE knows this image provider key and is able to decrypt the encrypted user data. Therefore a
trusted channel is not necessary to keep user data confidential.
End of comment

6.3.2              Rationale of the Assurance Requirements
The chosen assurance level EAL6 is augmented by ALC_FLR.1 in order to meet the assurance expectations
explained in the following paragraphs. In Table 23 the different assurance levels are shown as well as the
augmentations. The augmentations are in compliance with the Protection Profile.
An assurance level EAL6 with the augmentations ALC_FLR.1is required for this type of TOE since it is intended
to defend against highly sophisticated attacks without protective environment. This evaluation assurance
package was selected to permit a developer to gain maximum assurance from positive security engineering
based on good commercial practices. In order to provide a meaningful level of assurance that the TOE provides
an adequate level of defence against such attacks, the evaluators should have access to all information
regarding the TOE including the TSF internals, the low level design and source code including the testing of the
modular design. Additionally the mandatory technical document [JIL_ATT] shall be taken as a basis for the
vulnerability analysis of the TOE.




Security Target                                         52                                                   v4.0
                                                                                                       2020-10-15
Security Target Lite

TOE Summary Specification (ASE_TSS)


7                  TOE Summary Specification (ASE_TSS)
The product overview is given in Section 1.3.1. The Security Features are described below and the relation to
the security functional requirements is shown.
The TOE is equipped with the following security features to meet the security functional requirements:

Table 26      TOE Security Features
 SF_DPM                               Device Phase Management
 SF_PS                                Protection against Snooping
 SF_PMA                               Protection against Modification Attacks
 SF_PLA                               Protection against Logical Attacks
 SF_CS                                Cryptographic Support

The following description of the security features is a complete representation of the TSF.

7.1                SF_DPM: Device Phase Management
The life cycle of the TOE is split up into several phases. . Different operation modes help to protect the TOE
during each phase of its lifecycle.



7.2                SF_PS: Protection against Snooping
The TOE uses various means to protect from snooping of memories and busses and prevents single stepping.

7.3                SF_PMA: Protection against Modifying Attacks
This TOE implements protection against modifying attacks of memories, alarm lines, sensors and instruction
execution order.

7.4                SF_PLA: Protection against Logical Attacks
Memory access of the TOE is controlled by a Memory Protection Unit (MPU), which implements different
priviledge levels. The MPU decides, whether access to a physical memory location is allowed based on access
rights.

7.5                SF_CS: Cryptographic Support
The TOE is equipped with an asymmetric and a symmetric hardware accelerator and also software modules to
support several symmetric and asymmetric cryptographic operations. It further provides random numbers to
meet FCS_RNG.1.



7.6                Assignment of Security Functional Requirements to TOE’s Security
                   Functionality
The justification and overview of the mapping between security functional requirements (SFR) and the TOE’s
security functionality (SF) is given in the sections above. The results are shown in Table 27. The security
functional requirements are addressed by at least one related security feature.

Security Target                                         53                                                      v4.0
                                                                                                          2020-10-15
Security Target Lite

TOE Summary Specification (ASE_TSS)

Table 27      Mapping of SFR and SF
 SFR                                  SF_DPM   SF_PS    SF_PMA   SF_PLA   SF_CS
 FRU_FLT.2                                              x
 FPT_FLS.1                                     x        x                 x
 FMT_LIM.1                            x
 FMT_LIM.2                            x
 FAU_SAS.1                            x
 FDP_SDC.1                                     x
 FDP_SDI.2                                              x
 FPT_PHP.3                                     x        x                 x
 FDP_ITT.1                            x        x        x                 x
 FPT_ITT.1                            x        x        x                 x
 FDP_IFC.1                                     x        x
 FCS_COP.1/SCP/<iteration>                                                x
 FCS_CKM.4/SCP                                                            x
 FCS_COP.1/SCL/<iteration>                                                x
 FCS_CKM.4/SCL                                                            x
 FCS_COP.1/RSA/<iteration>                                                x
 FCS_CKM.1/RSA/<iteration>                                                x
 FCS_CKM.4/RSA                                                            x
 FCS_COP.1/ECC/<iteration>                                                x
 FCS_CKM.1/ECC                                                            x
 FCS_CKM.4/ECC                                                            x
 FCS_RNG.1/TRNG                                                           x
 FCS_RNG.1/HPRG                                                           x
 FCS_RNG.1/DRNG                                                           x
 FCS_RNG.1/DRNG4                                                          x
 FMT_LIM.1/Loader                     x
 FMT_LIM.2/Loader                     x
 FTP_ITC.1                            x
 FDP_UCT.1                            x
 FDP_UIT.1                            x
 FDP_ACC.1/Loader                     x
 FDP_ACF.1/Loader                     x
 FMT_MTD.1/Loader                     x
 FMT_SMR.1/Loader                     x
 FMT_SMF.1/Loader                     x
 FIA_UID.2/Loader                     x
 FIA_API.1                            x
 FPT_TST.2                                              x


Security Target                                    54                               v4.0
                                                                              2020-10-15
Security Target Lite

TOE Summary Specification (ASE_TSS)

 FDP_ACC.1                                                                        x
 FDP_ACF.1                                                                        x
 FMT_MSA.1                                                                        x
 FMT_MSA.3                                                                        x
 FMT_SMF.1                                                                        x
 FMT_SMR.1                                                                        x

7.7               Security Requirements are internally consistent
For this chapter [PP0084] section 6.3.4 can be applied completely.
The functional requirement FPT_TST.2 requires further protection to prevent manipulation of test results,
while checking the security functions of the TOE. An attacker could aim to switch off or disturb certain sensors
or filters and prevent the detection of distortion by blocking the correct operation of FPT_TST.2. The security
functional requirements required to meet the security objectives O.Leak-Inherent, O.Phys-Probing,
O.Malfunction, O.Phys-Manipulation and O.Leak-Forced also protect the security functional requirement
FPT_TST.2. Therefore, the related security functional requirements support the secure implementation and
operation of FPT_TST.2.
The requirement FPT_TST.2 allows testing of some security mechanisms by the Smartcard Embedded Software
after delivery.
The implemented privilege level concept represents the area based memory access protection enforced by the
MPU. As an attacker could attempt to manipulate the level concept as defined and present in the TOE, the
functional requirement FDP_ACC.1 and the related other requirements have to be protected. The security
functional requirements necessary to meet the security objectives O.Leak-Inherent, O.Phys-Probing,
O.Malfunction, O.Phys-Manipulation and O.Leak-Forced also protect the area based memory access control
function implemented according to the security functional requirement described in the security functional
requirement FDP_ACC.1 with reference to the Memory Access Control Policy and details given in FDP_ACF.1.
Therefore, those security functional requirements support the secure implementation and operation of
FDP_ACF.1 with its dependent security functional requirements.




Security Target                                        55                                                     v4.0
                                                                                                        2020-10-15
Security Target Lite

References


8                  References

 Reference        Standard Description
 Name
 [ANSX9.62]       American National Standard for Financial Services ANS X9.62-2005, Public Key Cryptography
                  for the Financial Services Industry, The Elliptic Curve Digital Signature Algorithm (ECDSA),
                  November 16, 2005, American National Standards Institute

 [ANSX9.63]       American National Standard for Financial Services X9.63-2001, Public Key Cryptography for
                  the Financial Services Industry: Key Agreement and Key Transport Using Elliptic Curve
                  Cryptography, November 20, 2001, American National Standards Institute

 [ARMv7M]         ARMv7-M Architecture Reference Manual, ARM DDI 0403D ID021310, 12. February 2010, ARM
                  Limited
 [BSI_RNGs]       A proposal for: Functionality classes for random number generators, Wolfgang Killmann,
                  Werner Schindler, Version 2.0, 18 Sept 2011
 [CCBook2]        Common Criteria for Information Technology Security Evaluation Part 2: Security
                  Functional Requirements; Version 3.1 Revision 5 April 2017, CCMB-2017-04-002
 [CCBook3]        Common Criteria for Information Technology Security Evaluation Part 3: Security
                  Assurance Requirements; Version 3.1 Revision 5 April 2017, CCMB-2017-04-003
 [IETF5639]       IETF: RFC 5639, Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve
                  Generation, March 2010, http://www.ietf.org/rfc/rfc5639.txt
 [IEEE1363]       IEEE 1363 Standard Specification for Public Key Cryptography, January 2000
 [ISO11770_3]     ISO/IEC 11770-3: 2009 - Information Technology - Security techniques - Key management -
       lost savings,
                                    business interruption, costs related to the removal or replacement of any products or
                                    rework charges) whether or not such damages are based on tort (including negligence),
                                    warranty, breach of contract or any other legal theory.
                                    Notwithstanding any damages that customer might incur for any reason whatsoever,
                                    NXP Semiconductors’ aggregate and cumulative liability towards customer for the
                                    products described herein shall be limited in accordance with the Terms and conditions
                                    of commercial sale of NXP Semiconductors.
                                    Right to make changes — NXP Semiconductors reserves the right to make changes
                                    to information published in this document, including without limitation specifications and
                                    product descriptions, at any time and without notice. This document supersedes and
                                    replaces all information supplied prior to the publication hereof.
                                    Suitability for use — NXP Semiconductors products are not designed, authorized or
                                    warranted to be suitable for use in life support, life-critical or safety-critical systems or
                                    equipment, nor in applications where failure or malfunction of an NXP Semiconductors
                                    product can reasonably be expected to result in personal injury, death or severe property
                                    or environmental damage. NXP Semiconductors and its suppliers accept no liability for
                                    inclusion and/or use of NXP Semiconductors products in such equipment or applications
                                    and therefore such inclusion and/or use is at the customer’s own risk.
                                    Applications — Applications that are described herein for any of these products are for
                                    illustrative purposes only. NXP Semiconductors makes no representation or warranty
                                    that such applications will be suitable for the specified use without further testing or
                                    modification.
                                    Export control — This document as well as the item(s) described herein may be subject
                                    to export control regulations. Export might require a prior authorization from competent
                                    authorities.




Crypto Library Cobalt on N7021 VA                   All information provided in this document is subject to legal disclaimers.     © NXP B.V. 2019. All rights reserved.

Product evaluation document                                         Rev. 2.3 — 5 June 2019
PUBLIC                                                                                                                                                       32 / 35
NXP Semiconductors                                                                                            Crypto Library Cobalt on N7021 VA
                     Part 3: Mechanisms using asymmetric techniques, Technical Corrigendum 1

 [ISO18033_3]     ISO/IEC 18033-3: 2005 - Information Technology - Security techniques - Encryption
                  algorithms - Part 3: Block ciphers (for AES)
 [ISO9797B]       ISO/IEC 9797-1: 2011 - Information Technology - Security techniques - Message
                  Authentication Codes - Part 1: Mechanisms using block cipher
 [ISO9798_2]      ISO/IEC 9798-2: 2008 - Information Technology - Security techniques - Entity authentication -
                  Part 2: Mechanisms using symmetric encipherment algorithms
 [JIL_ATT]        Joint Interpretation Library, Application of Attack Potential to Smartcards, Version 2.9,
                  January 2013
 [N186-4]         NIST: FIPS publication 186-4: Digital Signature Standard (DSS), July 2013
 [N197]           Federal Information Processing Standards Publication, U.S. Department of Commerce,
                  National Institute of Standards and Technology, Information Technology Laboratory (ITL),
                  Advanced Encryption Standard (AES), FIPS PUB 197, as of 26st November 2001
 [N800-22]        National Institute of Standards and Technology(NIST), Technology Administration, US
                  Department of Commerce, Special Publication, A Statistical Test Suite for Random and
                  Pseudorandom Number Generators for Cryptographic Applications, in the revision 1a as of
                  April 2010
 [N800-38A]       National Institute of Standards and Technology (NIST), Technology Administration, U.S.
                  Department of Data Encryption Standard, NIST Special Publication 800-38A, Edition 2001


Security Target                                         56                                                     v4.0
                                                                                                         2020-10-15
Security Target Lite

References

 [N800-38B]       National Institute of Standards and Technology (NIST), Technology Administration, U.S.
                  Department of Data Encryption Standard, NIST Special Publication 800-38B, Edition 2005
                  with updates as of 2016-10-06
 [N800-67B]       National Institute of Standards and Technology (NIST), Technology Administration, U.S.
                  Department of Commerce, NIST Special Publication 800-67, Recommendation for the Triple
                  Data Encryption Algorithm (TDEA) Block Cipher, Revised July 2017, Revision 2
 [PP0084]         Security IC Platform Protection Profile with Augmentation Packages, Version 1.0, 13.01.2014,
                  BSI-CC-PP-0084-2014
 [RSA-PKCSB]      PKCS #1: RSA Cryptography Standard, v2.2, October 27, 2012, RSA Laboratories



Note that the versions of these documents are listed in the certification report.




Security Target                                         57                                                  v4.0
                                                                                                      2020-10-15
Security Target Lite

Appendix: hash signatures of NRGҹ SW


9                 Appendix: hash signatures of NRGҹ SW
9.1               Hash Digests of the NrgOS.lib
MD5               9be5ee66ba20ad52f1a83c10aab501a1
SHA-1             c52cd426140b651596d1940c97489c10435d6fb4
SHA-256           0fc29ec712b9ba5a8a0f7541118702768b53ed43b8109df8584b8ef2539a2c64

9.2               Hash Digests of the NrgManagement.lib
MD5               b38c917c38d5fe685fb3031032892769
SHA-1             e08e13020682583dc2c9f70bd3fa1b088478f9f9
SHA-256           d130d7f45c8ef36de013d6132593e5279c85a172742fe45a2e7d2b3e02f8aac5




Security Target                             58                                    v4.0
                                                                            2020-10-15
Security Target Lite

Appendix: hash signatures of the HSL


10                Appendix: hash signatures of the HSL
HSL-03.52.9708-SLCx7V11a.lib
MD5               2e1ec43d5d13d27d65456cbeb7a84cc4
SHA-1             05d4e3caa916a6182aed7b06354153bcf04d82c7
SHA-256           7df825ec42763570334e641f72fc41466712d6d231a9bf75174acb5005f3869a




Security Target                            59                                     v4.0
                                                                            2020-10-15
Security Target Lite

Appendix: hash signatures of UMSLC lib


11                Appendix: hash signatures of UMSLC lib
UMSLC-01.30.0564-SLCx7V11a.lib:
MD5               b444ffaed77933be4407935f135728a7
SHA-1             c0ba8430b96a2dc7888067fd0da301ff3405736d
SHA-256           af948dfe1449b4bf20c4cdd23d6f40efb98515c84712a2526dfaf229fcda9536




Security Target                            60                                     v4.0
                                                                            2020-10-15
Security Target Lite

Appendix: hash signatures of SCL


12                Appendix: hash signatures of SCL
SCL37-SCP-v440-C40-cipher.lib:
MD5=              be3b586f0a28aa9d49aadc50a2db4be1
SHA1=             caf62712f4f822d2db989c14b8bc11b1098ec9a1
SHA256=           97a0c49036d07949f7d9e4da73be12b9cd2c465ee964c03af44751c9635bed2c


SCL37-SCP-v440-C40-mac.lib:
MD5=              bd46c41dd39dbd7a6c4de80dea52aef4
SHA1=             a25631b3f205eb8cb06abf40503153759b8f9b80
SHA256=           8e7c75b110872c698038d13ffa474f4704c908cc64e497fb6b263c768236ce47


SCL37-SCP-v440-C40-des.lib:
MD5=              ffc9fe59c7332ceb08d985e5a94ffd98
SHA1=             b19a97b32db533394a758a366bee535d4dbc4943
SHA256=           5e7fd5230b21a36420934841e1205beff46c70011095aceaa4ce8d2ed868d213


SCL37-SCP-v440-C40-aes.lib:
MD5=              852e3074775fa559fce734e86216e9e4
SHA1=             182663c8043ff906065feda20689090a1a8721fc
SHA256=           27547d8f5cfe26c89c4460e5bc254e9f1937768e9f9d681c9c04607e4f87a784




Security Target                            61                                     v4.0
                                                                            2020-10-15
Security Target Lite

Appendix: hash signatures of ACL


13                Appendix: hash signatures of ACL
ACL37-Crypto2304T-C40-base.lib:
MD5=              8760a5214c99c82f3d34fc8e8d295415
SHA1=             8cb34365b251f955e8baf7ba64950330898df8c9
SHA256=           f93fa12c7bc870f681f727b4081f198174d996ef5d4fd7009ad5a3840240af6a


ACL37-Crypto2304T-C40-ecc.lib:
MD5=              8308a51c0f13accc971931512a76fd02
SHA1=             873d481fdb78c35897aa4626363b88a5b6ba9a59
SHA256=           589592b20079d53ee0d39de1f061661f6924ed3c90be22186457abcfa6b87589


ACL37-Crypto2304T-C40-rsa2k.lib:
MD5=              3285732229560b79313f54dfa4867925
SHA1=             ce3d709407c8dfeac486a57d4f7299b7f1194831
SHA256=           bbe1f19dc864c5ca4125f870db3cbf70067cb6d0bc27fe5948b328207c4f77d2


ACL37-Crypto2304T-C40-rsa4k.lib:
MD5=              8ef66b7a1bfd2d636e913a3723a5c82e
SHA1=             dc931964805af30b0140ab4eec074f3f2f08a45b
SHA256=           17694b594b1914ddae84af86a868061dc144c181d9c78e72d7d887bf22979812


ACL37-Crypto2304T-C40-toolbox.lib:
MD5=              57e151190ade670f9a7531acedc77a10
SHA1=             0374f32135f191ef0fdb28f40c85c1468398cf22
SHA256=           8405ef906fe0ddce4a3659e00d4d9c724f0e6d18a58b1d87a6af64969b985523




Security Target                            62                                     v4.0
                                                                            2020-10-15
Security Target Lite

List of Abbreviations


14                  List of Abbreviations
AES      Advanced Encryption Standard
ACLB     Advanced Contactless Bridge
ACM      Advanced Communication Mode: The Advanced Communication Mode enables communication with bit
         rates above 848 kbit/s
AFM      Advanced Framing Mode refers to to the frame format “Frames with error correct                                                                                                 TÜV Rheinland Nederland B.V.




                                                                                                                                                          Certification Report
Version 2018-1




                                                                                                                                           Crypto Library V3.1.x on P6022y VB




                                                                                                                  Sponsor and developer:           NXP Semiconductors Germany GmbH
                                                                                                                                                   Business Unit Security & Connectivity
                                                                                                                                                   Troplowitzstrasse 20, 22529 Hamburg
                                                                                                                                                   Germany


                                                                                                                  Evaluation facility:             Brightsight
                                                                                                                                                   Brassersplein 2
                                                                                                                                                   2612 CT Delft
                                                                                                                                                   The Netherlands


                                                                                                                  Report number:                   NSCIB-CC-67206-CR4.1

                                                                                                                  Report version:                  4.1

                                                                                                                  Project number:                  67206

                                                                                                                  Author(s):                       Wouter Slegers
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.




                                                                                                                  Date:                            25 August 2020

                                                                                                                  Number of pages:                 15

                                                                                                                  Number of appendices:            0




                                                                                                                  Reproduction of this report is authorized provided the report is reproduced in its entirety.




                                                                                                 Headoffice:                        Location Leek:                   info@nl.tuv.com                   TÜV Rheinland Nederland B.V. is a
                                                                                                 Westervoortsedijk 73               Eiberkamp 10                     www.tuv.com/nl                    registered company at the Dutch
                                                                                                 NL-6827 AV Arnhem                  NL-9351 VT Leek                                                    Chamber of Commerce under
                                                                                                                                                                     Tel. +31 (0)88 888 7 888          number 27288788
                                                                                                 P.O. Box 2220                      P.O. Box 37                      Fax +31 (0)88 888 7 879
                                                                                                 NL-6802 CE Arnhem                  NL-9350 AA Leek                                                    VAT number: NL815820380B01
                                                                                                 The Netherlands                    The Netherlands                                                    IBAN: NL61DEUT0265155096
                                                                                                 Page: 3/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 CONTENTS:

                                                                                                 Foreword                                                                   4

                                                                                                 Recognition of the certificate                                             5
                                                                                                 International recognition                                                  5
                                                                                                 European recognition                                                       5

                                                                                                 1 Executive Summary                                                        6

                                                                                                 2 Certification Results                                                    8
                                                                                                 2.1      Identification of Target of Evaluation                            8
                                                                                                 2.2      Security Policy                                                   9
                                                                                                 2.3      Assumptions and Clarification of Scope                            9
                                                                                                 2.4      Architectural Information                                         9
                                                                                                 2.5      Documentation                                                    10
                                                                                                 2.6      IT Product Testing                                               10
                                                                                                 2.7      Re-used evaluation results                                       12
                                                                                                 2.8      Evaluated Configuration                                          12
                                                                                                 2.9      Results of the Evaluation                                        12
                                                                                                 2.10     Comments/Recommendations                                         13

                                                                                                 3 Security Target                                                         14

                                                                                                 4 Definitions                                                             14

                                                                                                 5 Bibliography                                                            15
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 4/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 Foreword
                                                                                                 The Netherlands Scheme for Certification in the Area of IT Security (NSCIB) provides a third-party
                                                                                                 evaluation and certification service for determining the trustworthiness of Information Technology (IT)
                                                                                                 security products. Under this NSCIB, TÜV Rheinland Nederland B.V. has the task of issuing
                                                                                                 certificates for IT security products, as well as for protection profiles and sites.
                                                                                                 Part of the procedure is the technical examination (evaluation) of the product, protection profile or site
                                                                                                 according to the Common Criteria assessment guidelines published by the NSCIB. Evaluations are
                                                                                                 performed by an IT Security Evaluation Facility (ITSEF) under the oversight of the NSCIB Certification
                                                                                                 Body, which is operated by TÜV Rheinland Nederland B.V. in cooperation with the Ministry of the
                                                                                                 Interior and Kingdom Relations.
                                                                                                 An ITSEF in the Netherlands is a commercial facility that has been licensed by TÜV Rheinland
                                                                                                 Nederland B.V. to perform Common Criteria evaluations; a significant requirement for such a license is
                                                                                                 accreditation to the requirements of ISO Standard 17025 “General requirements for the accreditation
                                                                                                 of calibration and testing laboratories”.
                                                                                                 By awarding a Common Criteria certificate, TÜV Rheinland Nederland B.V. asserts that the product or
                                                                                                 site complies with the security requirements specified in the associated (site) security target, or that
                                                                                                 the protection profile (PP) complies with the requirements for PP evaluation specified in the Common
                                                                                                 Criteria for Information Security Evaluation. A (site) security target is a requirements specification
                                                                                                 document that defines the scope of the evaluation activities.
                                                                                                 The consumer should review the (site) security target or protection profile, in addition to this
                                                                                                 certification report, in order to gain an understanding of any assumptions made during the evaluation,
                                                                                                 the IT product's intended environment, its security requirements, and the level of confidence (i.e., the
                                                                                                 evaluation assurance level) that the product or site satisfies the security requirements stated in the
                                                                                                 (site) security target.
                                                                                                 Reproduction of this report is authorized provided the report is reproduced in its entirety.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 5/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 Recognition of the certificate
                                                                                                 Presence of the Common Criteria Recognition Arrangement and SOG-IS logos on the certificate
                                                                                                 indicates that this certificate is issued in accordance with the provisions of the CCRA and the SOG-IS
                                                                                                 agreement and will be recognised by the participating nations.

                                                                                                 International recognition
                                                                                                 The CCRA has been signed by the Netherlands in May 2000 and provides mutual recognition of
                                                                                                 certificates based on the CC. Starting September 2014 the CCRA has been updated to provide mutual
                                                                                                 recognition of certificates based on cPPs (exact use) or STs with evaluation assurance components
                                                                                                 up to and including EAL2+ALC_FLR. The current list of signatory nations and approved certification
                                                                                                 schemes can be found on: http://www.commoncriteriaportal.org.

                                                                                                 European recognition
                                                                                                 The European SOGIS-Mutual Recognition Agreement (SOGIS-MRA) version 3 effective from April
                                                                                                 2010 provides mutual recognition of Common Criteria and ITSEC certificates at a basic evaluation
                                                                                                 level for all products. A higher recognition level for evaluation levels beyond EAL4 (resp. E3-basic) is
                                                                                                 provided for products related to specific technical domains. This agreement was initially signed by
                                                                                                 Finland, France, Germany, The Netherlands, Norway, Spain, Sweden and the United Kingdom. Italy
                                                                                                 joined the SOGIS-MRA in December 2010. The current list of signatory nations, approved certification
                                                                                                 schemes and the list of technical domains for which the higher recognition applies can be found on:
                                                                                                 http://www.sogisportal.eu.
® TÜV, TUEV and TUV are registered trademarks. Any use or application requires prior approval.
                                                                                                 Page: 6/15 of report number: NSCIB-CC-67206-CR4.1, dated 25 August 2020




                                                                                                 1 Executive Summary
                                                                                                 This Certification Report states the outcome of the Common Criteria security evaluation of the Crypto
                                                                                                 Library V3.1.x on P6022y VB. The developer of the Crypto Library V3.1.x on P6022y VB is NXP
                                                                                                 Semiconductors Germany GmbH located in Hamburg, Germany and they also act as the sponsor of
                                                                                                 the evaluation and certification. A Certification Report is intended to assist prospective consumers
                                                                                                 when judging the suitability of the IT security properties of the product for their particular requirements.
                                                                                                 The Target of Evaluation (TOE) consists of the Crypto Library V3.1.x and the NXP Secure Smart Card
                                                                                                 Controller P6022y VB Secure Smart Card Controller. For ease of reading the TOE is often called
                                                                                                 “Crypto Library on SmartMX2”.
                                                                                                 The Crypto Library on SmartMX2 is a cryptographic library, which provides a set of cryptographic
                                                                                                 functions that can be used by the Smartcard Embedded Software. The cryptographic library consists
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    